"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[4542],{96926:function(e,t,n){n.d(t,{Z:function(){return K}});n(35668);var r=n(86585),a=n(87462),i=n(67294),o=n(93517),c=n.n(o),l=n(45697),s=n.n(l),u=n(96036),d=n(80385),m=(n(52560),n(71577)),p=(n(36037),n(47933)),f=n(4942),v=n(29439),y=(n(52466),n(10642)),h=n(93433),g=n(15861),E=n(87757),_=n.n(E),Z=n(88144),b={labelCol:{span:8},wrapperCol:{span:10}},I=function(e){var t=e.visible,n=e.setDepartmentVisible,o=e.changeValue,c=e.departmentInfo,l=r.Z.useForm(),s=(0,v.Z)(l,1)[0],d=(0,i.useRef)([]),m=function(e){var t=[];return e.forEach((function(e){t.some((function(t){return t.id===e.id}))||t.push(e)})),t},p=function(){var e=(0,g.Z)(_().mark((function e(){var t,r;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.validateFields();case 2:t=d.current,r=[].concat((0,h.Z)(t),(0,h.Z)(c)),o("departmentInfo",m(r)),s.resetFields(),n(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=[i.createElement(r.Z.Item,{name:"departmentIds",label:"添加部门",rules:[{required:!0,message:"请选择"}]},i.createElement(Z.MG,{isAuthorized:!0,multiple:!0,onChange:function(e,t){d.current=e.map((function(e,n){return{id:e,name:t[n]}}))},filterTreeNode:function(e,t){return!!(e.trim()&&t&&t.props&&-1!==t.props.title.trim().indexOf(e.trim()))}}))];return i.createElement(y.Z,{title:"添加部门",visible:t,onOk:p,onCancel:function(){n(!1)}},i.createElement(r.Z,(0,a.Z)({form:s},b),i.createElement(u.Fp,{items:f,cols:1})))},k=function(){};I.propTypes={visible:s().bool,setDepartmentVisible:s().func,changeValue:s().func,departmentInfo:s().array},I.defaultProps={visible:!1,setDepartmentVisible:k,changeValue:k,departmentInfo:[{}]};var S=I,O={labelCol:{span:8},wrapperCol:{span:10}},C=function(e){var t=e.visible,n=e.setAccountVisible,o=e.changeValue,c=e.accountInfo,l=r.Z.useForm(),s=(0,v.Z)(l,1)[0],d=(0,i.useRef)([]),m=function(e){var t=[];return e.forEach((function(e){t.some((function(t){return t.id===e.id}))||t.push(e)})),t},p=function(){var e=(0,g.Z)(_().mark((function e(){var t,r;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.validateFields();case 2:t=d.current.map((function(e){return{id:e.payload.account_id,name:e.payload.name}})),r=[].concat((0,h.Z)(t),(0,h.Z)(c)),o("accountInfo",m(r)),s.resetFields(),n(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=[i.createElement(r.Z.Item,{name:"accountIds",label:"添加成员",rules:[{required:!0,message:"请选择"}]},i.createElement(Z.kl,{mode:"multiple",showArrow:!0,placeholder:"请选择成员",showSearch:!0,optionFilterProp:"children",onChange:function(e,t){d.current=t}}))];return i.createElement(y.Z,{title:"添加成员",visible:t,onOk:p,onCancel:function(){n(!1)}},i.createElement(r.Z,(0,a.Z)({form:s},O),i.createElement(u.Fp,{items:f,cols:1})))},P=function(){};C.propTypes={visible:s().bool,setAccountVisible:s().func,changeValue:s().func,accountInfo:s().array},C.defaultProps={visible:!1,setAccountVisible:P,changeValue:P,accountInfo:[{}]};var w=C,V="yC2Zm4yN4EvDNZioKYs9",D="LRFW8Do9vTZykibh9MxM",j="BZL8_GKS3Yl8JpV1MSq7";function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e){var t=e.value,n=e.onChange,r=e.authorityDetail,a=(0,i.useState)(!1),o=(0,v.Z)(a,2),c=o[0],l=o[1],s=(0,i.useState)(!1),u=(0,v.Z)(s,2),y=u[0],h=u[1],g=function(){n(F(F({},t),{},{accountInfo:[],departmentInfo:[]}))},E=function(e,r){n(F(F({},t),{},(0,f.Z)({},e,r)))},_=function(e){e.target.value!==d.MmK.all?n({state:e.target.value,accountInfo:r.accountInfo,departmentInfo:r.departmentInfo}):n({state:e.target.value,accountInfo:[],departmentInfo:[]})};(0,i.useEffect)((function(){t.state===d.MmK.all&&g()}),[]);var Z,b,I;return i.createElement(i.Fragment,null,(Z=t.state,b=t.accountInfo,I=t.departmentInfo,i.createElement("div",{className:V},i.createElement("div",null,i.createElement(p.ZP.Group,{defaultValue:Z,onChange:_},i.createElement(p.ZP,{value:d.MmK.all},d.MmK.description(d.MmK.all)),i.createElement(p.ZP,{value:d.MmK.section},d.MmK.description(d.MmK.section)))),i.createElement("div",null,i.createElement(m.Z,{className:D,type:"primary",disabled:Z===d.MmK.all,onClick:function(){l(!0)}},"添加成员"),i.createElement(m.Z,{className:D,type:"primary",disabled:Z===d.MmK.all,onClick:function(){h(!0)}},"添加部门"),i.createElement(m.Z,{type:"primary",disabled:Z===d.MmK.all,onClick:g},"清空")),i.createElement("div",{className:j},function(e,t){return e.concat(t).reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),"")}(b,I)))),i.createElement(w,{accountInfo:t.accountInfo,changeValue:E,visible:c,setAccountVisible:l}),i.createElement(S,{departmentInfo:t.departmentInfo,changeValue:E,visible:y,setDepartmentVisible:h}))};L.propTypes={value:s().object,onChange:s().func,authorityDetail:s().object},L.defaultProps={value:{},onChange:function(){},authorityDetail:{}};var M=L,x={labelCol:{span:5},wrapperCol:{span:19}},q=function(e){var t=e.detail,n={state:c().get(t,"look_acl",d.MmK.section),accountInfo:c().get(t,"look_account_info_list",[]).map((function(e){return{id:e._id,name:e.name}})),departmentInfo:c().get(t,"look_department_info_list",[]).map((function(e){return{id:e._id,name:e.name}}))};return i.createElement(i.Fragment,null,[{item:[i.createElement(r.Z.Item,(0,a.Z)({},x,{name:"lookAccountInfo",label:"可见成员",rules:[{required:!0,message:"请选择"}]}),i.createElement(M,{authorityDetail:n}))]}].map((function(e,t){return i.createElement(u.Fp,{key:t,items:e.item,cols:e.col||2})})))};q.propTypes={detail:s().object},q.defaultProps={detail:{}};var K=q},76033:function(e,t,n){var r=n(93433),a=(n(29093),n(16317)),i=n(67294),o=n(55609),c=n(45697),l=n.n(c),s=a.Z.Option;function u(e){var t=e.dispatch,n=e.company,o=void 0===n?{}:n,c=e.onChange,l=e.value,u=e.otherChild,d=o.data,m=void 0===d?[]:d;(0,i.useEffect)((function(){t({type:"sharedCompany/getSharedCompany",payload:{_meta:{page:1,limit:9999}}})}),[t]);return i.createElement(a.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0,optionFilterProp:"children",onChange:c,value:l},!u._id||m.some((function(e){return e._id===u._id}))?m.map((function(e){return i.createElement(s,{value:e._id,key:e._id,child:e},e.name)})):[].concat((0,r.Z)(m),[u]).map((function(e){return e._id===u._id?i.createElement(s,{disabled:!0,value:e._id,key:e._id,child:e},e.name):i.createElement(s,{value:e._id,key:e._id,child:e},e.name)})))}u.propTypes={otherChild:l().object},u.defaultProps={otherChild:{}};t.Z=(0,o.connect)((function(e){return{company:e.sharedCompany.company}}))(u)},74542:function(e,t,n){n(52560);var r=n(71577),a=(n(54071),n(14072)),i=n(87462),o=(n(26574),n(9676)),c=(n(36037),n(47933)),l=n(4942),s=(n(51838),n(48086)),u=n(15861),d=(n(35668),n(86585)),m=n(29439),p=(n(9070),n(20924)),f=(n(29093),n(16317)),v=n(87757),y=n.n(v),h=n(93517),g=n.n(h),E=n(30381),_=n.n(E),Z=n(67294),b=n(55609),I=n(96036),k=n(86221),S=n(76033),O=n(96926),C=n(80385),P=n(88144),w=n(3127);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j={labelCol:{span:9},wrapperCol:{span:15}},A={labelCol:{span:3},wrapperCol:{span:21}},F=f.Z.Option,L=p.Z.TextArea;t.Z=(0,b.connect)((function(e){return{licenseDetail:e.sharedLicense.licenseDetail}}),(function(e){return{getLicenseDetail:function(t){return e({type:"sharedLicense/getSharedLicenseDetail",payload:t})},resetLicenseDetail:function(){return e({type:"sharedLicense/resetSharedLicenseDetail",payload:{}})},updateLicense:function(t){return e({type:"sharedLicense/updateSharedLicense",payload:t})},createLicense:function(t){return e({type:"sharedLicense/createSharedLicense",payload:t})}}}))((function(e){var t=e.getLicenseDetail,n=e.resetLicenseDetail,l=e.location,v=void 0===l?{}:l,h=e.licenseDetail,E=void 0===h?{}:h,b=e.isUpdate,V=void 0!==b&&b,M=e.createLicense,x=e.updateLicense,q=d.Z.useForm(),K=(0,m.Z)(q,1)[0],T=v.query,Y=void 0===T?{}:T,N=(0,Z.useState)(!1),W=(0,m.Z)(N,2),G=W[0],R=W[1],U=(0,Z.useState)([]),B=(0,m.Z)(U,2),z=B[0],J=B[1],$=(0,Z.useState)(!0),H=(0,m.Z)($,2),Q=H[0],X=H[1];if((0,Z.useEffect)((function(){return Y.id&&t({id:Y.id}),function(){return n()}}),[t,n,Y.id]),(0,Z.useEffect)((function(){V&&E&&Object.keys(E).length>0&&0===z.length&&ee()}),[E]),(0,Z.useEffect)((function(){V&&E&&Object.keys(E).length>0&&R(g().get(E,"cert_type",void 0)===C.Vvo.businessLicense)}),[E]),V&&(!E||Object.keys(E).length<=0))return Z.createElement("div",null);var ee=function(){var e=E.province_code,t=void 0===e?void 0:e,n=(t?w._.find((function(e){return e.code===Number(t)})):{}).children;J(void 0===n?[]:n)},te=E.from_date,ne=void 0===te?void 0:te,re=E.end_date,ae=void 0===re?void 0:re,ie=E.send_date,oe=void 0===ie?void 0:ie,ce=E.other_cert_deadline,le=void 0===ce?void 0:ce,se=E.province_code,ue=void 0===se?void 0:se,de=E.city_code,me=void 0===de?void 0:de,pe=function(){var e=(0,u.Z)(y().mark((function e(){var t,n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.validateFields();case 2:if(t=e.sent,(n=t.lookAccountInfo).state!==C.MmK.section||0!==n.accountInfo.length||0!==n.departmentInfo.length){e.next=6;break}return e.abrupt("return",s.ZP.error("请选择指定范围"));case 6:if(delete t.originForm,!V){e.next=13;break}return e.next=10,x(D(D({},t),{},{_id:Y.id}));case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,M(D({},t));case 15:e.t0=e.sent;case 16:(r=e.t0)&&(r._id||r.ok)&&(s.ZP.success("请求成功"),window.location.href="/#/Shared/License");case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=[Z.createElement(d.Z.Item,{name:"cert_type",label:"证照类型",rules:[{required:!0,message:"请选择证照类型"}]},Z.createElement(f.Z,{placeholder:"请选择",onChange:function(e){e===C.Vvo.businessLicense?R(!0):R(!1)}},Z.createElement(F,{value:C.Vvo.businessLicense},C.Vvo.description(C.Vvo.businessLicense)),Z.createElement(F,{value:C.Vvo.expressDelivery},C.Vvo.description(C.Vvo.expressDelivery)),Z.createElement(F,{value:C.Vvo.food},C.Vvo.description(C.Vvo.food)))),Z.createElement(d.Z.Item,{name:"keep_account_id",label:"证照负责人",rules:[{required:!0,message:"请选择证照负责人"}]},Z.createElement(P.kl,{fareManagerInfo:g().get(E,"keep_account_info",{}),placeholder:"请选择",showSearch:!0,optionFilterProp:"children"}))],ve=[Z.createElement(d.Z.Item,(0,i.Z)({label:"正副本",name:"originForm",dependencies:["origin","display"],rules:[{required:!0,validator:function(){var e=K.getFieldValue("origin"),t=K.getFieldValue("display");return V&&e&&t||e&&Array.isArray(t)&&t.length>0?Promise.resolve():Promise.reject("请选择正副本")}}]},A),Z.createElement("div",{style:{display:"flex"}},Z.createElement(d.Z.Item,{name:"origin"},Z.createElement(c.ZP.Group,null,Z.createElement(c.ZP,{value:C.Ak0.original},C.Ak0.description(C.Ak0.original)),Z.createElement(c.ZP,{value:C.Ak0.copy},C.Ak0.description(C.Ak0.copy)))),Z.createElement(d.Z.Item,{name:"display",style:{marginLeft:100}},V?Z.createElement(c.ZP.Group,null,Z.createElement(c.ZP,{value:C.Sdt.original},C.Sdt.description(C.Sdt.original)),Z.createElement(c.ZP,{value:C.Sdt.copies},C.Sdt.description(C.Sdt.copies)),Z.createElement(c.ZP,{value:C.Sdt.scannedCopy},C.Sdt.description(C.Sdt.scannedCopy))):Z.createElement(o.Z.Group,null,Z.createElement(o.Z,{value:C.Sdt.original},C.Sdt.description(C.Sdt.original)),Z.createElement(o.Z,{value:C.Sdt.copies},C.Sdt.description(C.Sdt.copies)),Z.createElement(o.Z,{value:C.Sdt.scannedCopy},C.Sdt.description(C.Sdt.scannedCopy))))))],ye=[Z.createElement(d.Z.Item,{name:"name",label:"证照名称",rules:[{required:!0,message:"请填写证照名称"}]},Z.createElement(p.Z,{placeholder:"请输入"})),Z.createElement(d.Z.Item,{name:"firm_id",label:"公司名称",rules:[{required:!0,message:"请选择公司名称"}]},Z.createElement(S.Z,{otherChild:g().get(E,"firm_info",{})}))],he=G?[Z.createElement(d.Z.Item,{name:"cert_no",label:"证照编号"},Z.createElement(p.Z,{placeholder:"请输入"})),Z.createElement(d.Z.Item,{name:"credit_no",label:"统一社会信用代码",rules:[{required:!0,message:"请填写统一社会信用代码"},function(){return{validator:function(e,t){return!t||/^[0-9A-Z]{1,}$/.test(t)?Promise.resolve():Promise.reject("请输入数字或大写字母")}}}]},Z.createElement(p.Z,{placeholder:"请输入"})),Z.createElement(d.Z.Item,{name:"from_date",label:"营业期限开始",rules:[{required:!0,message:"请选择营业期限开始"}]},Z.createElement(a.Z,{placeholder:"请选择",onChange:function(){K.setFieldsValue({end_date:null})}})),Z.createElement(d.Z.Item,{name:"end_date",label:"营业期限结束",rules:[{required:!0,message:"请选择营业期限结束"}]},Z.createElement(a.Z,{showToday:Q,placeholder:"请选择",disabledDate:function(e){var t=K.getFieldValue("from_date");return!!t&&(_()(t).format("YYYY-MM-DD")===_()().format("YYYY-MM-DD")?X(!1):X(!0),e&&e<_()(t).add(1,"days"))}})),Z.createElement(d.Z.Item,{name:"send_date",label:"发证日期",rules:[{required:!0,message:"请选择发证日期"}]},Z.createElement(a.Z,{placeholder:"请选择"})),Z.createElement(d.Z.Item,{name:"certification_unit",label:"发证单位",rules:[{required:!0,message:"请填写发证单位"}]},Z.createElement(p.Z,{placeholder:"请输入"})),Z.createElement(d.Z.Item,{name:"cert_deadline_type",label:"证照有效期",rules:[{required:!0,message:"请选择证照有效期"}]},Z.createElement(f.Z,{placeholder:"请选择"},Z.createElement(F,{value:C.WIA.exist},C.WIA.description(C.WIA.exist)),Z.createElement(F,{value:C.WIA.not},C.WIA.description(C.WIA.not)))),Z.createElement(d.Z.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.cert_deadline_type!==t.cert_deadline_type}},(function(e){return(0,e.getFieldValue)("cert_deadline_type")===C.WIA.exist?Z.createElement(d.Z.Item,{name:"other_cert_deadline",rules:[{required:!0,message:"请选择证照有效期"}]},Z.createElement(a.Z,{placeholder:"请选择"})):null})),{key:"area_code",span:24,render:Z.createElement(d.Z.Item,(0,i.Z)({name:"area",label:"公司区域"},A,{required:!0}),Z.createElement("div",{style:{display:"flex"}},Z.createElement(d.Z.Item,{name:"province_code",rules:[{required:!0,message:"请选择省份"}],style:{width:"25%",marginRight:5}},Z.createElement(f.Z,{onChange:function(e,t){var n=t.citychild,r=void 0===n?[]:n;K.setFieldsValue({city_code:void 0}),J(r)},placeholder:"请选择省份"},w._.map((function(e){return Z.createElement(F,{value:String(e.code),citychild:e.children},e.value)})))),Z.createElement(d.Z.Item,{name:"city_code",style:{width:"30%"},rules:[{required:!0,message:"请选择城市"}]},Z.createElement(f.Z,{placeholder:"请选择城市"},z.map((function(e){return Z.createElement(F,{value:String(e.code)},e.value)}))))))}]:[],ge=[Z.createElement(d.Z.Item,(0,i.Z)({name:"note",label:"备注"},A),Z.createElement(L,{rows:4,placeholder:"请输入"})),Z.createElement(d.Z.Item,(0,i.Z)({label:"附件",name:"asset_keys"},A),Z.createElement(k.uA,{domain:k.uA.UploadDomains.OAUploadDomain}))],Ee={cert_type:g().get(E,"cert_type",void 0),keep_account_id:g().get(E,"keep_account_info._id",void 0),name:g().get(E,"name",void 0),firm_id:g().get(E,"firm_info._id",void 0),cert_no:g().get(E,"cert_no",void 0),credit_no:g().get(E,"credit_no",void 0),from_date:ne?_()(String(ne)):void 0,end_date:ae?_()(String(ae)):void 0,send_date:oe?_()(String(oe)):void 0,certification_unit:g().get(E,"certification_unit",void 0),cert_deadline_type:g().get(E,"cert_deadline_type",void 0)?g().get(E,"cert_deadline_type"):void 0,other_cert_deadline:le?_()(String(le)):void 0,note:g().get(E,"note",void 0),asset_keys:k.uA.getInitialValue(E,"asset_infos",{}),province_code:ue||void 0,city_code:me||void 0,origin:g().get(E,"origin",void 0),display:g().get(E,"display",void 0),lookAccountInfo:{state:g().get(E,"look_acl",C.MmK.section),accountInfo:g().get(E,"look_account_info_list",[]).map((function(e){return{id:e._id,name:e.name}})),departmentInfo:g().get(E,"look_department_info_list",[]).map((function(e){return{id:e._id,name:e.name}}))}};return Z.createElement(d.Z,(0,i.Z)({},j,{form:K,initialValues:Ee}),Z.createElement(I.IT,null,Z.createElement(I.Fp,{items:fe}),Z.createElement(I.Fp,{items:ve,cols:1}),Z.createElement(I.Fp,{items:ye}),Z.createElement(I.Fp,{items:he}),Z.createElement(I.Fp,{items:ge,cols:1}),Z.createElement(I.IT,{title:"权限"},Z.createElement(O.Z,{detail:E})),Z.createElement("div",{style:{textAlign:"center"}},Z.createElement(r.Z,{type:"primary",onClick:pe},"保存"))))}))}}]);