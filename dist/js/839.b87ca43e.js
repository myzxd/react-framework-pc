"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[839],{61882:function(e,t,a){var n=a(87462),r=a(44925),o=(a(29093),a(16317)),i=a(67294),c=a(55609),l=["dispatch","ticketTags","disabled","onChange","value"],s=o.Z.Option;t.Z=(0,c.connect)((function(e){return{ticketTags:e.ticketTag.ticketTags}}))((function(e){var t=e.dispatch,a=e.ticketTags,c=e.disabled,p=void 0!==c&&c,d=e.onChange,u=e.value,m=(0,r.Z)(e,l),f=a.data,h=void 0===f?[]:f;return(0,i.useEffect)((function(){t({type:"ticketTag/getTicketTags",payload:{page:1,limit:9999}})}),[t]),i.createElement(o.Z,(0,n.Z)({placeholder:"请选择",allowClear:!0,disabled:p,mode:"multiple",showArrow:!0,onChange:d,value:u},m),h.map((function(e){return i.createElement(s,{value:e._id,key:e._id,title:e.name},e.name)})))}))},40839:function(e,t,a){a.r(t),a.d(t,{default:function(){return oe}});a(20186);var n=a(75385),r=(a(13062),a(71230)),o=(a(52560),a(71577)),i=(a(89032),a(15746)),c=(a(55295),a(69713)),l=a(93433),s=(a(21316),a(75443)),p=a(71002),d=(a(51838),a(48086)),u=a(15671),m=a(43144),f=a(97326),h=a(60136),x=a(82963),g=a(61120),v=a(4942),y=a(94315),Z=a.n(y),b=a(93517),E=a.n(b),T=a(30381),w=a.n(T),S=a(55609),D=a(45697),P=a.n(D),C=a(67294),k=a(15947),I=a(96036),O=a(80385),R=a(97116),B=a(8240),F=a(45430),A=(a(9070),a(20924)),L=(a(54071),a(14072)),N=(a(29093),a(16317)),M=a(88144),Y=a(61882);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.Z)(e);if(t){var r=(0,g.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,x.Z)(this,a)}}var W=N.Z.Option,_=L.Z.RangePicker,K=L.Z.MonthPicker,V={scope:1,state:2,examine:3,creator:4},j=function(e){(0,h.Z)(a,e);var t=U(a);function a(){var e;return(0,u.Z)(this,a),e=t.call(this),(0,v.Z)((0,f.Z)(e),"onHookForm",(function(t){e.setState({form:t})})),(0,v.Z)((0,f.Z)(e),"onResetState",(function(){e.setState({existStateDis:!1,ticketTagDis:!1})})),(0,v.Z)((0,f.Z)(e),"onReset",(function(){var t=e.props,a=t.onSearch,n=t.selectedTabKey;e.onResetState(),"".concat(n)==="".concat(O.WPs.penddingVerify)&&R.By.setSearchParams("examineOrder",{}),a&&a({page:1,limit:30})})),(0,v.Z)((0,f.Z)(e),"onToggle",(function(t){var a=e.props.onToggle;a&&a(t)})),(0,v.Z)((0,f.Z)(e),"onNormalizeThemeTags",(function(e){var t=e,a=t.length,n=a>=1?t[a-1].replace(/\s+/g,""):"";return""===n?t.pop():t[a-1]=n,t})),(0,v.Z)((0,f.Z)(e),"onChangeExistState",(function(t){var a=e.state.form;t?(e.setState({ticketTagDis:!0}),a.setFieldsValue({ticketTag:void 0})):e.setState({ticketTagDis:!1})})),(0,v.Z)((0,f.Z)(e),"onChangeTicketTag",(function(t){var a=e.state.form;Array.isArray(t)&&t.length>0?(e.setState({existStateDis:!0}),a.setFieldsValue({existState:void 0})):e.setState({existStateDis:!1})})),(0,v.Z)((0,f.Z)(e),"onSearch",(function(t){var a=e.props.onSearch,n=t.suppliers,r=t.platforms,o=t.cities,i=t.districts,c=t.state,l=t.examineFlowId,s=t.applyAccountId,p=t.orderId,d=t.paidState,u=t.submitAt,m=t.paymentAt,f=t.belongTime,h=t.approvalType,x=t.themeTags,g=t.ticketTag,v=t.ticketState,y=t.existState,Z=t.totalMoney,b=E().has(u,"0")?w()(u[0]).format("YYYYMMDD"):"",T=E().has(u,"0")?w()(u[1]).format("YYYYMMDD"):"",S=E().has(m,"0")?w()(m[0]).format("YYYYMMDD"):"",D=E().has(m,"0")?w()(m[1]).format("YYYYMMDD"):"",P={suppliers:n,platforms:r,cities:o,districts:i,state:c,examineFlowId:l,applyAccountId:s,orderId:p?p.replace(/\s+/g,""):"",paidState:d,submitStartAt:b,submitEndAt:T,paidStartAt:S,paidEndAt:D,belongTime:f?w()(f).format("YYYYMM"):"",approvalType:h,themeTags:x,page:1,limit:30,ticketTag:g,ticketState:v,existState:y,totalMoney:Z};a&&a(P)})),(0,v.Z)((0,f.Z)(e),"disableDateOfMonth",(function(e){return e&&e>new Date})),(0,v.Z)((0,f.Z)(e),"render",(function(){var t=e.props,a=t.operations,n=t.componentItems,r=void 0===n?[]:n,o=t.platformCodes,i=t.isShowExpand,c=t.selectedTabKey,l=[],s=e.state,p=s.existStateDis,d=s.ticketTagDis,u=R.By.searchParams("examineOrder");-1!==r.indexOf(V.examine)&&l.push({label:"审批流",form:function(e){return e.getFieldDecorator("examineFlowId",{initialValue:void 0})(C.createElement(M.Z6,{showSearch:!0,allowClear:!0,isShowDataDisable:!0,optionFilterProp:"children",platformCodes:o,placeholder:"请选择审批流",namespace:"search"}))}}),-1!==r.indexOf(V.state)&&l.push({label:"流程状态",form:function(e){return e.getFieldDecorator("state",{initialValue:void 0})(C.createElement(N.Z,{allowClear:!0,placeholder:"请选择流程状态"},C.createElement(W,{value:"".concat(O.DU5.processing)},O.DU5.description(O.DU5.processing)),C.createElement(W,{value:"".concat(O.DU5.finish)},O.DU5.description(O.DU5.finish)),C.createElement(W,{value:"".concat(O.DU5.close)},O.DU5.description(O.DU5.close))))}}),-1!==r.indexOf(V.scope)&&l.push({label:"付款状态",form:function(e){return e.getFieldDecorator("paidState",{initialValue:void 0})(C.createElement(N.Z,{allowClear:!0,placeholder:"请选择付款状态"},C.createElement(W,{value:"".concat(O.vBr.payment)},O.vBr.description(O.vBr.payment)),C.createElement(W,{value:"".concat(O.vBr.untreated)},O.vBr.description(O.vBr.untreated)),C.createElement(W,{value:"".concat(O.vBr.abnormal)},O.vBr.description(O.vBr.abnormal))))}}),l.push({label:"审批类型",form:function(e){return e.getFieldDecorator("approvalType",{initialValue:"".concat(c)==="".concat(O.WPs.penddingVerify)?(0,B.Cg)(u,"approvalType",void 0):void 0})(C.createElement(N.Z,{placeholder:"请选择审批类型",allowClear:!0},C.createElement(W,{value:O.ZBL.cost},O.ZBL.description(O.ZBL.cost)),C.createElement(W,{value:O.ZBL.salaryRules},O.ZBL.description(O.ZBL.salaryRules)),C.createElement(W,{value:O.ZBL.salaryIssue},O.ZBL.description(O.ZBL.salaryIssue)),C.createElement(W,{value:O.ZBL.supplies},O.ZBL.description(O.ZBL.supplies)),C.createElement(W,{value:O.ZBL.housing},O.ZBL.description(O.ZBL.housing)),C.createElement(W,{value:O.ZBL.borrowing},O.ZBL.description(O.ZBL.borrowing)),C.createElement(W,{value:O.ZBL.repayments},O.ZBL.description(O.ZBL.repayments)),C.createElement(W,{value:O.ZBL.business},O.ZBL.description(O.ZBL.business)),C.createElement(W,{value:O.ZBL.travel},O.ZBL.description(O.ZBL.travel)),C.createElement(W,{value:O.ZBL.takeLeave},O.ZBL.description(O.ZBL.takeLeave)),C.createElement(W,{value:O.ZBL.overTime},O.ZBL.description(O.ZBL.overTime))))}}),-1!==r.indexOf(V.creator)&&l.push({label:"申请人",form:function(e){return e.getFieldDecorator("applyAccountId",{initialValue:void 0})(C.createElement(M.Di,{allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择申请人"}))}}),-1!==r.indexOf(V.examine)&&l.push({label:"审批单号",form:function(e){return e.getFieldDecorator("orderId",{initialValue:void 0})(C.createElement(A.Z,{placeholder:"请输入审批单号"}))}}),-1!==r.indexOf(V.scope)&&l.push({label:"提报日期",form:function(t){return t.getFieldDecorator("submitAt",{initialValue:null})(C.createElement(_,{format:"YYYY-MM-DD",disabledDate:e.disableDateOfMonth}))}},{label:"付款日期",form:function(t){return t.getFieldDecorator("paymentAt",{initialValue:null})(C.createElement(_,{format:"YYYY-MM-DD",disabledDate:e.disableDateOfMonth}))}},{label:"归属周期",form:function(t){return t.getFieldDecorator("belongTime",{initialValue:null})(C.createElement(K,{style:{width:"100%"},placeholder:"请选择归属周期",disabledDate:e.disableDateOfMonth}))}}),l.push({label:"主题标签",form:function(t){return t.getFieldDecorator("themeTags",{initialValue:[],normalize:e.onNormalizeThemeTags})(C.createElement(N.Z,{placeholder:"请输入主题标签",mode:"tags",notFoundContent:"",tokenSeparators:[",","，"],allowClear:!0}))}}),l[l.length]={label:"验票状态",form:function(e){return e.getFieldDecorator("ticketState",{initialValue:void 0})(C.createElement(N.Z,{allowClear:!0,placeholder:"请选择"},C.createElement(W,{value:O.xTp.already},O.xTp.description(O.xTp.already)),C.createElement(W,{value:O.xTp.waiting},O.xTp.description(O.xTp.waiting)),C.createElement(W,{value:O.xTp.abnormal},O.xTp.description(O.xTp.abnormal))))}},l[l.length]={label:"验票标签",form:function(t){return t.getFieldDecorator("ticketTag",{initialValue:void 0})(C.createElement(Y.Z,{showArrow:!0,showSearch:!0,optionFilterProp:"children",onChange:e.onChangeTicketTag,disabled:d}))}},l[l.length]={label:"是否有验票标签",form:function(t){return t.getFieldDecorator("existState",{initialValue:void 0})(C.createElement(N.Z,{allowClear:!0,placeholder:"请选择",onChange:e.onChangeExistState,disabled:p},C.createElement(W,{value:O.gCY.all},O.gCY.description(O.gCY.all)),C.createElement(W,{value:O.gCY.have},O.gCY.description(O.gCY.have)),C.createElement(W,{value:O.gCY.no},O.gCY.description(O.gCY.no))))}},l.push({label:"费用总金额",form:function(e){return e.getFieldDecorator("totalMoney")(C.createElement(A.Z,{placeholder:"请输入费用总金额(元)"}))}});var m={items:l,operations:a,isExpenseModel:!0,namespace:"namespace".concat(e.props.selectedTabKey),onReset:e.onReset,onSearch:e.onSearch,expand:i,onToggle:e.onToggle,onHookForm:e.onHookForm};return C.createElement(I.IT,null,C.createElement(M.p8,m))})),e.state={existStateDis:!1,ticketTagDis:!1,form:{}},e}return(0,m.Z)(a,[{key:"componentDidUpdate",value:function(e){Number(e.selectedTabKey)!==Number(this.props.selectedTabKey)&&this.state.form&&(this.state.form.resetFields(),this.state.form.setFieldsValue({platforms:[],suppliers:[],cities:[],districts:[]}),this.onResetState())}}]),a}(C.Component);(0,v.Z)(j,"propTypes",{componentItems:P().array,onSearch:P().func.isRequired,onToggle:P().func.isRequired,isShowExpand:P().bool,platformCodes:P().array}),(0,v.Z)(j,"defaultProps",{componentItems:[],onSearch:function(){},onToggle:function(){},isShowExpand:!1,platformCodes:[]}),j.SearchComponentItems=V;var H=j,q=(a(52466),a(10642)),z=(a(39305),a(97880)),Q=a(66939);a(98703);function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.Z)(e);if(t){var r=(0,g.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,x.Z)(this,a)}}var $=z.Z.Step,X=function(e){(0,h.Z)(a,e);var t=J(a);function a(e){var n;return(0,u.Z)(this,a),n=t.call(this,e),(0,v.Z)((0,f.Z)(n),"componentWillUnmount",(function(){n.onCancel(),(0,n.props.dispatch)({type:"expenseExamineFlow/resetExamineFlowDetail"})})),(0,v.Z)((0,f.Z)(n),"onSubmit",(function(e){e.preventDefault(),n.props.form.validateFieldsAndScroll((function(e,t){if(!e){var a=t.examineFlowId,r=n.props,o=r.OrderId,i=r.ActionType;n.private.isSubmit&&(n.props.dispatch({type:"expenseExamineOrder/createExamineOrder",payload:{examineFlowId:a,approvalType:O.ZBL.cost,onSuccessCallback:n.onSuccessCallback,onFailureCallback:n.onFailureCallback,orderId:o,actionType:i}}),n.private.isSubmit=!1)}}))})),(0,v.Z)((0,f.Z)(n),"onSuccessCallback",(function(e){var t=n.props,a=t.OrderId,r=t.ActionType;r===O.rkq.invoiceAdjust&&(window.location.href="/#/Expense/Manage/InvoiceAdjust?orderId=".concat(a,"&invoiceAdjustId=").concat(e._id)),r===O.rkq.refund&&(window.location.href="/#/Expense/Manage/RefundForm?orderId=".concat(a,"&refundId=").concat(e._id)),n.onCancel()})),(0,v.Z)((0,f.Z)(n),"onFailureCallback",(function(e){d.ZP.error(e.zh_message),n.private.isSubmit=!0})),(0,v.Z)((0,f.Z)(n),"onCancel",(function(){(0,n.props.dispatch)({type:"expenseExamineFlow/resetExamineFlowDetail",payload:{}}),n.props.form.resetFields();var e=n.props.onCancel;e&&e(),n.setState({selectedExamineFlowDetail:{},examineFlowDisabled:!1})})),(0,v.Z)((0,f.Z)(n),"onChangeExamineFlowId",(function(e){(0,n.props.dispatch)({type:"expenseExamineFlow/fetchExamineDetail",payload:{id:e}})})),(0,v.Z)((0,f.Z)(n),"reduceAccountList",(function(e){return!e||Z().array(e)&&0===e.length?"无":e.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),"")})),(0,v.Z)((0,f.Z)(n),"renderForm",(function(){var e=n.props.form.getFieldDecorator,t=n.props.examineFlowDisabled,a=[O.BsX.normal],r={disabled:t,onChange:n.onChangeExamineFlowId,bizType:O.z_o.costOf,showSearch:!0,optionFilterProp:"children",placeholder:"请选择审批流",namespace:"create".concat(O.z_o.costOf),state:a},o=[{label:"审批流",form:e("examineFlowId",{rules:[{required:!0,message:"请选择审批流"}],initialValue:void 0})(C.createElement(M.Z6,r))}];return C.createElement(I.KP,{items:o,cols:1,layout:{labelCol:{span:6},wrapperCol:{span:18}}})})),(0,v.Z)((0,f.Z)(n),"renderNodeListText",(function(e,t){var a=e&&"object"===(0,p.Z)(e)&&Array===e.constructor?e.reduce((function(e,t,a){return 0===a?"".concat(t.post_name,"(").concat(n.reduceAccountList(t.account_info_list),")"):"".concat(e,", ").concat(t.post_name,"(").concat(n.reduceAccountList(t.account_info_list),")")}),""):"",r=t&&"object"===(0,p.Z)(t)&&Array===t.constructor?t.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),""):"";return a&&r?"".concat(a,", ").concat(r):a||r})),(0,v.Z)((0,f.Z)(n),"renderFlowNodes",(function(){var e=n.props.selectedExamineFlowDetail;return Z().not.existy(e.nodeList)||Z().empty(e.nodeList)?"":e.nodeList.map((function(e,t){return C.createElement(z.Z,{direction:"vertical",key:t,current:t+1},C.createElement($,{title:"节点-".concat(t+1),description:n.renderNodeListText(e.postList,e.accountList)}))}))})),(0,v.Z)((0,f.Z)(n),"render",(function(){var e,t=n.props.visible,a=(0,f.Z)(n),r=a.onSubmit,o=a.onCancel,i=n.props.ActionType;return i===O.rkq.invoiceAdjust&&(e="红冲审批"),i===O.rkq.refund&&(e="退款审批"),C.createElement(q.Z,{title:e,visible:t,onOk:r,onCancel:o,okText:"确认",cancelText:"取消"},C.createElement(Q.Z,null,n.renderForm(),n.renderFlowNodes()))})),n.state={examineFlowDisabled:!1},n.private={isSubmit:!0},n}return a}(C.Component);(0,v.Z)(X,"propTypes",{visible:P().bool,selectedExamineFlowDetail:P().object,onCancel:P().func}),(0,v.Z)(X,"defaultProps",{visible:!1,selectedExamineFlowDetail:{},onCancel:function(){}});var G=(0,S.connect)((function(e){return{selectedExamineFlowDetail:e.expenseExamineFlow.examineDetail}}))(Q.Z.create()(X)),ee=a(83983);function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.Z)(e);if(t){var r=(0,g.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,x.Z)(this,a)}}var ae=H.SearchComponentItems,ne=function(e){switch(Number(e)){case O.WPs.penddingSubmit:return[ae.examine];case O.WPs.penddingVerify:return[ae.scope,ae.examine,ae.creator];case O.WPs.submit:return[ae.scope,ae.state,ae.examine];case O.WPs.verify:case O.WPs.all:return[ae.scope,ae.state,ae.examine,ae.creator];default:return"--"}},re=function(e){(0,h.Z)(a,e);var t=te(a);function a(e){var m;(0,u.Z)(this,a),m=t.call(this),(0,v.Z)((0,f.Z)(m),"onShowRenderRedRushRefund",(function(e,t){m.setState({redRushRefundVisible:!0,orderId:e,actionType:t})})),(0,v.Z)((0,f.Z)(m),"onHideRenderRedRushRefund",(function(){m.setState({redRushRefundVisible:!1})})),(0,v.Z)((0,f.Z)(m),"onSearch",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=m.state.selectedTabKey,n=R.By.searchParams("examineOrder");m.private.searchParams=e,(Z().not.existy(m.private.searchParams.page)||Z().empty(m.private.searchParams.page))&&(m.private.searchParams.page=1),(Z().not.existy(m.private.searchParams.limit)||Z().empty(m.private.searchParams.limit))&&(m.private.searchParams.limit=30),Number(a)===O.WPs.penddingSubmit&&(m.private.searchParams.applyAccountId=R.Iq.account.id,m.private.searchParams.flag=void 0,m.private.searchParams.state=[O.DU5.pendding]),Number(a)===O.WPs.penddingVerify&&(m.private.searchParams.currentPendingAccount=R.Iq.account.id,m.private.searchParams.flag=void 0,m.private.searchParams.state=[O.DU5.processing],m.private.searchParams.approvalType=(0,B.Cg)(e,"approvalType",void 0)||(0,B.Cg)(n,"approvalType",void 0)),Number(a)===O.WPs.submit&&(m.private.searchParams.applyAccountId=R.Iq.account.id,m.private.searchParams.flag=void 0,(Z().not.existy(e.state)||Z().empty(e.state))&&(m.private.searchParams.state=[O.DU5.processing,O.DU5.finish,O.DU5.close])),Number(a)===O.WPs.verify&&(m.private.searchParams.flowAccountId=R.Iq.account.id,m.private.searchParams.flag=void 0,(Z().not.existy(e.state)||Z().empty(e.state))&&(m.private.searchParams.state=[O.DU5.processing,O.DU5.finish,O.DU5.close])),Number(a)===O.WPs.all&&(m.private.searchParams.flag=!0,(Z().not.existy(e.state)||Z().empty(e.state))&&(m.private.searchParams.state=[O.DU5.processing,O.DU5.finish,O.DU5.close])),t||m.setState({selectedRowKeys:[]}),m.props.dispatch({type:"expenseExamineOrder/fetchExamineOrders",payload:m.private.searchParams})})),(0,v.Z)((0,f.Z)(m),"onShowSizeChange",(function(e,t){var a=m.private.searchParams;a.page=e,a.limit=t,m.onSearch(a,!0)})),(0,v.Z)((0,f.Z)(m),"onChangePage",(function(e,t){var a=m.private.searchParams;a.page=e,a.limit=t,m.onSearch(a,!0)})),(0,v.Z)((0,f.Z)(m),"onDelete",(function(e){var t=m.private.searchParams;m.props.dispatch({type:"expenseExamineOrder/deleteExamineOrder",payload:{id:e,onSuccessCallback:function(){m.onSearch(t)}}})})),(0,v.Z)((0,f.Z)(m),"onRecall",(function(e){var t=m.private.searchParams;m.props.dispatch({type:"expenseExamineOrder/recallExamineOrder",payload:{id:e,onSuccessCallback:function(){m.onSearch(t)}}})})),(0,v.Z)((0,f.Z)(m),"onClose",(function(e){var t=m.private.searchParams;m.props.dispatch({type:"expenseExamineOrder/closeExamineOrder",payload:{id:e,onSuccessCallback:function(){m.onSearch(t)}}})})),(0,v.Z)((0,f.Z)(m),"onSelectTab",(function(e){m.props.dispatch({type:"expenseExamineOrder/resetExamineOrders"}),R.By.setSearchParams("examineOrder",{}),m.setState({selectedTabKey:e},(function(){return m.onSearch()}))})),(0,v.Z)((0,f.Z)(m),"onToggle",(function(e){m.setState({isShowExpand:e})})),(0,v.Z)((0,f.Z)(m),"onSelectRow",(function(e){m.setState({selectedRowKeys:e})})),(0,v.Z)((0,f.Z)(m),"getPluginOrder",(function(e){var t=e.pluginExtraMeta,a=void 0===t?{}:t;return!(!Z().existy(a)||!0!==a.is_plugin_order)})),(0,v.Z)((0,f.Z)(m),"goPrintPreview",(function(){var e=JSON.stringify(m.state.selectedRowKeys),t=m.state.selectedRowKeys.length;t<=0?d.ZP.warning("请勾选打印单子"):t>20?d.ZP.warning("最多同时打印20份,你已选择: ".concat(t,"份")):k.Z.popUpCompatible("/#/Expense/Manage/ExamineOrder/print?selectedRowKeys=".concat(e))})),(0,v.Z)((0,f.Z)(m),"reduceAccountList",(function(e){return!e||"object"===(0,p.Z)(e)&&Array===e.constructor&&0===e.length?"无":e.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),"")})),(0,v.Z)((0,f.Z)(m),"renderTabs",(function(){var e=m.props.location.query.selectedTabKey,t=[];F.ZP.canOperateExpenseManageExamineOrderReported()&&t.push({title:"待提报",content:m.renderTabContent(O.WPs.penddingSubmit),key:O.WPs.penddingSubmit}),F.ZP.canOperateExpenseManageExamineOrderStayDo()&&t.push({title:"我待办的",content:m.renderTabContent(O.WPs.penddingVerify),key:O.WPs.penddingVerify}),F.ZP.canOperateExpenseManageExamineOrderSubmission()&&t.push({title:"我提报的",content:m.renderTabContent(O.WPs.submit),key:O.WPs.submit}),F.ZP.canOperateExpenseManageExamineOrderHandle()&&t.push({title:"我经手的",content:m.renderTabContent(O.WPs.verify),key:O.WPs.verify}),F.ZP.canOperateExpenseManageExamineOrderAll()&&t.push({title:"全部",content:m.renderTabContent(O.WPs.all),key:O.WPs.all});var a=e||"".concat(O.WPs.penddingSubmit);return C.createElement(I.DF,{items:t,defaultActiveKey:a,onChange:m.onSelectTab})})),(0,v.Z)((0,f.Z)(m),"renderTabContent",(function(e){return C.createElement("div",null,m.renderSearch(e),m.renderContent(e))})),(0,v.Z)((0,f.Z)(m),"renderSearch",(function(e){var t=m.state,a=t.selectedTabKey,n=t.isShowExpand,r=R.Iq.platform(),o="";Number(a)!==O.WPs.all&&Z().existy(r)&&(o=r.map((function(e){return e.id})));var i=(0,f.Z)(m).onSearch,c=ne(e);return C.createElement(H,{componentItems:c,onSearch:i,selectedTabKey:a,isShowMore:!0,isShowExpand:n,onToggle:m.onToggle,platformCodes:o})})),(0,v.Z)((0,f.Z)(m),"renderOperation",(function(e,t,a){var n=m.state.selectedTabKey,r=a.id,o=a.applyAccountInfo.id,i=a.state,c=a.paidState,l=a.currentFlowNode,p=a.applicationOrderType,d=a.applicationSubType,u=a.extraWorkOrLeaveId,f=void 0===u?void 0:u,h=[],x=!1,g=!1,v=!1,y=!1,Z=!1;if(Number(n)!==O.WPs.submit&&Number(n)!==O.WPs.all||i!==O.DU5.finish||p!==O.ZBL.cost||c!==O.$ym.paid||d!==O.rkq.normal||(Z=!0),a.state===O.DU5.pendding&&o===R.Iq.account.id&&(x=!0,g=!0),a.state!==O.DU5.pendding&&a.state!==O.DU5.processing||void 0!==a.currentFlowNodeInfo.id||o!==R.Iq.account.id||(x=!0),a.state===O.DU5.processing&&o===R.Iq.account.id&&c===O.$ym.waiting&&void 0!==l&&(v=!0),a.bizState!==O.iH$.reject&&a.bizState!==O.iH$.recall||a.state!==O.DU5.processing||o!==R.Iq.account.id||void 0!==l||p===O.ZBL.externalApproval||(y=!0),!0===x&&F.ZP.canOperateExpenseManageEditButton()&&p!==O.ZBL.turnover&&p!==O.ZBL.externalApproval){var b="/#/Expense/Manage/ExamineOrder/Form?orderId=".concat(r,"&approvalKey=").concat(t);d===O.rkq.refund&&(b="/#/Expense/Manage/RefundForm?refundId=".concat(r)),d===O.rkq.invoiceAdjust&&(b="/#/Expense/Manage/InvoiceAdjust?invoiceAdjustId=".concat(r)),p===O.ZBL.overTime&&void 0===f&&(b="/#/Expense/Attendance/OverTime/Create?applicationOrderId=".concat(r)),p===O.ZBL.takeLeave&&void 0===f&&(b="/#/Expense/Attendance/TakeLeave/Create?applicationOrderId=".concat(r)),h.push(C.createElement("a",{key:"update",href:b,target:"_blank",rel:"noopener noreferrer",className:ee.Z["app-comp-expense-exam-order-Table-operate-btn"]},"编辑"))}else h.push(C.createElement("a",{key:"detail",href:"javascript:void(window.open('/#/Expense/Manage/ExamineOrder/Detail?orderId=".concat(r,"&approvalKey=").concat(t,"'));"),rel:"noopener noreferrer",className:ee.Z["app-comp-expense-exam-order-Table-operate-btn"]},"查看"));if(g){h.push(C.createElement(s.Z,{key:"delete",title:"确认删除？",onConfirm:function(){m.onDelete(r)}},C.createElement("a",{className:ee.Z["app-comp-expense-exam-order-Table-operate-btn"]},"删除")))}return v&&h.push(C.createElement(s.Z,{key:"recall",title:"是否确认撤回审批单",onConfirm:function(){m.onRecall(r)}},C.createElement("a",{className:ee.Z["app-comp-expense-exam-order-Table-operate-btn"]},"撤回"))),y&&h.push(C.createElement(s.Z,{key:"close",title:"是否确认关闭审批单",onConfirm:function(){m.onClose(r)}},C.createElement("a",{className:ee.Z["app-comp-expense-exam-order-Table-operate-btn"]},"关闭"))),Z&&F.ZP.canOperateExpenseManageRefundButton()&&(a.refundApplicationOrderId?h.push(C.createElement("span",{className:ee.Z["app-comp-expense-exam-order-Table-operate-btn-diable"],key:"refunddisable"},"退款")):h.push(C.createElement("a",{type:"primary",onClick:function(){m.onShowRenderRedRushRefund(r,O.rkq.refund)},className:ee.Z["app-comp-expense-exam-order-Table-operate-btn"],key:"refund"},"退款"))),h})),(0,v.Z)((0,f.Z)(m),"renderContent",(function(e){var t=m.props.examineOrdersData,a=E().get(t,"meta.count",0),s=E().get(t,"data",[]),d=m.state,u=d.selectedTabKey,f=d.selectedRowKeys,h=[{title:"审批单号",dataIndex:"id",width:100,fixed:"left",render:function(e){return C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},e)}},{title:"主题标签",dataIndex:"themeLabelList",width:100,fixed:"left",render:function(e,t){var a=e||[],n=E().get(t,"pluginExtraMeta.theme_label_list",[]),r=[].concat((0,l.Z)(a),(0,l.Z)(n));return Z().not.empty(r)&&r.length>3?C.createElement(c.Z,{title:r.map((function(e){return e})).join(" 、 ")},C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},E().get(r,"0"),"、",E().get(r,"1"),"、",E().get(r,"2"),"...")):Z().not.empty(r)&&r.length<=3?C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},r.map((function(e){return e})).join("、")):"--"}},{title:"是否有验票标签",dataIndex:"inspectBillLabelList",key:"isInspectBill",width:120,fixed:"left",render:function(e){return Array.isArray(e)&&e.length>0?"有":"无"}},{title:"验票标签",dataIndex:"inspectBillLabelList",width:100,fixed:"left",render:function(e){return Array.isArray(e)&&e.length>3?C.createElement(c.Z,{title:e.map((function(e){return e.name})).join(" 、 ")},C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},E().get(e,"0").name,"、",E().get(e,"1").name,"、",E().get(e,"2").name,"...")):Array.isArray(e)&&e.length<=3?C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},e.map((function(e){return e.name})).join("、")):"--"}},{title:"平台",dataIndex:"platformNames",width:70,render:function(e){return Z().not.existy(e)||Z().empty(e)||Z().not.array(e)?"--":e.map((function(e){return e})).join(" , ")}},{title:"供应商",dataIndex:"supplierNames",width:150,render:function(e,t){var a=E().get(t,"pluginExtraMeta.supplier_names",[]),n=m.getPluginOrder(t)?a:e;return Z().not.existy(n)||Z().empty(n)||Z().not.array(n)?"--":1===n.length?E().get(n,"0"):C.createElement(c.Z,{title:n.map((function(e){return e})).join(" , ")},C.createElement("span",null,E().get(n,"0")," 等",n.length,"条"))}},{title:"城市",dataIndex:"cityNames",width:70,render:function(e,t){var a=E().get(t,"pluginExtraMeta.city_names",[]),n=m.getPluginOrder(t)?a:e;return Z().not.existy(n)||Z().empty(n)||Z().not.array(n)?"--":1===n.length?E().get(n,"0"):C.createElement(c.Z,{title:n.map((function(e){return e})).join(" , ")},C.createElement("span",null,E().get(n,"0")," 等",n.length,"条"))}},{title:"商圈",dataIndex:"bizDistrictNames",width:150,render:function(e,t){var a=E().get(t,"pluginExtraMeta.biz_district_names",[]),n=m.getPluginOrder(t)?a:e;return Z().not.existy(n)||Z().empty(n)||Z().not.array(n)?"--":1===n.length?E().get(n,"0"):C.createElement(c.Z,{title:n.map((function(e){return e})).join(" , ")},C.createElement("span",null,E().get(n,"0")," 等",n.length,"条"))}},{title:"提报日期",dataIndex:"submitAt",width:150,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"归属周期",dataIndex:"belongTime",width:100,render:function(e){return e||"--"}},{title:"申请人",dataIndex:"applyAccountInfo",width:100,render:function(e){return Z().existy(e)&&Z().not.empty(e)?e.state===O.m3m.off?e.name?"".concat(e.name,"(").concat(O.m3m.description(e.state),")"):"--":e.name?e.name:"--":"--"}},{title:"费用总金额(元)",dataIndex:"totalMoney",width:150,render:function(e,t){return m.getPluginOrder(t)?C.createElement("div",{className:"".concat(ee.Z["app-comp-expense-exam-order-table-break-line"]," ").concat(ee.Z["app-comp-expense-exam-order-table-total-money"])},O.fbc.exchangePriceCentToMathFormat(E().get(t,"pluginExtraMeta.total_money","--"))):e?C.createElement("div",{className:"".concat(ee.Z["app-comp-expense-exam-order-table-break-line"]," ").concat(ee.Z["app-comp-expense-exam-order-table-total-money"])},O.fbc.exchangePriceCentToMathFormat(e)):"--"}},{title:"审批流",dataIndex:"flowInfo",width:100,render:function(e){return e?C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},e.name):"--"}},{title:"审批类型",dataIndex:"applicationOrderType",width:100,render:function(e){return O.ZBL.description(e)}},{title:"流程状态",dataIndex:"state",width:100,render:function(e){return O.DU5.description(e)}},{title:"当前节点",dataIndex:"currentFlowNodeInfo",width:120,render:function(e,t){var a=t.currentPendingAccountList,n=t.state,r=t.currentFlowNode,o=t.applyAccountInfo;if(e&&e.name&&Z().existy(r)&&n===O.DU5.processing){var i=e.postList,l=void 0===i?[]:i,s=e.accountList,d=void 0===s?[]:s,u=[],m=[],f=[];a.forEach((function(e){var t=e;void 0!==a.find((function(t){return t.id===e.id}))?t.isHeight=!0:t.isHeight=!1,f[f.length]=t})),d.forEach((function(e){var t=e;void 0!==a.find((function(t){return t.id===e.id}))?t.isHeight=!0:t.isHeight=!1,u.push(t)})),l&&"object"===(0,p.Z)(l)&&Array===l.constructor&&l.forEach((function(e){var t=e;a.some((function(e){return(t.account_info_list||[]).some((function(t){return t._id===e.id||e._id}))}))?t.isHeight=!0:t.isHeight=!1,m.push(t)}));var h=C.createElement("span",null,e.name,"(",C.createElement("span",null,m.map((function(e,t){var a=e.account_info_list||[];return C.createElement("span",{className:!0===e.isHeight?ee.Z["app-comp-expense-exam-order-now-point-colored"]:"",key:"postData".concat(t)},e.post_name,"(",a.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),""),")",t!==m.length-1?" , ":null)}))),m&&u&&m.length>0&&u.length>0?", ":"",C.createElement("span",null,u.map((function(e,t){return C.createElement("span",{className:!0===e.isHeight?ee.Z["app-comp-expense-exam-order-now-point-colored"]:"",key:"accountData".concat(t)},e.name,t!==u.length-1?" , ":null)}))),C.createElement("span",null,u.length<1&&m.length<1?f.map((function(e,t){return C.createElement("span",null,e.name,t!==f.length-1?" , ":null)})):""),")");return C.createElement(c.Z,{title:h},C.createElement("div",{className:"".concat(ee.Z["app-comp-expense-exam-order-table-break-line"]," ").concat(ee.Z["app-comp-expense-exam-order-table-now-point"])},"".concat(e.name,"(").concat(Z().not.empty(a)?a.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),""):"",")").length>=10?"".concat("".concat(e.name,"(").concat(Z().not.empty(a)?a.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),""):"",")").substring(0,10),"..."):"".concat(e.name,"(").concat(Z().not.empty(a)?a.reduce((function(e,t,a){return 0===a?t.name:"".concat(e,", ").concat(t.name)}),""):"",")")))}return Z().not.existy(r)&&n===O.DU5.processing?"提报节点(".concat(o.name,")"):"--"}},{title:"付款状态",dataIndex:"paidState",width:100,render:function(e){return O.$ym.description(e)}},{title:"付款日期",dataIndex:"paidAt",width:150,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"付款异常说明",dataIndex:"paidNote",render:function(e){return Z().empty(e)||Z().not.existy(e)?"--":e.length<=100?C.createElement("span",null,e):C.createElement(c.Z,{title:C.createElement("span",{className:ee.Z["app-comp-expense-exam-order-table-paid-note"]},e)},C.createElement("span",null,e.substring(0,100),"..."))}},{title:"验票状态",dataIndex:"inspectBillState",width:150,render:function(e){return e?O.xTp.description(e):"--"}},{title:"验票日期",dataIndex:"inspectBillAt",width:150,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"验票说明",dataIndex:"inspectBillNote",width:150,render:function(e){return Z().empty(e)||Z().not.existy(e)?"--":e.length<=100?C.createElement("span",{className:ee.Z["app-comp-expense-exam-order-table-break-line"]},e):C.createElement(c.Z,{title:C.createElement("span",{className:ee.Z["app-comp-expense-exam-order-table-paid-note"]},e)},C.createElement("span",null,e.substring(0,100),"..."))}},{title:"操作",dataIndex:"operation",width:120,fixed:"right",render:function(t,a){return m.renderOperation(t,e,a)}}],x=m.private.searchParams,g=x.page,v={pageSize:x.limit||30,onChange:m.onChangePage,total:a,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,onShowSizeChange:m.onShowSizeChange};g&&(v.current=g);var y=null,b=!1;switch(Number(u)){case O.WPs.submit:case O.WPs.verify:case O.WPs.all:b=!0,y={selectedRowKeys:f,onChange:m.onSelectRow,columnWidth:60,getCheckboxProps:function(e){var t=e.pluginExtraMeta,a=void 0===t?{}:t,n=!1;return Z().existy(a)&&(n=a.is_plugin_order),{disabled:!(1===e.applicationOrderType||4===e.applicationOrderType||5===e.applicationOrderType||6===e.applicationOrderType||7===e.applicationOrderType||8===e.applicationOrderType||9===e.applicationOrderType||10===e.applicationOrderType||11===e.applicationOrderType)||n}}};break;default:y=null}return C.createElement(I.IT,null,C.createElement("div",{className:ee.Z["app-comp-expense-exam-order-table-header"]},C.createElement(r.Z,null,C.createElement(i.Z,{span:21,className:ee.Z["app-comp-expense-exam-order-table-header-col"]},C.createElement("span",{className:ee.Z.headerLeftSpan}),C.createElement("span",null,"付款审批列表")),b?C.createElement(i.Z,{span:3},C.createElement(o.Z,{type:"primary",onClick:m.goPrintPreview},"批量打印")):"")),C.createElement(n.Z,{rowSelection:y,rowKey:function(e){return e.id},dataSource:s,columns:h,pagination:v,bordered:!0,scroll:{x:b?2865:2700,y:400}}))})),(0,v.Z)((0,f.Z)(m),"renderHongChongRefundModal",(function(){var e=m.state,t=e.redRushRefundVisible,a=e.selectedTabKey,n=e.orderId,r=e.actionType,o=(0,f.Z)(m).onHideRenderRedRushRefund,i={dispatch:m.props.dispatch,visible:t,onCancel:o,selectedTabKey:a,OrderId:n,ActionType:r};return C.createElement(G,i)}));var h=e.location.query.selectedTabKey;return m.state={selectedTabKey:h||O.WPs.penddingSubmit,isShowExpand:!0,selectedRowKeys:[],redRushRefundVisible:!1,orderId:void 0,actionType:void 0},m.private={searchParams:{limit:30,page:1,applyAccountId:R.Iq.account.id,state:O.DU5.pendding}},m}return(0,m.Z)(a,[{key:"componentDidMount",value:function(){var e=this.props.location.query.selectedTabKey,t=R.By.searchParams("examineOrder"),a={limit:30,page:1,currentPendingAccount:R.Iq.account.id,state:O.DU5.processing,approvalType:(0,B.Cg)(t,"approvalType",void 0)};Number(e)===O.WPs.penddingVerify?this.props.dispatch({type:"expenseExamineOrder/fetchExamineOrders",payload:a}):this.props.dispatch({type:"expenseExamineOrder/fetchExamineOrders",payload:this.private.searchParams})}},{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"expenseExamineOrder/resetExamineOrders"}),R.By.setSearchParams("examineOrder",{})}},{key:"render",value:function(){return C.createElement("div",null,this.renderTabs(),this.renderHongChongRefundModal())}}]),a}(C.Component);(0,v.Z)(re,"propTypes",{examineOrdersData:P().object}),(0,v.Z)(re,"defaultProps",{examineOrdersData:{}});var oe=(0,S.connect)((function(e){return{examineOrdersData:e.expenseExamineOrder.examineOrdersData}}))(re)},83983:function(e,t){t.Z={"app-comp-expense-form-theme-tag-selector":"coJAzYjuyFTmJor03dx5","app-comp-expense-form-cost-order-table-operate-btn":"yrgWvHUVIh6d8UBc4qyh","app-comp-expense-form-modal-next-approval-wrap":"N30pg8kxw3zqjAo467JU","app-comp-expense-form-modal-next-approval":"sN9JrA1jA1QOjVC7fQtv","app-comp-expense-exam-order-Table-operate-btn":"WC9OtN1UCzDvk6KrRaqm","app-comp-expense-exam-order-Table-operate-btn-diable":"efJhUmtGXVaEmIHYNSKa","app-comp-expense-exam-order-table-break-line":"vIzpR4jpH3YWxwASnQK6","app-comp-expense-exam-order-table-total-money":"on9UubvhwRnNjQLtBUmA","app-comp-expense-exam-order-table-now-point":"pSaNbbpAMrRUgbscec33","app-comp-expense-exam-order-table-paid-note":"FMrYcJ5RZE9w4bGiWQ93","app-comp-expense-exam-order-new-apply":"ZI2WQaimQ_C5VuiMmWqA","app-comp-expense-exam-order-now-point-colored":"e7oR65hEjMmulRdN46Ud","app-comp-expense-exam-order-table-header":"XzHPH5NFQlTSqhNBjD0_","app-comp-expense-exam-order-table-header-col":"xn5egCpyQwDiemvvdlkR",headerLeftSpan:"WSAE0Fi7whXPmTu5RAHH"}}}]);