"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[6514],{78877:function(e,t,r){r(51838);var n=r(48086),o=r(94315),a=r.n(o),i=r(96486),c=r.n(i),s=r(80385);t.Z=function(e,t){var r=!0;if(t)r=!1;else{if(e.money<=0)return r=!1,void n.ZP.error("费用金额必须大于0");var o=e.expense,i=o.costItems,l=o.costBelong,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(a().empty(e))return n.ZP.error("分摊数据为空"),!0;if(a().not.array(e))return n.ZP.error("分摊数据格式错误"),!0;var r={vendor:"分摊信息供应商未选择",platform:"分摊信息平台未选择",city:"分摊信息城市未选择",district:"分摊信息商圈未选择",costCount:"分摊金额不能为空"},o=!1,i=!1;return e.forEach((function(e,c){!0!==o&&(a().empty(e)&&(i=!0),Number(t)!==s.eL2.custom||!a().not.existy(e.costCount)&&0!==e.costCount||(o=!0,n.ZP.error("第".concat(c+1,"条分摊明细 : ").concat(r.costCount))),Object.keys(e).forEach((function(t){a().not.existy(r[t])||!0===o||(a().not.existy(e[t])||a().empty(e[t]))&&(o=!0,n.ZP.error("第".concat(c+1,"条分摊明细 : ").concat(r[t])))})))})),!0===i?n.ZP.error("分摊数据为空"):!0===o}(e.expense.costItems,l);if(!d){var u=i.map((function(e){return c().omit(e,["cityName","platformName","vendorName","districtName","costCountFlag"])}));Number(l)===s.eL2.custom&&(u=i.map((function(e){return c().omit(e,["cityName","platformName","vendorName","districtName","costCount","costCountFlag"])})));var p=c().uniqWith(u,c().isEqual);if(u.length!==p.length)return r=!1,n.ZP.error("成本分摊不能设置相同的成本归属");if(l===s.eL2.custom){if(s.fbc.exchangePriceToCent(e.money)!==i.reduce((function(e,t){return e+s.fbc.exchangePriceToCent(t.costCount)}),0))return n.ZP.error("费用金额与分摊金额总和不一致")}return r}r=!1}}},74443:function(e,t,r){r(9070);var n=r(20924),o=r(93433),a=r(15671),i=r(43144),c=r(97326),s=r(60136),l=r(82963),d=r(61120),u=r(4942),p=r(45697),f=r.n(p),m=r(67294),y=r(97860),v=r(96036),O=r(38108);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,l.Z)(this,r)}}var C=function(e){(0,s.Z)(r,e);var t=Z(r);function r(e){var i;return(0,a.Z)(this,r),i=t.call(this,e),(0,u.Z)((0,c.Z)(i),"onUploadSuccess",(function(e){var t=i.state.fileList,r=i.props.form.setFieldsValue,n=[].concat((0,o.Z)(t),[e]);i.setState({fileList:n}),r({fileList:n})})),(0,u.Z)((0,c.Z)(i),"onDeleteFile",(function(e){var t=i.state.fileList,r=i.props.form.setFieldsValue,n=(0,o.Z)(t);n.splice(e,1),i.setState({fileList:n}),r({fileList:n})})),(0,u.Z)((0,c.Z)(i),"renderForm",(function(){var e=i.state,t=e.fileList,r=e.fileListUrl,n=e.domain,o=[{label:"上传附件",form:m.createElement("div",null,m.createElement(y.Z,{namespace:i.private.namespace,isVerifyFileType:!0,onSuccess:i.onUploadSuccess,onFailure:i.onUploadFailure,domain:n}),t.map((function(e,t){return r[t]?m.createElement("p",null,m.createElement("a",{className:O.Z["app-comp-expense-manage-template-refund-upload"],rel:"noopener noreferrer",target:"_blank",key:t,href:r[t]},e),m.createElement("span",{onClick:function(){i.onDeleteFile(t)},className:O.Z["app-comp-expense-manage-form-upload"]},"删除")):m.createElement("p",{key:t},e,m.createElement("span",{onClick:function(){i.onDeleteFile(t)},className:O.Z["app-comp-expense-manage-form-upload"]},"删除"))})))}];return m.createElement(v.KP,{cols:1,items:o,layout:{labelCol:{span:3},wrapperCol:{span:21}}})})),(0,u.Z)((0,c.Z)(i),"renderHiddenForm",(function(){var e=i.state.fileList,t=[{label:"",form:i.props.form.getFieldDecorator("fileList",{initialValue:e})(m.createElement(n.Z,{hidden:!0}))}];return m.createElement(v.KP,{items:t,cols:1,layout:{labelCol:{span:3},wrapperCol:{span:21}}})})),(0,u.Z)((0,c.Z)(i),"renderContent",(function(){return m.createElement("div",null,i.renderForm(),i.renderHiddenForm())})),i.state={fileList:e.fileList,fileListUrl:e.fileListUrl,domain:e.domain},i.private={namespace:"namespace".concat(Math.floor(1e5*Math.random()))},i}return(0,i.Z)(r,[{key:"render",value:function(){return this.renderContent()}}]),r}(m.Component);(0,u.Z)(C,"propTypes",{form:f().object,fileList:f().array,fileListUrl:f().array,domain:f().string}),(0,u.Z)(C,"defaultProps",{form:{},fileList:[],fileListUrl:[],isDown:!1,domain:"deflateDomain"}),t.Z=C},16514:function(e,t,r){r.r(t),r.d(t,{default:function(){return M}});r(52560);var n=r(71577),o=(r(51838),r(48086)),a=r(93433),i=r(15671),c=r(43144),s=r(97326),l=r(60136),d=r(82963),u=r(61120),p=r(4942),f=r(55609),m=r(45697),y=r.n(m),v=r(67294),O=r(66939),Z=(r(98703),r(80385)),C=r(96036),h=r(54971),g=(r(9070),r(20924)),x=r(74443),b=(r(36616),r(51368)),D=(r(29093),r(16317)),I=r(88144),E=r(80957);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){(0,p.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var P=D.Z.Option,L=function(e){(0,l.Z)(r,e);var t=k(r);function r(e){var n;return(0,i.Z)(this,r),n=t.call(this,e),(0,p.Z)((0,s.Z)(n),"onChangeGroup",(function(e){var t=n.props,r=t.dispatch,o=t.form;n.setState({expenseTypeId:e,selectedSubjectId:void 0,selectedCostCenterType:void 0}),o.resetFields("subject"),r({type:"expenseType/fetchExpenseTypeDetail",payload:{id:e}})})),(0,p.Z)((0,s.Z)(n),"onChangeSubject",(function(e,t){var r=t.props,o=(void 0===r?{}:r).costcentertype;n.setState(_(_({},n.state),{},{selectedSubjectId:e,selectedCostCenterType:o}))})),(0,p.Z)((0,s.Z)(n),"getPlatFormVendor",(function(e){n.setState({apportionData:e},(function(){n.props.form.resetFields("invoiceTitle")}))})),(0,p.Z)((0,s.Z)(n),"renderBase",(function(){var e=n.props,t=e.form,r=e.expenseTypeDetail,o=e.costOrderDetail,a=e.expenseTypeList.data,i=void 0===a?[]:a,c=o.cost_group_info,s=(c=void 0===c?{_id:""}:c)._id,l=o.cost_accounting_info,d=(l=void 0===l?{_id:""}:l)._id,u=o.total_money,p=o.invoice_flag,f=o._id,m=t.getFieldDecorator,y=r.accountingList,O=(void 0===y?[]:y).filter((function(e){return[Z.NF3.normal].indexOf(e.state)>-1})),h=[{label:"费用分组",form:m("expenseType",{initialValue:s||void 0,rules:[{required:!0,message:"请填写内容"}]})(v.createElement(D.Z,{style:{width:"100%"},placeholder:"请选择费用分组",onChange:n.onChangeGroup},i.map((function(e){return v.createElement(P,{key:e.id,value:"".concat(e.id)},e.name)}))))},{label:"科目",form:m("subject",{initialValue:d||void 0,rules:[{required:!0,message:"请选择科目"}]})(v.createElement(D.Z,{allowClear:!0,showSearch:!0,style:{width:"100%"},optionFilterProp:"children",placeholder:"请选择科目",onChange:n.onChangeSubject},O.map((function(e){return v.createElement(P,{value:e.id,key:e.id,costcentertype:e.costCenterType,disabled:e.state===Z.NF3.disable},"".concat(e.name,"(").concat(e.accountingCode,")").concat(e.state===Z.NF3.disable?"(停用)":""))}))))},{label:"费用金额",form:m("money",{initialValue:void 0!==u?Z.fbc.exchangePriceToYuan(u):void 0,rules:[{required:!0,message:"请填写金额"}]})(v.createElement(b.Z,{min:0,step:.01,formatter:Z.fbc.limitDecimals,parser:Z.fbc.limitDecimals}))},{label:"是否开票",form:m("hasInvoice",{initialValue:f?p?"1":"0":void 0,rules:[{required:!0,message:"请填写内容"}]})(v.createElement(D.Z,{placeholder:"请选择是否开票",style:{width:"100%"}},v.createElement(P,{value:"1"},"是"),v.createElement(P,{value:"0"},"否")))}];return v.createElement(C.KP,{cols:4,items:h,layout:{labelCol:{span:9},wrapperCol:{span:15}}})})),(0,p.Z)((0,s.Z)(n),"renderCostAllocation",(function(){var e=n.props,t=e.form,r=e.examineDetail,o=e.className,a=e.costOrderDetail,i=e.uniqueKey,c=n.state,s=c.selectedSubjectId,l=c.selectedCostCenterType,d=r.platformCodes,u=a.allocation_mode,p=void 0===u?void 0:u,f=a.cost_allocation_list,m=void 0===f?[]:f;return(0,t.getFieldDecorator)("expense",{initialValue:0===Object.keys(a).length?{}:{costBelong:p,costItems:m.map((function(e){var t;e.money&&(t=Z.fbc.exchangePriceToYuan(e.money));var r={};return e.platform_code&&(r.platform=e.platform_code,r.platformName=e.platform_name),e.supplier_id&&(r.vendor=e.supplier_id,r.vendorName=e.supplier_name),e.city_code&&(r.city=e.city_code,r.cityName=e.city_name,r.citySpelling=e.city_spelling),e.biz_district_id&&(r.district=e.biz_district_id,r.districtName=e.biz_district_name),t&&(r.costCount=t),r}))}})(v.createElement(E.Z,{unique:i,CostAccountingId:s,form:n.props.form,selectedCostCenterType:l,getPlatFormVendor:n.getPlatFormVendor,platformParam:d,className:o}))})),(0,p.Z)((0,s.Z)(n),"renderInvoice",(function(){var e=n.props,t=e.form,r=e.costOrderDetail,o=n.state.apportionData,a=[{label:"发票抬头",form:(0,t.getFieldDecorator)("invoiceTitle",{initialValue:r.invoice_title})(v.createElement(I.o2,{style:{width:"100%"},platforms:o.platform,allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择供应商",isSubmitNameAsValue:!0}))}];return v.createElement(C.KP,{cols:1,items:a,layout:{labelCol:{span:3},wrapperCol:{span:21}}})})),(0,p.Z)((0,s.Z)(n),"renderHiddenForm",(function(){var e=n.state.fileList,t=[{label:"",form:n.props.form.getFieldDecorator("",{initialValue:e})(v.createElement(g.Z,{hidden:!0}))}];return v.createElement(C.KP,{items:t,cols:1,layout:{labelCol:{span:3},wrapperCol:{span:21}}})})),(0,p.Z)((0,s.Z)(n),"renderContent",(function(){return v.createElement("div",null,n.renderBase(),n.renderCostAllocation(),n.renderInvoice())})),n.state={selectedSubjectId:e.costAccountingId,selectedCostCenterType:e.costCenterType,apportionData:{}},n}return(0,c.Z)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,r=e.costOrderDetail,n=e.expenseTypeList,o=r.cost_group_info,a=(o=void 0===o?{_id:void 0}:o)._id;a&&t({type:"expenseType/fetchExpenseTypeDetail",payload:{id:a}}),0===Object.keys(n).length&&t({type:"expenseType/fetchExpenseType",payload:{limit:999,page:1,state:Z.XOG.enable}})}},{key:"render",value:function(){return this.renderContent()}}]),r}(v.Component);(0,p.Z)(L,"propsTypes",{form:y().object,expenseTypeId:y().string,examineDetail:y().object,expenseTypeDetail:y().object,costOrderDetail:y().object,uniqueKey:y().string,expenseTypeList:y().object}),(0,p.Z)(L,"defaultProps",{form:{},expenseTypeId:"",examineDetail:{},expenseTypeDetail:{},costOrderDetail:{},uniqueKey:"",expenseTypeList:{}});var T=(0,f.connect)((function(e){var t=e.expenseType;return{expenseTypeDetail:t.expenseTypeDetail,expenseTypeList:t.expenseTypeList}}))(L),F=r(28501),S=g.Z.TextArea,w=function(e){var t,r=e.form,n=e.examineDetail,o=void 0===n?{}:n,a=e.costOrderDetail,i=void 0===a?{}:a,c=e.uniqueKey,s=r.getFieldDecorator,l=i.note,d=void 0===l?void 0:l,u=i.attachment_private_urls,p=i.attachments,f=i.cost_accounting_info,m=(f=void 0===f?{_id:"",cost_center_type:""}:f)._id,y=f.cost_center_type;return v.createElement("div",null,v.createElement(T,{form:r,costCenterType:y,costAccountingId:m,uniqueKey:c,examineDetail:o,costOrderDetail:i}),(t=[{label:"备注",form:s("note",{initialValue:d,rules:[{required:!0,message:"请填写内容"}]})(v.createElement(S,{rows:2}))}],v.createElement(C.KP,{items:t,cols:1,layout:{labelCol:{span:3},wrapperCol:{span:21}}})),v.createElement(x.Z,{form:r,fileList:p,fileListUrl:u}),v.createElement(F.Z,{form:r,detail:i,totalMoney:r.getFieldValue("money"),isClassName:!0}))},N=r(38386),A=r(78877),q=r(36621);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var V=function(e){(0,l.Z)(r,e);var t=U(r);function r(e){var a;return(0,i.Z)(this,r),a=t.call(this,e),(0,p.Z)((0,s.Z)(a),"onUpdateOrder",(function(e){var t,r=e.record,n=void 0===r?{}:r,o=e.records,i=void 0===o?[]:o,c=a.props,s=c.onUpdate,l=c.uniqueKey;Object.keys(n).length>0&&(t=n._id),i.length>0&&1===i.length&&(t=i[0]._id),2===i.length&&(t=i[1]._id),s&&s(t,l),a.setState({isUpdate:!1})})),(0,p.Z)((0,s.Z)(a),"onSave",(function(){var e=a.props,t=e.form,r=e.dispatch,n=e.costOrderId,o=e.invoiceAdjustId,i=e.originalId;t.validateFields((function(e,t){e||!0===(0,A.Z)(t,e)&&r(n?{type:"expenseCostOrder/updateCostOrder",payload:{id:n,action:Z.rkq.invoiceAdjust,record:t,onSuccessCallback:a.onUpdateOrder,onFailureCallback:a.onFailureCallback}}:{type:"expenseCostOrder/createCostOrder",payload:{orderId:o,costOrderId:i,action:Z.rkq.invoiceAdjust,records:[t],onSuccessCallback:a.onUpdateOrder,onFailureCallback:a.onFailureCallback}})}))})),(0,p.Z)((0,s.Z)(a),"onCancel",(function(){var e=a.props,t=e.dispatch,r=e.costOrderId;t({type:"expenseCostOrder/deleteCostOrder",payload:{orderId:e.invoiceAdjustId,recordIds:[r],onSuccessCallback:a.onCancelCostOrder}})})),(0,p.Z)((0,s.Z)(a),"onFailureCallback",(function(e){if(e&&e.zh_message)return o.ZP.error(e.zh_message)})),(0,p.Z)((0,s.Z)(a),"onCancelCostOrder",(function(){var e=a.props,t=e.onCancel,r=e.uniqueKey;t&&t(r)})),(0,p.Z)((0,s.Z)(a),"onUpdate",(function(){a.setState({isUpdate:!0})})),(0,p.Z)((0,s.Z)(a),"onSuccessCallback",(function(e){var t=a.props,r=t.costOrderId,n=t.dispatch;e===r&&n({type:"expenseCostOrder/fetchNamespaceCostOrderDetail",payload:{recordId:e,namespace:e}}),a.setState({isUpdate:!1})})),(0,p.Z)((0,s.Z)(a),"renderContent",(function(){var e=a.state.isUpdate,t=a.props,r=t.form,n=t.examineDetail,o=t.examineOrderDetail,i=t.costOrderDetail,c=t.uniqueKey;return v.createElement("div",{className:q.Z["app-comp-expense-manage-invoiceAdjust-cost-wrap"]},v.createElement("h2",{className:q.Z["app-comp-expense-manage-invoiceAdjust-cost-title"]},"红冲申请单"),e?v.createElement(w,{form:r,uniqueKey:c,examineDetail:n,costOrderDetail:i}):v.createElement(N.Z,{detail:i,examineOrderDetail:o}),a.renderOperate())})),(0,p.Z)((0,s.Z)(a),"renderOperate",(function(){var e=a.state.isUpdate,t=a.props.costOrderDetail.total_money,r=(void 0===t?0:t)<0;return e?v.createElement("div",{className:q.Z["app-comp-expense-manage-invoiceAdjust-cost-operate"]},v.createElement(n.Z,{type:"primary",onClick:a.onSave,disabled:r},"保存")):v.createElement("div",{className:q.Z["app-comp-expense-invoiceAdjust-operate-wrap"]},v.createElement(n.Z,{type:"primary",onClick:a.onCancel,disabled:r},"删除"),v.createElement(n.Z,{type:"primary",onClick:a.onUpdate,disabled:r,className:q.Z["app-comp-expense-invoiceAdjust-operate-done"]},"编辑"))})),a.state={isUpdate:!1,costOrderId:""},a}return(0,c.Z)(r,[{key:"render",value:function(){return this.renderContent()}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.costOrderId;if(r!==t.costOrderId)return{costOrderId:r,isUpdate:!r}}}]),r}(v.Component);(0,p.Z)(V,"propTypes",{uniqueKey:y().number,costOrderId:y().string,originalId:y().string,invoiceAdjustId:y().string,examineDetail:y().object,examineOrderDetail:y().object,onUpdate:y().func,onCancel:y().func}),(0,p.Z)(V,"defaultProps",{uniqueKey:"",costOrderId:"",originalId:"",invoiceAdjustId:"",examineDetail:{},examineOrderDetail:{},onCancel:function(){},onUpdate:function(){}});var R=(0,f.connect)()(O.Z.create()(V));function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var B=function(e){(0,l.Z)(r,e);var t=K(r);function r(){var e;return(0,i.Z)(this,r),e=t.call(this),(0,p.Z)((0,s.Z)(e),"onAdd",(function(){var t=e.state.costOrderList;e.setState({costOrderList:[].concat((0,a.Z)(t),[""])})})),(0,p.Z)((0,s.Z)(e),"onUpdate",(function(t,r){var n=e.state.costOrderList;n.splice(r,1,t),e.setState({costOrderList:n}),e.fetchOriginalCostOrder()})),(0,p.Z)((0,s.Z)(e),"onCancel",(function(t){var r=e.state.costOrderList;r.splice(t,1),e.setState({costOrderList:r}),e.fetchOriginalCostOrder()})),(0,p.Z)((0,s.Z)(e),"onSubmit",(function(){var t=e.props,r=t.location,n=t.costOrderDetail,a=t.originalCostOrder,i=r.query,c=i.orderId,s=i.invoiceAdjustId,l=i.costOrderId,d=n.totalMoney,u=(a.filter((function(e){return e.id===l}))[0]||{}).refCostOrderInfoList;if((void 0===u?[]:u).filter((function(e){return e.state!==Z.Vm3.delete&&e.state!==Z.Vm3.close&&e.total_money>0})).map((function(e){return Math.abs(e.total_money)})).reduce((function(e,t){return e+t}))!==d)return o.ZP.error("红冲单金额累计不正确");window.location.href="/#/Expense/Manage/InvoiceAdjust?orderId=".concat(c,"&invoiceAdjustId=").concat(s)})),(0,p.Z)((0,s.Z)(e),"onSuccessCallbackExamineOrderDetail",(function(t){var r=t.flow_id,n=void 0===r?"":r,o=e.props.dispatch;n&&o({type:"expenseExamineFlow/fetchExamineDetail",payload:{id:n}})})),(0,p.Z)((0,s.Z)(e),"fetchOriginalCostOrder",(function(){var t=e.props;(0,t.dispatch)({type:"expenseCostOrder/fetchOriginalCostOrder",payload:{orderId:t.location.query.orderId}})})),(0,p.Z)((0,s.Z)(e),"renderOriginalCostOrder",(function(){var t=e.props,r=t.location,n=t.examineOrderDetail,o=t.examineDetail,a=t.costOrderDetail,i=r.query.costOrderId;return v.createElement(h.Z,{isInvoiceAdjust:!0,location:r,recordId:i,costOrderDetail:a,examineOrderDetail:n,examineDetail:o})})),(0,p.Z)((0,s.Z)(e),"renderInvocieAdjust",(function(){var t=e.props,r=t.examineOrderDetail,n=t.examineDetail,o=t.location,a=t.originalCostOrder,i=e.state.costOrderList;0===i.length&&i.push("");var c=o.query,s=c.orderId,l=c.invoiceAdjustId,d=c.costOrderId,u=(a.filter((function(e){return e.id===d}))[0]||{}).refCostOrderInfoList,p=void 0===u?[]:u;return i.map((function(t,o){var a=p.filter((function(e){return e._id===t}))[0]||{};return v.createElement(R,{uniqueKey:o,orderId:s,onCancel:e.onCancel,onUpdate:e.onUpdate,invoiceAdjustId:l,originalId:d,costOrderId:t,costOrderDetail:a,examineDetail:n,examineOrderDetail:r})}))})),(0,p.Z)((0,s.Z)(e),"renderOperate",(function(){return v.createElement("div",{className:q.Z["app-comp-expense-invoiceAdjust-operate-wrap"]},v.createElement(n.Z,{type:"primary",onClick:e.onAdd},"添加下一个红冲单"),v.createElement(n.Z,{type:"primary",onClick:e.onSubmit,className:q.Z["app-comp-expense-invoiceAdjust-operate-done"]},"创建完成"))})),(0,p.Z)((0,s.Z)(e),"renderContent",(function(){var t=e.props,r=t.examineOrderDetail,n=t.examineDetail,o=t.costOrderDetail,a=t.originalCostOrder;return 0===Object.keys(n).length||0===Object.keys(r).length||0===Object.keys(o).length||0===Object.keys(a).length?null:v.createElement("div",null,v.createElement(C.IT,{title:"原费用单"},e.renderOriginalCostOrder()),e.renderInvocieAdjust(),e.renderOperate())})),e.state={originalCostOrder:void 0,costOrderList:[]},e}return(0,c.Z)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,r=e.location.query,n=r.orderId,o=r.costOrderId;o&&t({type:"expenseCostOrder/fetchCostOrderDetail",payload:{recordId:o}}),void 0!==n&&(t({type:"expenseExamineOrder/fetchExamineOrderDetail",payload:{id:n,flag:!0,onSuccessCallback:this.onSuccessCallbackExamineOrderDetail}}),t({type:"expenseCostOrder/fetchOriginalCostOrder",payload:{orderId:n}}))}},{key:"render",value:function(){return this.renderContent()}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=t.originalCostOrder,n=void 0===r?void 0:r,o=e.originalCostOrder,a=void 0===o?[]:o,i=e.location.query.costOrderId;if(void 0===n&&a.length>0){var c=(a.filter((function(e){return e.id===i}))[0]||{}).refCostOrderInfoList;return{costOrderList:(void 0===c?[]:c).filter((function(e){return e.state!==Z.Vm3.delete&&e.state!==Z.Vm3.close&&e.total_money>0})).map((function(e){return e._id})),originalCostOrder:a}}}}]),r}(v.Component);(0,p.Z)(B,"propTypes",{examineOrderDetail:y().object,examineDetail:y().object,costOrderDetail:y().object,originalCostOrder:y().array}),(0,p.Z)(B,"defaultProps",{examineOrderDetail:{},examineDetail:{},costOrderDetail:{},originalCostOrder:[]});var M=(0,f.connect)((function(e){var t=e.expenseExamineOrder.examineOrderDetail,r=e.expenseExamineFlow.examineDetail,n=e.expenseCostOrder;return{examineOrderDetail:t,examineDetail:r,costOrderDetail:n.costOrderDetail,originalCostOrder:n.originalCostOrder}}))(O.Z.create()(B))}}]);