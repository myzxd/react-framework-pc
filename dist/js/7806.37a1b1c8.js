"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[7806],{7806:function(e,t,r){r.r(t),r.d(t,{default:function(){return J}});r(52466);var n=r(10642),a=(r(20186),r(75385)),o=r(15671),i=r(43144),c=r(97326),l=r(60136),s=r(82963),p=r(61120),u=r(4942),d=r(93517),f=r.n(d),m=r(55609),h=r(45697),y=r.n(h),g=r(66939),Z=(r(98703),r(67294)),v=(r(9070),r(20924)),O=(r(29093),r(16317)),C=r(96036),b=r(80385);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,p.Z)(e);if(t){var a=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var E=O.Z.Option,P=function(e){(0,l.Z)(r,e);var t=S(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"onChangeSuppliers",(function(e){var t=n.form.setFieldsValue;n.setState({suppliers:e,cities:[]}),t({cities:[],districts:[]})})),(0,u.Z)((0,c.Z)(n),"onChangePlatforms",(function(e){var t=n.form.setFieldsValue;n.setState({platforms:e,suppliers:[],cities:[]}),t({suppliers:[],cities:[],districts:[]})})),(0,u.Z)((0,c.Z)(n),"onChangeCity",(function(e,t){var r=n.form.setFieldsValue,a=t.map((function(e){return e.props?e.props.spell:""}));n.setState({cities:a}),r({districts:[]})})),(0,u.Z)((0,c.Z)(n),"onReset",(function(){var e=n.props.onSearch;e&&e({id:void 0,name:void 0,mobile:void 0,idCard:void 0,teamId:void 0,platforms:void 0,suppliers:void 0,cities:void 0,districts:void 0,state:void 0,meta:{page:1,limit:30}})})),(0,u.Z)((0,c.Z)(n),"onSearch",(function(e){var t=n.props.onSearch,r=M(M({},e),{},{meta:{page:1,limit:30}});t&&t(r)})),(0,u.Z)((0,c.Z)(n),"onHookForm",(function(e){n.form=e})),(0,u.Z)((0,c.Z)(n),"renderSearch",(function(){var e={items:[{label:"业主姓名",form:function(e){return e.getFieldDecorator("name")(Z.createElement(v.Z,{placeholder:"请输入业主姓名"}))}},{label:"手机号",form:function(e){return e.getFieldDecorator("mobile")(Z.createElement(v.Z,{placeholder:"请输入手机号"}))}},{label:"身份证号",form:function(e){return e.getFieldDecorator("idCard")(Z.createElement(v.Z,{placeholder:"请输入身份证号"}))}},{label:"状态",form:function(e){return e.getFieldDecorator("state")(Z.createElement(O.Z,{placeholder:"请选择状态"},Z.createElement(E,{value:b.zqR.normal},b.zqR.description(b.zqR.normal)),Z.createElement(E,{value:b.zqR.notEffect},b.zqR.description(b.zqR.notEffect))))}},{label:"团队ID",form:function(e){return e.getFieldDecorator("teamId")(Z.createElement(v.Z,{placeholder:"请输入团队ID"}))}}],operations:n.props.operations,expand:!0,onReset:n.onReset,onSearch:n.onSearch,onHookForm:n.onHookForm};return Z.createElement(C.IT,null,Z.createElement(C.yL,e))})),n.state={suppliers:[],platforms:[],cities:[]},n.form={},n}return(0,i.Z)(r,[{key:"render",value:function(){return Z.createElement("div",null,this.renderSearch())}}]),r}(Z.Component);(0,u.Z)(P,"propTypes",{onSearch:y().func,operations:y().array}),(0,u.Z)(P,"defaultProps",{onSearch:function(){},operations:[]});var k=P,_=(r(52560),r(71577)),j="DYorBwZm5gvjdaNMginH";function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,p.Z)(e);if(t){var a=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var D=function(e){(0,l.Z)(r,e);var t=I(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"renderContainer",(function(){var e=n.state.buttonList;return Z.createElement("div",null,e.map((function(e,t){return Z.createElement(_.Z,{type:e.type,key:t,onClick:e.onCallback,className:j},e.name)})))})),(0,u.Z)((0,c.Z)(n),"render",(function(){return Z.createElement("div",null,n.renderContainer())})),n.state={buttonList:e.buttonList?e.buttonList:[]},n}return r}(Z.Component),R=r(87462),F=(r(51838),r(48086)),z=(r(35668),r(86585)),x=r(29439),T=r(78890);function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var H=(0,m.connect)((function(e){return{teamManager:e.teamManager}}))((function(e){var t,r,a=e.dispatch,o=e.onOwnerHandleCancel,i=e.isOwnerModal,c=e.district,l=z.Z.useForm(),s=(0,x.Z)(l,1)[0],p=(0,Z.useState)({}),u=(0,x.Z)(p,2),d=u[0],m=u[1],h=(0,Z.useState)(!1),y=(0,x.Z)(h,2),g=y[0],v=y[1],O=function(e,t){m(t)},b=function(){s.validateFields().then((function(e){v(!0);var t=B(B({},e),{},{district:c,id:d._id,onFailureCallback:function(e){return v(!1),F.ZP.error("请求错误：".concat(e.zh_message))},onSuccessCallback:function(){v(!1),s.resetFields(),m({}),o&&o(),a({type:"teamManager/fetchTeamManagers",payload:{meta:{page:1,limit:30}}})}});a({type:"teamManager/createTeamManager",payload:t})}))},w=function(){s.resetFields(),v(!1),m({}),o&&o()};return Z.createElement(z.Z,{layout:"horizontal",form:s},(t={labelCol:{span:6},wrapperCol:{span:16}},r=[Z.createElement(z.Z.Item,(0,R.Z)({label:"身份证号",name:"idCard",help:d._id?"":"暂无档案的新业主，输入身份证号后点“确定”即邀请加入",rules:[{required:!0,message:"请输入身份证号"}]},t),Z.createElement(T.Z,{onChange:O})),Z.createElement(z.Z.Item,(0,R.Z)({label:"姓名"},t),f().get(d,"name","--")),Z.createElement(z.Z.Item,(0,R.Z)({label:"手机号"},t),f().get(d,"phone","--"))],Z.createElement(n.Z,{title:"选择业主",visible:i,confirmLoading:g,onOk:b,onCancel:w},Z.createElement(C.Fp,{items:r,cols:1}))))})),N=r(48390),L=r(88144),U=r(97116),V=r(45430),K="K2a11xl0NP_SCtae5QFb";function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,p.Z)(e);if(t){var a=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var W=function(e){(0,l.Z)(r,e);var t=Q(r);function r(e){var i;return(0,o.Z)(this,r),i=t.call(this,e),(0,u.Z)((0,c.Z)(i),"onChangePage",(function(e,t){var r=i.private.searchParams;r.meta.page=e,r.meta.limit=t,i.onSearch(r)})),(0,u.Z)((0,c.Z)(i),"onShowSizeChange",(function(e,t){var r=i.private.searchParams;r.meta.page=e,r.meta.limit=t,i.onSearch(r)})),(0,u.Z)((0,c.Z)(i),"onSearch",(function(e){var t=i.private.searchParams;i.private.searchParams=A(A({},t),e),i.props.dispatch({type:"teamManager/fetchTeamManagers",payload:i.private.searchParams})})),(0,u.Z)((0,c.Z)(i),"onReqList",(function(){var e=i.private.searchParams;i.props.dispatch({type:"teamManager/fetchTeamManagers",payload:e})})),(0,u.Z)((0,c.Z)(i),"onExportBiz",(function(){var e=i.private.searchParams;i.props.dispatch({type:"teamManager/exportOwnerBiz",payload:e})})),(0,u.Z)((0,c.Z)(i),"onExportNotOwnerBiz",(function(){i.props.dispatch({type:"teamManager/exportNotOwnerBiz"})})),(0,u.Z)((0,c.Z)(i),"onOwnerHandleCancel",(function(){i.setState({isOwnerModal:!1})})),(0,u.Z)((0,c.Z)(i),"onCreateModalHandleOk",(function(e){e.preventDefault(),i.props.form.validateFields((function(e,t){if(!e){var r=A(A({},t),{},{onSuccessCallback:function(){i.setState({districts:t.district}),i.props.form.resetFields(),i.setState({isShowCreateModal:!1,isOwnerModal:!0})}});i.props.dispatch({type:"teamManager/createOwnerTeamScope",payload:r}),i.props.dispatch({type:"employeeManage/resetEmployees",payload:{fileType:"second"}})}}))})),(0,u.Z)((0,c.Z)(i),"onCreateModalHandleCancel",(function(){i.setState({isShowCreateModal:!1}),i.props.form.resetFields(),i.props.dispatch({type:"employeeManage/resetEmployees",payload:{fileType:"second"}})})),(0,u.Z)((0,c.Z)(i),"onCreateOwner",(function(){i.setState({isShowCreateModal:!0})})),(0,u.Z)((0,c.Z)(i),"onClickUpdateOwner",(function(e){i.setState({updateOwnerModal:A({},e),visible:!0})})),(0,u.Z)((0,c.Z)(i),"onCancelUpdateOwner",(function(){i.setState({updateOwnerModal:{},visible:!1})})),(0,u.Z)((0,c.Z)(i),"onChangePlatformId",(function(){i.props.form.setFieldsValue({supplierId:void 0,cities:void 0,district:void 0})})),(0,u.Z)((0,c.Z)(i),"onChangeSuppliers",(function(){(0,i.props.form.setFieldsValue)({cities:void 0,district:void 0})})),(0,u.Z)((0,c.Z)(i),"onChangeCity",(function(e,t){var r=i.props.form.setFieldsValue,n=f().get(t,"props.spell",void 0);i.setState({cities:n}),r({district:void 0})})),(0,u.Z)((0,c.Z)(i),"deleteSuccessCallback",(function(){i.props.dispatch({type:"teamManager/fetchTeamManagers",payload:i.private.searchParams})})),(0,u.Z)((0,c.Z)(i),"renderSearch",(function(){return Z.createElement(k,{onSearch:i.onSearch})})),(0,u.Z)((0,c.Z)(i),"renderOwnerModal",(function(){var e=i.state,t=e.isOwnerModal,r=e.districts;return Z.createElement(H,{isOwnerModal:t,onOwnerHandleCancel:i.onOwnerHandleCancel,district:r})})),(0,u.Z)((0,c.Z)(i),"renderContent",(function(){var e=i.private.searchParams.meta,t=e.page,r=e.limit,n=i.props.teamManagers,o=[{title:"团队ID",dataIndex:"_id",key:"_id",render:function(e){return e||"--"}},{title:"状态",dataIndex:"state",key:"state",render:function(e){return e?b.zqR.description(e):"--"}},{title:"业主姓名",dataIndex:["staff_info","name"],key:"staff_info.name",render:function(e){return e||"--"}},{title:"性别",dataIndex:["staff_info","gender_id"],key:"staff_info.gender_id",render:function(e){return e?b.Y0t.description(e):"--"}},{title:"手机号",dataIndex:["staff_info","phone"],key:"staff_info.phone",render:function(e){return e||"--"}},{title:"身份证号",dataIndex:["staff_info","identity_card_id"],key:"staff_info.identity_card_id",render:function(e,t){return t.state===b.zqR.notEffect?t.identity_card_id?t.identity_card_id:"--":e||"--"}},{title:"平台",dataIndex:"platform_names",key:"platform_names",render:function(e){return e&&e.length>0?e.toString():"--"}},{title:"供应商",dataIndex:"supplier_names",key:"supplier_names",render:function(e){return e&&e.length>0?e.toString():"--"}},{title:"承揽范围数量",dataIndex:"biz_district_amount",key:"biz_district_amount",render:function(e){return e||"0"==="".concat(e)?e:"--"}},{title:"操作",dataIndex:"operation",key:"operation",width:150,render:function(e,t){return Z.createElement(Z.Fragment,null,V.ZP.canOperateTeamManagerDetail()?Z.createElement("a",{href:"#/Team/Manager/Detail?id=".concat(t._id),target:"_blank",rel:"noopener noreferrer",className:K},"查看"):"",t.state!==b.A5d.true&&t.state!==b.zqR.notEffect||!V.ZP.canOperateTeamManagerUpdate()?"":Z.createElement("a",{href:"#/Team/Manager/Update?id=".concat(t._id),target:"_blank",rel:"noopener noreferrer",className:K},"编辑"),V.ZP.canOperateTeamManagerUpdateOwner()?Z.createElement("a",{className:K,onClick:function(){return i.onClickUpdateOwner(t)}},"变更业主"):"")}}],c={current:t,pageSize:r||30,onChange:i.onChangePage,showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:i.onShowSizeChange,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],total:f().get(n,"_meta.result_count",0)},l=[];return V.ZP.canOperateTeamManagerCreate()&&l.push({name:"新增业主团队",onCallback:i.onCreateOwner,type:"primary"}),V.ZP.canOperateTeamManagerExport()&&l.push({name:"导出",onCallback:i.onExportBiz,type:"primary"}),V.ZP.canOperateTeamManagerExportNotOwner()&&l.push({name:"导出无业主的商圈",onCallback:i.onExportNotOwnerBiz,type:"primary"}),Z.createElement(C.IT,null,Z.createElement(D,{buttonList:l}),Z.createElement(a.Z,{rowKey:function(e){return e._id},pagination:c,dataSource:f().get(n,"data",[]),columns:o,bordered:!0}))})),(0,u.Z)((0,c.Z)(i),"renderCreateModal",(function(){var e=i.props.form,t=e.getFieldDecorator,r=e.getFieldValue,a=i.state,o=a.isShowCreateModal,c=a.cities,l=[{label:"平台",form:t("platformId",{rules:[{required:!0,message:"请选择平台"}]})(Z.createElement(L.Yg,{allowClear:!0,style:{width:"80%"},placeholder:"请选择平台",onChange:i.onChangePlatformId})),span:24,layout:{labelCol:{span:8},wrapperCol:{span:16}}},{label:"供应商",form:t("supplierId",{rules:[{required:!0,message:"请选择供应商"}]})(Z.createElement(L.o2,{allowClear:!0,platforms:r("platformId"),style:{width:"80%"},placeholder:"请选择供应商",onChange:i.onChangeSuppliers})),span:24,layout:{labelCol:{span:8},wrapperCol:{span:16}}},{label:"城市",form:t("cities",{rules:[{required:!0,message:"请选择城市"}]})(Z.createElement(L.Wn,{allowClear:!0,suppliers:r("supplierId"),platforms:r("platformId"),optionFilterProp:"children",onChange:i.onChangeCity,style:{width:"80%"},isExpenseModel:!0,placeholder:"请选择城市"})),span:24,layout:{labelCol:{span:8},wrapperCol:{span:16}}},{label:"商圈",form:t("district",{rules:[{required:!0,message:"请选择商圈"}]})(Z.createElement(L.Wc,{allowClear:!0,suppliers:r("supplierId"),platforms:r("platformId"),cities:c,style:{width:"80%"},placeholder:"请选择商圈"})),span:24,layout:{labelCol:{span:8},wrapperCol:{span:16}}}];return Z.createElement(n.Z,{title:"选择团队",visible:o,onOk:i.onCreateModalHandleOk,onCancel:i.onCreateModalHandleCancel},Z.createElement(C.KP,{items:l,cols:1,layout:{labelCol:{span:8},wrapperCol:{span:16}}}))})),(0,u.Z)((0,c.Z)(i),"render",(function(){var e=(0,c.Z)(i),t=e.renderSearch,r=e.renderContent,n=e.renderCreateModal,a=e.renderOwnerModal;return Z.createElement("div",null,t(),r(),n(),a(),Z.createElement(N.Z,{detail:i.state.updateOwnerModal,visible:i.state.visible,onCancel:i.onCancelUpdateOwner,dispatch:i.props.dispatch,onSuccessCallBack:i.onReqList,onClickUpdateOwner:i.onClickUpdateOwner}))})),i.state={isShowCreateModal:!1,updateOwnerModal:{},visible:!1,isOwnerModal:!1,districts:void 0},i.private={searchParams:{meta:{page:1,limit:30}}},i}return(0,i.Z)(r,[{key:"componentDidMount",value:function(){var e=this.private.searchParams;this.props.dispatch({type:"teamManager/fetchTeamManagers",payload:e}),this.props.dispatch({type:"accountManage/fetchAccountsDetails",payload:{id:U.Iq.account.id}})}}]),r}(Z.Component);(0,u.Z)(W,"propTypes",{teamManagers:y().object}),(0,u.Z)(W,"defaultProps",{teamManagers:{},accountDetail:{}});var J=(0,m.connect)((function(e){return{teamManagers:e.teamManager.teamManagers,accountDetail:e.accountManage.accountDetail}}))(g.Z.create()(W))}}]);