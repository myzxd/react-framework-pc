"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[7273],{90681:function(e,t,a){var n=a(87462),l=a(15861),s=a(29439),r=(a(29093),a(16317)),o=a(87757),i=a.n(o),c=a(67294),m=a(55609),d=a(45697),p=a.n(d),u=(a(98703),a(8240)),f=r.Z.Option;function g(e){var t=e.dispatch,a=(0,c.useState)({}),o=(0,s.Z)(a,2),m=o[0],d=o[1];(0,c.useEffect)((function(){(0,l.Z)(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({type:"applicationCommon/getEnumeratedType",payload:{}});case 2:(a=e.sent)&&a.pact_types_has_sub_types&&d(a.pact_types_has_sub_types);case 4:case"end":return e.stop()}}),e)})))()}),[]);var p=Object.keys(m).map((function(e){return c.createElement(f,{value:"".concat(e),key:e},(0,u.Cg)(m,"".concat(e,".name")))}));return e.isDetail?c.createElement("div",null,e.showValue.map((function(e){return(0,u.Cg)(m,"".concat(e,".name"))})).join(",")):c.createElement(r.Z,(0,n.Z)({allowClear:!0,showSearch:!0},(0,u.CE)(["dispatch","isDetail","showValue"],e)),p)}g.propTypes={isDetail:p().bool,showValue:p().array},g.defaultProps={isDetail:!1,showValue:[]},t.Z=(0,m.connect)()(g)},33582:function(e,t,a){a(52466);var n=a(10642),l=a(87462),s=(a(9070),a(20924)),r=(a(35668),a(86585)),o=a(29439),i=a(67294),c=a(55609),m=a(45697),d=a.n(m),p=a(96036),u=a(97116),f=a(86221),g={labelCol:{span:8},style:{display:"flex",marginBottom:12}};function Z(e){var t=e._id,a=e.contractNumber,c=e.visible,m=e.setVisible,d=e.dispatch,Z=e.breakContractList,b=e.contractDetail,E=void 0===b?{}:b,y=(0,i.useState)(!1),h=(0,o.Z)(y,2),_=h[0],v=h[1],w=r.Z.useForm(),N=(0,o.Z)(w,1)[0],k=(0,i.useState)(!0),C=(0,o.Z)(k,2),O=C[0],S=C[1],P=function(){v(!1),x(),Z(),!u.P6.dotOptimal(E,"is_filed")&&(window.location.href="/#/Shared/Contract")},x=function(){m(!1),v(!1),S(!0)},F=function(e,t){var a=t.forms[e].getFieldsValue(),n=a.filed_address,l=a.file_keys,s=a.filed_box;S(!(n&&l&&s))};(0,i.useEffect)((function(){c&&N.setFieldsValue({filed_address:u.P6.dotOptimal(E,"filed_info.filed_address",void 0),filed_box:u.P6.dotOptimal(E,"filed_info.filed_box",void 0),file_keys:f.uA.getInitialValue(E,"sign_asset_infos"),filed_note:u.P6.dotOptimal(E,"filed_info.filed_note",void 0)})}),[c]);var j;return i.createElement(n.Z,{visible:c,title:"归档信息",confirmLoading:_,onOk:function(){N.validateFields().then((function(e){var n=e.filed_address,l=e.filed_box,s=e.file_keys,r=e.filed_note;v(!0);var o={_id:t,filed_address:n,filed_box:l,file_keys:s,filed_note:r,pact_num:a,isUpdateContract:u.P6.dotOptimal(E,"is_filed",!1),onCallBack:P};d({type:"sharedContract/updateFiles",payload:o})}))},onCancel:function(){return x&&x(!1)},width:"35%",okButtonProps:{disabled:O}},(j=[i.createElement(r.Z.Item,(0,l.Z)({label:"存放地",name:"filed_address"},g,{rules:[{required:!0}]}),i.createElement(s.Z,{placeholder:"请输入存放地"})),i.createElement(r.Z.Item,(0,l.Z)({label:"存放档案盒",name:"filed_box"},g,{rules:[{required:!0}]}),i.createElement(s.Z,{placeholder:"请输入存放档案盒"})),i.createElement(r.Z.Item,(0,l.Z)({label:"上传盖章合同附件",name:"file_keys"},g,{rules:[{required:!0}]}),i.createElement(f.uA,{domain:f.uA.UploadDomains.OAUploadDomain})),i.createElement(r.Z.Item,(0,l.Z)({label:"备注",name:"filed_note"},g),i.createElement(s.Z.TextArea,null)),i.createElement(r.Z.Item,(0,l.Z)({label:"合同序号",name:"pact_num"},g),a||"--")],i.createElement(r.Z.Provider,{onFormChange:F},i.createElement(r.Z,{form:N,name:"control-hooks",className:"affairs-flow-basic form-item-content-scroll"},i.createElement(p.Fp,{items:j,cols:1})))))}Z.propTypes={dispatch:d().func.isRequired,_id:d().string,visible:d().bool,setVisible:d().func,contractNumber:d().string,breakContractList:d().func},Z.defaultProps={_id:"",contractNumber:"",visible:!1,setVisible:function(){},breakContractList:function(){}},t.Z=(0,c.connect)()(Z)},36696:function(e,t,a){a(52560);var n=a(71577),l=(a(52466),a(10642)),s=(a(51838),a(48086)),r=a(4942),o=a(15861),i=(a(35668),a(86585)),c=a(29439),m=(a(19597),a(27279)),d=(a(9070),a(20924)),p=a(87757),u=a.n(p),f=a(67294),g=a(45697),Z=a.n(g),b=a(55609),E=a(97116),y=a(80385),h=a(96036),_=a(86221),v=a(11393);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=d.Z.TextArea,C=m.Z.Panel,O=function(){};function S(e){var t,a,r,d,p=e.visible,g=e.setSignModalVisible,Z=e.signType,b=e.signContractInfo,w=e.batchSignContractInfo,O=e.selectedRowKeys,S=e.setSelectedRowKeys,P=e.breakContractList,x=e.sharedContractSign,F=i.Z.useForm(),j=(0,c.Z)(F,1)[0],D=(0,f.useState)(!1),I=(0,c.Z)(D,2),A=I[0],V=I[1],K=(0,f.useState)(!1),T=(0,c.Z)(K,2),L=T[0],B=T[1],R=(0,f.useState)([]),q=(0,c.Z)(R,2),U=q[0],Y=q[1],z=function(){var e=(0,o.Z)(u().mark((function e(){var t,a,n,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V(!0),e.next=3,j.validateFields();case 3:return a=e.sent,t=N(N({},a),{},"sign"===Z?{contractIds:[b._id]}:{contractIds:O}),e.next=7,x(N({},t));case 7:return n=e.sent,l=n[0]||{},e.next=11,E.P6.sleep(2e3);case 11:if(V(!1),n){e.next=14;break}return e.abrupt("return");case 14:Y(n),"batchSign"===Z?B(!0):l.msg?s.ZP.error(l.msg):s.ZP.success("盖章成功"),j.resetFields(),g(!1),P(),S([]);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){j.resetFields(),g(!1)};return f.createElement(f.Fragment,null,(t=w.filter((function(e){return e&&e.stamp_type===y.bmm.weFirst})),a=w.filter((function(e){return e&&e.stamp_type===y.bmm.weNext})),r=function(e){return f.createElement("div",{key:e._id,className:"batchSign"===Z?v.Z["sign-modal-collapse-panel-item"]:void 0},f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"合同名称："),f.createElement("span",{className:v.Z["sign-modal-content"]},e.name||"--")),f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"签订单位："),f.createElement("span",{className:v.Z["sign-modal-content"]},E.P6.dotOptimal(e,"firm_info.name","--"))),f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"BOSS审批单号："),f.createElement("span",{className:v.Z["sign-modal-content"]},e.application_order_id||"--")),f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"合同甲方："),f.createElement("span",{className:v.Z["sign-modal-content"]},e.pact_part_a||"--")))},d=[f.createElement(i.Z.Item,{name:"note",label:"备注",rules:[{pattern:/\S+/,message:"禁止输入空白字符"}]},f.createElement(k,{rows:2,placeholder:"请输入"}))],"sign"===Z&&(d[d.length]=f.createElement(i.Z.Item,{label:"上传附件",name:"assetKeys"},f.createElement(_.uA,{domain:_.uA.UploadDomains.OAUploadDomain}))),f.createElement(l.Z,{title:"确认盖章",visible:p,confirmLoading:A,onOk:z,onCancel:H},"sign"===Z?r(b):f.createElement("div",{style:{maxHeight:300,overflowY:"auto"}},f.createElement(m.Z,{defaultActiveKey:["weFirst","weNext"],bordered:!1},f.createElement(C,{header:f.createElement("span",{className:v.Z["sign-modal-collapse-panel-header"]},"我方先章：",t.length,"份合同"),key:"weFirst",className:v.Z["sign-modal-collapse-panel"]},t.map((function(e){return r(e)}))),f.createElement(C,{header:f.createElement("span",{className:v.Z["sign-modal-collapse-panel-header"]},"我方后章：",a.length,"份合同"),key:"weNext",className:v.Z["sign-modal-collapse-panel"]},a.map((function(e){return r(e)}))))),f.createElement(i.Z,{form:j,style:{paddingTop:20},className:"affairs-flow-basic form-item-content-scroll"},f.createElement(h.Fp,{items:d,cols:1})))),function(){if("sign"!==Z){var e=U.filter((function(e){return e&&e.ok})),t=U.filter((function(e){return e&&!e.ok})),a=function(e,t){return f.createElement("div",{key:e._id,className:v.Z["sign-modal-collapse-panel-item"]},f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"合同名称："),f.createElement("span",{className:v.Z["sign-modal-content"]},e.pact_name||"--")),f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"BOSS审批单号："),f.createElement("span",{className:v.Z["sign-modal-content"]},e.application_order_id||"--")),"fail"===t&&f.createElement("p",{className:v.Z["sign-modal-info-wrap"]},f.createElement("span",{className:v.Z["sign-modal-lable"]},"失败原因："),f.createElement("span",{className:v.Z["sign-modal-content"]},e.msg||"--")))};return f.createElement(l.Z,{title:"".concat(e.length,"份合同盖章成功，").concat(t.length,"份合同盖章失败"),visible:L,onOk:function(){B(!1)},onCancel:function(){B(!1)},footer:f.createElement("div",{className:v.Z["signres-modal-footer"]},f.createElement(n.Z,{type:"primary",onClick:function(){B(!1)}},"知道了"))},f.createElement("div",{style:{maxHeight:300,overflowY:"auto"}},f.createElement(m.Z,{defaultActiveKey:["fail","success"],bordered:!1},f.createElement(C,{header:f.createElement("span",{className:v.Z["sign-modal-collapse-panel-header"]},e.length,"份合同盖章成功"),key:"success",className:v.Z["sign-modal-collapse-panel"]},e.map((function(e){return a(e,"success")}))),f.createElement(C,{header:f.createElement("span",{className:v.Z["sign-modal-collapse-panel-header"]},t.length,"份合同盖章失败"),key:"fail",className:v.Z["sign-modal-collapse-panel"]},t.map((function(e){return a(e,"fail")}))))))}}())}S.propTypes={visible:Z().bool,setSignModalVisible:Z().func,signType:Z().string,signContractInfo:Z().object,batchSignContractInfo:Z().array,selectedRowKeys:Z().array,setSelectedRowKeys:Z().func,breakContractList:Z().func},S.defaultProps={batchSignContractInfo:[],selectedRowKeys:[],setSelectedRowKeys:O,breakContractList:O};t.Z=(0,b.connect)((function(){return{}}),(function(e){return{sharedContractSign:function(t){return e({type:"sharedContract/sharedContractSign",payload:t})}}}))(S)},11393:function(e,t){t.Z={"sign-modal-info-wrap":"Axi7VGja7DK6AQTgK5Xi","sign-modal-lable":"ARYvv_4fWxbdKWdUt7jB","sign-modal-content":"aqFftV4_9e3wetrj2pp7","sign-modal-collapse-panel":"asY7cL5ZxaZPTfPI9X6F","sign-modal-collapse-panel-header":"Zildgdz00UHrXzqeBLaG","sign-modal-collapse-panel-item":"aejb3dlFMNPo8TcRWlEa","signres-modal-footer":"iDzJZeNuPDddw67uAKcq"}}}]);