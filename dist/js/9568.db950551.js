"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[9568],{97376:function(e,n,t){t(52466);var a=t(10642),i=(t(29394),t(94756)),l=t(29439),r=t(93517),o=t.n(r),c=t(67294),u=t(55609);n.Z=(0,u.connect)((function(e){return{codeInformation:e.adminManage.codeInformation}}))((function(e){var n=e.visible,t=e.dispatch,r=e.values,u=e.roleInfos,d=void 0===u?[]:u,s=(0,c.useState)([]),m=(0,l.Z)(s,2),f=m[0],p=m[1],E=o().get(e,"codeInformation",[]),g=d.map((function(e){return e._id})),v=E.filter((function(e){return!g.includes(e._id)}));(0,c.useEffect)((function(){t({type:"adminManage/fetchSystemCodeInformation",payload:{}})}),[t]),(0,c.useEffect)((function(){p(r)}),[r]);var y=function(){var n=k(f);e.onOk&&e.onOk(f,n)},h=function(){p([]),e.onCancel&&e.onCancel()},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=v.filter((function(n){return e.includes(n._id)}));return n},Z=function(e){p(e)};return c.createElement(c.Fragment,null,!0!==n?null:c.createElement(a.Z,{title:"数据权限组",visible:n,onOk:y,onCancel:h,width:900},c.createElement(i.Z,{dataSource:v,rowKey:function(e){return e._id},titles:["全选／合计","全选／合计"],showSearch:!0,targetKeys:f,onChange:Z,render:function(e){return e.name},listStyle:{height:400,width:400}})))}))},19568:function(e,n,t){t.r(n),t.d(n,{default:function(){return P}});t(52466);var a=t(10642),i=(t(9070),t(20924)),l=(t(51838),t(48086)),r=(t(18085),t(55241)),o=(t(20186),t(75385)),c=(t(438),t(14277)),u=(t(52560),t(71577)),d=(t(21316),t(75443)),s=t(29439),m=(t(29093),t(16317)),f=t(67294),p=t(94315),E=t.n(p),g=t(93517),v=t.n(g),y=t(55609),h=t(66939),k=(t(98703),t(96036)),Z=t(97116),b=t(80385),C=t(45430),S=t(97376),x="lwKIQjbkWLTRh8Y5jMvI",I="d7CfMwP2PWE9TrnPpEr3",_=m.Z.Option,T=Z.By.isShowCode(),M="角色管理",N="CODE业务策略";function w(e){var n,t=(0,f.useState)({}),p=(0,s.Z)(t,2),g=p[0],y=p[1],Z=(0,f.useState)({}),w=(0,s.Z)(Z,2),P=w[0],O=w[1],R=(0,f.useState)(!1),D=(0,s.Z)(R,2),H=D[0],z=D[1],F=(0,f.useState)(!1),j=(0,s.Z)(F,2),B=j[0],V=j[1],A=(0,f.useState)([]),K=(0,s.Z)(A,2),G=K[0],L=K[1],U=(0,f.useState)(!1),q=(0,s.Z)(U,2),W=q[0],Q=q[1],Y=e.dispatch,J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(e),z(!0)},X=function(e,n){var t={gid:e.gid,name:e.name,pid:e.pid,state:n};Y({type:"adminManage/updateSystemRole",payload:t})},$=function e(n,t){var a=[];if(n.forEach((function(i){if(i.available!==b.sHN.deleted&&"".concat(i.current_pid)==="".concat(t)){var l=i;l.key="".concat(i.gid,"-").concat(i.current_pid),l.children=e(n,i.gid),a.push(l)}})),!E().empty(a))return a},ee=function(){var n=e.roles,t=$(n,0),a=[{title:"角色名称",dataIndex:"name",key:"name"},{title:"状态",dataIndex:"available",key:"available",render:function(e){return f.createElement("span",null,b.sHN.description(e))}},{title:"角色id",dataIndex:"gid",key:"id"},{title:"操作",dataIndex:"gid",key:"gid",render:function(e,n){if(0===n.pid)return"";var t=[];return n.available===b.sHN.available&&t.push(f.createElement("span",{key:"off-".concat(e),className:x},f.createElement(d.Z,{title:"确定执行此操作?",onConfirm:function(){X(n,b.sHN.disable)},okText:"确定",cancelText:"取消"},f.createElement("a",null,"禁用")))),n.available===b.sHN.disable&&t.push(f.createElement("span",{key:"on-".concat(e),className:x},f.createElement(d.Z,{title:"确定执行此操作?",onConfirm:function(){X(n,b.sHN.available)},okText:"确定",cancelText:"取消"},f.createElement("a",null,"启用")))),(E().empty(n.children)||E().not.existy(n.children))&&t.push(f.createElement("span",{key:"delete-".concat(e),className:x},f.createElement(d.Z,{title:"确定执行此操作?",onConfirm:function(){X(n,b.sHN.deleted)},okText:"确定",cancelText:"取消"},f.createElement("a",null,"停用")))),f.createElement("span",null,f.createElement("a",{onClick:function(){J(n)}},"编辑"),t)}}],i=f.createElement("div",null,f.createElement(u.Z,{type:"primary",className:I,onClick:function(){J()}},"添加角色"));return t?f.createElement(k.IT,{title:"角色管理",titleExt:i},f.createElement(o.Z,{dataSource:t,columns:a,bordered:!0,pagination:!1,defaultExpandAllRows:!0})):f.createElement(c.Z,{image:c.Z.PRESENTED_IMAGE_SIMPLE})},ne=function(){var n=e.roles,t=$(void 0===n?[]:n,0),a=[{title:"角色名称",dataIndex:"name",key:"name"},{title:"业务策略",dataIndex:"code_biz_group_infos",key:"code_biz_group_infos",render:function(e){return E().not.existy(e)||E().empty(e)?"--":e.length<=5?f.createElement("span",null,e.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.name})).join(", ")):f.createElement(r.Z,{overlayStyle:{zIndex:9999},content:f.createElement("span",null,e.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.name})).join(", ")),trigger:"hover"},f.createElement("div",null,e.slice(0,5).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.name})).join(", "),"..."))}},{title:"操作",dataIndex:"操作",key:"操作",render:function(e,n){return f.createElement("a",{onClick:function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.code_biz_group_ids||[];V(!0),L(n),O(e)}(n)}},"编辑")}}];return t?f.createElement(k.IT,{title:"CODE业务策略"},f.createElement(o.Z,{dataSource:t,columns:a,bordered:!0,pagination:!1,loading:W,defaultExpandAllRows:!0})):f.createElement(c.Z,{image:c.Z.PRESENTED_IMAGE_SIMPLE})},te=function(){y({}),z(!1),e.form.resetFields()},ae=function(){e.form.validateFields((function(e,n){if(!e){var t=n.isUpdate,a=n.gid,i=n.name,r=n.pid,o=n.state;if(""!==i)if(""!==r){if(t)Y({type:"adminManage/updateSystemRole",payload:{gid:a,name:i,pid:r,state:o}});else Y({type:"adminManage/createSystemRole",payload:{name:i,pid:r}});te()}else l.ZP.error("所属上级不能为空");else l.ZP.error("角色名称不能为空")}}))},ie=function(){V(!1),O({})},le=function(){ie()},re=function(n){Q(!0);var t={gid:P.gid,name:P.name,pid:P.pid,codeBizGroupIds:n,isCode:!0,onSucessCallback:le,callBack:function(){return Q(!1)},onFailureCallback:function(){return Q(!1)}};e.dispatch({type:"adminManage/updateSystemRole",payload:t})};return f.createElement("div",null,(n=[{title:"角色管理",content:ee(),key:M}],!0===T&&(0,C.yU)()&&n.push({title:"CODE业务策略",content:ne(),key:N}),f.createElement(k.DF,{items:n})),function(){var n=e.roles,t=e.form.getFieldDecorator,l=!(!E().existy(g)||!E().not.empty(g)),r=l?"更新数据":"添加数据",o={name:v().get(g,"name",""),pid:v().get(g,"current_pid","")},c=[{label:"角色名称",form:t("name",{rules:[{required:!0,message:"请填写角色名称"}],initialValue:o.name})(f.createElement(i.Z,null))},{label:"所属上级",form:t("pid",{rules:[{required:!0,message:"请选择所属上级"}],initialValue:"".concat(o.pid)})(f.createElement(m.Z,{placeholder:"请选择所属上级"},n.filter((function(e){return e.gid!==g.gid})).map((function(e){return f.createElement(_,{key:"role-select-".concat(e.gid),value:"".concat(e.gid)},e.name)}))))}];t("isUpdate",{initialValue:l})(f.createElement(i.Z,null)),t("gid",{initialValue:v().get(g,"gid","")})(f.createElement(i.Z,null)),t("state",{initialValue:v().get(g,"state","")})(f.createElement(i.Z,null));return f.createElement(a.Z,{title:r,visible:H,onOk:ae,onCancel:te,okText:"提交",cancelText:"取消"},f.createElement(h.Z,{layout:"horizontal"},f.createElement(k.KP,{items:c,cols:1,layout:{labelCol:{span:6},wrapperCol:{span:9}}})))}(),!0!==B?null:f.createElement(S.Z,{visible:B,values:G,onOk:re,onCancel:ie}))}w.defaultProps={roles:[]};var P=(0,y.connect)((function(e){return{roles:e.adminManage.roles}}))(h.Z.create()(w))}}]);