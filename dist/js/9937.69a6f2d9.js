"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[9937],{12213:function(e,t,n){n(52466);var r=n(10642),a=(n(52560),n(71577)),o=n(4942),i=n(93517),c=n.n(i),s=n(94315),l=n.n(s),p=n(55609),f=n(67294);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=(0,p.connect)((function(e){return{teamManager:e.teamManager}}))((function(e){var t,n,o,i,s,p=e.dispatch,u=e.onDistrictHandleCancel,m=e.isDistrictModal,h=function(){var t=e.api,n=void 0===t?void 0:t,r=e.paramsInfo,a=void 0===r?{}:r,o=e.updateListCallback,i=e.onCancel,c=e.knightInfo.map((function(e){return e.biz_district_id})),s=d(d({},a),{},{districtId:c,onSuccessCallBack:function(){o&&o(),u&&u(),i&&i()}});p({type:n,payload:s})};return f.createElement(r.Z,{visible:m,onOk:h,onCancel:function(){var t=e.onClickUpdateOwner,n=e.detail;u&&u(),t&&t(n)},footer:[f.createElement(a.Z,{key:"yes",type:"primary",onClick:h},"是"),f.createElement(a.Z,{key:"no",onClick:function(){var t=e.api,n=void 0===t?void 0:t,r=e.paramsInfo,a=void 0===r?{}:r,o=e.updateListCallback,i=e.onCancel,c=d(d({},a),{},{onSuccessCallBack:function(){u&&u(),o&&o(),i&&i()}});p({type:n,payload:c})}},"否")]},(t=e.detail,n=e.knightInfo,o=l().not.empty(n)&&n.length>0?n:[],i=c().get(t,"staff_info.name")?c().get(t,"staff_info.name","--"):c().get(t,"owner_info.staff_info.name"),s=o.map((function(e){return e.biz_district_name})),f.createElement("div",{style:{textAlign:"center"}},f.createElement("span",null,"是否同时将".concat(i||"--","的骑士账号移出")),f.createElement("a",null,s&&l().not.empty(s)?s.join(","):""),f.createElement("span",null,"（当前业主有骑士身份的商圈）？"))))}))},87679:function(e,t,n){var r=n(15671),a=n(97326),o=n(60136),i=n(82963),c=n(61120),s=n(4942),l=n(67294),p=n(45697),f=n.n(p),u=n(96036),d=n(88144);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.Z)(e);if(t){var a=(0,c.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var h=function(e){(0,o.Z)(n,e);var t=m(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"onSearch",(function(t){var n=e.props.onSearch,r=t.platforms,a=t.suppliers,o=t.cities,i=t.districts,c=t.department,s=t.month;n&&n({platforms:r,suppliers:a,cities:o,districts:i,department:c,month:s,page:1,limit:30})})),(0,s.Z)((0,a.Z)(e),"onReset",(function(){var t=e.props.onSearch;t&&t({page:1,limit:30})})),(0,s.Z)((0,a.Z)(e),"render",(function(){var t={onReset:e.onReset,onSearch:e.onSearch,items:e.props.items,isExpenseModel:!0},n=e.props.items;return n&&(t.items=n),l.createElement(u.IT,null,l.createElement(d.p8,t))})),e}return n}(l.Component);(0,s.Z)(h,"propTypes",{onSearch:f().func}),(0,s.Z)(h,"defaultProps",{onSearch:function(){}}),t.Z=h},54994:function(e,t,n){var r=n(87462),a=n(15671),o=n(43144),i=n(97326),c=n(60136),s=n(82963),l=n(61120),p=n(4942),f=n(94315),u=n.n(f),d=n(45697),m=n.n(d),h=n(67294),y=n(55609),g=n(96036),b=n(8240);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}var C=g.Hr.Option,S=function(e){(0,c.Z)(n,e);var t=v(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),(0,p.Z)((0,i.Z)(e),"onSearch",(function(t){t&&e.props.dispatch({type:"ownerBusiness/fetchOwnerId",payload:{name:t}})})),(0,p.Z)((0,i.Z)(e),"onChange",(function(t){var n=e.props.businessOwner,r=(void 0===n?[]:n).filter((function(e){return e._id===t}));e.props.onChange&&e.props.onChange(t,r[0])})),e}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.props.isResetData||this.props.dispatch({type:"ownerBusiness/reduceBusinessOwner",payload:{}})}},{key:"componentDidUpdate",value:function(e){this.props.tiemStamp!==e.tiemStamp&&this.props.dispatch({type:"ownerBusiness/reduceBusinessOwner",payload:{}})}},{key:"render",value:function(){var e,t=this.props.businessOwner,n=void 0===t?[]:t;u().not.empty(n)&&u().existy(n)&&(e=n.map((function(e){return h.createElement(C,{value:e._id,key:e._id},"".concat(e.staff_info.name,"（").concat(e._id,"）"))})));var a=w(w({},(0,b.CE)(["dispatch","businessOwner","tiemStamp","platformCode","supplierId"],this.props)),{},{placeholder:"请输入姓名搜索",showSearch:!0,defaultActiveFirstOption:!1,showArrow:!1,allowClear:!0,filterOption:!1,onChange:this.onChange,onSearch:this.onSearch,notFoundContent:null});return h.createElement(g.Hr,(0,r.Z)({},a,{style:{width:260}}),e)}}]),n}(h.Component);(0,p.Z)(S,"propTypes",{businessOwner:m().array,tiemStamp:m().number,isResetData:m().bool}),(0,p.Z)(S,"defaultProps",{businessOwner:[],tiemStamp:0,isResetData:!1});t.Z=(0,y.connect)((function(e){return{businessOwner:e.ownerBusiness.businessOwner}}))(S)},89937:function(e,t,n){n.r(t);n(52466);var r=n(10642),a=(n(36037),n(47933)),o=(n(20186),n(75385)),i=n(15671),c=n(43144),s=n(97326),l=n(60136),p=n(82963),f=n(61120),u=n(4942),d=n(94315),m=n.n(d),h=n(30381),y=n.n(h),g=n(93517),b=n.n(g),_=n(45697),w=n.n(_),v=n(66939),C=(n(98703),n(67294)),S=n(55609),Z=n(87679),O=n(54994),D=n(96036),k=n(80385),P=n(12213);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.Z)(e);if(t){var a=(0,f.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var M=new Date,B=M.getFullYear(),z=M.getMonth(),R=new Date(B,z+1,1),x=function(e){(0,l.Z)(n,e);var t=j(n);function n(e){var c;return(0,i.Z)(this,n),c=t.call(this,e),(0,u.Z)((0,s.Z)(c),"onSearch",(function(e){if(e){var t=e.page,n=e.limit,r=e.platforms,a=e.suppliers,o=e.cities,i=e.districts;c.private.searchParams={meta:{page:t,limit:n},platforms:r,suppliers:a,cities:o,districts:i}}c.props.dispatch({type:"ownerBusiness/fetchOwnerBusinessList",payload:c.private.searchParams})})),(0,u.Z)((0,s.Z)(c),"onChangePage",(function(e,t){c.onSearch(I({page:e,limit:t},c.private.searchParams))})),(0,u.Z)((0,s.Z)(c),"onDistrictHandleCancel",(function(){c.setState({isDistrictModal:!1})})),(0,u.Z)((0,s.Z)(c),"onShowSizeChange",(function(e,t){c.onSearch(I({page:e,limit:t},c.private.searchParams))})),(0,u.Z)((0,s.Z)(c),"onChangeScope",(function(e){c.setState({isShowChangeScopeModal:!0,ownerData:e})})),(0,u.Z)((0,s.Z)(c),"onSuccessCallBack",(function(){c.onSearch(),c.onClickChangeScopeCancel(),c.props.dispatch({type:"ownerBusiness/effctResetOwnerId"}),c.props.form.setFieldsValue({id:void 0}),c.setState({isShowChangeScopeModal:!1,managerDetail:{}})})),(0,u.Z)((0,s.Z)(c),"onCallBackInfo",(function(e,t){var n=c.props.form.getFieldValue;m().not.empty(e)&&m().existy(e)&&n("date")===k.D9p.immediately?c.setState({isShowChangeScopeModal:!1,isDistrictModal:!0,knightInfo:e}):c.props.dispatch({type:"teamManager/fetchOwnerUpdateScope",payload:I(I({},t),{},{onSuccessCallBack:function(){c.onClickChangeScopeCancel(),c.onSuccessCallBack()}})})})),(0,u.Z)((0,s.Z)(c),"onClickChangeScopeOk",(function(e){e.preventDefault(),c.props.form.validateFields((function(e,t){var n=c.state,r=n.effectDate,a=n.managerDetail,o=n.ownerData;if(!e){var i=I({id:a._id,district:[o.biz_district_id],staffId:a.staff_id,ownerId:o.owner_id,effectDate:r},t);c.setState({paramsInfo:i}),c.props.dispatch({type:"teamManager/fetchTeamKnightDistrcit",payload:I(I({},i),{},{onSuccessCallBack:function(e){c.onCallBackInfo(e,i)}})})}}))})),(0,u.Z)((0,s.Z)(c),"onClickChangeScopeCancel",(function(){c.props.form.resetFields(),c.props.form.setFieldsValue({id:void 0}),c.setState({isShowChangeScopeModal:!1,managerDetail:{},tiemStamp:Date.parse(new Date)})})),(0,u.Z)((0,s.Z)(c),"onChangeManager",(function(e,t){c.setState({managerDetail:t})})),(0,u.Z)((0,s.Z)(c),"onEffectDate",(function(e){e.target.value===k.D9p.immediately?c.setState({effectDate:Number(y()(M).format("YYYYMMDD"))}):c.setState({effectDate:Number(y()(R).format("YYYYMMDD"))})})),(0,u.Z)((0,s.Z)(c),"renderSearch",(function(){var e=(0,s.Z)(c).onSearch;return C.createElement(Z.Z,{onSearch:e})})),(0,u.Z)((0,s.Z)(c),"renderContent",(function(){var e=c.private.searchParams.meta,t=e.page,n=e.limit,r=c.props.businessList,a=void 0===r?{}:r,i=a.data,l=void 0===i?[]:i,p=[{title:"平台",dataIndex:["biz_district_info","platform_name"],key:"biz_district_info.platform_name",render:function(e){return e||"--"}},{title:"供应商",dataIndex:["biz_district_info","supplier_name"],key:"biz_district_info.supplier_name",render:function(e){return e||"--"}},{title:"城市",dataIndex:["biz_district_info","city_name"],key:"biz_district_info.city_name",render:function(e){return e||"--"}},{title:"商圈",dataIndex:["biz_district_info","name"],key:"biz_district_info.name",render:function(e){return e||"--"}},{title:"商圈状态",dataIndex:["biz_district_info","state"],key:"biz_district_info.state",render:function(e){return k.hQm.description(e)}},{title:"业主姓名",dataIndex:["owner_info","staff_info","name"],key:"owner_info.staff_info.name",render:function(e){return e||"--"}},{title:"身份证号",dataIndex:["owner_info","staff_info","identity_card_id"],key:"owner_info.staff_info.identity_card_id",render:function(e,t){return t.owner_state===k.zqR.notEffect?t.owner_info.identity_card_id?t.owner_info.identity_card_id:"--":e||"--"}},{title:"业主手机号",dataIndex:["owner_info","staff_info","phone"],key:"owner_info.staff_info.phone",render:function(e){return e||"--"}},{title:"操作",dataIndex:"operation",key:"operation",width:100,render:function(e,t){return C.createElement(C.Fragment,null,C.createElement("span",{className:"app-global-compoments-cursor",onClick:c.onChangeScope.bind((0,s.Z)(c),t)},"变更业务承揽"))}}],f={current:t,pageSize:n,onChange:c.onChangePage,showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:c.onShowSizeChange,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],total:b().get(a,"_meta.result_count",0)};return C.createElement(D.IT,null,C.createElement(o.Z,{rowKey:function(e,t){return t},pagination:f,dataSource:l,columns:p,bordered:!0}))})),(0,u.Z)((0,s.Z)(c),"renderIdentityCardId",(function(){var e=c.state.ownerData,t=e.owner_info||{},n=t.staff_info||{};return e.owner_state===k.zqR.notEffect?t.identity_card_id?t.identity_card_id:"--":n.identity_card_id||"--"})),(0,u.Z)((0,s.Z)(c),"renderChangeScopeModal",(function(){var e=c.props.form.getFieldDecorator,t=c.state,n=t.isShowChangeScopeModal,o=t.managerDetail,i=t.ownerData,s=t.tiemStamp,l=(i.owner_info||{}).staff_info||{};if(!i.biz_district_info)return null;var p=[{label:"平台",form:i.biz_district_info.platform_name},{label:"供应商",form:i.biz_district_info.supplier_name},{label:"城市",form:i.biz_district_info.city_name},{label:"商圈",form:i.biz_district_info.name}],f=[{label:"姓名",form:l.name||"--"},{label:"身份证号",form:c.renderIdentityCardId(),layout:{labelCol:{span:10},wrapperCol:{span:14}}},{label:"手机号",form:l.phone||"--"}],u=[{label:"姓名",form:e("id",{rules:[{required:!0,message:"请输入姓名"}]})(C.createElement(O.Z,{tiemStamp:s,onChange:c.onChangeManager})),span:24,layout:{labelCol:{span:8},wrapperCol:{span:16}}},{label:"身份证号",form:b().get(o,"staff_info.identity_card_id","--")},{label:"手机号",form:b().get(o,"staff_info.phone","--")},{label:"团队ID",form:b().get(o,"_id","--")},{label:"生效日期",form:e("date",{initialValue:k.D9p.immediately,rules:[{required:!0,message:"请选择生效日期"}]})(C.createElement(a.ZP.Group,{onChange:c.onEffectDate},C.createElement(a.ZP,{value:k.D9p.immediately},k.D9p.description(k.D9p.immediately)),C.createElement(a.ZP,{value:k.D9p.second},k.D9p.description(k.D9p.second))))}];return C.createElement(r.Z,{title:"变更业务承揽",width:"800px",visible:n,onOk:c.onClickChangeScopeOk,onCancel:c.onClickChangeScopeCancel,okText:"确定变更"},C.createElement("p",null,"业务范围信息"),C.createElement(D.KP,{items:p,cols:2,layout:{labelCol:{span:8},wrapperCol:{span:16}}}),C.createElement("p",null,"变更前业主"),C.createElement(D.KP,{items:f,cols:3,layout:{labelCol:{span:8},wrapperCol:{span:16}}}),C.createElement("p",null,"变更后业主"),C.createElement(D.KP,{items:u,cols:1,layout:{labelCol:{span:8},wrapperCol:{span:16}}}))})),(0,u.Z)((0,s.Z)(c),"renderDistrictModl",(function(){var e={api:"teamManager/fetchOwnerUpdateScope",isDistrictModal:c.state.isDistrictModal,detail:c.state.ownerData,knightInfo:c.state.knightInfo,onClickUpdateOwner:c.onChangeScope,onCancel:c.onClickChangeScopeCancel,onDistrictHandleCancel:c.onDistrictHandleCancel,updateListCallback:c.onSuccessCallBack,paramsInfo:c.state.paramsInfo};return C.createElement(P.Z,e)})),c.state={isDistrictModal:!1,isShowChangeScopeModal:!1,managerDetail:{},ownerData:{},knightInfo:[],paramsInfo:{},effectDate:Number(y()(M).format("YYYYMMDD")),tiemStamp:Date.parse(new Date)},c.private={searchParams:{meta:{page:1,limit:30}},namespace:"namespace".concat(Math.floor(1e5*Math.random()))},c}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){var e=this.private.searchParams;this.props.dispatch({type:"ownerBusiness/fetchOwnerBusinessList",payload:e})}},{key:"render",value:function(){return C.createElement("div",null,this.renderSearch(),this.renderContent(),this.renderChangeScopeModal(),this.renderDistrictModl())}}]),n}(C.Component);(0,u.Z)(x,"propTypes",{businessList:w().object}),(0,u.Z)(x,"defaultProps",{businessList:{}}),t.default=(0,S.connect)((function(e){return{businessList:e.ownerBusiness.businessList}}))(v.Z.create()(x))}}]);