"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[3087],{87679:function(e,t,n){var a=n(15671),r=n(97326),o=n(60136),i=n(82963),c=n(61120),s=n(4942),l=n(67294),p=n(45697),d=n.n(p),u=n(96036),f=n(88144);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,i.Z)(this,n)}}var m=function(e){(0,o.Z)(n,e);var t=h(n);function n(){var e;(0,a.Z)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,r.Z)(e),"onSearch",(function(t){var n=e.props.onSearch,a=t.platforms,r=t.suppliers,o=t.cities,i=t.districts,c=t.department,s=t.month;n&&n({platforms:a,suppliers:r,cities:o,districts:i,department:c,month:s,page:1,limit:30})})),(0,s.Z)((0,r.Z)(e),"onReset",(function(){var t=e.props.onSearch;t&&t({page:1,limit:30})})),(0,s.Z)((0,r.Z)(e),"render",(function(){var t={onReset:e.onReset,onSearch:e.onSearch,items:e.props.items,isExpenseModel:!0},n=e.props.items;return n&&(t.items=n),l.createElement(u.IT,null,l.createElement(f.p8,t))})),e}return n}(l.Component);(0,s.Z)(m,"propTypes",{onSearch:d().func}),(0,s.Z)(m,"defaultProps",{onSearch:function(){}}),t.Z=m},93087:function(e,t,n){n.r(t);n(52466);var a=n(10642),r=(n(36616),n(51368)),o=(n(20186),n(75385)),i=(n(52560),n(71577)),c=(n(55295),n(69713)),s=(n(51838),n(48086)),l=n(15671),p=n(43144),d=n(97326),u=n(60136),f=n(82963),h=n(61120),m=n(4942),g=(n(54071),n(14072)),Z=n(93517),C=n.n(Z),_=n(30381),w=n.n(_),y=n(67294),v=n(55609),S=n(66939),k=(n(98703),n(68628)),x=n(87679),I=n(45430),E=n(96036),P=n(88144),b=n(80385),M=n(43894);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,f.Z)(this,n)}}var R=I.ZP.canOperateTeamTeacherManageOperationsEdit(),D=I.ZP.canOperateTeamTeacherManageOperationsBatchEdit(),T=g.Z.MonthPicker,z=function(e){(0,u.Z)(n,e);var t=O(n);function n(e){var p;return(0,l.Z)(this,n),p=t.call(this,e),(0,m.Z)((0,d.Z)(p),"onSearch",(function(e){if(e){var t=e.page,n=e.limit,a=e.platforms,r=e.suppliers,o=e.cities,i=e.districts,c=e.department,s=e.month,l=void 0===s?new Date:s,d=e.singleCost,u=e.singleIncome;p.private.searchParams={meta:{page:t,limit:n},platforms:a,suppliers:r,cities:o,districts:i,department:c,month:l,singleCost:d,singleIncome:u}}p.setState({selectedRowKeys:[]}),p.props.dispatch({type:"modelCoachOperations/fetchCoachOperationsList",payload:p.private.searchParams})})),(0,m.Z)((0,d.Z)(p),"onChangePage",(function(e,t){p.private.searchParams.meta.page=e,p.private.searchParams.meta.limit=t,p.onSearch()})),(0,m.Z)((0,d.Z)(p),"onShowSizeChange",(function(e,t){p.private.searchParams.meta.page=e,p.private.searchParams.meta.limit=t,p.onSearch()})),(0,m.Z)((0,d.Z)(p),"onChangeMoney",(function(e){p.props.form.setFieldsValue({changeIncome:e.forecast_order_income||0===e.forecast_order_income?b.fbc.exchangePriceToYuan(e.forecast_order_income):void 0,changeCost:e.forecast_order_cost||0===e.forecast_order_cost?b.fbc.exchangePriceToYuan(e.forecast_order_cost):void 0}),p.setState({isShowChangeModal:!0,changeData:e})})),(0,m.Z)((0,d.Z)(p),"onClickChangeOk",(function(){p.props.form.validateFieldsAndScroll((function(e,t){if(!e){var n=t.changeIncome,a=t.changeCost,r=p.state.changeData;if(!n&&0!==n&&!a&&0!==a)return!1;var o={ids:[r._id],changeIncome:n,changeCost:a,onSuccessCallback:p.onSuccessCallback};p.props.dispatch({type:"modelCoachOperations/updateMoney",payload:o})}}))})),(0,m.Z)((0,d.Z)(p),"onSuccessCallback",(function(){s.ZP.success("修改成功！"),p.props.form.setFieldsValue({changeIncome:void 0,changeCost:void 0}),p.setState({isShowChangeModal:!1,changeData:{}}),p.onSearch()})),(0,m.Z)((0,d.Z)(p),"onClickChangeCancel",(function(){p.props.form.setFieldsValue({changeIncome:void 0,changeCost:void 0}),p.setState({changeData:{},isShowChangeModal:!1}),p.props.form.setFieldsValue({changeIncome:void 0,changeCost:void 0})})),(0,m.Z)((0,d.Z)(p),"onSelectChange",(function(e){p.setState({selectedRowKeys:e})})),(0,m.Z)((0,d.Z)(p),"goBatchPage",(function(){var e=p.state.selectedRowKeys;if(e.length>30)return s.ZP.warning("最多同时操作30个单子");if(e.length<=0)return s.ZP.warning("请勾选需要批量操作的单子");var t=JSON.stringify(e);window.location.href="/#/Team/Teacher/Manage/Operations/Update?selectedRowKeys=".concat(t)})),(0,m.Z)((0,d.Z)(p),"disabledDate",(function(e){return e>w()().month(w()().month()+1)})),(0,m.Z)((0,d.Z)(p),"showMoreStr",(function(e,t){return e.length<=t?e:y.createElement(c.Z,{placement:"right",title:e},"".concat(e.slice(0,t),"..."))})),(0,m.Z)((0,d.Z)(p),"renderSearch",(function(){var e=(0,d.Z)(p).onSearch,t=w()(new Date),n=[{label:"私教部门",form:function(e){return e.getFieldDecorator("department")(y.createElement(P.MG,{isAuthorized:!0,multiple:!0,isOnlyShowCoach:!0,allowClear:!0,namespace:"filter-department",placeholder:"请选择私教部门"}))}},{label:"归属月份",form:function(e){return e.getFieldDecorator("month",{initialValue:t})(y.createElement(T,{allowClear:!1,disabledDate:p.disabledDate,placeholder:"请选择月份",className:M.Z["app-comp-team-teacher-operations-w100"]}))}}];return y.createElement(x.Z,{onSearch:e,items:n,isExpenseModel:!0})})),(0,m.Z)((0,d.Z)(p),"renderContent",(function(){var e=(0,d.Z)(p).showMoreStr,t=p.private.searchParams.meta,n=t.page,a=t.limit,r=p.state.selectedRowKeys,c=p.props.coachOperationsList,s=c.data,l=void 0===s?[]:s,u=c._meta,f=void 0===u?{}:u,h=[{title:"私教部门",dataIndex:"department_info",key:"department_info.name",fixed:"left",width:100,render:function(e){return e&&e.name||"--"}},{title:"私教部门ID",dataIndex:"_id",key:"_id",fixed:"left",width:150,render:function(e){return e||"--"}},{title:"业主",dataIndex:"owner_info",key:"owner_info.staff_info.name",width:100,render:function(e){return e&&e.staff_info&&e.staff_info.name||"--"}},{title:"业主团队ID",dataIndex:"owner_info",key:"owner_info.staff_info._id",width:150,render:function(e){return e&&e.staff_info&&e.staff_info._id||"--"}},{title:"平台",dataIndex:"platform_name",key:"platform_name",render:function(t){return e(t||"--",10)}},{title:"供应商",dataIndex:"supplier_info",key:"supplier_info.name",render:function(t){return e(t&&t.name||"--",10)}},{title:"城市",dataIndex:"city_name",key:"city_name",render:function(t){return e(t||"--",10)}},{title:"商圈",dataIndex:"biz_district_info",key:"biz_district_info.name",render:function(t){return e(t&&t.name||"--",10)}},{title:"商圈状态",dataIndex:"biz_district_info",key:"biz_district_info.state",width:100,render:function(e){return e&&e.state?b.hQm.description(e.state):"--"}},{title:"操作日期",dataIndex:"updated_at",key:"updated_at",width:150,render:function(e){return e?w()(e).format("YYYY年MM月DD日"):"--"}},{title:"归属月份",dataIndex:"month",key:"month",width:150,render:function(e){return e?w()("".concat(e,"01")).format("YYYY年MM月"):"--"}},{title:"操作人",dataIndex:"operator_info",key:"operator_info.name",width:100,render:function(e){return e&&e.name||"--"}},{title:"预估当月单收入(元)",dataIndex:"forecast_order_income",key:"forecast_order_income",width:150,render:function(e){return e||0===e?b.fbc.exchangePriceToYuan(e):"--"}},{title:"预估当月单成本(元)",dataIndex:"forecast_order_cost",key:"forecast_order_cost",width:150,render:function(e){return e||0===e?b.fbc.exchangePriceToYuan(e):"--"}},{title:"操作",dataIndex:"can_update",key:"can_update",fixed:"right",width:100,render:function(e,t){return e&&R?y.createElement(y.Fragment,null,y.createElement("span",{className:"app-global-compoments-cursor",onClick:p.onChangeMoney.bind((0,d.Z)(p),t)},"修改")):null}}],m={current:n,defaultPageSize:30,pageSize:a,onChange:p.onChangePage,showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:p.onShowSizeChange,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],total:C().get(f,"result_count",0)},g={selectedRowKeys:r,onChange:p.onSelectChange},Z=y.createElement("div",null,y.createElement(k.Z,{className:M.Z["app-comp-team-teacher-operations-icon"]}),y.createElement("span",{className:M.Z["app-comp-team-teacher-operations-title-ext"]},"请于本月填写次月“预估当月单收入、当月单成本”数据"),D?y.createElement(i.Z,{onClick:p.goBatchPage,type:"primary",className:M.Z["app-comp-team-teacher-operations-title-btn"]},"批量修改"):null);return y.createElement(E.IT,{title:"列表信息",titleExt:Z},y.createElement(o.Z,{rowKey:function(e){return e._id},pagination:m,dataSource:l,columns:h,bordered:!0,rowSelection:D?g:null,scroll:{x:2030}}))})),(0,m.Z)((0,d.Z)(p),"renderChangeModal",(function(){var e=p.props.form.getFieldDecorator,t=p.state.isShowChangeModal,n=[{label:"预估当月单收入",form:e("changeIncome")(y.createElement(r.Z,{min:0,precision:2,placeholder:"请输入单收入",formatter:function(e){return"".concat(e,"元")},className:M.Z["app-comp-team-teacher-operations-w100"]}))},{label:"预估当月单成本",form:e("changeCost")(y.createElement(r.Z,{min:0,precision:2,placeholder:"请输入单成本",formatter:function(e){return"".concat(e,"元")},className:M.Z["app-comp-team-teacher-operations-w100"]}))}];return y.createElement(a.Z,{title:"修改信息",visible:t,onOk:p.onClickChangeOk,onCancel:p.onClickChangeCancel,okText:"修改"},y.createElement(E.KP,{items:n,cols:1,layout:{labelCol:{span:8},wrapperCol:{span:12}}}))})),p.state={isShowChangeModal:!1,changeData:{},selectedRowKeys:[]},p.private={searchParams:{meta:{page:1,limit:30},month:new Date}},p}return(0,p.Z)(n,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"modelCoachOperations/fetchCoachOperationsList",payload:this.private.searchParams})}},{key:"render",value:function(){return y.createElement("div",null,this.renderSearch(),this.renderContent(),this.renderChangeModal())}}]),n}(y.Component);t.default=(0,v.connect)((function(e){return{coachOperationsList:e.modelCoachOperations.coachOperationsList}}))(S.Z.create()(z))},43894:function(e,t){t.Z={"app-comp-team-teacher-operations-w100":"lc4FhHY8j_1gQBwulfxx","app-comp-team-teacher-operations-title-btn":"nfMFkI1pn4in3FEOpaCt","app-comp-team-teacher-operations-icon":"IQVFuyBzQmz8Odgs7YEC","app-comp-team-teacher-operations-title-ext":"EiLsFxgAWwCe2gqhA9EW"}}}]);