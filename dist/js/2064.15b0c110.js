"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[2064],{12064:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});n(20186);var r=n(75385),a=(n(52560),n(71577)),o=(n(21316),n(75443)),c=n(71002),i=(n(55295),n(69713)),s=n(15671),l=n(43144),u=n(97326),p=n(60136),f=n(82963),d=n(61120),m=n(4942),h=n(30381),Z=n.n(h),y=n(55609),b=n(45697),v=n.n(b),k=n(67294),P=n(80385),E=n(96036),O=(n(9070),n(20924)),g=(n(29093),n(16317)),D=n(88144);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,f.Z)(this,n)}}var x=g.Z.Option,j=function(e){(0,p.Z)(n,e);var t=w(n);function n(e){var r;return(0,s.Z)(this,n),r=t.call(this,e),(0,m.Z)((0,u.Z)(r),"onSearch",(function(e){var t=r.props.onSearch,n=C(C({},e),{},{meta:{page:1,limit:30}});t&&t(n)})),(0,m.Z)((0,u.Z)(r),"onReset",(function(){var e=r.props.onSearch;e&&e({meta:{page:1,limit:30}})})),(0,m.Z)((0,u.Z)(r),"onHookForm",(function(e){r.setState({form:e})})),(0,m.Z)((0,u.Z)(r),"renderSearch",(function(){var e={items:[{label:"岗位名称",form:function(e){return e.getFieldDecorator("postId")(k.createElement(D.cT,{placeholder:"请选择岗位名称",allowClear:!0,showSearch:!0,optionFilterProp:"children"}))}},{label:"成员姓名",form:function(e){return e.getFieldDecorator("memberName")(k.createElement(O.Z,{placeholder:"请输入成员姓名"}))}},{label:"状态",form:function(e){return e.getFieldDecorator("state")(k.createElement(g.Z,{placeholder:"请选择",allowClear:!0,mode:"multiple",showArrow:!0},k.createElement(x,{value:P.Dkk.draft},P.Dkk.description(P.Dkk.draft)),k.createElement(x,{value:P.Dkk.disable},P.Dkk.description(P.Dkk.disable)),k.createElement(x,{value:P.Dkk.normal},P.Dkk.description(P.Dkk.normal))))}},{label:"岗位号",form:function(e){return e.getFieldDecorator("postNum")(k.createElement(O.Z,{placeholder:"请输入岗位号"}))}}],expand:!0,onReset:r.onReset,onSearch:r.onSearch,onHookForm:r.onHookForm};return k.createElement(E.IT,null,k.createElement(E.yL,e))})),(0,m.Z)((0,u.Z)(r),"renderAddPostModal",(function(){if(!1===r.state.isShowTransferModel)return null})),r.state={form:void 0},r}return(0,l.Z)(n,[{key:"render",value:function(){return k.createElement("div",null,this.renderSearch())}}]),n}(k.Component);(0,m.Z)(j,"propTypes",{onSearch:v().func.isRequired}),(0,m.Z)(j,"defaultProps",{onSearch:function(){}});var R=j,F="Rx0EafjLnUJWMpRmwppG",_=(n(52466),n(10642)),M=(n(29394),n(94756)),A=n(66939),N=(n(98703),"Af_CJqeWua2jtQm4949O"),T="I1Df_sf0kjqi8xPrJNvF",I="bnr_RaDkDdL_qtCSwFh9",q="r34AGoGBR08S6Of43ChL";function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,f.Z)(this,n)}}var K=function(e){(0,p.Z)(n,e);var t=H(n);function n(){var e;return(0,s.Z)(this,n),e=t.call(this),(0,m.Z)((0,u.Z)(e),"componentDidMount",(function(){var t=e.props,n=t.postDate;(0,t.form.setFieldsValue)({member:n.account_ids}),e.props.dispatch({type:"applicationCommon/fetchAllAccountName"})})),(0,m.Z)((0,u.Z)(e),"onChangeMembers",(function(t){e.setState({accountIds:t})})),(0,m.Z)((0,u.Z)(e),"onOkModal",(function(){var t=e.props,n=t.isCreate,r=t.postDate;e.props.form.validateFields((function(t,a){if(!t){var o=r._id,c=r.state,i=z(z({},a),{},{id:o,onSuccessCallback:e.onAddSuccessCallback});n?e.props.dispatch({type:"expenseExamineFlow/createPost",payload:i}):c===P.Dkk.draft?e.props.dispatch({type:"expenseExamineFlow/updatePost",payload:i}):c===P.Dkk.normal&&e.props.dispatch({type:"expenseExamineFlow/managementPost",payload:i}),e.props.onCancel()}}))})),(0,m.Z)((0,u.Z)(e),"onCancelModal",(function(){(0,e.props.form.resetFields)(),e.props.onCancel()})),(0,m.Z)((0,u.Z)(e),"onAddSuccessCallback",(function(){e.props.dispatch({type:"expenseExamineFlow/fetchExaminePost",payload:{meta:{page:1,limit:30}}})})),(0,m.Z)((0,u.Z)(e),"renderTransfer",(function(){var t=e.props.form,n=t.getFieldDecorator,r=t.getFieldsValue,a=e.props.postDate,o=a.post_name,c=void 0===o?void 0:o,i=a.state===P.Dkk.normal,s=e.props.allAccount.nameTree,l=void 0===s?[]:s,u=[{label:"",form:n("name",{rules:[{required:!0,max:64,message:"岗位名称不能为空且不能超过64字符"}],initialValue:c})(k.createElement(O.Z,{placeholder:"请输入岗位名称",disabled:i}))}],p=r(["member"]).member,f=[{label:"",form:n("member")(k.createElement(M.Z,{dataSource:l,showSearch:!0,rowKey:function(e){return e.key},targetKeys:p,render:function(e){return e.title},className:I,listStyle:{height:400},titles:["全选／合计","全选／合计"]}))}],d={labelCol:{span:0},wrapperCol:{span:24}};return k.createElement(_.Z,{title:"添加岗位",visible:e.props.visible,onOk:e.onOkModal,onCancel:e.onCancelModal},k.createElement("h4",{className:N},k.createElement("span",{className:q}),"岗位名称"),k.createElement(E.KP,{items:u,cols:1,layout:d}),k.createElement("h4",{className:T},"岗位成员"),k.createElement(E.KP,{items:f,cols:1,layout:d}))})),(0,m.Z)((0,u.Z)(e),"render",(function(){return e.renderTransfer()})),e.state={},e}return n}(k.Component);(0,m.Z)(K,"propTypes",{visible:v().bool.isRequired,form:v().object.isRequired,dispatch:v().func.isRequired,allAccount:v().object.isRequired,postDate:v().object,isCreate:v().bool.isRequired}),(0,m.Z)(K,"defaultProps",{visible:!1,form:{},dispatch:function(){},allAccount:{},postDate:{},isCreate:!0});var J=A.Z.create()(K),L=(0,y.connect)((function(e){return{allAccount:e.applicationCommon.allAccount}}))(J),Y=n(45430),G=n(97116);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,f.Z)(this,n)}}var W=function(e){(0,p.Z)(n,e);var t=Q(n);function n(e){var l;return(0,s.Z)(this,n),l=t.call(this,e),(0,m.Z)((0,u.Z)(l),"onChangePage",(function(e,t){var n=l.private.searchParams;n.meta.page=e,n.meta.limit=t,l.onChangeSearch(n)})),(0,m.Z)((0,u.Z)(l),"onShowSizeChange",(function(e,t){var n=l.private.searchParams;n.meta.page=e,n.meta.limit=t,l.onChangeSearch(n)})),(0,m.Z)((0,u.Z)(l),"onChangeSearch",(function(e){var t=V(V({},l.private.searchParams),e);l.props.dispatch({type:"expenseExamineFlow/fetchExaminePost",payload:t})})),(0,m.Z)((0,u.Z)(l),"onSearch",(function(e){var t=l.private.searchParams;t.meta.page=1,t.meta.limit=30,l.onChangeSearch(V(V({},t),e))})),(0,m.Z)((0,u.Z)(l),"onShowAdd",(function(){l.setState({isShowTransferModel:!0,isCreate:!0})})),(0,m.Z)((0,u.Z)(l),"onCancelModal",(function(){l.setState({isShowTransferModel:!1})})),(0,m.Z)((0,u.Z)(l),"onEdit",(function(e){l.setState({isShowTransferModel:!0,isCreate:!1,postDate:e})})),(0,m.Z)((0,u.Z)(l),"onEnableAndDisablePost",(function(e,t){l.props.dispatch({type:"expenseExamineFlow/enableAndDisablePost",payload:{id:e,flag:t,onSuccessCallback:l.onSuccessCallback}})})),(0,m.Z)((0,u.Z)(l),"onSuccessCallback",(function(){l.props.dispatch({type:"expenseExamineFlow/fetchExaminePost",payload:{meta:{page:1,limit:30}}})})),(0,m.Z)((0,u.Z)(l),"reduceName",(function(e){return e.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),"")})),(0,m.Z)((0,u.Z)(l),"renderPostName",(function(e){return e&&"string"==typeof e?e.length<=6?e:k.createElement(i.Z,{title:e},k.createElement("span",null,"".concat(e.substring(0,6),"..."))):"--"})),(0,m.Z)((0,u.Z)(l),"renderMemberInfo",(function(e){return!e||"object"===(0,c.Z)(e)&&Array===e.constructor&&0===e.length?"--":e.length<=7?l.reduceName(e):k.createElement(i.Z,{title:l.reduceName(e)},k.createElement("span",null,"".concat(l.reduceName(e.slice(0,7)),"...")))})),(0,m.Z)((0,u.Z)(l),"renderSearch",(function(){return k.createElement(R,{onSearch:l.onSearch})})),(0,m.Z)((0,u.Z)(l),"renderContent",(function(){var e=l.private.searchParams.meta,t=e.page,n=e.limit,c=l.props.examinePostData,i=c.data,s=c._meta,u=G.Iq.account.id,p=[{title:"岗位号",dataIndex:"_id",key:"_id",render:function(e){return e||"--"}},{title:"岗位名称",dataIndex:"post_name",key:"post_name",render:l.renderPostName},{title:"成员",width:"200px",dataIndex:"account_info_list",key:"account_info_list",render:l.renderMemberInfo},{title:"状态",dataIndex:"state",key:"state",render:function(e){return e?P.Dkk.description(e):"--"}},{title:"最新操作者",dataIndex:"operator_info",key:"operator_info",render:function(e){return e&&e.name?e.phone?"".concat(e.name,"(").concat(e.phone,")"):e.name:"--"}},{title:"最新操作时间",dataIndex:"updated_at",key:"updated_at",render:function(e){return e?Z()(e).format("YYYY-MM-DD HH:mm"):"--"}},{title:"操作",dataIndex:"operation",key:"operation",render:function(e,t){var n=t._id,r=t.state,a=t.creator_id,c=[],i=!0;return r===P.Dkk.draft&&a===u&&(Y.ZP.canOperateExpensePostUpdate()&&c.push(k.createElement("a",{key:"update",className:F,onClick:function(){return l.onEdit(t)}},"编辑")),Y.ZP.canOperateExpensePostEnable()&&c.push(k.createElement(o.Z,{key:"delete",title:"确认启用?",onConfirm:function(){l.onEnableAndDisablePost(n,i)}},k.createElement("a",{key:"disable"},"启用")))),r===P.Dkk.normal&&(i=!1,Y.ZP.canOperateExpensePostUpdate()&&c.push(k.createElement("a",{key:"update",className:F,onClick:function(){return l.onEdit(t)}},"编辑")),Y.ZP.canOperateExpensePostDisable()&&c.push(k.createElement(o.Z,{key:"delete",title:"确认停用?",onConfirm:function(){l.onEnableAndDisablePost(n,i)}},k.createElement("a",{key:"disable"},"停用")))),r!==P.Dkk.disable&&0!==c.length||(c="--"),c}}],f={current:t,pageSize:n,onChange:l.onChangePage,showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:l.onShowSizeChange,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],total:s.result_count||0},d=Y.ZP.canOperateExpensePostCreate()?k.createElement(a.Z,{type:"primary",onClick:l.onShowAdd},"添加岗位"):"";return k.createElement(E.IT,{title:"审批岗位",titleExt:d},k.createElement(r.Z,{rowKey:function(e,t){return t},pagination:f,dataSource:i,columns:p}))})),(0,m.Z)((0,u.Z)(l),"renderAddPostModal",(function(){var e=l.state,t=e.isShowTransferModel,n=e.isCreate,r=e.postDate;if(!1!==t){var a={isCreate:n,postDate:n?{}:r,dispatch:l.props.dispatch,visible:t,onCancel:l.onCancelModal};return k.createElement(L,a)}})),l.state={isShowTransferModel:!1,isCreate:!0,postDate:{}},l.private={searchParams:{meta:{page:1,limit:30}}},l}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){var e=this.private.searchParams;this.props.dispatch({type:"expenseExamineFlow/fetchExaminePost",payload:e})}},{key:"render",value:function(){return k.createElement("div",null,this.renderSearch(),this.renderContent(),this.renderAddPostModal())}}]),n}(k.Component);(0,m.Z)(W,"propTypes",{examinePostData:v().object}),(0,m.Z)(W,"defaultProps",{examinePostData:{data:[],_meta:{}}});var X=(0,y.connect)((function(e){return{examinePostData:e.expenseExamineFlow.examinePostData}}))(W)}}]);