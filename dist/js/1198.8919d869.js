"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[1198],{22112:function(e,t,n){var a=n(87462),r=n(93433),o=n(44925),i=(n(29093),n(16317)),c=n(96486),l=n.n(c),u=n(67294),m=n(55609),s=["dispatch","value","onChange","enumeratedValue"],d=i.Z.Option;t.Z=(0,m.connect)((function(e){return{enumeratedValue:e.codeRecord.enumeratedValue}}))((function(e){var t=e.dispatch,n=e.value,c=e.onChange,m=e.enumeratedValue,p=void 0===m?{}:m,f=(0,o.Z)(e,s);(0,u.useEffect)((function(){return t({type:"codeRecord/getEnumeratedValue",payload:{}}),function(){t({type:"codeRecord/resetEnumerateValue",payload:{}})}}),[t]);var g=p.code_invoice_titles||[],h=p.team_invoice_titles||[],b=l().uniqWith([].concat((0,r.Z)(g),(0,r.Z)(h)),(function(e,t){return e.name===t.name}));return u.createElement(i.Z,(0,a.Z)({value:n,onChange:c,dropdownMatchSelectWidth:!1},f),b.map((function(e,t){return u.createElement(d,{value:e.name,key:t},e.name)})))}))},42167:function(e,t,n){var a=n(87462),r=n(44925),o=(n(29093),n(16317)),i=n(96486),c=n.n(i),l=n(55609),u=n(67294),m=["dispatch","mainBodyList","value","onChange"],s=o.Z.Option;t.Z=(0,l.connect)((function(e){return{mainBodyList:e.costAmortization.mainBodyList}}))((function(e){var t=e.dispatch,n=e.mainBodyList,i=void 0===n?{}:n,l=e.value,d=e.onChange,p=(0,r.Z)(e,m);(0,u.useEffect)((function(){return t({type:"costAmortization/getMainBodyList",payload:{}}),function(){t({type:"costAmortization/resetMainBodyList"})}}),[t]);var f=i.data,g=void 0===f?[]:f,h=c().uniqWith(g,(function(e,t){return e.name===t.name}));return u.createElement(o.Z,(0,a.Z)({value:l,onChange:d,dropdownMatchSelectWidth:!1},p),h.map((function(e){return u.createElement(s,{value:e._id,key:e._id},e.name)})))}))},35578:function(e,t,n){var a=n(87462),r=n(44925),o=(n(29093),n(16317)),i=n(55609),c=n(67294),l=["dispatch","platformList","value","onChange"],u=o.Z.Option;t.Z=(0,i.connect)((function(e){return{platformList:e.costAmortization.platformList}}))((function(e){var t=e.dispatch,n=e.platformList,i=void 0===n?{}:n,m=e.value,s=e.onChange,d=(0,r.Z)(e,l);(0,c.useEffect)((function(){return t({type:"costAmortization/getPlatformList",payload:{}}),function(){t({type:"costAmortization/resetPlatformList"})}}),[t]);var p=i.data,f=void 0===p?[]:p;return c.createElement(o.Z,(0,a.Z)({value:m,onChange:s,dropdownMatchSelectWidth:!1},d),f.map((function(e){return c.createElement(u,{value:e._id,key:e._id},e.name)})))}))},63781:function(e,t,n){var a=n(87462),r=n(44925),o=(n(29093),n(16317)),i=n(55609),c=n(67294),l=["dispatch","projectList","value","onChange"],u=o.Z.Option;t.Z=(0,i.connect)((function(e){return{projectList:e.costAmortization.projectList}}))((function(e){var t=e.dispatch,n=e.projectList,i=void 0===n?{}:n,m=e.value,s=e.onChange,d=(0,r.Z)(e,l);(0,c.useEffect)((function(){t({type:"costAmortization/getProjectList",payload:{}})}),[t]);var p=i.data,f=void 0===p?[]:p;return c.createElement(o.Z,(0,a.Z)({value:m,onChange:s,dropdownMatchSelectWidth:!1},d),f.map((function(e){return c.createElement(u,{value:e._id,key:e._id},e.name)})))}))},38225:function(e,t,n){var a=n(87462),r=n(44925),o=(n(29093),n(16317)),i=n(55609),c=n(67294),l=["dispatch","scenesList","value","onChange"],u=o.Z.Option;t.Z=(0,i.connect)((function(e){return{scenesList:e.costAmortization.scenesList}}))((function(e){var t=e.dispatch,n=e.scenesList,i=void 0===n?{}:n,m=e.value,s=e.onChange,d=(0,r.Z)(e,l);(0,c.useEffect)((function(){return t({type:"costAmortization/getScenesList",payload:{}}),function(){t({type:"costAmortization/resetScenesList"})}}),[t]);var p=i.data,f=void 0===p?[]:p;return c.createElement(o.Z,(0,a.Z)({value:m,onChange:s,dropdownMatchSelectWidth:!1},d),f.map((function(e){return c.createElement(u,{value:e._id,key:e._id},e.name)})))}))},54589:function(e,t,n){var a=n(87462),r=n(44925),o=(n(29093),n(16317)),i=n(55609),c=n(67294),l=["dispatch","subjectList","value","onChange","costCenterType","namespace"],u=o.Z.Option;t.Z=(0,i.connect)((function(e){return{subjectList:e.costAmortization.subjectList}}))((function(e){var t=e.dispatch,n=e.subjectList,i=void 0===n?{}:n,m=e.value,s=e.onChange,d=e.costCenterType,p=e.namespace,f=void 0===p?"all_data":p,g=(0,r.Z)(e,l);(0,c.useEffect)((function(){t({type:"costAmortization/getSubjectList",payload:{page:1,limit:9999,type:d,namespace:f}})}),[t,d,f]);var h=i[f]||[];return m&&h.length<1?c.createElement(o.Z,{style:{width:"80%"}}):c.createElement(o.Z,(0,a.Z)({value:m,onChange:s},g),h.map((function(e){return c.createElement(u,{value:e._id,key:e._id,disabled:Array.isArray(m)&&m.includes("*")},e.name,"(",e.ac_code,")")})))}))},91198:function(e,t,n){n.r(t),n.d(t,{default:function(){return ge}});var a=n(15861),r=n(4942),o=n(29439),i=n(87757),c=n.n(i),l=n(55609),u=n(67294),m=n(94315),s=n.n(m),d=n(87462),p=(n(9070),n(20924)),f=(n(35668),n(86585)),g=(n(54071),n(14072)),h=(n(29093),n(16317)),b=n(30381),y=n.n(b),v=n(96036),E=n(80385),_=n(54589),Z=n(38225),x=n(35578),S=n(42167),P=n(63781),C=n(93433),w=n(44925),I=["dispatch","value","onChange","codeCostCenterTypeList","teamCostCenterTypeList"],T=h.Z.Option,O=(0,l.connect)((function(e){var t=e.codeRecord;return{codeCostCenterTypeList:t.codeCostCenterTypeList,teamCostCenterTypeList:t.teamCostCenterTypeList}}))((function(e){var t=e.dispatch,n=e.value,a=e.onChange,r=e.codeCostCenterTypeList,o=void 0===r?[]:r,i=e.teamCostCenterTypeList,c=void 0===i?[]:i,l=(0,w.Z)(e,I);(0,u.useEffect)((function(){return t({type:"codeRecord/getCodeCostCenterTypeList",payload:{}}),t({type:"codeRecord/getTeamCostCenterTypeList",payload:{}}),function(){t({type:"codeRecord/resetCodeCostCenterTypeList"}),t({type:"codeRecord/resetTeamCostCenterTypeList"})}}),[t]);var m=[];return Array.isArray(o)&&Array.isArray(c)&&(m=[].concat((0,C.Z)(o),(0,C.Z)(c))),u.createElement(h.Z,(0,d.Z)({value:n,onChange:a,dropdownMatchSelectWidth:!1},l),m.map((function(e){return u.createElement(T,{value:e._id,key:e._id},e.name)})))})),A=n(22112),z=h.Z.Option,M=g.Z.MonthPicker,j={labelCol:{span:4},wrapperCol:{span:16}},F=function(e){var t=e.onSearch,n={placeholder:"请选择",allowClear:!0,mode:"multiple",optionFilterProp:"children",showArrow:!0},a={items:[u.createElement(f.Z.Item,{label:"科目名称",name:"subject"},u.createElement(_.Z,n)),u.createElement(f.Z.Item,{label:"场景",name:"scenes"},u.createElement(Z.Z,n)),u.createElement(f.Z.Item,{label:"平台",name:"platform"},u.createElement(x.Z,n)),u.createElement(f.Z.Item,{label:"主体",name:"body"},u.createElement(S.Z,n)),u.createElement(f.Z.Item,{label:"项目",name:"project"},u.createElement(P.Z,n)),u.createElement(f.Z.Item,{label:"记账月份",name:"bookMonth"},u.createElement(M,{placeholder:"请选择",disabledDate:function(e){return e&&e>((t=Number(y()().get("date")))>12?y()():t<=12?y()().subtract(1,"M"):void 0);var t}})),u.createElement(f.Z.Item,{label:"摊销状态",name:"amortizationState"},u.createElement(h.Z,{allowClear:!0,placeholder:"请选择"},u.createElement(z,{value:E.R9S.processing},E.R9S.description(E.R9S.processing)),u.createElement(z,{value:E.R9S.completed},E.R9S.description(E.R9S.completed)),u.createElement(z,{value:E.R9S.terminated},E.R9S.description(E.R9S.terminated)),u.createElement(z,{value:E.R9S.notStarted},E.R9S.description(E.R9S.notStarted)),u.createElement(z,{value:E.R9S.notFund},E.R9S.description(E.R9S.notFund)))),u.createElement(f.Z.Item,{label:"是否确认规则",name:"isConfirmRule"},u.createElement(h.Z,{allowClear:!0,placeholder:"请选择"},u.createElement(z,{value:E.ndJ.right},E.ndJ.description(E.ndJ.right)),u.createElement(z,{value:E.ndJ.negate},E.ndJ.description(E.ndJ.negate)))),u.createElement(f.Z.Item,{label:"是否红冲",name:"billRedPushState"},u.createElement(h.Z,{allowClear:!0,placeholder:"请选择"},u.createElement(z,{value:E.Lm.right},E.Lm.description(E.Lm.right)),u.createElement(z,{value:E.Lm.negate},E.Lm.description(E.Lm.negate)))),u.createElement(f.Z.Item,{label:"费用单号",name:"costId"},u.createElement(p.Z,{allowClear:!0,placeholder:"请输入"})),u.createElement(f.Z.Item,{label:"审批单号",name:"orderId"},u.createElement(p.Z,{allowClear:!0,placeholder:"请输入"})),u.createElement(f.Z.Item,{label:"核算中心",name:"account"},u.createElement(O,n)),{key:"invoice",span:16,render:u.createElement(f.Z.Item,(0,d.Z)({label:"发票抬头",name:"invoiceTitle"},j),u.createElement(A.Z,n))}],onSearch:t,onReset:t};return u.createElement(v.IT,{className:"affairs-flow-basic"},u.createElement(v.j6,a))},L=(n(20186),n(75385)),D=(n(52560),n(71577)),k=(n(52466),n(10642)),R=(n(55295),n(69713)),Y=(n(36037),n(47933)),H=(n(51838),n(48086)),N=n(93517),V=n.n(N);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G={labelCol:{span:6},wrapperCol:{span:18}},W=(0,l.connect)((function(e){return{recordList:e.costAmortization.recordList}}))((function(e){var t,n,r=e.dispatch,i=e.recordList,l=void 0===i?{}:i,m=e.getAmortizationList,s=(0,u.useRef)({page:1,limit:30}),p=(0,u.useState)({}),g=(0,o.Z)(p,2),h=g[0],b=g[1],C=(0,u.useState)(!1),w=(0,o.Z)(C,2),I=w[0],T=w[1],O=(0,u.useState)(!1),A=(0,o.Z)(O,2),z=A[0],M=A[1],j=(0,u.useState)([]),F=(0,o.Z)(j,2),N=F[0],q=F[1],W=(0,u.useState)(!1),B=(0,o.Z)(W,2),U=B[0],X=B[1],J=(0,u.useState)(E.Xr3.code),Q=(0,o.Z)(J,2),$=Q[0],ee=Q[1],te=function(){M(!0),r({type:"costAmortization/resetRecordList"}),r({type:"costAmortization/getRecordList",payload:K(K({},s.current),{},{setLoading:function(){return M(!1)}})})},ne=function(e){h&&h.setFieldsValue({subject:void 0}),ee(e.target.value)},ae=function(){q([]),T(!1),h.resetFields()},re=function(e){s.current=K(K(K({},s.current),e),{},{page:1,limit:30}),q([]),te()},oe=function(e,t){s.current=K(K({},s.current),{},{page:e,limit:t}),q([]),te()},ie=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(!0),e.next=3,r({type:"costAmortization/onAddShareList",payload:{ids:N}});case 3:if(!(t=e.sent)||!t.zh_message){e.next=7;break}return X(!1),e.abrupt("return",H.ZP.error(t.zh_message));case 7:t&&t.result&&(H.ZP.success("请求成功"),q([]),te(),m&&m(),X(!1),T(!1));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=l.data,t=void 0===e?[]:e,n=l._meta,a=void 0===n?{}:n,r=[{title:"费用单",dataIndex:"_id",fixed:"left",width:120,render:function(e){return e||"--"}},{title:"审批单",dataIndex:"oa_order_id",fixed:"left",width:120,render:function(e){return e||"--"}},{title:"主题标签",dataIndex:"theme_label_list",width:120,render:function(e){return function(e,t){if(Array.isArray(e)&&e.length>3){var n="inspect"===t?e.map((function(e){return e.name})).join(" 、 "):e.map((function(e){return e})).join(" 、 ");return u.createElement(R.Z,{title:n},u.createElement("div",null,"inspect"===t?e.slice(0,3).map((function(e){return e.name})).join(" 、 "):e.slice(0,3).map((function(e){return e})).join(" 、 "),"..."))}return Array.isArray(e)&&e.length<=3&&e.length>0?u.createElement("div",null,"inspect"===t?e.map((function(e){return e.name})).join("、"):e.map((function(e){return e})).join("、")):"--"}(e)}},{title:"科目名称",dataIndex:"biz_account_info",width:200,render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.ac_code;return u.createElement("span",null,t||"--",n?"(".concat(n,")"):"")}},{title:"核算中心",dataIndex:"cost_center_type",width:120,render:function(e,t){var n="--";return e===E.Xr3.code&&(n=V().get(t,"biz_code_info.name","--")),e===E.Xr3.team&&(n=V().get(t,"biz_team_info.name","--")),n}},{title:"发票抬头",dataIndex:"invoice_title",width:200,render:function(e){return e||"--"}},{title:"付款金额",dataIndex:"payment_total_money",width:120,render:function(e){return e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"红冲金额",dataIndex:"total_tax_amount_amount",width:120,render:function(e,t){return t.bill_red_push_state===E.v7n.right&&e?E.fbc.exchangePriceCentToMathFormat(e):E.fbc.exchangePriceCentToMathFormat(0)}},{title:"单据状态",dataIndex:"state",width:100,render:function(e){return e?E.DU5.description(e):"--"}},{title:"付款状态",dataIndex:"paid_state",width:100,render:function(e){return e?E.rTI.description(e):"--"}},{title:"提报时间",dataIndex:"submit_at",width:160,render:function(e){return e?y()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"付款时间",dataIndex:"paid_at",width:160,render:function(e){return e?y()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}}],o={selectedRowKeys:N,columnWidth:60,onChange:function(e){return q(e)}},i={current:a.page||1,defaultPageSize:30,pageSize:a.page_size||30,showQuickJumper:!0,showSizeChanger:!0,onChange:oe,onShowSizeChange:oe,showTotal:function(e){return"总共".concat(e,"条")},total:a.result_count,pageSizeOptions:["10","20","30","40"]};return u.createElement(v.IT,{title:"费用记录明细",style:{marginBottom:0,paddingBottom:0}},u.createElement(L.Z,{rowKey:function(e,t){return e._id||t},columns:r,dataSource:t,pagination:i,rowSelection:o,bordered:!0,loading:z,scroll:{y:150,x:1700}}))};return u.createElement(u.Fragment,null,u.createElement(k.Z,{title:"添加分摊数据",visible:I,okText:"确认添加",width:"70%",okButtonProps:{disabled:N.length<1},onOk:ie,confirmLoading:U,style:{maxHeight:"600px",paddingBottom:0,top:"55px"},onCancel:ae},(t={placeholder:"请选择",allowClear:!0,mode:"multiple",optionFilterProp:"children"},n={items:[u.createElement(f.Z.Item,(0,d.Z)({label:"科目类型",name:"reportType"},G),u.createElement(Y.ZP.Group,{onChange:ne},u.createElement(Y.ZP,{value:E.Xr3.code},E.Xr3.description(E.Xr3.code)),u.createElement(Y.ZP,{value:E.Xr3.team},E.Xr3.description(E.Xr3.team)))),u.createElement(f.Z.Item,(0,d.Z)({label:"科目名称",name:"subject"},G),u.createElement(_.Z,(0,d.Z)({},t,{costCenterType:$,namespace:"".concat(E.Xr3.description($),"_data")}))),u.createElement(f.Z.Item,(0,d.Z)({label:"场景",name:"scenes"},G),u.createElement(Z.Z,t)),u.createElement(f.Z.Item,(0,d.Z)({label:"平台",name:"platform"},G),u.createElement(x.Z,t)),u.createElement(f.Z.Item,(0,d.Z)({label:"主体",name:"body"},G),u.createElement(S.Z,t)),u.createElement(f.Z.Item,(0,d.Z)({label:"项目",name:"project"},G),u.createElement(P.Z,t))],onSearch:re,onReset:re,onHookForm:function(e){return b(e)},initialValues:{reportType:E.Xr3.code}},u.createElement(v.IT,{className:"affairs-flow-basic"},u.createElement(v.j6,n))),ce()),u.createElement(D.Z,{type:"primary",onClick:function(){return T(!0)}},"添加分摊数据"))})),B=(n(13062),n(71230)),U=(n(89032),n(15746)),X=(n(36616),n(51368));function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=g.Z.RangePicker,ee=(0,l.connect)()((function(e){var t=e.dispatch,n=e.visible,r=e.onCancel,i=e.selectedRowKeys,l=void 0===i?[]:i,m=e.data,d=void 0===m?[]:m,p=f.Z.useForm(),g=(0,o.Z)(p,1)[0],h=(0,u.useState)([]),b=(0,o.Z)(h,2),Z=b[0],x=b[1],S=(0,u.useState)(!1),P=(0,o.Z)(S,2),C=P[0],w=P[1];(0,u.useEffect)((function(){if(d.length>0&&l.length>0){var e=d.filter((function(e){return l.includes(e._id)}));x(e)}}),[d,l]);var I,T,O=function(e){var t=Z[0]||{},n=t.allocation_total_money,a=void 0===n?0:n,r=t.pre_salvage_money,o=void 0===r?0:r,i=t.tax_deduction;if(e||0===e){var c=a+o-1e3*(void 0===i?0:i)*(e/100)/1e3;g.setFieldsValue({allocationTotalMoney:E.fbc.exchangePriceToYuan(c)})}},A=function(e){g.resetFields(),r&&r(e)},z=function(e){return e&&e<y()().set("date",1).startOf("day")},M=function(){var e=(0,a.Z)(c().mark((function e(){var n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.validateFields();case 2:return n=e.sent,w(!0),e.next=6,t({type:"costAmortization/onUpdateRule",payload:Q(Q({},n),{},{ids:l,allocationTotalMoney:l.length>1?void 0:n.allocationTotalMoney||0===n.allocationTotalMoney?E.fbc.exchangePriceToCent(n.allocationTotalMoney):void 0})});case 6:if(!(a=e.sent)||!a.zh_message){e.next=10;break}return w(!1),e.abrupt("return",H.ZP.error(a.zh_message));case 10:a&&a.result&&(H.ZP.success("请求成功"),x([]),w(!1),A(!0));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(e){e===E.SHS.cycle&&g.setFieldsValue({belongDate:void 0}),e===E.SHS.startAndEnd&&g.setFieldsValue({belongTime:void 0})},F=function(e){var t=e("belongDate");return u.createElement(f.Z.Item,{label:"分期期数",key:"numberOfPeriodsItem"},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(e)&&2===e.length){var t=y()(String(e[0])).get("year"),n=y()(String(e[1])).get("year"),a=y()(String(e[0])).get("M"),r=y()(String(e[1])).get("M"),o=n-t;return Number(r)-Number(a)+1+12*o}return 0}(t),"期")},L=function(e){s().not.existy(e)&&g.setFieldsValue({allocationTotalMoney:0})};return u.createElement(u.Fragment,null,u.createElement(k.Z,{visible:n,onOk:M,title:"设置摊销规则",confirmLoading:C,onCancel:function(){return A(!1)},width:"70%"},l.length>1?(I=[u.createElement(f.Z.Item,{label:"总付款金额"},E.fbc.exchangePriceCentToMathFormat(Z.reduce((function(e,t){return e+(t.total_money||0)}),0))),u.createElement(f.Z.Item,{label:"数量"},l.length),u.createElement(f.Z.Item,{label:"总税金"},E.fbc.exchangePriceCentToMathFormat(Z.reduce((function(e,t){return e+(t.tax_money||0)}),0))),u.createElement(f.Z.Item,{label:"总税后金额"},E.fbc.exchangePriceCentToMathFormat(Z.reduce((function(e,t){return e+(t.tax_deduction||0)}),0))),u.createElement(f.Z.Item,{label:"残值率",name:"residual"},u.createElement(X.Z,{min:0,max:99,placeholder:"请输入",formatter:function(e){return"".concat(E.fbc.limitMaxZeroIntegerNumber(e,99),"%")},parser:function(e){return E.fbc.limitMaxZeroIntegerNumber(e.replace("%",""),99)}})),u.createElement(f.Z.Item,{label:"预计残值金额",shouldUpdate:function(e,t){return e.residual!==t.residual}},(function(e){var t=e.getFieldValue,n=Z.reduce((function(e,t){return e+(t.pre_salvage_money||0)}),0),a=t("residual"),r=Z.reduce((function(e,t){return e+(t.tax_deduction||0)}),0);if(a||0===a){var o=1e3*r*(a/100)/1e3;return E.fbc.exchangePriceCentToMathFormat(o)}return E.fbc.exchangePriceCentToMathFormat(n)})),u.createElement(f.Z.Item,{label:"应摊总金额"},E.fbc.exchangePriceCentToMathFormat(Z.reduce((function(e,t){return e+(t.allocation_total_money||0)}),0))),{key:"amortization_cycle",span:24,render:u.createElement(f.Z.Item,{label:"摊销周期",name:"belongTimeType"},u.createElement(Y.ZP.Group,{onChange:function(e){return j(e.target.value)}},u.createElement(Y.ZP,{value:E.SHS.cycle},E.SHS.description(E.SHS.cycle)),u.createElement(Y.ZP,{value:E.SHS.startAndEnd},E.SHS.description(E.SHS.startAndEnd))))},{key:"batchTimeType",span:24,render:u.createElement(f.Z.Item,{shouldUpdate:function(e,t){return e.belongTimeType!==t.belongTimeType||e.belongDate!==t.belongDate}},(function(e){var t=e.getFieldValue,n=t("belongTimeType");return n===E.SHS.cycle?u.createElement(f.Z.Item,{name:"belongTime",label:"摊销周期",rules:[{required:!0,message:"请输入"}]},u.createElement(X.Z,{max:9999,min:1,precision:0,placeholder:"请输入",formatter:E.fbc.limitPositiveIntegerNumber,parser:E.fbc.limitPositiveIntegerNumber})):n===E.SHS.startAndEnd?u.createElement(B.Z,null,u.createElement(U.Z,{span:12},u.createElement(f.Z.Item,{name:"belongDate",label:"摊销起止日期",rules:[{required:!0,message:"请选择"}]},u.createElement($,{disabledDate:z}))),u.createElement(U.Z,{span:12},F(t))):void 0}))},u.createElement(f.Z.Item,{label:"分摊规则",name:"rule"},u.createElement(Y.ZP.Group,null,u.createElement(Y.ZP,{value:E.lxA.average},E.lxA.description(E.lxA.average))))],T={belongTimeType:E.SHS.cycle,rule:E.lxA.average,residual:0},u.createElement(f.Z,{form:g,initialValues:T,className:"affairs-flow-basic"},u.createElement(v.Fp,{items:I,cols:4}))):function(){var e=Z[0]||{},t=[{span:12,render:u.createElement(f.Z.Item,{label:"记账科目",name:"subject",rules:[{required:!0,message:"请选择"}]},u.createElement(_.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0,optionFilterProp:"children",style:{width:"80%"}}))},u.createElement(f.Z.Item,{label:"付款金额"},e.total_money?E.fbc.exchangePriceCentToMathFormat(e.total_money):"0.00"),u.createElement(f.Z.Item,{label:"税金"},e.tax_money?E.fbc.exchangePriceCentToMathFormat(e.tax_money):"0.00"),u.createElement(f.Z.Item,{label:"税后金额"},e.tax_deduction?E.fbc.exchangePriceCentToMathFormat(e.tax_deduction):"0.00"),u.createElement(f.Z.Item,{label:"残值率",name:"residual"},u.createElement(X.Z,{min:0,max:99,placeholder:"请输入",formatter:function(e){return"".concat(E.fbc.limitMaxZeroIntegerNumber(e,99),"%")},parser:function(e){return E.fbc.limitMaxZeroIntegerNumber(e.replace("%",""),99)},onChange:O})),u.createElement(f.Z.Item,{label:"预计残值金额",shouldUpdate:function(e,t){return e.residual!==t.residual}},(function(t){var n=t.getFieldValue,a=e.pre_salvage_money?E.fbc.exchangePriceCentToMathFormat(e.pre_salvage_money):"0.00",r=e.tax_deduction?e.tax_deduction:0,o=n("residual");if(o||0===o){var i=1e3*r*(o/100)/1e3;return E.fbc.exchangePriceCentToMathFormat(i)}return a})),u.createElement(f.Z.Item,{label:"应摊总金额",name:"allocationTotalMoney"},u.createElement(X.Z,{onChange:L,precision:2,max:9999999999,min:0,placeholder:"请输入",formatter:E.fbc.limitDecimalsFormatter,parser:E.fbc.limitDecimalsParser})),{span:12,key:"belongTimeType",render:u.createElement(f.Z.Item,{label:"摊销周期",name:"belongTimeType"},u.createElement(Y.ZP.Group,{onChange:function(e){return j(e.target.value)}},u.createElement(Y.ZP,{value:E.SHS.cycle},E.SHS.description(E.SHS.cycle)),u.createElement(Y.ZP,{value:E.SHS.startAndEnd},E.SHS.description(E.SHS.startAndEnd))))},{key:"belongTime",span:24,render:u.createElement(f.Z.Item,{shouldUpdate:function(e,t){return e.belongTimeType!==t.belongTimeType||e.belongDate!==t.belongDate}},(function(e){var t=e.getFieldValue,n=t("belongTimeType");return n===E.SHS.cycle?u.createElement(f.Z.Item,{name:"belongTime",label:"摊销周期",rules:[{required:!0,message:"请输入"}]},u.createElement(X.Z,{min:1,max:9999,precision:0,placeholder:"请输入",formatter:E.fbc.limitPositiveIntegerNumber,parser:E.fbc.limitPositiveIntegerNumber})):n===E.SHS.startAndEnd?u.createElement(B.Z,null,u.createElement(U.Z,{span:12},u.createElement(f.Z.Item,{name:"belongDate",label:"摊销起止日期",rules:[{required:!0,message:"请选择"}]},u.createElement($,{disabledDate:z}))),u.createElement(U.Z,{span:12},F(t))):void 0}))},u.createElement(f.Z.Item,{label:"分摊规则",name:"rule"},u.createElement(Y.ZP.Group,null,u.createElement(Y.ZP,{value:E.lxA.average},E.lxA.description(E.lxA.average))))],n={subject:e.book_accounting_id||e.cost_accounting_id||void 0,belongTimeType:e.allocation_type||E.SHS.cycle,belongTime:e.allocation_cycle||void 0,belongDate:e.allocation_start_date&&e.allocation_end_date?[y()(String(e.allocation_start_date)),y()(String(e.allocation_end_date))]:void 0,rule:E.lxA.average||void 0,residual:e.salvage_value_rate||0,allocationTotalMoney:e.allocation_total_money||0===e.allocation_total_money?E.fbc.exchangePriceToYuan(e.allocation_total_money):void 0};return u.createElement(f.Z,{form:g,initialValues:n,className:"affairs-flow-basic"},u.createElement(v.Fp,{items:t,cols:4}))}()))}));function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae={labelCol:{span:8},wrapperCol:{span:16}},re=(0,l.connect)()((function(e){var t,n,r=e.dispatch,i=e.visible,l=e.onCancel,m=e.curAmotization,s=void 0===m?{}:m,p=f.Z.useForm(),g=(0,o.Z)(p,1)[0],h=(0,u.useState)(!1),b=(0,o.Z)(h,2),y=b[0],_=b[1],Z=s.unallocation_money,x=void 0===Z?0:Z,S=function(e){g.resetFields(),l&&l(e)},P=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.validateFields();case 2:return t=e.sent,_(!0),e.next=6,r({type:"costAmortization/onTerminationAmortization",payload:ne(ne({},t),{},{id:s._id})});case 6:if(!(n=e.sent)||!n.zh_message){e.next=10;break}return _(!1),e.abrupt("return",H.ZP.error(n.zh_message));case 10:n&&n.result&&(_(!1),H.ZP.success("请求成功"),S(!0));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u.createElement(k.Z,{visible:i,title:"终止",confirmLoading:y,onOk:P,onCancel:function(){return S(!1)}},(t=[u.createElement(f.Z.Item,(0,d.Z)({label:"剩余摊销金额计入方式",name:"creditWay"},ae),u.createElement(Y.ZP.Group,null,u.createElement(Y.ZP,{value:E.EEK.allGredit},E.EEK.description(E.EEK.allGredit)),u.createElement(Y.ZP,{value:E.EEK.notGredit},E.EEK.description(E.EEK.notGredit)),u.createElement(Y.ZP,{value:E.EEK.sectionGredit},E.EEK.description(E.EEK.sectionGredit)))),u.createElement(f.Z.Item,{key:"creditMoneyFormWrap",shouldUpdate:function(e,t){return e.creditWay!==t.creditWay}},(function(e){if((0,e.getFieldValue)("creditWay")===E.EEK.sectionGredit)return u.createElement(f.Z.Item,(0,d.Z)({name:"money",label:"计入金额",rules:[{required:!0,message:"请输入"}]},ae),u.createElement(X.Z,{precision:2,min:0,placeholder:"请输入",formatter:function(e){return E.fbc.limitMaxDecimals(e,E.fbc.exchangePriceToYuan(x))},parser:function(e){return E.fbc.limitMaxDecimals(e,E.fbc.exchangePriceToYuan(x))},max:x?E.fbc.exchangePriceToYuan(x):void 0}))}))],n={creditWay:E.EEK.allGredit,money:x?E.fbc.exchangePriceToYuan(x):void 0},u.createElement(f.Z,{form:g,initialValues:n,className:"affairs-flow-basic"},u.createElement(v.Fp,{items:t,cols:1}))),u.createElement("div",null,"操作「终止」费用将计入未封板财报当期，请谨慎操作"))}));function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=(0,l.connect)()((function(e){var t,n,r,i=e.dispatch,l=e.visible,m=e.onCancel,s=e.curAmotization,d=void 0===s?{}:s,p=e.getAmortizationList,h=f.Z.useForm(),b=(0,o.Z)(h,1)[0],Z=(0,u.useState)(!1),x=(0,o.Z)(Z,2),S=x[0],P=x[1],C=d.allocation_type,w=void 0===C?E.SHS.cycle:C,I=d.allocation_cycle,T=void 0===I?0:I,O=d.accumulated_allocation_cycle,A=void 0===O?0:O,z=d.unallocation_money,M=void 0===z?void 0:z,j=function(e){if(d.allocation_start_date)return e<y()(String(d.allocation_start_date)).endOf("day")},F=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.validateFields();case 2:return t=e.sent,P(!0),e.next=6,i({type:"costAmortization/onUpdateRule",payload:ie(ie({},t),{},{unallocationTotalMoney:t.unallocationTotalMoney?E.fbc.exchangePriceToCent(t.unallocationTotalMoney):void 0,ids:d._id?[d._id]:void 0})});case 6:if(!(n=e.sent)||!n.zh_message){e.next=10;break}return P(!1),e.abrupt("return",H.ZP.error(n.zh_message));case 10:n&&n.result&&(H.ZP.success("请求成功"),P(!1),p&&p(),m&&m(!0));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=[{span:12,render:u.createElement(f.Z.Item,{label:"记账科目",name:"subject",rules:[{required:!0,message:"请选择"}]},u.createElement(_.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0,optionFilterProp:"children",style:{width:"80%"}}))},u.createElement(f.Z.Item,{label:"付款金额"},d.total_money?E.fbc.exchangePriceCentToMathFormat(d.total_money):"0.00"),u.createElement(f.Z.Item,{label:"税金"},d.tax_money?E.fbc.exchangePriceCentToMathFormat(d.tax_money):"0.00"),u.createElement(f.Z.Item,{label:"税后金额"},d.tax_money?E.fbc.exchangePriceCentToMathFormat(d.tax_money):"0.00"),u.createElement(f.Z.Item,{label:"残值率"},d.salvage_value_rate?"".concat(d.salvage_value_rate,"%"):"0%"),u.createElement(f.Z.Item,{label:"预计残值金额"},d.pre_salvage_money?E.fbc.exchangePriceCentToMathFormat(d.pre_salvage_money):"0.00"),u.createElement(f.Z.Item,{label:"应摊总金额"},d.allocation_total_money?E.fbc.exchangePriceCentToMathFormat(d.allocation_total_money):"0.00"),{key:"belong_date",span:12,render:u.createElement(f.Z.Item,{label:"摊销起止时间"},u.createElement("div",{style:{display:"flex"}},u.createElement("span",{style:{lineHeight:"30px"}},d.allocation_start_date?y()(String(d.allocation_start_date)).format("YYYY-MM-DD"):"--"),u.createElement("span",{style:{lineHeight:"30px",margin:"0 10px"}}," - "),u.createElement(f.Z.Item,{name:"allocationEndDate"},u.createElement(g.Z,{disabledDate:j}))))},u.createElement(f.Z.Item,{label:"分期期数",shouldUpdate:function(e,t){return e.allocationEndDate!==t.allocationEndDate}},(function(e){var t=(0,e.getFieldValue)("allocationEndDate");return d.allocation_start_date&&t?"".concat(function(e,t){if(e&&t){var n=y()(String(e)).get("year"),a=y()(String(t)).get("year"),r=y()(String(e)).get("M"),o=y()(String(t)).get("M"),i=a-n;return Number(o)-Number(r)+1+12*i}return 0}(d.allocation_start_date,y()(t).format("YYYYMMDD")),"期"):"0期"})),u.createElement(f.Z.Item,{label:"已摊"},d.accumulated_allocation_cycle?"".concat(d.accumulated_allocation_cycle,"期"):"0期"),u.createElement(f.Z.Item,{label:"已摊金额"},d.accumulated_allocation_money?"".concat(E.fbc.exchangePriceCentToMathFormat(d.accumulated_allocation_money),"元"):"0.00元"),u.createElement(f.Z.Item,{label:"剩余"},T-A,"期"),{span:12,render:u.createElement(f.Z.Item,{label:"未摊销金额",className:"boss-form-item-wrap-required"},u.createElement("div",{style:{display:"flex"}},u.createElement(f.Z.Item,{name:"unallocationTotalMoney",rules:[{required:!0,message:"请输入"}]},u.createElement(X.Z,{precision:2,min:.01,placeholder:"请输入",formatter:E.fbc.limitDecimalsFormatter,parser:E.fbc.limitDecimalsParser})),u.createElement(f.Z.Item,{shouldUpdate:function(e,t){return e.unallocationTotalMoney!==t.unallocationTotalMoney||e.allocationEndDate!==t.allocationEndDate}},(function(e){var t=e.getFieldValue,n=0,a=t("unallocationTotalMoney"),r=t("allocationEndDate");return n=a&&r&&d.allocation_start_date?1e3*a/y()(r).diff(y()(String(d.allocation_start_date)),"days")/1e3:0,u.createElement("span",{style:{marginLeft:5,lineHeight:"30px"}},"元，（预计每天摊".concat(n.toFixed(2),"元）"))}))))},u.createElement(f.Z.Item,{label:"分摊规则",name:"rule"},u.createElement(Y.ZP.Group,null,u.createElement(Y.ZP,{value:E.lxA.average},E.lxA.description(E.lxA.average))))],t={rule:E.lxA.average,subject:d.cost_accounting_id,unallocationTotalMoney:M?E.fbc.exchangePriceToYuan(M):void 0,allocationEndDate:d.allocation_end_date?y()(String(d.allocation_end_date)):void 0};return u.createElement(f.Z,{form:b,labelAlign:"left",initialValues:t,className:"affairs-flow-basic"},u.createElement(v.Fp,{items:e,cols:4}))};return u.createElement(u.Fragment,null,u.createElement(k.Z,{visible:l,title:"设置摊销规则",confirmLoading:S,onOk:F,onCancel:function(){return m&&m(!1)},width:"70%"},w===E.SHS.cycle?(t=[{span:12,render:u.createElement(f.Z.Item,{label:"记账科目",name:"subject",rules:[{required:!0,message:"请选择"}]},u.createElement(_.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0,optionFilterProp:"children",style:{width:"80%"}}))},u.createElement(f.Z.Item,{label:"付款金额"},d.total_money?E.fbc.exchangePriceCentToMathFormat(d.total_money):"0.00"),u.createElement(f.Z.Item,{label:"税金"},d.tax_money?E.fbc.exchangePriceCentToMathFormat(d.tax_money):"0.00"),u.createElement(f.Z.Item,{label:"税后金额"},d.tax_deduction?E.fbc.exchangePriceCentToMathFormat(d.tax_deduction):"0.00"),u.createElement(f.Z.Item,{label:"残值率"},d.salvage_value_rate?"".concat(d.salvage_value_rate,"%"):"0%"),u.createElement(f.Z.Item,{label:"预计残值金额"},d.pre_salvage_money?E.fbc.exchangePriceCentToMathFormat(d.pre_salvage_money):"0.00"),u.createElement(f.Z.Item,{label:"应摊总金额"},d.allocation_total_money?E.fbc.exchangePriceCentToMathFormat(d.allocation_total_money):"0.00"),u.createElement(f.Z.Item,{label:"摊销周期"},"周期摊销，共".concat(T,"期")),u.createElement(f.Z.Item,{label:"摊销起止时间"},d.allocation_start_date&&d.allocation_end_date?"".concat(d.allocation_start_date," - ").concat(d.allocation_end_date):"--"),u.createElement(f.Z.Item,{label:"已摊"},d.accumulated_allocation_cycle?"".concat(d.accumulated_allocation_cycle,"期"):"0期"),u.createElement(f.Z.Item,{label:"已摊销金额"},d.accumulated_allocation_money?"".concat(E.fbc.exchangePriceCentToMathFormat(d.accumulated_allocation_money),"元"):"0.00元")],n=[u.createElement(f.Z.Item,{label:"剩余",className:"boss-form-item-wrap-required"},u.createElement("div",{style:{display:"flex"}},u.createElement(f.Z.Item,{name:"remaining",rules:[{required:!0,message:"请输入"}]},u.createElement(X.Z,{min:1,precision:0,placeholder:"请输入",formatter:E.fbc.limitPositiveIntegerNumber,parser:E.fbc.limitPositiveIntegerNumber})),u.createElement("span",{style:{marginLeft:5,lineHeight:"30px"}},"期"))),u.createElement(f.Z.Item,{label:"未摊销金额",className:"boss-form-item-wrap-required"},u.createElement("div",{style:{display:"flex"}},u.createElement(f.Z.Item,{name:"unallocationTotalMoney",rules:[{required:!0,message:"请输入"}]},u.createElement(X.Z,{precision:2,min:.01,placeholder:"请输入",formatter:E.fbc.limitDecimalsFormatter,parser:E.fbc.limitDecimalsParser})),u.createElement(f.Z.Item,{shouldUpdate:function(e,t){return e.unallocationTotalMoney!==t.unallocationTotalMoney||e.remaining!==t.remaining}},(function(e){var t=e.getFieldValue,n=t("remaining"),a=t("unallocationTotalMoney"),r=0;return n&&a&&(r=1e3*a/n/1e3),u.createElement("span",{style:{marginLeft:5}},"元，（预计每期摊".concat(r.toFixed(2),"元）"))})))),u.createElement(f.Z.Item,{label:"分摊规则",name:"rule"},u.createElement(Y.ZP.Group,null,u.createElement(Y.ZP,{value:E.lxA.average},E.lxA.description(E.lxA.average))))],r={rule:E.lxA.average,subject:d.book_accounting_id,remaining:T-A,unallocationTotalMoney:M?E.fbc.exchangePriceToYuan(M):void 0},u.createElement(f.Z,{form:b,labelAlign:"left",initialValues:r,className:"affairs-flow-basic"},u.createElement(v.Fp,{items:t,cols:4}),u.createElement(v.Fp,{items:n,cols:2}))):L()))})),le=n(45430),ue="edit",me="comfirm",se=(0,l.connect)()((function(e){var t=e.dispatch,n=e.onShowSizeChange,a=void 0===n?function(){}:n,r=e.onChangePage,i=void 0===r?function(){}:r,c=e.amortizationList,l=void 0===c?{}:c,m=e.loading,d=e.history,p=e.getAmortizationList,f=e.randomString,g=(0,u.useState)([]),h=(0,o.Z)(g,2),b=h[0],_=h[1],Z=(0,u.useState)(!1),x=(0,o.Z)(Z,2),S=x[0],P=x[1],C=(0,u.useState)(!1),w=(0,o.Z)(C,2),I=w[0],T=w[1],O=(0,u.useState)(!1),A=(0,o.Z)(O,2),z=A[0],M=A[1],j=(0,u.useState)({}),F=(0,o.Z)(j,2),k=F[0],R=F[1],Y=(0,u.useState)(ue),H=(0,o.Z)(Y,2),N=H[0],V=H[1];(0,u.useEffect)((function(){_([])}),[f]);var q=l.data,K=void 0===q?[]:q,G=l._meta,B=void 0===G?{}:G,U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.state===E.R9S.completed||e.state===E.R9S.terminated||e.accumulated_allocation_cycle>0},X=function(e){e&&p&&p(),R({}),P(!1)},J=function(e){e&&p&&p(),V(ue),R({}),T(!1)},Q=function(e){e&&(p&&p(),N===me?R({}):_([])),V(ue),M(!1)},$=function(e){var n=e.state;return le.ZP.canOperateCostAmortizationDetail()||le.ZP.canOperateCostAmortizationOption()?u.createElement(u.Fragment,null,le.ZP.canOperateCostAmortizationDetail()&&u.createElement("a",{style:{marginRight:5},onClick:function(){return function(e){s().not.existy(e)||s().empty(e)||(t({type:"costAmortization/updateUserAction",payload:{page:B.page,pageSize:B.page_size}}),d.push({pathname:"/Amortization/Detail",query:{id:e._id}}))}(e)}},"查看"),le.ZP.canOperateCostAmortizationOption()&&n!==E.R9S.completed&&n!==E.R9S.terminated&&u.createElement(u.Fragment,null,u.createElement("a",{style:{marginRight:5},onClick:function(){return function(e){R(e),e.accumulated_allocation_cycle>0?(V(ue),T(!0)):(V(me),M(!0))}(e)}},"编辑规则"),u.createElement("a",{onClick:function(){return function(e){R(e),P(!0)}(e)}},"终止"))):"--"},te=[{title:"科目名称",dataIndex:"biz_account_info",fixed:"left",width:150,render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return"--";var t=e.name,n=e.ac_code;return t&&n?"".concat(t,"（").concat(n,"）"):t||"--"}},{title:"记账科目",dataIndex:"book_account_info",fixed:"left",width:120,render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return"--";var t=e.name,n=e.ac_code;return t&&n?"".concat(t,"（").concat(n,"）"):t||"--"}},{title:"核算中心",dataIndex:"biz_team_name",width:200,render:function(e,t){return t.biz_team_name?t.biz_team_name:t.biz_code_name?t.biz_code_name:"--"}},{title:"摊销状态",dataIndex:"state",width:100,render:function(e){return e?E.R9S.description(e):"--"}},{title:"红冲状态",dataIndex:"bill_red_push_state",width:100,render:function(e){return e||!1===e?E.v7n.description(e):"--"}},{title:"付款金额",dataIndex:"total_money",width:140,render:function(e){return e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"税金",dataIndex:"tax_money",width:140,render:function(e){return e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"税后金额 （费用金额）",dataIndex:"tax_deduction",width:160,render:function(e){return e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"应摊总额",dataIndex:"allocation_total_money",width:150,render:function(e){return e||0===e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"本期应摊金额",dataIndex:"allocation_money",width:150,render:function(e){return e||0===e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"累计已摊金额",dataIndex:"accumulated_allocation_money",width:150,render:function(e){return e||0===e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"累计未摊金额",dataIndex:"accumulated_unallocation_money",width:150,render:function(e){return e||0===e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"预计残值金额",dataIndex:"pre_salvage_money",width:150,render:function(e){return e||0===e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"摊销周期",dataIndex:"allocation_cycle",width:150,render:function(e){return e||"--"}},{title:"实际已摊周期",dataIndex:"accumulated_allocation_cycle",width:140,render:function(e){return e||"--"}},{title:"摊销开始日期",dataIndex:"allocation_start_date",width:140,render:function(e){return e?y()(String(e)).format("YYYY-MM-DD"):"--"}},{title:"摊销终止日期",dataIndex:"allocation_end_date",width:140,render:function(e){return e?y()(String(e)).format("YYYY-MM-DD"):"--"}},{title:"实际已摊截止日期",dataIndex:"actual_allocation_end_date",width:150,render:function(e){return e?y()(String(e)).format("YYYY-MM-DD"):"--"}},{title:"费用单号",dataIndex:"cost_order_id",width:200,render:function(e){return e||"--"}},{title:"审批单号",dataIndex:"oa_order_id",width:200,render:function(e){return e?u.createElement("a",{href:"/#/Code/PayOrder/Detail?orderId=".concat(e,"&isShowOperation=true")},e):"--"}},{title:"发票抬头",dataIndex:"invoice_title",width:200,render:function(e){return e||"--"}},{title:"最新操作人",dataIndex:["operator_info","name"],render:function(e){return e||"--"}},{title:"操作",dataIndex:"_id",key:"operate",fixed:"right",width:140,render:function(e,t){return $(t)}}],ne={current:B.page||1,defaultPageSize:30,pageSize:B.page_size||30,showQuickJumper:!0,showSizeChanger:!0,onChange:i,onShowSizeChange:a,showTotal:function(e){return"总共".concat(e,"条")},total:B.result_count,pageSizeOptions:["10","20","30","40"]},ae={selectedRowKeys:b,columnWidth:60,getCheckboxProps:function(e){return{disabled:U(e)}},onChange:function(e){return _(e)}},oe=u.createElement(u.Fragment,null,le.ZP.canOperateCostAmortizationOption()?u.createElement(W,{getAmortizationList:p}):u.createElement("div",null),function(){if(le.ZP.canOperateCostAmortizationOption())return u.createElement(D.Z,{type:"primary",onClick:function(){return M(!0)},disabled:b.length<1,style:{marginLeft:5}},"批量确认摊销规则")}());return u.createElement(v.IT,{title:"摊销确认表",titleExt:oe},u.createElement(L.Z,{rowKey:function(e,t){return e._id||t},columns:te,dataSource:K,pagination:ne,rowSelection:ae,bordered:!0,loading:m,scroll:{y:500,x:3500}}),function(){if(S&&!(Object.keys(k).length<1))return le.ZP.canOperateCostAmortizationOption()?u.createElement(re,{visible:S,curAmotization:k,onCancel:X}):u.createElement("div",null)}(),function(){if(I&&k&&!(Object.keys(k).length<1))return le.ZP.canOperateCostAmortizationOption()?u.createElement(ce,{visible:I,curAmotization:k,onCancel:J}):u.createElement("div",null)}(),function(){if(z){if(le.ZP.canOperateCostAmortizationOption()){var e=b;return N===me&&(e=[k._id]),u.createElement(ee,{data:K,selectedRowKeys:e,visible:z,onCancel:Q})}return u.createElement("div",null)}}())})),de=n(8240);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge=(0,l.connect)((function(e){var t=e.costAmortization;return{amortizationList:t.amortizationList,prePageAction:t.prePageAction}}))((function(e){var t=e.dispatch,n=e.history,r=e.amortizationList,i=void 0===r?{}:r,l=e.prePageAction,m=void 0===l?{}:l,d=(0,u.useState)(!0),p=(0,o.Z)(d,2),f=p[0],g=p[1],h=(0,u.useState)(void 0),b=(0,o.Z)(h,2),y=b[0],v=b[1],E=(0,u.useRef)({page:1,limit:30});(0,u.useEffect)((function(){s().not.existy(m)||s().empty(m)||(E.current={page:m.page,limit:m.pageSize})}),[m]),(0,u.useEffect)((function(){return t({type:"costAmortization/getAmortizationList",payload:fe(fe({},E.current),{},{setLoading:function(){return g(!1)}})}),function(){t({type:"costAmortization/resetAmortizationList"}),t({type:"costAmortization/resetSubjectList"})}}),[t]);var _=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,t({type:"costAmortization/resetAmortizationList"});case 3:t({type:"costAmortization/getAmortizationList",payload:fe(fe({},E.current),{},{setLoading:function(){return g(!1)}})});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(e,t){E.current=fe(fe({},E.current),{},{page:e,limit:t}),_()},x={onSearch:function(e){E.current=fe(fe(fe({},E.current),e),{},{page:1,limit:30}),_(),v((0,de.xv)(32))}},S={onChangePage:Z,onShowSizeChange:Z,amortizationList:i,dispatch:t,getAmortizationList:_,loading:f,history:n,randomString:y};return u.createElement(u.Fragment,null,u.createElement(F,x),u.createElement(se,S))}))}}]);