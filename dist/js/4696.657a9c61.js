"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[4696],{4696:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});n(20186);var r=n(75385),a=(n(21316),n(75443)),o=(n(52560),n(71577)),i=(n(51838),n(48086)),c=n(15671),u=n(43144),l=n(97326),p=n(60136),s=n(82963),d=n(61120),m=n(4942),f=n(93517),h=n.n(f),y=n(30381),v=n.n(y),Z=n(45697),_=n.n(Z),P=n(67294),x=n(55609),w=n(96036),S=n(88144);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}var k=function(e){(0,p.Z)(n,e);var t=g(n);function n(e){var r;return(0,c.Z)(this,n),r=t.call(this,e),(0,m.Z)((0,l.Z)(r),"onSearch",(function(e){var t=r.state.onSearch,n=e.platforms,a=e.suppliers,o=e.cities,i=e.districts;t&&t({platforms:n,suppliers:a,cities:o,districts:i,page:1,limit:30})})),(0,m.Z)((0,l.Z)(r),"onReset",(function(){var e=r.state.onSearch;e&&e({page:1,limit:30})})),(0,m.Z)((0,l.Z)(r),"render",(function(){var e={onReset:r.onReset,onSearch:r.onSearch};return P.createElement(w.IT,null,P.createElement(S.p8,e))})),r.state={search:{},onSearch:e.onSearch},r}return n}(P.Component),D=n(80385),I=n(45430),C="hLsdbyLNRxbIfmmYOcVA";function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}var R=function(e){(0,p.Z)(n,e);var t=b(n);function n(e){var u;return(0,c.Z)(this,n),u=t.call(this,e),(0,m.Z)((0,l.Z)(u),"onSearch",(function(e){u.private.searchParams=e,u.private.searchParams.page||(u.private.searchParams.page=1),u.private.searchParams.limit||(u.private.searchParams.limit=30),u.props.dispatch({type:"supplyProcurement/fetchSupplyProcurement",payload:u.private.searchParams})})),(0,m.Z)((0,l.Z)(u),"onChangePage",(function(e,t){u.private.searchParams.page=e,u.private.searchParams.limit=t,u.onSearch(u.private.searchParams)})),(0,m.Z)((0,l.Z)(u),"onShowSizeChange",(function(e,t){u.private.searchParams.page=e,u.private.searchParams.limit=t,u.onSearch(u.private.searchParams)})),(0,m.Z)((0,l.Z)(u),"onDownloadSuccess",(function(){i.ZP.success("模板下载成功")})),(0,m.Z)((0,l.Z)(u),"onDownloadFailure",(function(){i.ZP.error("模板下载失败")})),(0,m.Z)((0,l.Z)(u),"onDownload",(function(){var e={type:D.O3x.purchaseTemplate};u.props.dispatch({type:"supplyProcurement/materialDownloadTemplate",payload:{params:e,onSuccessCallback:u.onDownloadSuccess,onFailureCallback:u.onDownloadFailure}})})),(0,m.Z)((0,l.Z)(u),"renderSearch",(function(){var e=(0,l.Z)(u).onSearch;return P.createElement(k,{onSearch:e})})),(0,m.Z)((0,l.Z)(u),"renderContent",(function(){var e=u.private.searchParams,t=e.page,n=e.limit,i=u.props,c=i.supplyProcurementData,l=void 0===c?{}:c,p=i.templateDate,s=void 0===p?"":p,d=h().get(l,"data",[]),m=h().get(l,"meta.count",0),f=[{title:"平台",dataIndex:"platform_name",key:"platform_name",fixed:"left",width:70,render:function(e){return e||"--"}},{title:"供应商",dataIndex:"supplier_name",key:"supplier_name",fixed:"left",width:120,render:function(e){return e||"--"}},{title:"城市",dataIndex:"city_name",key:"city_name",fixed:"left",width:70,render:function(e){return e||"--"}},{title:"商圈",dataIndex:"biz_district_name",key:"biz_district_name",fixed:"left",width:145,render:function(e){return e||"--"}},{title:"物资名称",dataIndex:"material_item_info",key:"material_item_info.name",width:100,render:function(e){return e.name||"--"}},{title:"物资编号",dataIndex:"material_item_info",key:"material_item_info.code",render:function(e){return e.code||"--"}},{title:"供货商",dataIndex:"provider_name",key:"provider_name",width:120,render:function(e){return e||"--"}},{title:"物资分类",dataIndex:"material_item_info",key:"material_item_info.group",width:130,render:function(e){return D.IO9.description(e.group)||"--"}},{title:"采购方式",dataIndex:"aquire_type",key:"aquire_type",width:100,render:function(e){return D.JFv.description(e)||"--"}},{title:"单价/租金（元）",dataIndex:"rent_money",key:"rent_money",width:120,render:function(e){return D.fbc.exchangePriceToYuan(e)||0}},{title:"租赁周期（月）",dataIndex:"lease_cycle",key:"lease_cycle",width:120,render:function(e){return e||"--"}},{title:"押金（元）",dataIndex:"deposit_money",key:"deposit_money",width:120,render:function(e){return D.fbc.exchangePriceToYuan(e)||0}},{title:"数量",dataIndex:"qty",key:"qty",width:100,render:function(e){return e||"--"}},{title:"税费合计（元）",dataIndex:"tax_payment_money",key:"tax_payment_money",width:120,render:function(e){return D.fbc.exchangePriceToYuan(e)||0}},{title:"总金额（元）",dataIndex:"total_money",key:"total_money",width:120,render:function(e){return D.fbc.exchangePriceToYuan(e)||0}},{title:"入库时间",dataIndex:"created_at",key:"created_at",width:120,render:function(e){return e?v()(e).format("YYYY-MM-DD"):"--"}}],y={showSizeChanger:!0,showQuickJumper:!0,pageSize:n||30,onShowSizeChange:u.onShowSizeChange,total:m,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],onChange:u.onChangePage};t&&(y.current=t);var Z="";return I.ZP.canOperateSupplyProcurementDownload()&&(Z=P.createElement("div",null,P.createElement("span",{className:C},"模板更新时间: ",s),P.createElement(a.Z,{placement:"top",title:"是否下载模板?",okText:"确认",onConfirm:function(){u.onDownload()},cancelText:"取消"},P.createElement(o.Z,{type:"primary"},"下载模板")))),P.createElement(w.IT,{title:"采购入库明细列表",titleExt:Z},P.createElement(r.Z,{columns:f,pagination:y,rowKey:function(e,t){return t},scroll:{x:1900,y:400},dataSource:d,bordered:!0}))})),u.state={},u.private={searchParams:{}},u}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){var e={type:D.O3x.purchaseTemplate};this.props.dispatch({type:"supplyProcurement/fetchSupplyProcurement"}),this.props.dispatch({type:"supplyProcurement/materialTemplateUpdatedDate",payload:e})}},{key:"render",value:function(){return P.createElement("div",null,this.renderSearch(),this.renderContent())}}]),n}(P.Component);(0,m.Z)(R,"propTypes",{supplyProcurementData:_().object,templateDate:_().string}),(0,m.Z)(R,"defaultProps",{supplyProcurementData:{},templateDate:""});var T=(0,x.connect)((function(e){var t=e.supplyProcurement;return{supplyProcurementData:t.supplyProcurementData,templateDate:t.templateDate}}))(R)}}]);