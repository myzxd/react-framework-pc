"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[2237],{62237:function(e,t,a){a.r(t),a.d(t,{default:function(){return L}});a(20186);var r=a(75385),n=(a(52560),a(71577)),i=a(15671),o=a(43144),s=a(97326),l=a(60136),c=a(82963),p=a(61120),u=a(4942),d=a(93517),f=a.n(d),m=a(30381),h=a.n(m),Z=a(45697),S=a.n(Z),g=a(67294),v=a(55609),C=(a(29093),a(16317)),y=a(96036),w=a(88144),F=a(80385);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.Z)(e);if(t){var n=(0,p.Z)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.Z)(this,a)}}var P=C.Z.Option,Y=function(e){(0,l.Z)(a,e);var t=D(a);function a(e){var r;return(0,i.Z)(this,a),r=t.call(this,e),(0,u.Z)((0,s.Z)(r),"onReset",(function(){var e=r.props.onSearch,t={platforms:"",suppliers:"",cities:"",districts:"",state:void 0};r.setState({search:t,citySpelling:""}),e&&e(t)})),(0,u.Z)((0,s.Z)(r),"onSearch",(function(e){var t=r.props.onSearch;t&&t(e)})),(0,u.Z)((0,s.Z)(r),"onHookForm",(function(e){r.setState({form:e})})),(0,u.Z)((0,s.Z)(r),"onChangePlatforms",(function(e){var t=r.state,a=t.search,n=t.form;a.platforms=e,a.suppliers="",a.cities="",a.districts="",r.setState({search:a,citySpelling:""}),n.setFieldsValue({suppliers:""}),n.setFieldsValue({cities:""}),Number(a.state)===F.F$Y.district&&n.setFieldsValue({districts:""})})),(0,u.Z)((0,s.Z)(r),"onChangeSuppliers",(function(e){var t=r.state,a=t.search,n=t.form;a.suppliers=e,a.cities="",a.districts="",r.setState({search:a,citySpelling:""}),n.setFieldsValue({cities:""}),Number(a.state)===F.F$Y.district&&n.setFieldsValue({districts:""})})),(0,u.Z)((0,s.Z)(r),"onChangeCity",(function(e,t){var a=r.state,n=a.search,i=a.form,o=f().get(t,"props.spell","");n.cities=e,n.districts="",r.setState({search:n,citySpelling:o}),Number(n.state)===F.F$Y.district&&i.setFieldsValue({districts:""})})),(0,u.Z)((0,s.Z)(r),"onChangeDistrict",(function(e){var t=r.state.search;t.districts=e,r.setState({search:t})})),(0,u.Z)((0,s.Z)(r),"onState",(function(e){var t=r.state.search;t.state=e,r.setState({search:t})})),(0,u.Z)((0,s.Z)(r),"render",(function(){var e=r.state.search,t=e.platforms,a=e.suppliers,n=e.cities,i=e.state,o=e.districts,s=r.state.citySpelling,l=[{label:"平台",form:function(e){return e.getFieldDecorator("platforms",{initialValue:t})(g.createElement(w.Yg,{allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择平台",onChange:r.onChangePlatforms}))}},{label:"供应商",form:function(e){return e.getFieldDecorator("suppliers",{initialValue:a})(g.createElement(w.o2,{state:F.Acu.enable,allowClear:!0,showSearch:!0,optionFilterProp:"children",platforms:t,placeholder:"请选择供应商",onChange:r.onChangeSuppliers}))}},{label:"城市:",form:function(e){return e.getFieldDecorator("cities",{initialValue:n})(g.createElement(w.Wn,{namespace:"cities",isExpenseModel:!0,allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择城市",platforms:t,suppliers:a,onChange:r.onChangeCity}))}},{label:"方案类型:",form:function(e){return e.getFieldDecorator("state",{initialValue:i})(g.createElement(C.Z,{allowClear:!0,placeholder:"请选择方案类型",onChange:r.onState},g.createElement(P,{value:"".concat(F.F$Y.city)},F.F$Y.description(F.F$Y.city)),g.createElement(P,{value:"".concat(F.F$Y.district)},F.F$Y.description(F.F$Y.district))))}}];Number(i)===F.F$Y.district&&l.push({label:"商圈:",form:function(e){return e.getFieldDecorator("districts",{initialValue:o})(g.createElement(w.Wc,{allowClear:!0,showSearch:!0,namespace:"districts",optionFilterProp:"children",placeholder:"请选择商圈",platforms:t,suppliers:a,cities:s,disabled:r.state.isShowDistricts,onChange:r.onChangeDistrict}))}});var c={items:l,onReset:r.onReset,onSearch:r.onSearch,onHookForm:r.onHookForm,expand:!0};return g.createElement(y.IT,null,g.createElement(y.yL,c))})),r.state={form:void 0,search:{platforms:"",suppliers:"",cities:"",districts:"",state:void 0},citySpelling:""},r}return a}(g.Component);(0,u.Z)(Y,"propTypes",{onSearch:S().func}),(0,u.Z)(Y,"defaultProps",{onSearch:function(){}});var b=Y,E=a(45430),M=(a(52466),a(10642)),x=(a(36037),a(47933)),R=(a(54071),a(14072)),V=a(66939);a(98703);function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.Z)(e);if(t){var n=(0,p.Z)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.Z)(this,a)}}var I=R.Z.RangePicker,N=function(e){(0,l.Z)(a,e);var t=$(a);function a(e){var r;return(0,i.Z)(this,a),r=t.call(this,e),(0,u.Z)((0,s.Z)(r),"onChangePlatforms",(function(e){var t=r.props.form,a=r.state.fields;a.name.platform=e,a.platforms=e,a.suppliers="",a.cities="",a.districts="",r.setState({fields:a,citySpelling:""}),t.setFieldsValue({suppliers:""}),t.setFieldsValue({cities:""}),t.setFieldsValue({districts:""})})),(0,u.Z)((0,s.Z)(r),"onChangeSuppliers",(function(e){var t=r.props.form,a=r.state.fields;a.name.supplier=e,a.suppliers=e,a.cities="",a.districts="",r.setState({fields:a,citySpelling:""}),t.setFieldsValue({cities:""}),t.setFieldsValue({districts:""})})),(0,u.Z)((0,s.Z)(r),"onChangeCity",(function(e,t){var a=r.props.form,n=r.state.fields,i=f().get(t,"props.spell","");n.name.city=e,n.cities=e,n.districts="",r.setState({fields:n,citySpelling:i}),a.setFieldsValue({districts:""})})),(0,u.Z)((0,s.Z)(r),"onChangeDistrict",(function(e){var t=r.state.fields;t.name.district=e,t.districts=e,r.setState({fields:t})})),(0,u.Z)((0,s.Z)(r),"onChangeScope",(function(e){var t=r.state.fields;t.scope=e.target.value,e.target.value===F.F$Y.district?r.setState({isShowDistricts:!1}):(t.name.district="",t.districts="",r.setState({fields:t,isShowDistricts:!0})),r.setState({fields:t})})),(0,u.Z)((0,s.Z)(r),"onChangeDate",(function(e,t){var a=r.state.fields;a.fromDate=t[0],a.toDate=t[1],r.setState({fields:a})})),(0,u.Z)((0,s.Z)(r),"onChangeChoice",(function(e){var t=r.state.fields;t.range=e.target.value,r.setState({fields:t})})),(0,u.Z)((0,s.Z)(r),"onDirectToInfo",(function(e){window.location.href="/#/Finance/Rules?id=".concat(e.record._id,"&type=").concat(e.record.domain),r.onReset()})),(0,u.Z)((0,s.Z)(r),"onSubmit",(function(e){var t=r.props.onHideModal;e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e){if(!e){var a=r.state.fields,n={name:a.name.district?"".concat(a.name.platform,"-").concat(a.name.supplier,"-").concat(a.name.city,"-").concat(a.name.district):"".concat(a.name.platform,"-").concat(a.name.supplier,"-").concat(a.name.city),platforms:a.platforms,suppliers:a.suppliers,cities:a.cities,districts:a.districts,fromDate:Number(h()(a.fromDate).format("YYYYMMDD")),toDate:Number(h()(a.toDate).format("YYYYMMDD")),range:a.range,scope:a.scope};r.props.dispatch({type:"financePlan/createSalaryPlanType",payload:{params:n,onSuccessCallback:r.onDirectToInfo}}),t&&t()}}))})),(0,u.Z)((0,s.Z)(r),"onCancel",(function(){var e=r.props.onHideModal;e&&e(),r.onReset()})),(0,u.Z)((0,s.Z)(r),"onReset",(function(){var e={name:[],platforms:"",suppliers:"",cities:"",districts:"",fromDate:"",toDate:"",range:F.Frw.template,scope:F.F$Y.city};r.setState({fields:e,isShowDistricts:!0,citySpelling:""}),r.props.form.resetFields()})),(0,u.Z)((0,s.Z)(r),"renderCreateForm",(function(){var e=r.props.form.getFieldDecorator,t=r.state.fields,a=t.platforms,n=t.suppliers,i=r.state.citySpelling,o=[{label:"平台 :",form:e("platforms",{rules:[{required:!0,message:"请选择平台"}],initialValue:void 0})(g.createElement(w.Yg,{allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择平台",onChange:r.onChangePlatforms}))},{label:"供应商 :",form:e("suppliers",{rules:[{required:!0,message:"请选择供应商"}],initialValue:void 0})(g.createElement(w.o2,{state:F.Acu.enable,allowClear:!0,showSearch:!0,optionFilterProp:"children",platforms:a,placeholder:"请选择供应商",onChange:r.onChangeSuppliers}))},{label:"适用范围 :",form:e("state",{rules:[{required:!0,message:"请选择状态"}],initialValue:F.F$Y.city})(g.createElement(x.ZP.Group,{onChange:r.onChangeScope},g.createElement(x.ZP,{value:F.F$Y.city},F.F$Y.description(F.F$Y.city)),g.createElement(x.ZP,{value:F.F$Y.district},F.F$Y.description(F.F$Y.district))))},{label:"城市 :",form:e("cities",{rules:[{required:!0,message:"请选择城市"}],initialValue:void 0})(g.createElement(w.Wn,{isExpenseModel:!0,enableSelectAll:!0,allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择城市",platforms:a,suppliers:n,onChange:r.onChangeCity}))},{label:"商圈 :",form:e("districts",{rules:[{required:!r.state.isShowDistricts,message:"请选择商圈"}],initialValue:void 0})(g.createElement(w.Wc,{allowClear:!0,showSearch:!0,enableSelectAll:!0,optionFilterProp:"children",placeholder:"请选择商圈",platforms:a,suppliers:n,cities:i,disabled:r.state.isShowDistricts,onChange:r.onChangeDistrict}))},{label:"有效时间 :",form:e("effectiveDate",{rules:[{required:!0,message:"请选择有效时间"}],initialValue:null})(g.createElement(I,{onChange:r.onChangeDate,format:"YYYY-MM-DD"}))},{label:"选择模板 :",form:e("range",{rules:[{required:!0,message:"请选择状态"}],initialValue:F.Frw.templates})(g.createElement(x.ZP.Group,{onChange:r.onChangeChoice},g.createElement(x.ZP,{value:F.Frw.templates},F.Frw.description(F.Frw.templates)),g.createElement(x.ZP,{value:F.Frw.empty},F.Frw.description(F.Frw.empty))))}];return g.createElement("div",null,g.createElement(y.KP,{items:o,cols:1,layout:{labelCol:{span:5},wrapperCol:{span:13}}}))})),(0,u.Z)((0,s.Z)(r),"render",(function(){var e=r.props.isShowModal,t=void 0!==e&&e,a=(0,s.Z)(r),n=a.onSubmit,i=a.onCancel;return g.createElement(M.Z,{title:"选择类型",visible:t,onOk:n,onCancel:i,okText:"创建",cancelText:"取消"},g.createElement(V.Z,null,r.renderCreateForm()))})),r.state={fields:{name:{},platforms:"",suppliers:"",cities:"",districts:"",fromDate:"",toDate:"",range:F.Frw.template,scope:F.F$Y.city},citySpelling:"",isShowDistricts:!0},r}return a}(g.Component);(0,u.Z)(N,"propTypes",{onHideModal:S().func,isShowModal:S().bool}),(0,u.Z)(N,"defaultProps",{onHideModal:function(){},isShowModal:!1});var k=(0,v.connect)((function(e){return{financePlan:e.financePlan}}))(V.Z.create()(N)),H="IlnpORSzvzhWTBlu0evL";function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.Z)(e);if(t){var n=(0,p.Z)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.Z)(this,a)}}var z=function(e){(0,l.Z)(a,e);var t=T(a);function a(e){var o;return(0,i.Z)(this,a),o=t.call(this,e),(0,u.Z)((0,s.Z)(o),"onShowModal",(function(){o.setState({isShowModal:!0})})),(0,u.Z)((0,s.Z)(o),"onHideModal",(function(){o.setState({isShowModal:!1})})),(0,u.Z)((0,s.Z)(o),"onSearch",(function(e){o.private.searchParams=e,o.private.searchParams.page||(o.private.searchParams.page=1),o.private.searchParams.limit||(o.private.searchParams.limit=30),o.props.dispatch({type:"financePlan/fetchSalaryPlanList",payload:o.private.searchParams})})),(0,u.Z)((0,s.Z)(o),"onChangePage",(function(e,t){o.private.searchParams.page=e,o.private.searchParams.limit=t,o.onSearch(o.private.searchParams)})),(0,u.Z)((0,s.Z)(o),"onShowSizeChange",(function(e,t){o.private.searchParams.page=e,o.private.searchParams.limit=t,o.onSearch(o.private.searchParams)})),(0,u.Z)((0,s.Z)(o),"renderSearch",(function(){var e=(0,s.Z)(o).onSearch;return g.createElement(b,{onSearch:e})})),(0,u.Z)((0,s.Z)(o),"renderContent",(function(){var e=o.private.searchParams.page,t=o.props.planListData,a=void 0===t?{}:t,i=f().get(a,"data",[]),s=f().get(a,"meta.count",0),l=[{title:"代码",dataIndex:"id",fixed:"left",width:120,render:function(e){return e||"--"}},{title:"平台",dataIndex:"platformName",width:60,render:function(e){return e||"--"}},{title:"供应商",dataIndex:"supplierName",width:170,render:function(e){return e||"--"}},{title:"城市",dataIndex:"cityName",width:70,render:function(e){return e||"--"}},{title:"商圈",dataIndex:"bizDistrictName",width:158,render:function(e){return e||"--"}},{title:"方案类型",dataIndex:"domain",width:80,render:function(e){return F.F$Y.description(e)}},{title:"服务费方案名称",dataIndex:"name",render:function(e,t){return g.createElement("span",null,t.bizDistrictName?"".concat(t.platformName,"-").concat(t.supplierName,"-").concat(t.cityName,"-").concat(t.bizDistrictName):"".concat(t.platformName,"-").concat(t.supplierName,"- ").concat(t.cityName))}},{title:"创建日期",dataIndex:"createdAt",width:135,render:function(e){return e?h()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"创建者",dataIndex:["creatorInfo","name"],width:60},{title:"状态",dataIndex:"state",width:60,render:function(e){return F.c8g.description(e)}},{title:"生效日期",dataIndex:"enabledAt",width:90,render:function(e){return e?h()(e).format("YYYY-MM-DD"):"--"}},{title:"最后操作日期",dataIndex:"updatedAt",width:90,render:function(e){return e?h()(e).format("YYYY-MM-DD"):"--"}},{title:"最后操作者",dataIndex:["operatorInfo","name"],width:80,render:function(e){return e||"--"}},{title:"操作",fixed:"right",width:60,render:function(e,t){return g.createElement("span",null,g.createElement("a",{className:H,target:"_blank",rel:"noopener noreferrer",href:"/#/Finance/Rules?id=".concat(t.id)},"详情"))}}],c={showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:30,onShowSizeChange:o.onShowSizeChange,total:s,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],onChange:o.onChangePage};e&&(c.current=e);var p=g.createElement("span",null,!E.ZP.canOperateFinancePlanCreate()||g.createElement(n.Z,{type:"primary",onClick:o.onShowModal},"创建服务费方案"));return g.createElement(y.IT,{title:"服务费方案汇总列表",titleExt:p},g.createElement(r.Z,{columns:l,pagination:c,rowKey:function(e,t){return t},scroll:{x:1470},dataSource:i,bordered:!0}))})),(0,u.Z)((0,s.Z)(o),"renderCreateModal",(function(){var e=(0,s.Z)(o).onHideModal,t=o.state.isShowModal,a=o.props.planListData,r=void 0===a?{}:a,n=f().get(r,"data",[]);return g.createElement(k,{onHideModal:e,isShowModal:t,planListData:n})})),o.state={isShowModal:!1},o.private={searchParams:{}},o}return(0,o.Z)(a,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"financePlan/fetchSalaryPlanList"})}},{key:"render",value:function(){return g.createElement("div",null,this.renderSearch(),this.renderContent(),this.renderCreateModal())}}]),a}(g.Component);(0,u.Z)(z,"propTypes",{planListData:S().object}),(0,u.Z)(z,"defaultProps",{planListData:{}});var L=(0,v.connect)((function(e){return{planListData:e.financePlan.planListData}}))(z)}}]);