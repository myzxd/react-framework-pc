"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[5380],{39144:function(e,t,a){a.d(t,{Z:function(){return h}});var n=a(4942),r=a(87462),o=a(67294),l=a(94184),c=a.n(l),i=a(98423),s=a(65632),p=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},d=function(e){var t=e.prefixCls,a=e.className,l=e.hoverable,i=void 0===l||l,d=p(e,["prefixCls","className","hoverable"]);return o.createElement(s.C,null,(function(e){var l=(0,e.getPrefixCls)("card",t),s=c()("".concat(l,"-grid"),a,(0,n.Z)({},"".concat(l,"-grid-hoverable"),i));return o.createElement("div",(0,r.Z)({},d,{className:s}))}))},u=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},m=function(e){return o.createElement(s.C,null,(function(t){var a=t.getPrefixCls,n=e.prefixCls,l=e.className,i=e.avatar,s=e.title,p=e.description,d=u(e,["prefixCls","className","avatar","title","description"]),m=a("card",n),f=c()("".concat(m,"-meta"),l),_=i?o.createElement("div",{className:"".concat(m,"-meta-avatar")},i):null,y=s?o.createElement("div",{className:"".concat(m,"-meta-title")},s):null,g=p?o.createElement("div",{className:"".concat(m,"-meta-description")},p):null,v=y||g?o.createElement("div",{className:"".concat(m,"-meta-detail")},y,g):null;return o.createElement("div",(0,r.Z)({},d,{className:f}),_,v)}))},f=a(51752),_=a(71230),y=a(15746),g=a(97647),v=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a};var b=function(e){var t,a,l,p=o.useContext(s.E_),u=p.getPrefixCls,m=p.direction,b=o.useContext(g.Z),h=e.prefixCls,E=e.className,C=e.extra,Z=e.headStyle,x=void 0===Z?{}:Z,w=e.bodyStyle,I=void 0===w?{}:w,O=e.title,P=e.loading,k=e.bordered,T=void 0===k||k,S=e.size,F=e.type,D=e.cover,M=e.actions,j=e.tabList,Y=e.children,A=e.activeTabKey,N=e.defaultActiveTabKey,B=e.tabBarExtraContent,L=e.hoverable,R=e.tabProps,H=void 0===R?{}:R,V=v(e,["prefixCls","className","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps"]),z=u("card",h),U=0===I.padding||"0px"===I.padding?{padding:24}:void 0,$=o.createElement("div",{className:"".concat(z,"-loading-block")}),q=o.createElement("div",{className:"".concat(z,"-loading-content"),style:U},o.createElement(_.Z,{gutter:8},o.createElement(y.Z,{span:22},$)),o.createElement(_.Z,{gutter:8},o.createElement(y.Z,{span:8},$),o.createElement(y.Z,{span:15},$)),o.createElement(_.Z,{gutter:8},o.createElement(y.Z,{span:6},$),o.createElement(y.Z,{span:18},$)),o.createElement(_.Z,{gutter:8},o.createElement(y.Z,{span:13},$),o.createElement(y.Z,{span:9},$)),o.createElement(_.Z,{gutter:8},o.createElement(y.Z,{span:4},$),o.createElement(y.Z,{span:3},$),o.createElement(y.Z,{span:16},$))),G=void 0!==A,K=(0,r.Z)((0,r.Z)({},H),(t={},(0,n.Z)(t,G?"activeKey":"defaultActiveKey",G?A:N),(0,n.Z)(t,"tabBarExtraContent",B),t)),W=j&&j.length?o.createElement(f.Z,(0,r.Z)({size:"large"},K,{className:"".concat(z,"-head-tabs"),onChange:function(t){var a;null===(a=e.onTabChange)||void 0===a||a.call(e,t)}}),j.map((function(e){return o.createElement(f.Z.TabPane,{tab:e.tab,disabled:e.disabled,key:e.key})}))):null;(O||C||W)&&(l=o.createElement("div",{className:"".concat(z,"-head"),style:x},o.createElement("div",{className:"".concat(z,"-head-wrapper")},O&&o.createElement("div",{className:"".concat(z,"-head-title")},O),C&&o.createElement("div",{className:"".concat(z,"-extra")},C)),W));var J,Q=D?o.createElement("div",{className:"".concat(z,"-cover")},D):null,X=o.createElement("div",{className:"".concat(z,"-body"),style:I},P?q:Y),ee=M&&M.length?o.createElement("ul",{className:"".concat(z,"-actions")},function(e){return e.map((function(t,a){return o.createElement("li",{style:{width:"".concat(100/e.length,"%")},key:"action-".concat(a)},o.createElement("span",null,t))}))}(M)):null,te=(0,i.Z)(V,["onTabChange"]),ae=S||b,ne=c()(z,(a={},(0,n.Z)(a,"".concat(z,"-loading"),P),(0,n.Z)(a,"".concat(z,"-bordered"),T),(0,n.Z)(a,"".concat(z,"-hoverable"),L),(0,n.Z)(a,"".concat(z,"-contain-grid"),(o.Children.forEach(e.children,(function(e){e&&e.type&&e.type===d&&(J=!0)})),J)),(0,n.Z)(a,"".concat(z,"-contain-tabs"),j&&j.length),(0,n.Z)(a,"".concat(z,"-").concat(ae),ae),(0,n.Z)(a,"".concat(z,"-type-").concat(F),!!F),(0,n.Z)(a,"".concat(z,"-rtl"),"rtl"===m),a),E);return o.createElement("div",(0,r.Z)({},te,{className:ne}),l,Q,X,ee)};b.Grid=d,b.Meta=m;var h=b},80160:function(e,t,a){a(97564),a(9523),a(13062),a(89032)},30117:function(e,t,a){a.d(t,{Z:function(){return B}});a(80160);var n=a(39144),r=a(87462),o=(a(52560),a(71577)),l=(a(21316),a(75443)),c=(a(55295),a(69713)),i=(a(36616),a(51368)),s=(a(51838),a(48086)),p=a(4942),d=(a(35668),a(86585)),u=a(29439),m=(a(9070),a(20924)),f=a(94315),_=a.n(f),y=a(93517),g=a.n(y),v=a(67294),b=a(55609),h=a(15873),E=a(96036),C=a(80385),Z=a(13328),x=a(33185),w=a(90652),I=a(85277),O=a(52651),P=(a(13062),a(71230)),k=(a(89032),a(15746));var T=function(e){var t,a,n=e.detail,r=e.costCenterType;return v.createElement("div",null,(a=[v.createElement(d.Z.Item,{label:"科目",labelCol:{span:4},wrapperCol:{span:20}},g().get(n,"biz_account_info.name","--"),g().get(n,"biz_account_info.ac_code",void 0)?"(".concat(g().get(n,"biz_account_info.ac_code",void 0),")"):null),v.createElement(d.Z.Item,{label:"核算中心",labelCol:{span:4},wrapperCol:{span:20}},r===C.G$J.code?g().get(n,"biz_code_info.name","--"):g().get(n,"biz_team_info.name","--")),{span:12,render:v.createElement(d.Z.Item,{label:"发票抬头",labelCol:{span:4},wrapperCol:{span:20}},g().get(n,"invoice_title","--"))},{span:12,render:v.createElement(d.Z.Item,{label:"金额",labelCol:{span:4},wrapperCol:{span:20}},C.fbc.exchangePriceCentToMathFormat(g().get(n,"total_money",0)))},{span:24,render:v.createElement(d.Z.Item,{label:"事由说明",labelCol:{span:2},wrapperCol:{span:22}},v.createElement("div",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},g().get(n,"note","--")))},{span:24,render:v.createElement(d.Z.Item,{label:"上传附件",labelCol:{span:2},wrapperCol:{span:22}},v.createElement(I.Z,{displayMode:!0,value:I.Z.getInitialValue(n,"attachment_private_urls")}))}],v.createElement(E.Fp,{items:a,cols:2})),(t=g().get(n,"payee_list",[]),v.createElement(E.IT,{title:"支付明细",color:"rgba(255, 119, 0, 0.5)",style:{backgroundColor:"rgba(255, 226, 200, 0.15)"}},t.map((function(e,t){return v.createElement(P.Z,{key:t},v.createElement(k.Z,{span:8},v.createElement(d.Z.Item,{label:"收款人",labelCol:{span:8},wrapperCol:{span:16}},g().get(e,"card_name","--"))),v.createElement(k.Z,{span:8},v.createElement(d.Z.Item,{label:"手机号",labelCol:{span:8},wrapperCol:{span:16}},g().get(e,"card_phone","--"))),v.createElement(k.Z,{span:8},v.createElement(d.Z.Item,{label:"收款方式",labelCol:{span:8},wrapperCol:{span:16}},C.vaC.description(g().get(e,"payee_type","--")))),v.createElement(k.Z,{span:8},v.createElement(d.Z.Item,{label:"开户支行",labelCol:{span:8},wrapperCol:{span:16}},g().get(e,"bank_details","--"))),v.createElement(k.Z,{span:8},v.createElement(d.Z.Item,{label:"收款账户",labelCol:{span:8},wrapperCol:{span:16}},v.createElement("div",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},g().get(e,"card_num","--")))),v.createElement(k.Z,{span:8},v.createElement(d.Z.Item,{label:"金额",labelCol:{span:8},wrapperCol:{span:16}},g().get(e,"money")>=0?C.fbc.exchangePriceCentToMathFormat(g().get(e,"money")):"--")))})),v.createElement(d.Z.Item,{labelCol:{span:0},wrapperCol:{span:24}},function(){var e=C.fbc.exchangePriceToYuan(g().get(n,"total_money",0)).toFixed(2),t=g().get(n,"payee_list",[]).map((function(e){return C.fbc.exchangePriceToYuan(e.money)})),a=0;t.length>0&&(a=t.reduce((function(e,t){return e+t})).toFixed(2));var r=Number(e-a).toFixed(2);return v.createElement("div",{style:{textAlign:"right"}},v.createElement("span",null,"费用总金额：",C.fbc.exchangePriceToMathFormat(e),"元"),v.createElement("span",{style:{marginLeft:20}},"当前合计金额：",C.fbc.exchangePriceToMathFormat(a),"元"),0===Number(r)?v.createElement(h.Z,{style:{marginLeft:20,color:"#52c41a"}}):v.createElement("span",{style:{marginLeft:20}},"差额：",v.createElement("span",{style:{color:"red"}},C.fbc.exchangePriceToMathFormat(r))," 元"))}()))))},S=a(15727),F=a(45498);function D(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==a.return||a.return()}finally{if(c)throw o}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,p.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var A=m.Z.TextArea,N=new RegExp("^[1][3,4,5,6,7,8,9][0-9]{9}$");var B=(0,b.connect)((function(e){return{orderCostItem:e.codeOrder.orderCostItem}}))((function(e){var t=e.formKey,a=e.index,p=e.orderId,m=e.item,f=e.dispatch,y=e.orderCostItem,b=e.costCenterType,P="".concat(m._id,"-").concat(t),k=!1,M=y[P]||{},j=d.Z.useForm(),B=(0,u.Z)(j,1)[0],L=(0,v.useState)(!1),R=(0,u.Z)(L,2),H=R[0],V=R[1];(0,v.useEffect)((function(){if(m._id&&p){var e={id:m._id,orderId:p,namespace:P};f({type:"codeOrder/fetchOrderCostItem",payload:e})}return function(){f({type:"codeOrder/reduceOrderCostItem",payload:{namespace:P,result:{}}})}}),[f,m,p,P]),(0,v.useEffect)((function(){if(m._id&&_().existy(M)&&_().not.empty(M)){var e=g().get(M,"payee_list",[]);B.setFieldsValue({subjectId:g().get(M,"cost_accounting_id",void 0),codeBusinessAccount:g().get(M,"cost_target_id",void 0),invoiceTitle:g().get(M,"invoice_title",void 0),money:g().get(M,"total_money")?C.fbc.exchangePriceToYuan(g().get(M,"total_money")):void 0,note:g().get(M,"note",void 0),assets:I.Z.getInitialValue(M,"attachment_private_urls"),bankList:e.map((function(e,t){var a=Y(Y({},e),{},{flag:!0});return"number"==typeof e.money&&(a.money=C.fbc.exchangePriceToYuan(e.money)),a.num=t+1,a}))})}}),[B,m._id,M]);var z=function(){f({type:"codeOrder/removeOrderCostItem",payload:{id:m._id,onSucessCallback:e.onInterfaceDetail}})},U=function(){m._id&&!0!==m.isShowCopy?z():e.onClickRemoveCost&&e.onClickRemoveCost(t)},$=function(){if(!0!==m.isShowCopy&&_().existy(M)&&_().not.empty(M)){var e=g().get(M,"payee_list",[]);B.setFieldsValue({subjectId:g().get(M,"cost_accounting_id",void 0),codeBusinessAccount:g().get(M,"cost_target_id",void 0),invoiceTitle:g().get(M,"invoice_title",void 0),money:g().get(M,"total_money")?C.fbc.exchangePriceToYuan(g().get(M,"total_money")):void 0,note:g().get(M,"note",void 0),assets:I.Z.getInitialValue(M,"attachment_private_urls"),bankList:e.map((function(e,t){var a=Y(Y({},e),{},{flag:!0});return"number"==typeof e.money&&(a.money=C.fbc.exchangePriceToYuan(e.money)),a.num=t+1,a}))})}else B.resetFields(),B.setFieldsValue({bankList:[{payee_type:C.vaC.onlineBanking,num:1,flag:!0}]})},q=function(){B.setFieldsValue({codeBusinessAccount:void 0,invoiceTitle:void 0})},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(e)){var t=e.some((function(e){return!0===e.loading}));V(t)}},K=function(){V(!1),k=!1,e.onInterfaceDetail&&e.onInterfaceDetail()},W=function(){B.validateFields().then((function(e){if(V(!0),!0!==m.isShowCopy&&m._id&&!1===k)return k=!0,void f({type:"codeOrder/updateOrderCostItem",payload:Y(Y({},e),{},{id:m._id,namespace:P,assets:e.assets||[],onSucessCallback:K,onErrorCallback:function(){V(!1),k=!1}})});!1===k&&(k=!0,f({type:"codeOrder/createOrderCostItem",payload:Y(Y({},e),{},{orderId:p,onSucessCallback:K,onErrorCallback:function(){V(!1),k=!1}})}))})).catch((function(e){B.scrollToField(e.errorFields[0].name,{behavior:function(e){return e.forEach((function(e){var t=e.el,a=e.top;t.scrollTop=a-5}))}})}))},J=function(){e.onCopy&&e.onCopy(m._id)},Q=function(){e.onIsShowEdit&&e.onIsShowEdit(a)},X=function(e,t){var a=t.supplier_name;B.setFieldsValue({invoiceTitle:a})},ee=function(e){return e>C.fbc.maxMoney?C.fbc.maxMoney:e},te=function(e,t,a){var n=Number(B.getFieldValue("money")||0).toFixed(2);if(t){var r,o=D(t);try{for(o.s();!(r=o.n()).done;){var l=r.value;if(!l.card_name||!l.bank_details||!l.card_num||"number"!=typeof l.money)return void s.ZP.error("请将收款人，开户支行，收款账户，金额请填写完整");if(Number(l.payee_type)===C.vaC.wallet&&!l.card_phone)return void s.ZP.error("请将手机号请填写完整");if(l.card_phone&&!N.test(l.card_phone))return void s.ZP.error("请将手机号请填写完整")}}catch(e){o.e(e)}finally{o.f()}}var c=t.map((function(e){return Number(e.money||0)})),i=c.reduce((function(e,t){return e+t})).toFixed(2),p=Number(n-i).toFixed(2);0===Number(p)?a():s.ZP.error("收款信息金额与费用总金额不一致")},ae=v.createElement("div",null,v.createElement("span",null,"目前支持的上传格式：- office文件(doc/docx/ppt/pptx/xls/xlsx)"),v.createElement("span",null,"- Rtf文档/- pdf文件/ - 图片文件(jpg/jpeg/png/gif/bmp/tiff/webp)"),v.createElement("span",null,"- txt文件/- csv文件/-eml格式 /- zip格式/- rar格式(不能上传有密码的此类文件)")),ne=function(){var e=[v.createElement(d.Z.Item,{name:"bankList",labelCol:{span:0},wrapperCol:{span:24},rules:[{validator:te}],validateTrigger:"onSave",initialValue:[{payee_type:C.vaC.onlineBanking,num:1}]},v.createElement(O.Z,{formKey:t,onChange:G}))];return v.createElement(E.IT,{title:"支付明细",color:"rgba(255, 119, 0, 0.5)",style:{backgroundColor:"rgba(255, 226, 200, 0.15)"}},v.createElement(E.Fp,{items:e,cols:1}),v.createElement(d.Z.Item,{labelCol:{span:0},wrapperCol:{span:24},shouldUpdate:function(e,t){return e.money!==t.money||e.bankList!==t.bankList}},(function(){return function(){var e=Number(B.getFieldValue("money")||0).toFixed(2),t=(B.getFieldValue("bankList")||[]).map((function(e){return Number(e.money||0)})),a="0.00";t.length>0&&(a=t.reduce((function(e,t){return e+t})).toFixed(2));var n=Number(e-a).toFixed(2);return v.createElement("div",{style:{textAlign:"right"}},v.createElement("span",null,"费用总金额：",v.createElement("span",{style:{fontWeight:"bold"}},C.fbc.exchangePriceToMathFormat(e)," 元")),v.createElement("span",{style:{marginLeft:20}},"当前合计金额：",v.createElement("span",{style:{fontWeight:"bold"}},C.fbc.exchangePriceToMathFormat(a),"元")),0===Number(n)?v.createElement(h.Z,{style:{marginLeft:20,color:"#52c41a"}}):v.createElement("span",{style:{marginLeft:20}},"差额：",v.createElement("span",{style:{fontWeight:"bold"}},v.createElement("span",{style:{color:"red"}},C.fbc.exchangePriceToMathFormat(n))," 元")))}()})))},re=function(){return e.paidState===C.rTI.done||e.paidState===C.rTI.noNeed||e.inspectBillState===C.A1w.already?null:v.createElement("div",{style:{textAlign:"right",borderTop:"1px solid #ccc",paddingTop:10}},m.isShowEdit&&!0!==m.isShowCopy?v.createElement(v.Fragment,null,v.createElement(l.Z,{title:"您是否确定移除当前费用单",onConfirm:z,okText:"确定",cancelText:"取消"},v.createElement("a",{style:{color:"red"}},"移除费用单")),v.createElement(o.Z,{onClick:J,style:{marginLeft:15}},"复制"),v.createElement(o.Z,{onClick:Q,style:{marginLeft:15}},"编辑")):v.createElement(v.Fragment,null,v.createElement(l.Z,{title:"您是否确定移除当前费用单",onConfirm:U,okText:"确定",cancelText:"取消"},v.createElement("a",{style:{color:"red"}},"移除费用单")),v.createElement("a",{style:{marginLeft:15},onClick:$},"重置"),v.createElement(o.Z,{loading:H,onClick:W,style:{marginLeft:15}},"保存")))},oe=function(){return v.createElement(v.Fragment,null,(e=[v.createElement(d.Z.Item,{name:"subjectId",label:"科目",labelCol:{span:4},wrapperCol:{span:16},rules:[{required:!0,message:"请选择科目"}]},v.createElement(Z.Z,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择科目",orderId:p,onChange:q})),v.createElement(d.Z.Item,{name:"invoiceTitle",label:"发票抬头",labelCol:{span:4},wrapperCol:{span:20},rules:[{required:!0,message:"请选择发票抬头"}]},v.createElement(S.Z,{allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择发票抬头",costCenterType:b})),v.createElement(d.Z.Item,{name:"money",label:"金额",labelCol:{span:4},wrapperCol:{span:10},rules:[{required:!0,message:"请填写金额"}],getValueFromEvent:ee},v.createElement(i.Z,{precision:2,min:.01,max:C.fbc.maxMoney,style:{width:"100%"},placeholder:"请填写金额",formatter:C.fbc.maxMoneyLimitDecimalsFormatter,parser:C.fbc.limitDecimalsParser})),{span:24,render:v.createElement(d.Z.Item,{name:"note",label:"事由说明",labelCol:{span:2},wrapperCol:{span:18}},v.createElement(A,{placeholder:"请填写",rows:4}))},{span:24,render:v.createElement(d.Z.Item,{label:v.createElement("div",null,v.createElement(c.Z,{placement:"top",title:ae},v.createElement("span",{className:F.Z["code-order-cost-tooltip-title"]},"!")),v.createElement("span",null,"上传附件")),name:"assets",labelCol:{span:2},wrapperCol:{span:22}},v.createElement(I.Z,{domain:I.Z.UploadDomains.OAUploadDomain}))}],b===C.G$J.code&&e.splice(1,0,v.createElement(d.Z.Item,{key:"codeBusinessAccount",noStyle:!0,shouldUpdate:function(e,t){return e.subjectId!==t.subjectId}},(function(e){var t=e.getFieldValue;return v.createElement(d.Z.Item,{name:"codeBusinessAccount",label:"核算中心",labelCol:{span:4},wrapperCol:{span:16},rules:[{required:!0,message:"请选择核算中心"}]},v.createElement(x.Z,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择核算中心",orderId:p,subjectId:t("subjectId"),onChange:X}))}))),b===C.G$J.team&&e.splice(1,0,v.createElement(d.Z.Item,{noStyle:!0,key:"codeBusinessAccount",shouldUpdate:function(e,t){return e.subjectId!==t.subjectId}},(function(e){var t=e.getFieldValue;return v.createElement(d.Z.Item,{name:"codeBusinessAccount",label:"核算中心",labelCol:{span:4},wrapperCol:{span:16},rules:[{required:!0,message:"请选择核算中心"}]},v.createElement(w.Z,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择核算中心",subjectId:t("subjectId"),orderId:p}))}))),v.createElement(E.Fp,{items:e,cols:2})),ne(),re());var e};return v.createElement(n.Z,{key:t,className:F.Z["card-box"]},b===C.G$J.code?v.createElement("span",{className:F.Z["card-box-code"]},C.G$J.description(b)):v.createElement("span",{className:F.Z["card-box-team"]},C.G$J.description(b)),v.createElement("div",{className:F.Z["card-title"]},"费用单申请"),v.createElement(d.Z,(0,r.Z)({form:B},{labelCol:{span:8},wrapperCol:{span:16}}),m.isShowEdit?v.createElement(v.Fragment,null,v.createElement(T,{detail:M,costCenterType:b}),re()):oe()))}))},8793:function(e,t,a){a.d(t,{Z:function(){return ue}});a(80160);var n=a(39144),r=a(87462),o=(a(52560),a(71577)),l=(a(21316),a(75443)),c=(a(36616),a(51368)),i=(a(89032),a(15746)),s=(a(55295),a(69713)),p=(a(51838),a(48086)),d=a(93433),u=a(4942),m=(a(35668),a(86585)),f=a(29439),_=(a(9070),a(20924)),y=(a(54071),a(14072)),g=a(94315),v=a.n(g),b=a(93517),h=a.n(b),E=a(96486),C=a.n(E),Z=a(55609),x=a(67294),w=a(30381),I=a.n(w),O=a(68628),P=a(15873),k=a(80385),T=a(96036),S=a(13328),F=a(15671),D=a(43144),M=a(97326),j=a(60136),Y=a(82963),A=a(61120),N=(a(29093),a(16317)),B=a(97116),L=a(8240);function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,A.Z)(e);if(t){var r=(0,A.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,Y.Z)(this,a)}}var z=N.Z.Option,U=function(e){(0,j.Z)(a,e);var t=V(a);function a(e){var n;return(0,F.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,M.Z)(n),"componentDidMount",(function(){var e={state:[k.NWs.complete],bizState:k.r0i.undone,applyAccountId:B.Iq.account.id};n.props.dispatch({type:"expenseExamineOrder/fetchTravelApplicationLists",payload:e}),n.props.dispatch({type:"fake/getBusinssTripList",payload:e})})),(0,u.Z)((0,M.Z)(n),"onChangeSelect",(function(e,t){var a=t.define,r=t.item,o=n.props.onChange;o&&o(e,a,r)})),n.state={},n}return(0,D.Z)(a,[{key:"render",value:function(){var e=H(H({},(0,L.CE)(["dispatch","travelApplicationLists","businessTripList","enableSelectAll"],this.props)),{},{style:this.props.style,value:this.props.value,disabled:this.props.disabled,placeholder:this.props.placeholder}),t=h().get(this.props,"travelApplicationLists.data",[]),a=h().get(this.props,"businessTripList.data",[]).map((function(e){var t=e.departure||{},a=e.destination||{},n=h().get(e,"cost_order_info.state",void 0);return x.createElement(z,{key:e._id,define:k.coV.oa,value:e._id,item:e},e.apply_user_name,"-- (",t.province_name,t.city_name,"--",a.province_name,a.city_name,") -",e._id,n?"-".concat(k.Vm3.description(n)):"")})),n=t.map((function(e){var t=e.departure||{},a=e.destination||{},n=h().get(e,"cost_order_info.state",void 0);return x.createElement(z,{key:e._id,define:k.coV.expense,value:e._id,item:e},e.apply_user_name,"-- (",t.province_name,t.city_name,"--",a.province_name,a.city_name,") -",e._id,n?"-".concat(k.Vm3.description(n)):"")}));return x.createElement(N.Z,(0,r.Z)({},e,{onChange:this.onChangeSelect}),[].concat((0,d.Z)(a),(0,d.Z)(n)))}}]),a}(x.Component);var $=(0,Z.connect)((function(e){return{travelApplicationLists:e.expenseExamineOrder.travelApplicationLists,businessTripList:e.fake.businessTripList}}))(U),q=a(33185),G=a(90652),K=(a(13062),a(71230));function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,A.Z)(e);if(t){var r=(0,A.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,Y.Z)(this,a)}}var X=function(e){(0,j.Z)(a,e);var t=Q(a);function a(e){var n;return(0,F.Z)(this,a),n=t.call(this,e),(0,u.Z)((0,M.Z)(n),"onChangeSubsidyFee",(function(e){var t=n.state.value;t.subsidy_fee=e,(v().not.existy(e)||v().empty(e))&&(t.subsidy_fee=0),e>k.fbc.maxMoney&&(t.subsidy_fee=k.fbc.maxMoney),n.props.onChangeBizExtraDataIsOutMoney&&n.props.onChangeBizExtraDataIsOutMoney(t),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangeStayFee",(function(e){var t=n.state.value;t.stay_fee=e,(v().not.existy(e)||v().empty(e))&&(t.stay_fee=0),e>k.fbc.maxMoney&&(t.stay_fee=k.fbc.maxMoney),n.props.onChangeBizExtraDataIsOutMoney&&n.props.onChangeBizExtraDataIsOutMoney(t),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangeTransportFee",(function(e){var t=n.state.value;t.transport_fee=e,(v().not.existy(e)||v().empty(e))&&(t.transport_fee=0),e>k.fbc.maxMoney&&(t.transport_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangeurBanTransportFee",(function(e){var t=n.state.value;t.urban_transport_fee=e,(v().not.existy(e)||v().empty(e))&&(t.urban_transport_fee=0),e>k.fbc.maxMoney&&(t.urban_transport_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangeOtherFee",(function(e){var t=n.state.value;t.other_fee=e,(v().not.existy(e)||v().empty(e))&&(t.other_fee=0),e>k.fbc.maxMoney&&(t.other_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangehighSpeedRailMotorCarFee",(function(e){var t=n.state.value;t.high_speed_train_fee=e,(v().not.existy(e)||v().empty(e))&&(t.high_speed_train_fee=0),e>k.fbc.maxMoney&&(t.high_speed_train_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangeplaneFee",(function(e){var t=n.state.value;t.aircraft_fee=e,(v().not.existy(e)||v().empty(e))&&(t.aircraft_fee=0),e>k.fbc.maxMoney&&(t.aircraft_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangesoftSleeperFee",(function(e){var t=n.state.value;t.train_ordinary_soft_sleeper_fee=e,(v().not.existy(e)||v().empty(e))&&(t.train_ordinary_soft_sleeper_fee=0),e>k.fbc.maxMoney&&(t.train_ordinary_soft_sleeper_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangepassengerCarFee",(function(e){var t=n.state.value;t.bus_fee=e,(v().not.existy(e)||v().empty(e))&&(t.bus_fee=0),e>k.fbc.maxMoney&&(t.bus_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"onChangedriveFee",(function(e){var t=n.state.value;t.self_driving_fee=e,(v().not.existy(e)||v().empty(e))&&(t.self_driving_fee=0),e>k.fbc.maxMoney&&(t.self_driving_fee=k.fbc.maxMoney),n.setState({value:t}),n.triggerChange(J({},t))})),(0,u.Z)((0,M.Z)(n),"triggerChange",(function(e){var t=n.props.onChange;t&&t(Object.assign({},n.state.value,e))})),(0,u.Z)((0,M.Z)(n),"renderDetailed",(function(){var e=n.state.value,t=void 0===e?{}:e,a=n.props,r=a.isTransportFee,o=a.isHighSpeedRailMotorCarFee,l=a.isplaneFee,s=a.issoftSleeperFee,p=a.ispassengerCarFee,d=a.isdriveFee,u=a.subsidyFeeVisible,m=a.stayFeeVisible,f=[{label:"补助(元)",form:x.createElement(c.Z,{value:t.subsidy_fee,style:{width:"100%",color:u?"red":""},onChange:n.onChangeSubsidyFee,min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser})},{label:"住宿(元)",form:x.createElement(c.Z,{value:t.stay_fee,style:{width:"100%",color:m?"red":""},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangeStayFee})},{label:"市内交通费(元)",form:x.createElement(c.Z,{value:t.urban_transport_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangeurBanTransportFee})}];return o&&f.push({label:"动车/高铁交通费(元)",form:x.createElement(c.Z,{value:t.high_speed_train_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangehighSpeedRailMotorCarFee})}),l&&f.push({label:"飞机交通费(元)",form:x.createElement(c.Z,{value:t.aircraft_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangeplaneFee})}),s&&f.push({label:"普通软卧交通费(元)",form:x.createElement(c.Z,{value:t.train_ordinary_soft_sleeper_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangesoftSleeperFee})}),p&&f.push({label:"客车交通费(元)",form:x.createElement(c.Z,{value:t.bus_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangepassengerCarFee})}),d&&f.push({label:"自驾交通费(元)",form:x.createElement(c.Z,{value:t.self_driving_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangedriveFee})}),r&&f.push({label:"往返交通费(元)",form:x.createElement(c.Z,{value:t.transport_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangeTransportFee})}),t.other_fee&&f.push({label:"其他(元)",form:x.createElement(c.Z,{value:t.other_fee,style:{width:"100%"},min:0,step:.01,max:k.fbc.maxMoney,formatter:k.fbc.maxMoneyLimitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:n.onChangeOtherFee})}),x.createElement(K.Z,null,f.map((function(e,t){return x.createElement(i.Z,{key:t,span:6,style:{marginTop:t>=4?10:0,display:"flex",alignItems:"center",width:"100%"}},x.createElement("div",null,e.label,"："),x.createElement("div",null,e.form))})))})),n.state={value:h().get(e,"value",{})},n}return(0,D.Z)(a,[{key:"render",value:function(){var e=this.props.id;return x.createElement("div",{id:e,style:{marginLeft:10}},this.renderDetailed())}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.value?{value:h().get(e,"value",{})}:null}}]),a}(x.Component),ee=a(85277),te=a(52651);var ae=function(e){var t,a,n=e.detail,r=e.costCenterType,o=function(e){var t={province:e.province_name,city:e.city_name,area:e.area_name};return e.detailed_address&&(t.detailed_address=e.detailed_address),t},l=function(e){return e.map((function(e){var t={province:e.province_name,city:e.city_name,area:e.area_name};return e.detailed_address&&(t.detailed_address=e.detailed_address),t}))};return x.createElement(x.Fragment,null,(a=[x.createElement(m.Z.Item,{label:"出差单号",labelCol:{span:2},wrapperCol:{span:10}},h().get(n,"travel_order_info",{})._id)],x.createElement(T.Fp,{items:a,cols:1})),k.coV.oa===n.travel_order_type?function(){var e=h().get(n,"travel_order_info",{}),t=e.departure||{},a=h().get(e,"destination_list",[]),r=[{span:6,render:x.createElement(m.Z.Item,{label:"出差申请单号"},x.createElement("div",null,e._id?x.createElement("a",{href:"/#/Expense/Manage/ExamineOrder/Detail?orderId=".concat(e.oa_application_order_id),target:"_blank",rel:"noopener noreferrer"},h().get(e,"_id","--")):"--"))},{span:4,render:x.createElement(m.Z.Item,{label:"实际出差人",labelCol:{span:10},wrapperCol:{span:14}},x.createElement("div",null,h().get(e,"apply_user_name","--")))},{span:4,render:x.createElement(m.Z.Item,{label:"部门"},x.createElement("div",null,h().get(e,"department_info.name","--")))},{span:4,render:x.createElement(m.Z.Item,{label:"岗位"},x.createElement("div",null,h().get(e,"job_info.name","--")))},{span:4,render:x.createElement(m.Z.Item,{label:"职级"},x.createElement("div",null,h().get(e,"work_level","--")))},{span:24,render:x.createElement(m.Z.Item,{label:"预计出差时间",labelCol:{span:2},wrapperCol:{span:22}},x.createElement("div",null,e.expect_start_at?I()(e.expect_start_at).format("YYYY-MM-DD HH:00"):"","--",e.expect_done_at?I()(e.expect_done_at).format("YYYY-MM-DD HH:00"):""))},{span:24,render:x.createElement(m.Z.Item,{label:"出发地",labelCol:{span:2},wrapperCol:{span:22}},Object.values(o(t)).join("-"))},{span:24,render:x.createElement(m.Z.Item,{label:"目的地",labelCol:{span:2},wrapperCol:{span:22}},l(a).map((function(e){return Object.values(e).join("-")})).join(" 、"))},{span:12,render:x.createElement(m.Z.Item,{label:"实际出差时间",labelCol:{span:6},wrapperCol:{span:18}},e.actual_start_at?I()(e.actual_start_at).format("YYYY-MM-DD HH:00"):"","--",e.actual_done_at?I()(e.actual_done_at).format("YYYY-MM-DD HH:00"):"")},x.createElement(m.Z.Item,{label:"出差天数"},x.createElement("div",null,e.actual_apply_days||"--","天",e.actual_apply_days>e.expect_apply_days?x.createElement("span",null,"（",x.createElement("span",{style:{color:"red"}},"申请出差天数：",e.expect_apply_days,"天"),"）"):""))];return x.createElement(T.Fp,{items:r,cols:4,layout:{labelCol:{span:8},wrapperCol:{span:10}}})}():function(){var e=h().get(n,"travel_order_info",{}),t=e.departure||{},a=e.destination||{},r=[x.createElement(m.Z.Item,{label:"出差申请单号"},x.createElement("div",null,e._id?x.createElement("a",{href:"/#/Expense/TravelApplication/Detail?id=".concat(e._id),target:"_blank",rel:"noopener noreferrer"},h().get(e,"_id","--")):"--")),x.createElement(m.Z.Item,{label:"实际出差人"},x.createElement("div",null,h().get(e,"apply_user_name","--"))),x.createElement(m.Z.Item,{label:"预计出差时间"},x.createElement("div",null,e.expect_start_at?I()(e.expect_start_at).format("YYYY-MM-DD HH:00"):"","--",e.expect_done_at?I()(e.expect_done_at).format("YYYY-MM-DD HH:00"):"")),x.createElement(m.Z.Item,{label:"出发地"},Object.values(o(t)).join("-")),x.createElement(m.Z.Item,{label:"目的地"},l([a]).map((function(e){return Object.values(e).join("-")})).join(" 、")),{span:12,render:x.createElement(m.Z.Item,{label:"实际出差时间",labelCol:{span:6},wrapperCol:{span:18}},e.actual_start_at?I()(e.actual_start_at).format("YYYY-MM-DD HH:00"):"","--",e.actual_done_at?I()(e.actual_done_at).format("YYYY-MM-DD HH:00"):"")},x.createElement(m.Z.Item,{label:"出差天数"},x.createElement("div",null,e.actual_apply_days||"--","天",e.actual_apply_days>e.expect_apply_days?x.createElement("span",null,"（",x.createElement("span",{style:{color:"red"}},"申请出差天数：",e.expect_apply_days,"天"),"）"):""))];return x.createElement(T.Fp,{items:r,cols:4,layout:{labelCol:{span:8},wrapperCol:{span:10}}})}(),function(){var e=h().get(n,"travel_fee_extra_data.high_speed_train_fee",0),t=h().get(n,"travel_fee_extra_data.aircraft_fee",0),a=h().get(n,"travel_fee_extra_data.train_ordinary_soft_sleeper_fee",0),o=h().get(n,"travel_fee_extra_data.bus_fee",0),l=h().get(n,"travel_fee_extra_data.self_driving_fee",0),c=[x.createElement(m.Z.Item,{label:"科目",labelCol:{span:2},wrapperCol:{span:10}},h().get(n,"biz_account_info.name","--"),h().get(n,"biz_account_info.ac_code",void 0)?"(".concat(h().get(n,"biz_account_info.ac_code",void 0),")"):null),x.createElement(m.Z.Item,{label:"核算中心",labelCol:{span:2},wrapperCol:{span:10}},r===k.G$J.code?h().get(n,"biz_code_info.name","--"):h().get(n,"biz_team_info.name","--")),x.createElement(i.Z,{push:1},x.createElement("span",{style:{fontWeight:500}},"差旅费用明细"),x.createElement("span",{style:{marginLeft:10}},"明细超标将会用红色字体显示")),x.createElement(m.Z.Item,{label:"",wrapperCol:{span:22,push:1}},x.createElement(K.Z,{style:{marginLeft:10}},x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"补助(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word",color:h().get(n,"travel_fee_extra_data.is_out_subsidy_fee",!1)?"red":""}},k.fbc.exchangePriceCentToMathFormat(h().get(n,"travel_fee_extra_data.subsidy_fee",0)))),x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"住宿(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word",color:h().get(n,"travel_fee_extra_data.is_out_stay_fee",!1)?"red":""}},k.fbc.exchangePriceCentToMathFormat(h().get(n,"travel_fee_extra_data.stay_fee",0)))," "),x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"市内交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(h().get(n,"travel_fee_extra_data.urban_transport_fee",0)))," "),e?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"动车/高铁交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(e))," "):null,t?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"飞机交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(t))," "):null,a?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"普通软卧交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(a))," "):null,o?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"客车交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(o))," "):null,l?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"自驾交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}}," ",k.fbc.exchangePriceCentToMathFormat(l))):null,h().get(n,"travel_fee_extra_data.transport_fee",0)?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"往返交通费(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(h().get(n,"travel_fee_extra_data.transport_fee",0)))):null,h().get(n,"travel_fee_extra_data.other_fee",0)?x.createElement(i.Z,{style:{marginTop:10},span:6},x.createElement("span",null,"其他(元): "),x.createElement("span",{style:{flex:1,wordBreak:"break-word"}},k.fbc.exchangePriceCentToMathFormat(h().get(n,"travel_fee_extra_data.other_fee",0)))):null)),x.createElement(m.Z.Item,{label:"报销金额",labelCol:{span:2},wrapperCol:{span:10}},k.fbc.exchangePriceCentToMathFormat(h().get(n,"total_money",0))),x.createElement(m.Z.Item,{label:"发票抬头",labelCol:{span:2},wrapperCol:{span:22}},h().get(n,"invoice_title","--")),x.createElement(m.Z.Item,{label:"事由说明",labelCol:{span:2},wrapperCol:{span:22}},x.createElement("div",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},h().get(n,"note","--"))),x.createElement(m.Z.Item,{label:"上传附件",labelCol:{span:2},wrapperCol:{span:22}},x.createElement(ee.Z,{displayMode:!0,value:ee.Z.getInitialValue(n,"attachment_private_urls")}))];return x.createElement(x.Fragment,null,x.createElement(T.Fp,{items:c,cols:1}))}(),(t=h().get(n,"payee_list",[]),x.createElement(T.IT,{title:"支付明细",color:"rgba(255, 119, 0, 0.5)",style:{backgroundColor:"rgba(255, 226, 200, 0.15)"}},t.map((function(e,t){return x.createElement(K.Z,{key:t},x.createElement(i.Z,{span:6},x.createElement(m.Z.Item,{label:"收款人",labelCol:{span:8},wrapperCol:{span:16}},h().get(e,"card_name","--"))),x.createElement(i.Z,{span:6},x.createElement(m.Z.Item,{label:"开户支行",labelCol:{span:8},wrapperCol:{span:16}},h().get(e,"bank_details","--"))),x.createElement(i.Z,{span:6},x.createElement(m.Z.Item,{label:"收款账户",labelCol:{span:8},wrapperCol:{span:16}},x.createElement("div",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},h().get(e,"card_num","--")))),x.createElement(i.Z,{span:6},x.createElement(m.Z.Item,{label:"报销金额",labelCol:{span:8},wrapperCol:{span:16}},h().get(e,"money")>=0?k.fbc.exchangePriceCentToMathFormat(h().get(e,"money")):"--")),x.createElement(i.Z,{span:6},x.createElement(m.Z.Item,{label:"收款方式",labelCol:{span:8},wrapperCol:{span:16}},k.vaC.description(h().get(e,"payee_type","--")))),x.createElement(i.Z,{span:6},x.createElement(m.Z.Item,{label:"手机号",labelCol:{span:8},wrapperCol:{span:16}},h().get(e,"card_phone","--"))))})),x.createElement(m.Z.Item,{labelCol:{span:0},wrapperCol:{span:24}},function(){var e=k.fbc.exchangePriceToYuan(h().get(n,"total_money",0)).toFixed(2),t=h().get(n,"payee_list",[]).map((function(e){return k.fbc.exchangePriceToYuan(e.money)})),a=0;t.length>0&&(a=t.reduce((function(e,t){return e+t})).toFixed(2));var r=Number(e-a).toFixed(2);return x.createElement("div",{style:{textAlign:"right"}},x.createElement("span",null,"费用总金额：",k.fbc.exchangePriceToMathFormat(e),"元"),x.createElement("span",{style:{marginLeft:20}},"当前合计金额：",k.fbc.exchangePriceToMathFormat(a),"元"),0===Number(r)?x.createElement(P.Z,{style:{marginLeft:20,color:"#52c41a"}}):x.createElement("span",{style:{marginLeft:20}},"差额：",x.createElement("span",{style:{color:"red"}},k.fbc.exchangePriceToMathFormat(r))," 元"))}()))))},ne=a(15727),re=a(45498);function oe(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return le(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==a.return||a.return()}finally{if(c)throw o}}}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var se=new RegExp("^[1][3,4,5,6,7,8,9][0-9]{9}$"),pe=y.Z.RangePicker,de=_.Z.TextArea;var ue=(0,Z.connect)((function(e){return{travelOrder:e.codeOrder.travelOrder,businessTripDays:e.fake.businessTripDays}}))((function(e){var t=e.travelOrder,a=e.formKey,u=e.item,_=e.index,y=e.dispatch,g=e.orderId,b=e.costCenterType,E=e.businessTripDays,Z=u._id,w=!1,F=t[Z]||{},D=(E[a]||{}).travel_days,M=m.Z.useForm(),j=(0,f.Z)(M,1)[0],Y=(0,x.useState)({}),A=(0,f.Z)(Y,2),N=A[0],B=A[1],L=(0,x.useState)(),R=(0,f.Z)(L,2),H=R[0],V=R[1],z=(0,x.useState)({}),U=(0,f.Z)(z,2),K=U[0],W=U[1],J=(0,x.useState)(!1),Q=(0,f.Z)(J,2),le=Q[0],ce=Q[1],ue=(0,x.useState)(),me=(0,f.Z)(ue,2),fe=me[0],_e=me[1],ye=(0,x.useState)(),ge=(0,f.Z)(ye,2),ve=ge[0],be=ge[1],he=(0,x.useState)(),Ee=(0,f.Z)(he,2),Ce=Ee[0],Ze=Ee[1],xe=[k.s6P.highSpeedRailMotorCarOne,k.s6P.highSpeedRailMotorCarTwo,k.s6P.planeOne,k.s6P.planeTwo,k.s6P.softSleeper,k.s6P.passengerCar,k.s6P.drive];(0,x.useEffect)((function(){return we(),function(){y({type:"codeOrder/reduceTravelOrder",payload:{namespace:u._id,result:{}}})}}),[y,u,g,Z]),(0,x.useEffect)((function(){if(v().existy(F)&&v().not.empty(F)){var e=h().get(F,"travel_order_info",{});_e(e.expect_apply_days),e.actual_start_at&&e.actual_done_at&&y({type:"fake/getBusinssTripDays",payload:{expectStartAt:I()("".concat(e.actual_start_at)).format("YYYY-MM-DD HH:mm:ss"),expectDoneAt:I()("".concat(e.actual_done_at)).format("YYYY-MM-DD HH:mm:ss"),namespace:a}})}}),[y,F,a]),(0,x.useEffect)((function(){if(v().existy(F)&&v().not.empty(F)){var e=h().get(F,"travel_order_info",{}),t=h().get(F,"payee_list",[]),a=[];v().existy(e.actual_start_at)&&v().not.empty(e.actual_start_at)&&v().existy(e.actual_done_at)&&v().not.empty(e.actual_done_at)&&(a=[I()(e.actual_start_at),I()(e.actual_done_at)]);var n={subsidy_fee:h().get(F,"travel_fee_extra_data.subsidy_fee")?k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.subsidy_fee")):0,stay_fee:h().get(F,"travel_fee_extra_data.stay_fee")?k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.stay_fee")):0,urban_transport_fee:h().get(F,"travel_fee_extra_data.urban_transport_fee")?k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.urban_transport_fee")):0};be(h().get(F,"travel_fee_extra_data.is_out_subsidy_fee")),Ze(h().get(F,"travel_fee_extra_data.is_out_stay_fee")),h().get(F,"travel_fee_extra_data.transport_fee")&&(n.transport_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.transport_fee"))),h().get(F,"travel_fee_extra_data.other_fee")&&(n.other_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.other_fee")));var r=h().get(F,"travel_order_info.transport_kind",[]);(r.includes(k.s6P.highSpeedRailMotorCarOne)||r.includes(k.s6P.highSpeedRailMotorCarTwo))&&(n.high_speed_train_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.high_speed_train_fee",0))),(r.includes(k.s6P.planeOne)||r.includes(k.s6P.planeTwo))&&(n.aircraft_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.aircraft_fee",0))),r.includes(k.s6P.softSleeper)&&(n.train_ordinary_soft_sleeper_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.train_ordinary_soft_sleeper_fee",0))),r.includes(k.s6P.passengerCar)&&(n.bus_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.bus_fee",0))),r.includes(k.s6P.drive)&&(n.self_driving_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.self_driving_fee",0))),j.setFieldsValue({subjectId:h().get(F,"cost_accounting_id",void 0),businessTravelId:h().get(F,"travel_order_info._id",void 0),date:a,codeBusinessAccount:h().get(F,"cost_target_id",void 0),money:h().get(F,"total_money")?k.fbc.exchangePriceToYuan(h().get(F,"total_money")):void 0,bizExtraData:n,invoiceTitle:h().get(F,"invoice_title",void 0),note:h().get(F,"note",void 0),assets:ee.Z.getInitialValue(F,"attachment_private_urls"),bankList:t.map((function(e,t){var a=ie(ie({},e),{},{flag:!0});return"number"==typeof e.money&&(a.money=k.fbc.exchangePriceToYuan(e.money)),a.num=t+1,a}))})}}),[j,F]);var we=function(){if(u._id&&g){var e={id:u._id,orderId:g,namespace:Z};y({type:"codeOrder/fetchTravelOrder",payload:e})}},Ie=function(e){var t={province:e.province_name,city:e.city_name,area:e.area_name};return e.detailed_address&&(t.detailed_address=e.detailed_address),t},Oe=function(e){return e.map((function(e){var t={province:e.province_name,city:e.city_name,area:e.area_name};return e.detailed_address&&(t.detailed_address=e.detailed_address),t}))},Pe=function(){y({type:"codeOrder/removeOrderCostItem",payload:{id:u._id,onSucessCallback:function(){ke(),e.onInterfaceDetail()}}})},ke=function(){e.onClickRemoveCost&&e.onClickRemoveCost(a)},Te=function(){ce(!1),w=!1,e.onInterfaceDetail&&e.onInterfaceDetail()},Se=function(){j.validateFields().then((function(e){if(ce(!0),u._id&&!1===w)return w=!0,void y({type:"codeOrder/updateOrderCostcostTravelOrder",payload:ie(ie({},e),{},{id:u._id,travelState:H||F.travel_order_type,dateDay:D,onSucessCallback:Te,onErrorCallback:function(){ce(!1),w=!1}})});!1===w&&y({type:"codeOrder/createOrderCostcostTravelOrder",payload:ie(ie({},e),{},{dateDay:D,orderId:g,travelState:H||F.travel_order_type,onSucessCallback:Te,onErrorCallback:function(){ce(!1),w=!1}})})})).catch((function(e){j.scrollToField(e.errorFields[0].name,{behavior:function(e){return e.forEach((function(e){var t=e.el,a=e.top;t.scrollTop=a-5}))}})}))},Fe=function(){e.onIsShowEdit&&e.onIsShowEdit(_)},De=function(e){if(Array.isArray(e)){var t=(0,d.Z)(e);return I()(e[1]).valueOf()>I()().valueOf()&&(t[1]=I()()),y({type:"fake/getBusinssTripDays",payload:{expectStartAt:I()(t[0]).format("YYYY-MM-DD HH:mm:ss"),expectDoneAt:I()(t[1]).format("YYYY-MM-DD HH:mm:ss"),namespace:a}}),t}},Me=function(e){return e&&e>I()().endOf("day")},je=function(e,t){var a,n=(new Date).getHours(),r=I()(new Date).format("YYYYHHDD");if(C()&&2===C().length)return a=I()(C()[1]).format("YYYYHHDD"),Number(a)===Number(r)&&"end"===t?{disabledHours:function(){return function(e,t){for(var a=[],n=e;n<t;n+=1)a.push(n);return a}(n+1,24)}}:{disabledHours:function(){return[]}}},Ye=function(){j.setFieldsValue({codeBusinessAccount:void 0})},Ae=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};v().existy(e)&&v().not.empty(e)&&v().existy(t)&&v().not.empty(t)&&v().existy(a)&&v().not.empty(a)&&y({type:"codeOrder/fetchTravelMoneyExceedingStandard",payload:{bizExtraData:a,travelState:t,travelOrderId:e,onSucessCallback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};be(e.is_out_subsidy_fee),Ze(e.is_out_stay_fee)}}})},Ne=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};V(t);var r=j.getFieldValue("bizExtraData");if(Ae(e,t,r),v().existy(n.transport_kind)&&v().not.empty(n.transport_kind)){var o=C().intersection(n.transport_kind,xe);v().existy(o)&&v().not.empty(o)?delete r.transport_fee:r.transport_fee=0;var l=h().get(n,"transport_kind",[]);l.includes(k.s6P.highSpeedRailMotorCarOne)||l.includes(k.s6P.highSpeedRailMotorCarTwo)?r.high_speed_train_fee=0:delete r.high_speed_train_fee,l.includes(k.s6P.planeOne)||l.includes(k.s6P.planeTwo)?r.aircraft_fee=0:delete r.aircraft_fee,l.includes(k.s6P.softSleeper)?r.train_ordinary_soft_sleeper_fee=0:delete r.train_ordinary_soft_sleeper_fee,l.includes(k.s6P.passengerCar)?r.bus_fee=0:delete r.bus_fee,l.includes(k.s6P.drive)?r.self_driving_fee=0:delete r.self_driving_fee;var c=Object.values(r),i=c.reduce((function(e,t){return e+t})).toFixed(2);j.setFieldsValue({bizExtraData:r,money:i})}return y({type:"fake/getBusinssTripDays",payload:{expectStartAt:I()(n.expect_start_at).format("YYYY-MM-DD HH:mm:ss"),expectDoneAt:I()(n.expect_done_at).format("YYYY-MM-DD HH:mm:ss"),namespace:a,isEstimateDay:!0,onEstimateSuccessCallback:function(e){_e(e)}}}),j.setFieldsValue({date:[I()(n.expect_start_at),I()(n.expect_done_at)]}),t===k.coV.expense?B(n):t===k.coV.oa?W(n):void 0},Be=function(e,t,a){var n=Object.values(t).some((function(e){return e>0}));v().existy(t)&&v().not.empty(t)&&!0===n?a():a("请填写差旅费用明细")},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=j.getFieldValue("businessTravelId"),a=H||F.travel_order_type;Ae(t,a,e)},Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.values(e),a=t.reduce((function(e,t){return Number(e)+Number(t)})).toFixed(2);j.setFieldsValue({money:a})},He=function(){j.validateFields(["bizExtraData"])},Ve=function(){u._id?function(){if(v().existy(F)&&v().not.empty(F)){var e=h().get(F,"travel_order_info",{}),t=h().get(F,"payee_list",[]),a=[];v().existy(e.actual_start_at)&&v().not.empty(e.actual_start_at)&&v().existy(e.actual_done_at)&&v().not.empty(e.actual_done_at)&&(a=[I()(e.actual_start_at),I()(e.actual_done_at)]),_e(e.expect_apply_days);var n={subsidy_fee:h().get(F,"travel_fee_extra_data.subsidy_fee")?k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.subsidy_fee")):0,stay_fee:h().get(F,"travel_fee_extra_data.stay_fee")?k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.stay_fee")):0,urban_transport_fee:h().get(F,"travel_fee_extra_data.urban_transport_fee")?k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.urban_transport_fee")):0};Ae(h().get(F,"travel_order_info._id",void 0),F.travel_order_type,n);var r=h().get(e,"transport_kind",[]);(r.includes(k.s6P.highSpeedRailMotorCarOne)||r.includes(k.s6P.highSpeedRailMotorCarTwo))&&(n.high_speed_train_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.high_speed_train_fee",0))),(r.includes(k.s6P.planeOne)||r.includes(k.s6P.planeTwo))&&(n.aircraft_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.aircraft_fee",0))),r.includes(k.s6P.softSleeper)&&(n.train_ordinary_soft_sleeper_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.train_ordinary_soft_sleeper_fee",0))),r.includes(k.s6P.passengerCar)&&(n.bus_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.bus_fee",0))),r.includes(k.s6P.drive)&&(n.self_driving_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.self_driving_fee"))),h().get(F,"travel_fee_extra_data.transport_fee")&&(n.transport_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.transport_fee",0))),h().get(F,"travel_fee_extra_data.other_fee")&&(n.other_fee=k.fbc.exchangePriceToYuan(h().get(F,"travel_fee_extra_data.other_fee"))),j.setFieldsValue({subjectId:h().get(F,"cost_accounting_id",void 0),businessTravelId:h().get(F,"travel_order_info._id",void 0),date:a,codeBusinessAccount:h().get(F,"cost_target_id",void 0),money:h().get(F,"total_money")?k.fbc.exchangePriceToYuan(h().get(F,"total_money")):void 0,bizExtraData:n,invoiceTitle:h().get(F,"invoice_title",void 0),note:h().get(F,"note",void 0),assets:ee.Z.getInitialValue(F,"attachment_private_urls"),bankList:t.map((function(e,t){var a=ie(ie({},e),{},{flag:!0});return"number"==typeof e.money&&(a.money=k.fbc.exchangePriceToYuan(e.money)),a.num=t+1,a}))})}}():(_e(void 0),j.resetFields(),be(!1),Ze(!1),B({}),W({}),j.setFieldsValue({bankList:[{payee_type:k.vaC.onlineBanking,num:1,flag:!0}]}))},ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(e)){var t=e.some((function(e){return!0===e.loading}));ce(t)}},Ue=function(e,t,a){var n=Number(j.getFieldValue("money")||0).toFixed(2);if(t){var r,o=oe(t);try{for(o.s();!(r=o.n()).done;){var l=r.value;if(!l.card_name||!l.bank_details||!l.card_num||"number"!=typeof l.money)return void p.ZP.error("请将收款人，开户支行，收款账户，金额请填写完整");if(Number(l.payee_type)===k.vaC.wallet&&!l.card_phone)return void p.ZP.error("请将手机号请填写完整");if(l.card_phone&&!se.test(l.card_phone))return void p.ZP.error("请将手机号请填写完整")}}catch(e){o.e(e)}finally{o.f()}}var c=t.map((function(e){return Number(e.money||0)})),i=c.reduce((function(e,t){return e+t})).toFixed(2),s=Number(n-i).toFixed(2);0===Number(s)?a():p.ZP.error("收款信息金额与费用总金额不一致")},$e=x.createElement("div",null,x.createElement("span",null,"目前支持的上传格式：- office文件(doc/docx/ppt/pptx/xls/xlsx)"),x.createElement("span",null,"- Rtf文档/- pdf文件/ - 图片文件(jpg/jpeg/png/gif/bmp/tiff/webp)"),x.createElement("span",null,"- txt文件/- csv文件/-eml格式 /- zip格式/- rar格式(不能上传有密码的此类文件)")),qe=function(){var e=[x.createElement(m.Z.Item,{name:"bankList",labelCol:{span:0},wrapperCol:{span:24},validateTrigger:"onSave",rules:[{validator:Ue}],initialValue:[{payee_type:k.vaC.onlineBanking,num:1}]},x.createElement(te.Z,{formKey:a,onChange:ze}))];return x.createElement(T.IT,{title:"支付明细",color:"rgba(255, 119, 0, 0.5)",style:{backgroundColor:"rgba(255, 226, 200, 0.15)"}},x.createElement(T.Fp,{items:e,cols:1}),x.createElement(m.Z.Item,{labelCol:{span:0},wrapperCol:{span:24},shouldUpdate:function(e,t){return e.money!==t.money||e.bankList!==t.bankList}},(function(){return function(){var e=Number(j.getFieldValue("money")||0).toFixed(2),t=(j.getFieldValue("bankList")||[]).map((function(e){return Number(e.money||0)})),a="0.00";t.length>0&&(a=t.reduce((function(e,t){return e+t})).toFixed(2));var n=Number(e-a).toFixed(2);return x.createElement("div",{style:{textAlign:"right"}},x.createElement("span",null,"费用总金额：",x.createElement("span",{style:{fontWeight:"bold"}},k.fbc.exchangePriceToMathFormat(e)," 元")),x.createElement("span",{style:{marginLeft:20}},"当前合计金额：",x.createElement("span",{style:{fontWeight:"bold"}},k.fbc.exchangePriceToMathFormat(a),"元")),0===Number(n)?x.createElement(P.Z,{style:{marginLeft:20,color:"#52c41a"}}):x.createElement("span",{style:{marginLeft:20}},"差额：",x.createElement("span",{style:{fontWeight:"bold"}},x.createElement("span",{style:{color:"red"}},k.fbc.exchangePriceToMathFormat(n))," 元")))}()})))},Ge=function(){if(e.paidState===k.rTI.done||e.paidState===k.rTI.noNeed)return null;if(e.inspectBillState===k.A1w.already)return null;var t=x.createElement(l.Z,{title:"您是否确定移除当前费用单",onConfirm:u.isShowEdit?Pe:ke,okText:"确定",cancelText:"取消"},x.createElement("a",{style:{color:"red",marginRight:15}},"移除费用单"));return x.createElement("div",{style:{textAlign:"right",borderTop:"1px solid #ccc",paddingTop:10}},u.isShowEdit?x.createElement(x.Fragment,null,t,x.createElement(o.Z,{onClick:Fe},"编辑")):x.createElement(x.Fragment,null,t,x.createElement("a",{onClick:Ve},"重置"),x.createElement(o.Z,{loading:le,onClick:Se,style:{marginLeft:15}},"保存")))},Ke=function(){return x.createElement(x.Fragment,null,(e=[x.createElement(m.Z.Item,{name:"businessTravelId",label:x.createElement("div",null,x.createElement("span",{style:{marginRight:5}},"出差单号"),x.createElement(s.Z,{title:x.createElement(x.Fragment,null,x.createElement("div",null,"进行中、待提报的出差单已经发起过报销申请，不能重复发起！"),x.createElement("div",null,"请在原单据进行操作！"))},x.createElement(O.Z,null))),labelCol:{span:2},wrapperCol:{span:14},rules:[{required:!0,message:"请选择出差单号"}]},x.createElement($,{placeholder:"请选择出差单号",enableSelectAll:!0,showSearch:!0,optionFilterProp:"children",onChange:Ne}))],x.createElement(T.Fp,{items:e,cols:1})),(H||F.travel_order_type)===k.coV.oa?function(){var e=h().get(F,"travel_order_info",{}),t=v().existy(K)&&v().not.empty(K)?K:e,a=t.departure||{},n=h().get(t,"destination_list",[]),r=[{span:6,render:x.createElement(m.Z.Item,{label:"出差申请单号"},x.createElement("div",null,t._id?x.createElement("a",{href:"/#/Expense/Manage/ExamineOrder/Detail?orderId=".concat(t.oa_application_order_id),target:"_blank",rel:"noopener noreferrer"},h().get(t,"_id","--")):"--"))},{span:4,render:x.createElement(m.Z.Item,{label:"实际出差人",labelCol:{span:10},wrapperCol:{span:14}},x.createElement("div",null,h().get(t,"apply_user_name","--")))},{span:4,render:x.createElement(m.Z.Item,{label:"部门"},x.createElement("div",null,h().get(t,"department_info.name","--")))},{span:4,render:x.createElement(m.Z.Item,{label:"岗位"},x.createElement("div",null,h().get(t,"job_info.name","--")))},{span:4,render:x.createElement(m.Z.Item,{label:"职级"},x.createElement("div",null,h().get(t,"work_level","--")))},{span:24,render:x.createElement(m.Z.Item,{label:"预计出差时间",labelCol:{span:2},wrapperCol:{span:22}},x.createElement("div",null,t.expect_start_at?I()(t.expect_start_at).format("YYYY-MM-DD HH:00"):"","--",t.expect_done_at?I()(t.expect_done_at).format("YYYY-MM-DD HH:00"):""))},{span:24,render:x.createElement(m.Z.Item,{label:"出发地",labelCol:{span:2},wrapperCol:{span:22}},Object.values(Ie(a)).join("-"))},{span:24,render:x.createElement(m.Z.Item,{label:"目的地",labelCol:{span:2},wrapperCol:{span:22}},Oe(n).map((function(e){return Object.values(e).join("-")})).join(" 、"))},{span:12,render:x.createElement(m.Z.Item,{name:"date",label:"实际出差时间",labelCol:{span:6},wrapperCol:{span:18},getValueFromEvent:De,rules:[{required:!0,message:"请选择"}]},x.createElement(pe,{showTime:{format:"HH:00"},format:"YYYY-MM-DD HH:00",disabledDate:Me,disabledTime:je}))},x.createElement(m.Z.Item,{label:"出差天数",shouldUpdate:function(e,t){return e.date!==t.date}},D||"--","天",D>fe?x.createElement("span",null,"（",x.createElement("span",{style:{color:"red"}},"申请出差天数：",fe,"天"),"）"):"")];return x.createElement(T.Fp,{items:r,cols:4,layout:{labelCol:{span:8},wrapperCol:{span:10}}})}():function(){var e=h().get(F,"travel_order_info",{}),t=v().existy(N)&&v().not.empty(N)?N:e,a=t.departure||{},n=t.destination||{},r=[x.createElement(m.Z.Item,{label:"出差申请单号"},x.createElement("div",null,t._id?x.createElement("a",{href:"/#/Expense/TravelApplication/Detail?id=".concat(t._id),target:"_blank",rel:"noopener noreferrer"},h().get(t,"_id","--")):"--")),x.createElement(m.Z.Item,{label:"实际出差人"},x.createElement("div",null,h().get(t,"apply_user_name","--"))),x.createElement(m.Z.Item,{label:"预计出差时间"},x.createElement("div",null,t.expect_start_at?I()(t.expect_start_at).format("YYYY-MM-DD HH:00"):"","--",t.expect_done_at?I()(t.expect_done_at).format("YYYY-MM-DD HH:00"):"")),x.createElement(m.Z.Item,{label:"出发地"},Object.values(Ie(a)).join("-")),x.createElement(m.Z.Item,{label:"目的地"},Oe([n]).map((function(e){return Object.values(e).join("-")})).join(" 、")),{span:12,render:x.createElement(m.Z.Item,{name:"date",label:"实际出差时间",labelCol:{span:6},wrapperCol:{span:18},getValueFromEvent:De,rules:[{required:!0,message:"请选择"}]},x.createElement(pe,{showTime:{format:"HH:00"},format:"YYYY-MM-DD HH:00",disabledDate:Me,disabledTime:je}))},x.createElement(m.Z.Item,{label:"出差天数",shouldUpdate:function(e,t){return e.date!==t.date}},D||"--","天",D>fe?x.createElement("span",null,"（",x.createElement("span",{style:{color:"red"}},"申请出差天数：",fe,"天"),"）"):"")];return x.createElement(T.Fp,{items:r,cols:4,layout:{labelCol:{span:8},wrapperCol:{span:10}}})}(),function(){var e=h().get(F,"travel_order_info",{}),t={},a={};(H||F.travel_order_type)===k.coV.oa?(t=v().existy(K)&&v().not.empty(K)?K:e,a=K):(t=v().existy(N)&&v().not.empty(N)?N:e,a=N);var n=h().get(t,"transport_kind",[]),r=!1,o=!1,l=!1,p=!1,d=!1,u=C().intersection(n,xe),f=v().existy(a)&&v().not.empty(a)&&(v().not.existy(u)||v().empty(u)),_={subsidy_fee:0,stay_fee:0,urban_transport_fee:0};(n.includes(k.s6P.highSpeedRailMotorCarOne)||n.includes(k.s6P.highSpeedRailMotorCarTwo)||h().get(F,"travel_fee_extra_data.high_speed_train_fee"))&&(_.high_speed_train_fee=0,r=!0),(n.includes(k.s6P.planeOne)||n.includes(k.s6P.planeTwo)||h().get(F,"travel_fee_extra_data.aircraft_fee"))&&(_.aircraft_fee=0,o=!0),(n.includes(k.s6P.softSleeper)||h().get(F,"travel_fee_extra_data.train_ordinary_soft_sleeper_fee"))&&(_.train_ordinary_soft_sleeper_fee=0,l=!0),(n.includes(k.s6P.passengerCar)||h().get(F,"travel_fee_extra_data.bus_fee"))&&(_.bus_fee=0,p=!0),(n.includes(k.s6P.drive)||h().get(F,"travel_fee_extra_data.self_driving_fee"))&&(_.self_driving_fee=0,d=!0),(f||h().get(F,"travel_fee_extra_data.transport_fee"))&&(f=!0,_.transport_fee=0);var y=[x.createElement(m.Z.Item,{name:"subjectId",label:"科目",labelCol:{span:2},wrapperCol:{span:10},rules:[{required:!0,message:"请选择科目"}]},x.createElement(S.Z,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择科目",orderId:g,onChange:Ye})),x.createElement(i.Z,{push:1,style:{marginBottom:10,display:"flex"},className:"boss-form-item-required"},x.createElement("span",{style:{fontWeight:500}},"差旅费用明细"),x.createElement("span",{style:{marginLeft:10}},"明细超标将会用红色字体显示")),x.createElement(m.Z.Item,{name:"bizExtraData",label:"",wrapperCol:{span:22,push:1},initialValue:_,rules:[{required:!0,message:"请选择差旅费用明细"},{validator:Be}]},x.createElement(X,{isHighSpeedRailMotorCarFee:r,isplaneFee:o,issoftSleeperFee:l,ispassengerCarFee:p,isdriveFee:d,isTransportFee:f,transportKind:n,onChange:Re,onChangeBizExtraDataIsOutMoney:Le,subsidyFeeVisible:ve,stayFeeVisible:Ce})),x.createElement(m.Z.Item,{name:"money",label:"报销金额",labelCol:{span:2},wrapperCol:{span:10},rules:[{required:!0,message:"请填写报销金额"}]},x.createElement(c.Z,{disabled:!0,precision:2,min:0,style:{width:"100%"},placeholder:"请填写报销金额",formatter:k.fbc.limitDecimalsFormatter,parser:k.fbc.limitDecimalsParser,onChange:He})),x.createElement(m.Z.Item,{name:"invoiceTitle",label:"发票抬头",labelCol:{span:2},wrapperCol:{span:22},rules:[{required:!0,message:"请选择发票抬头"}]},x.createElement(ne.Z,{allowClear:!0,showSearch:!0,optionFilterProp:"children",placeholder:"请选择发票抬头",costCenterType:b})),x.createElement(m.Z.Item,{name:"note",label:"事由说明",labelCol:{span:2},wrapperCol:{span:22},rules:[{required:!0,message:"请填写事由说明"}]},x.createElement(de,{placeholder:"请填写"})),x.createElement(m.Z.Item,{label:x.createElement("div",null,x.createElement(s.Z,{placement:"top",title:$e},x.createElement("span",{className:re.Z["code-order-cost-tooltip-title"]},"!")),x.createElement("span",null,"上传附件")),name:"assets",labelCol:{span:2},wrapperCol:{span:22}},x.createElement(ee.Z,{domain:ee.Z.UploadDomains.OAUploadDomain}))];return b===k.G$J.code&&y.splice(1,0,x.createElement(m.Z.Item,{noStyle:!0,key:"codeBusinessAccount",shouldUpdate:function(e,t){return e.subjectId!==t.subjectId}},(function(e){var t=e.getFieldValue;return x.createElement(m.Z.Item,{name:"codeBusinessAccount",label:"核算中心",labelCol:{span:2},wrapperCol:{span:10},rules:[{required:!0,message:"请选择核算中心"}]},x.createElement(q.Z,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择核算中心",subjectId:t("subjectId"),orderId:g}))}))),b===k.G$J.team&&y.splice(1,0,x.createElement(m.Z.Item,{noStyle:!0,key:"codeBusinessAccount",shouldUpdate:function(e,t){return e.subjectId!==t.subjectId}},(function(e){var t=e.getFieldValue;return x.createElement(m.Z.Item,{name:"codeBusinessAccount",label:"核算中心",labelCol:{span:2},wrapperCol:{span:10},rules:[{required:!0,message:"请选择核算中心"}]},x.createElement(G.Z,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择核算中心",subjectId:t("subjectId"),orderId:g}))}))),x.createElement(x.Fragment,null,x.createElement(T.Fp,{items:y,cols:1}))}(),qe(),Ge());var e};return x.createElement(n.Z,{key:a,className:re.Z["card-box"]},b===k.G$J.code?x.createElement("span",{className:re.Z["card-box-code"]},k.G$J.description(b)):x.createElement("span",{className:re.Z["card-box-team"]},k.G$J.description(b)),x.createElement("div",{className:re.Z["card-title"]},"差旅报销申请"),x.createElement(m.Z,(0,r.Z)({form:j},{labelCol:{span:8},wrapperCol:{span:16}}),u.isShowEdit?x.createElement(x.Fragment,null,x.createElement(ae,{detail:F,costCenterType:b}),Ge()):Ke()))}))},10349:function(e,t,a){a(13062);var n=a(71230),r=(a(52560),a(71577)),o=(a(9070),a(20924)),l=(a(89032),a(15746)),c=(a(20186),a(75385)),i=(a(55295),a(69713)),s=(a(51838),a(48086)),p=a(15671),d=a(43144),u=a(97326),m=a(60136),f=a(82963),_=a(61120),y=a(4942),g=(a(19597),a(27279)),v=a(93517),b=a.n(v),h=a(55609),E=a(67294),C=a(45697),Z=a.n(C),x=a(30381),w=a.n(x),I=a(73218),O=a(80385),P=a(80309),k=a(97418),T=a(45430);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,_.Z)(e);if(t){var r=(0,_.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,f.Z)(this,a)}}var F=g.Z.Panel,D=function(e){(0,m.Z)(a,e);var t=S(a);function a(e){var d;return(0,p.Z)(this,a),d=t.call(this,e),(0,y.Z)((0,u.Z)(d),"onInterfaceDetail",(function(){var e=d.props.orderId;d.props.dispatch({type:"codeOrder/getRelationOrderList",payload:{orderId:e}})})),(0,y.Z)((0,u.Z)(d),"onChangeAssociated",(function(e){var t=e.target.value.trim();d.setState({associatedId:t})})),(0,y.Z)((0,u.Z)(d),"onDeleteAssociatedOrder",(function(e){var t=d.props.orderId,a=d.props.dispatch;if(d.props.getIsShowSave&&d.props.getIsShowSave())return s.ZP.error("请将当前费用单数据保存后再进行操作");a({type:"codeOrder/deleteAssociatedAccount",payload:{associatedId:t,id:e,onSuccessCallback:d.onSuccessDeleteAssociatedCallback}})})),(0,y.Z)((0,u.Z)(d),"onSuccessDeleteAssociatedCallback",(function(){d.onInterfaceDetail()})),(0,y.Z)((0,u.Z)(d),"onSuccessAssociatedCallback",(function(){s.ZP.success("关联成功"),d.onInterfaceDetail&&d.onInterfaceDetail()})),(0,y.Z)((0,u.Z)(d),"onSubmitAssociated",(function(){var e=d.state.associatedId,t=d.props.orderId;if(e){var a={associatedId:e,orderId:t};d.props.dispatch({type:"codeOrder/updateAssociatedAccount",payload:{params:a,onSuccessCallback:d.onSuccessAssociatedCallback}})}})),(0,y.Z)((0,u.Z)(d),"renderTags",(function(e,t){if(Array.isArray(e)&&e.length>3){var a="inspect"===t?e.map((function(e){return e.name})).join(" 、 "):e.map((function(e){return e})).join(" 、 ");return E.createElement(i.Z,{title:a},E.createElement("div",null,"inspect"===t?e.slice(0,3).map((function(e){return e.name})).join(" 、 "):e.slice(0,3).map((function(e){return e})).join(" 、 "),"..."))}return Array.isArray(e)&&e.length<=3&&e.length>0?E.createElement("div",null,"inspect"===t?e.map((function(e){return e.name})).join("、"):e.map((function(e){return e})).join("、")):"--"})),(0,y.Z)((0,u.Z)(d),"renderAssociatedList",(function(){var e=d.props.relationOrderList,t=void 0===e?{}:e,a=b().get(t,"data",[]),n=[{title:"审批单标题",dataIndex:"name",fixed:"left",width:150,render:function(e){return e||"--"}},{title:"审批单号",dataIndex:"_id",fixed:"left",width:120,render:function(e){return e||"--"}},{title:"主题标签",width:150,dataIndex:"theme_label_list",render:function(e){return d.renderTags(e)}},{title:"验票标签",dataIndex:"inspect_bill_label_list",width:150,render:function(e){return d.renderTags(e,"inspect")}},{title:"归属",width:120,dataIndex:"cost_center_type",render:function(e,t){return t.order_type===O.phB.new?e?O.Xr3.description(e):"--":t.order_type===O.phB.old?e>=100?k.z0.titleByKey(e):e?O.ZBL.description(e):"--":"--"}},{title:"发票抬头",dataIndex:"invoice_title",width:150,render:function(e){return e||"--"}},{title:"付款金额",dataIndex:"paid_money",width:120,render:function(e){return e?O.fbc.exchangePriceCentToMathFormat(e):"0.00"}},{title:"申请人",dataIndex:["apply_account_info","name"],width:120,render:function(e){return e||"--"}},{title:"提报时间",dataIndex:"submit_at",width:150,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"付款时间",dataIndex:"paid_at",width:150,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"流程状态",dataIndex:"state",width:120,render:function(e){return O.DU5.description(e)||"--"}},{title:"操作",dataIndex:"operation",fixed:"right",width:80,render:function(e,t){return O.DU5.pendding!==t.state&&T.ZP.canOperateModuleCodeOrderDetail()?t.order_type===O.phB.new?E.createElement("a",{key:"delete",target:"_blank",rel:"noopener noreferrer",href:"/#/Code/PayOrder/Detail?orderId=".concat(t._id,"&isShowOperation=true")},"查看"):t.order_type===O.phB.old?E.createElement("a",{key:"detail",href:"javascript:void(window.open('/#/Expense/Manage/ExamineOrder/Detail?orderId=".concat(t._id,"'));"),rel:"noopener noreferrer",className:P.Z["app-comp-expense-exam-order-Table-operate-btn"]},"查看"):"--":"--"}}];return E.createElement(c.Z,{rowKey:function(e){return e._id},dataSource:a,columns:n,pagination:!1,bordered:!0,scroll:{x:1580}})})),(0,y.Z)((0,u.Z)(d),"renderAssociatedInfo",(function(){var e=d.state.associatedId,t=d.props.relationOrderList,a=b().get(t,"data",[]).map((function(e){return e._id})),c=E.createElement("span",{className:P.Z["app-comp-expense-associated-info-wrap"],key:"success"},a.map((function(e,t){return E.createElement("span",{key:t},E.createElement("a",{key:"delete",target:"_blank",rel:"noopener noreferrer",className:P.Z["app-comp-expense-associated-info-link"],href:"/#/Code/PayOrder/Detail?orderId=".concat(e,"&isShowOperation=true")},e),E.createElement(I.Z,{className:P.Z["app-comp-expense-associated-info-icon"],onClick:function(){return d.onDeleteAssociatedOrder(e)}}))})));return E.createElement(E.Fragment,null,E.createElement(n.Z,{type:"flex",align:"middle"},E.createElement(l.Z,{span:24},E.createElement(n.Z,null,E.createElement(l.Z,{span:2,className:P.Z["app-comp-expense-associated-info-input-label"]},E.createElement("span",{className:P.Z["app-comp-expense-associated-info-wrap"]},"关联审批单:")),E.createElement(l.Z,{span:6,className:P.Z["app-comp-expense-associated-info-input"]},E.createElement(o.Z,{placeholder:"请输入关联审批单号",value:e,onChange:d.onChangeAssociated})),E.createElement(l.Z,{span:2,className:P.Z["app-comp-expense-associated-info-btn"]},E.createElement(r.Z,{type:"primary",onClick:d.onSubmitAssociated},"确定")),E.createElement(l.Z,{span:12,className:P.Z["app-comp-expense-associated-info-content"]},E.createElement("span",null,c)))),E.createElement(l.Z,{span:24,className:P.Z["app-comp-expense-associated-info-table-wrap"]},E.createElement(n.Z,null,E.createElement(l.Z,{span:2,className:P.Z["app-comp-expense-associated-info-list-table"]},"关联审批单列表:"),E.createElement(l.Z,{span:21,className:P.Z["app-comp-expense-associated-info-list"]},d.renderAssociatedList())))))})),d.state={associatedId:void 0},d}return(0,d.Z)(a,[{key:"componentDidMount",value:function(){this.onInterfaceDetail()}},{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"codeOrder/reduceRelationOrderList",payload:{}})}},{key:"render",value:function(){return E.createElement(g.Z,null,E.createElement(F,{header:"关联信息"},this.renderAssociatedInfo()))}}]),a}(E.Component);(0,y.Z)(D,"propTypes",{orderId:Z().string}),(0,y.Z)(D,"defaultProps",{orderId:""});t.Z=(0,h.connect)((function(e){return{relationOrderList:e.codeOrder.relationOrderList}}))(D)},33185:function(e,t,a){var n=a(87462),r=(a(29093),a(16317)),o=a(93517),l=a.n(o),c=a(67294),i=a(55609),s=a(8240),p=r.Z.Option;t.Z=(0,i.connect)((function(e){return{codeBusAccount:e.codeCommon.codeBusAccount}}))((function(e){var t=e.dispatch,a=e.orderId,o=e.subjectId;(0,c.useEffect)((function(){a&&o&&t({type:"codeCommon/fetchCodeBusinessAccounting",payload:{orderId:a,subjectId:o}}),t({type:"codeCommon/reduceCodeBusinessAccounting",payload:[]})}),[t,a,o]);var i=(0,s.CE)(["dispatch","codeBusAccount","orderId","subjectId"],e),d=l().get(e,"codeBusAccount",[]).map((function(e){return c.createElement(p,{key:e._id,item:e,value:e._id},e.name)}));return c.createElement(r.Z,(0,n.Z)({},i,{onChange:function(t,a){var n=a.item,r=void 0===n?{}:n;e.onChange&&e.onChange(t,r)}}),d)}))},52651:function(e,t,a){a.d(t,{Z:function(){return N}});a(52560);var n=a(71577),r=(a(13062),a(71230)),o=(a(89032),a(15746)),l=(a(36616),a(51368)),c=(a(36037),a(47933)),i=a(93433),s=a(15671),p=a(43144),d=a(97326),u=a(60136),m=a(82963),f=a(61120),_=a(4942),y=a(94315),g=a.n(y),v=a(93517),b=a.n(v),h=a(67294),E=a(1058),C=a(49101),Z=a(55609),x=a(80385),w=a(29439),I=(a(29093),a(16317)),O=I.Z.Option;var P=(0,Z.connect)((function(e){return{collectionCardNum:e.expenseCostOrder.collectionCardNum}}))((function(e){var t=e.dispatch,a=e.collectionCardNum,n=void 0===a?{}:a,r=e.namespace,o=e.isUpdateRule,l=e.card_name,c=e.bank_details,s=e.placeholder,p=e.disabled,d=e.value,u=void 0===d?void 0:d,m=e.onChange,f=e.update,_=(0,h.useRef)(!1),y=(0,h.useState)([]),v=(0,w.Z)(y,2),b=v[0],E=v[1],C=function(){_.current=!1};return(0,h.useEffect)((function(){return!0!==o&&g().existy(l)&&g().not.empty(l)&&g().existy(c)&&g().not.empty(c)&&t({type:"expenseCostOrder/fetchCollectionCardNum",payload:{card_name:l,bank_details:c,namespace:r,onSucessCallback:C}}),t({type:"expenseCostOrder/reduceCollectionCardNum",payload:{namespace:r,result:{}}}),function(){t({type:"expenseCostOrder/reduceCollectionCardNum",payload:{namespace:r,result:{}}})}}),[t,o,r,l,c]),(0,h.useEffect)((function(){var e=n[r]||[];E(e)}),[n,r]),(0,h.useEffect)((function(){var e=n[r]||[];(g().not.existy(e)||g().empty(e))&&(_.current=!1),!0!==f&&!1===_.current&&void 0===u&&g().existy(e)&&g().not.empty(e)&&m&&(m(e[0]),_.current=!0)}),[n,r,m,u,f]),h.createElement(I.Z,{value:u,showSearch:!0,placeholder:s,onSearch:function(e){var t=e.replace(/\s+/g,""),a=n[r]||[];!a.includes(t)&&t&&/^([0-9]{1,99})$/.test(t)&&E([].concat((0,i.Z)(a),[t]))},onChange:function(e){m&&m(e)},style:{width:"100%"},disabled:p,dropdownMatchSelectWidth:!1},b.map((function(e,t){return h.createElement(O,{key:t,value:e},e)})))})),k=I.Z.Option;var T=(0,Z.connect)((function(e){return{collectionBankDetails:e.expenseCostOrder.collectionBankDetails}}))((function(e){var t=e.dispatch,a=e.collectionBankDetails,n=void 0===a?{}:a,r=e.namespace,o=e.isUpdateRule,l=e.card_name,c=e.placeholder,s=e.disabled,p=e.value,d=void 0===p?void 0:p,u=e.onChange,m=e.update,f=(0,h.useRef)(!1),_=(0,h.useState)([]),y=(0,w.Z)(_,2),v=y[0],b=y[1],E=function(){f.current=!1};return(0,h.useEffect)((function(){return!0!==o&&g().existy(l)&&g().not.empty(l)&&(t({type:"expenseCostOrder/reduceCollectionBankDetails",payload:{namespace:r,result:{}}}),t({type:"expenseCostOrder/fetchCollectionBankDetails",payload:{card_name:l,namespace:r,onSucessCallback:E}})),function(){t({type:"expenseCostOrder/reduceCollectionBankDetails",payload:{namespace:r,result:{}}}),f.current=!1}}),[t,o,r,l]),(0,h.useEffect)((function(){var e=n[r]||[];b(e)}),[n,r]),(0,h.useEffect)((function(){var e=n[r]||[];!0!==m&&!0===f.current&&(g().not.existy(e)||g().empty(e))&&u&&(f.current=!1,u(void 0)),!0!==m&&!1===f.current&&void 0===d&&g().existy(e)&&g().not.empty(e)&&u&&(u(e[0]),f.current=!0)}),[n,r,u,d,m]),h.createElement(I.Z,{value:d,showSearch:!0,placeholder:c,onSearch:function(e){var t=e.replace(/\s+/g,""),a=n[r]||[];!a.includes(t)&&t&&b([].concat((0,i.Z)(a),[t]))},onChange:function(e){u&&u(e)},style:{width:"100%"},disabled:s,dropdownMatchSelectWidth:!1},v.map((function(e,t){return h.createElement(k,{key:t,value:e},e)})))})),S=I.Z.Option;var F=(0,Z.connect)((function(e){return{collectionCardName:e.expenseCostOrder.collectionCardName}}))((function(e){var t=e.dispatch,a=e.collectionCardName,n=void 0===a?{}:a,r=e.namespace,o=e.isUpdateRule,l=e.placeholder,c=e.disabled,s=e.value,p=void 0===s?void 0:s,d=(0,h.useState)([]),u=(0,w.Z)(d,2),m=u[0],f=u[1];return(0,h.useEffect)((function(){return!0!==o&&t({type:"expenseCostOrder/fetchCollectionCardName",payload:{namespace:r}}),function(){t({type:"expenseCostOrder/reduceCollectionCardName",payload:{namespace:r,result:{}}})}}),[t,o,r]),(0,h.useEffect)((function(){var e=n[r]||[];f(e)}),[n,r]),h.createElement(I.Z,{value:p,showSearch:!0,placeholder:l,onSearch:function(e){var t=e.replace(/\s+/g,""),a=n[r]||[];!a.includes(t)&&t&&f([].concat((0,i.Z)(a),[t]))},onChange:function(t){e.onChange&&e.onChange(t)},style:{width:"100%"},disabled:c},m.map((function(e,t){return h.createElement(S,{key:t,value:e},e)})))})),D=I.Z.Option;var M=(0,Z.connect)((function(e){return{collectionCardPhone:e.expenseCostOrder.collectionCardPhone}}))((function(e){var t=e.dispatch,a=e.collectionCardPhone,n=void 0===a?{}:a,r=e.namespace,o=e.isUpdateRule,l=e.card_name,c=e.placeholder,s=e.disabled,p=e.value,d=void 0===p?void 0:p,u=e.onChange,m=e.update,f=(0,h.useRef)(!1),_=function(){f.current=!1},y=(0,h.useState)([]),v=(0,w.Z)(y,2),b=v[0],E=v[1];return(0,h.useEffect)((function(){return!0!==o&&g().existy(l)&&g().not.empty(l)&&t({type:"expenseCostOrder/fetchCollectionCardPhone",payload:{card_name:l,namespace:r,onSucessCallback:_}}),function(){t({type:"expenseCostOrder/reduceCollectionCardPhone",payload:{namespace:r,result:{}}})}}),[t,o,r,l]),(0,h.useEffect)((function(){var e=n[r]||[];E(e)}),[n,r]),(0,h.useEffect)((function(){var e=n[r]||[];(g().not.existy(e)||g().empty(e))&&(f.current=!1),!0!==m&&!1===f.current&&void 0===d&&g().existy(e)&&g().not.empty(e)&&u&&(u(e[0]),f.current=!0)}),[n,u,d,r,m]),h.createElement(I.Z,{value:d,showSearch:!0,placeholder:c,onSearch:function(e){var t=e.replace(/\s+/g,""),a=n[r]||[];!a.includes(t)&&t&&/^([0-9]{1,11})$/.test(t)&&E([].concat((0,i.Z)(a),[t]))},onSelect:function(e){u&&u(e)},style:{width:"100%"},disabled:s},b.map((function(e,t){return h.createElement(D,{key:t,value:e},e)})))})),j="u3_8ICxMRKI7Cuz3DM95";function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,f.Z)(e);if(t){var r=(0,f.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,m.Z)(this,a)}}var A=function(e){(0,u.Z)(a,e);var t=Y(a);function a(){var e;return(0,s.Z)(this,a),e=t.call(this),(0,_.Z)((0,d.Z)(e),"onChangeCardName",(function(t,a){var n=e.props,r=n.value,o=n.dispatch,l=n.formKey;r[a].card_name=String(t).replace(/\s*/g,""),r[a].card_phone=void 0,r[a].bank_details=void 0,r[a].card_num=void 0,r[a].flag=!1,o({type:"expenseCostOrder/reduceCollectionCardPhone",payload:{namespace:"namespaceCardPhone".concat(l).concat(r[a].num),result:{}}}),e.props.onChange&&(r[a].card_phone&&t?(r[a].loading=!0,e.props.dispatch({type:"employeeManage/fetchEmployeeDetail",payload:{phone:r[a].card_phone,name:t,fileType:"staff",onSuccessCallback:function(t){return e.onSuccessCallback(t,a)}}})):(r[a].payee_type=x.vaC.onlineBanking,r[a].payee_employee_id=void 0,r[a].flag=!1,r[a].card_phone=void 0),e.props.onChange((0,i.Z)(r)))})),(0,_.Z)((0,d.Z)(e),"onChangeBankName",(function(t,a){var n=e.props.value;n[a].bank_details=t,n[a].card_num=void 0,n[a].flag=!1,e.props.onChange&&e.props.onChange((0,i.Z)(n))})),(0,_.Z)((0,d.Z)(e),"onChangeCardNum",(function(t,a){var n=e.props.value;n[a].card_num=t,n[a].flag=!1,e.props.onChange&&e.props.onChange((0,i.Z)(n))})),(0,_.Z)((0,d.Z)(e),"onChangeBankMoney",(function(t,a){var n=e.props.value;g().not.existy(t)||g().empty(t)?n[a].money=void 0:(n[a].money=t,t>x.fbc.maxMoney&&(n[a].money=x.fbc.maxMoney)),e.props.onChange&&e.props.onChange((0,i.Z)(n))})),(0,_.Z)((0,d.Z)(e),"onChangePhone",(function(t,a){var n=e.props.value;n[a].card_phone=t,n[a].flag=!1,e.props.onChange&&(n[a].loading=!0,n[a].card_name&&t&&e.props.dispatch({type:"employeeManage/fetchEmployeeDetail",payload:{phone:t,name:n[a].card_name,fileType:"staff",onSuccessCallback:function(t){return e.onSuccessCallback(t,a)}}}),e.props.onChange((0,i.Z)(n)))})),(0,_.Z)((0,d.Z)(e),"onChangeBankType",(function(t,a){var n=e.props.value;n[a].payee_type=t.target.value,e.props.onChange&&e.props.onChange((0,i.Z)(n))})),(0,_.Z)((0,d.Z)(e),"onSuccessCallback",(function(t,a){var n=e.props.value;if(n[a].loading=!1,g().not.existy(t)||g().empty(t))return n[a].payee_employee_id=void 0,n[a].payee_type=x.vaC.onlineBanking,n[a].flag=!1,void(e.props.onChange&&e.props.onChange((0,i.Z)(n)));g().existy(t)&&g().not.empty(t)&&(n[a].payee_employee_id=t._id,n[a].payee_type=x.vaC.wallet,n[a].flag=!1,e.props.onChange&&e.props.onChange((0,i.Z)(n)))})),(0,_.Z)((0,d.Z)(e),"onCreate",(function(t){var a=e.props.value,n=a[t].num+1;e.props.onChange&&e.props.onChange([].concat((0,i.Z)(a),[{payee_type:x.vaC.onlineBanking,num:n}]))})),(0,_.Z)((0,d.Z)(e),"onDelete",(function(t){var a=e.props.value.filter((function(e,a){return a!==t}));e.props.onChange&&e.props.onChange((0,i.Z)(a))})),(0,_.Z)((0,d.Z)(e),"renderItem",(function(t,a){var i=e.props,s=i.disabled,p=i.isUpdateRule,d=i.value,u=void 0===d?{}:d,m=i.formKey,f=b().get(t,"card_name",void 0),_=[{label:h.createElement("span",{className:j},"收款人"),render:h.createElement(F,{value:f,namespace:"namespaceCardName".concat(m).concat(t.num),placeholder:"请填写收款人",onChange:function(t){return e.onChangeCardName(t,a)},style:{width:"100%"},disabled:p||s})},{label:b().get(t,"payee_type",void 0)===x.vaC.wallet?h.createElement("span",{className:j},"手机号"):"手机号",render:h.createElement(M,{value:b().get(t,"card_phone",void 0),namespace:"namespaceCardPhone".concat(m).concat(t.num).concat(f),card_name:f,disabled:p||s,onChange:function(t){return e.onChangePhone(t,a)},update:u[a].flag,placeholder:"请输入手机号"})},{label:"收款方式",render:h.createElement(c.ZP.Group,{value:b().get(t,"payee_type",void 0),style:{display:"flex"},disabled:p||s,onChange:function(t){return e.onChangeBankType(t,a)}},h.createElement(c.ZP,{disabled:!b().get(t,"payee_employee_id",void 0),value:x.vaC.wallet},x.vaC.description(x.vaC.wallet)),h.createElement(c.ZP,{value:x.vaC.onlineBanking},x.vaC.description(x.vaC.onlineBanking)))},{label:h.createElement("span",{className:j},"开户支行"),render:h.createElement(T,{value:b().get(t,"bank_details",void 0),namespace:"namespaceBankDetails".concat(m).concat(t.num).concat(f),placeholder:"请填写开户支行",card_name:f,onChange:function(t){return e.onChangeBankName(t,a)},update:t.flag,disabled:p||s})},{label:h.createElement("span",{className:j},"收款账户"),render:h.createElement(P,{value:b().get(t,"card_num",void 0),namespace:"namespaceCardNum".concat(m).concat(t.num).concat(f),placeholder:"请填写收款账号",card_name:f,bank_details:b().get(t,"bank_details",void 0),update:t.flag,onChange:function(t){return e.onChangeCardNum(t,a)},disabled:p||s})},{label:h.createElement("span",{className:j},"金额(元)"),render:h.createElement(l.Z,{value:b().get(t,"money",void 0),style:{width:"100%"},onChange:function(t){return e.onChangeBankMoney(t,a)},precision:2,min:.01,max:x.fbc.maxMoney,formatter:x.fbc.maxMoneyLimitDecimalsFormatter,parser:x.fbc.limitDecimalsParser,placeholder:"请填写金额"})}];return h.createElement(r.Z,{key:t.num},h.createElement(o.Z,{span:22},h.createElement(r.Z,null,_.map((function(e,t){return h.createElement(o.Z,{key:t,span:8,style:{display:"flex",alignItems:"center",marginTop:10}},h.createElement(o.Z,{style:{textAlign:"right",marginRight:10},span:8},e.label,": "),h.createElement(o.Z,{span:14},e.render))})))),h.createElement(o.Z,{span:2},1!==u.length?h.createElement(n.Z,{size:"small",onClick:function(){return e.onDelete(a)},style:{marginRight:10,marginTop:13},disabled:p||s,shape:"circle",icon:h.createElement(E.Z,null)}):null,u.length-1===a?h.createElement(n.Z,{size:"small",style:{marginTop:13},onClick:function(){return e.onCreate(a)},disabled:p||s,shape:"circle",icon:h.createElement(C.Z,null)}):null))})),(0,_.Z)((0,d.Z)(e),"renderContent",(function(){var t=e.props.value;return(void 0===t?[]:t).map((function(t,a){return e.renderItem(t,a)}))})),e.state={},e}return(0,p.Z)(a,[{key:"render",value:function(){return h.createElement(h.Fragment,null,this.renderContent())}}]),a}(h.Component),N=(0,Z.connect)()(A)},13328:function(e,t,a){a(29093);var n=a(16317),r=a(93517),o=a.n(r),l=a(67294),c=a(55609),i=a(8240),s=n.Z.Option;t.Z=(0,c.connect)((function(e){return{subjects:e.codeCommon.subjects}}))((function(e){var t=e.dispatch,a=e.orderId;(0,l.useEffect)((function(){t({type:"codeCommon/fetchSubject",payload:{orderId:a}})}),[t,a]);var r=(0,i.CE)(["dispatch","orderId","subjects"],e),c=o().get(e,"subjects",[]).map((function(e){return l.createElement(s,{key:e._id,value:e._id},e.name,"(",e.ac_code,")")}));return l.createElement(n.Z,r,c)}))},90652:function(e,t,a){a(29093);var n=a(16317),r=a(93517),o=a.n(r),l=a(67294),c=a(55609),i=a(8240),s=n.Z.Option;t.Z=(0,c.connect)((function(e){return{teamBusAccount:e.codeCommon.teamBusAccount}}))((function(e){var t=e.dispatch,a=e.orderId,r=e.subjectId;(0,l.useEffect)((function(){a&&r&&t({type:"codeCommon/fetchTeamBusinessAccounting",payload:{orderId:a,subjectId:r}}),t({type:"codeCommon/reduceTeamBusinessAccounting",payload:[]})}),[t,a,r]);var c=(0,i.CE)(["dispatch","teamBusAccount","orderId","subjectId"],e),p=o().get(e,"teamBusAccount",[]).map((function(e){return l.createElement(s,{key:e._id,value:e._id},e.name)}));return l.createElement(n.Z,c,p)}))},15727:function(e,t,a){a(29093);var n=a(16317),r=a(93517),o=a.n(r),l=a(67294),c=a(55609),i=a(8240),s=a(80385),p=n.Z.Option;t.Z=(0,c.connect)((function(e){return{enumeratedValue:e.applicationCommon.enumeratedValue}}))((function(e){var t,a=e.dispatch,r=e.orderId,c=e.costCenterType;c===s.G$J.code&&(t="codeInvoiceTitles"),c===s.G$J.team&&(t="teamInvoiceTitles"),(0,l.useEffect)((function(){a({type:"applicationCommon/getEnumeratedValue",payload:{enumeratedType:t}})}),[a,r,t]);var d=(0,i.CE)(["dispatch","orderId","enumeratedValue","costCenterType"],e),u=o().get(e,"enumeratedValue.".concat(t),[]).map((function(e){return l.createElement(p,{key:e.name,value:e.name},e.name)}));return l.createElement(n.Z,d,u)}))},61816:function(e,t){t.Z={"code-approveOder-btn":"I4p9cShfO4cAllQnUC_T","code-approveOder-title":"Cpyg9yf9mw84l7hV9PPA"}}}]);