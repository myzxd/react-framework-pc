"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[5141],{95141:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var r=n(4942),o=n(55609),a=n(67294),c=n(80385),l=(n(35668),n(86585)),i=(n(9070),n(20924)),d=(n(29093),n(16317)),s=n(96036),u=d.Z.Option,f=function(e){var t=e.onSearch,n=e.onReset,r={items:[a.createElement(l.Z.Item,{label:"审批流名称",name:"name"},a.createElement(i.Z,{placeholder:"请输入",allowClear:!0})),a.createElement(l.Z.Item,{label:"成本中心类型",name:"type"},a.createElement(d.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0},a.createElement(u,{value:c.Xr3.code},c.Xr3.description(c.Xr3.code)),a.createElement(u,{value:c.Xr3.team},c.Xr3.description(c.Xr3.team)))),a.createElement(l.Z.Item,{label:"状态",name:"state"},a.createElement(d.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0},a.createElement(u,{value:c.ZAv.normal},c.ZAv.description(c.ZAv.normal)),a.createElement(u,{value:c.ZAv.deactivate},c.ZAv.description(c.ZAv.deactivate)),a.createElement(u,{value:c.ZAv.draft},c.ZAv.description(c.ZAv.draft))))],onSearch:t,onReset:n};return a.createElement(s.IT,null,a.createElement(s.j6,r))},p=(n(20186),n(75385)),m=(n(18085),n(55241)),w=(n(21316),n(75443)),v=n(15861),h=(n(51838),n(48086)),g=(n(52466),n(10642)),y=n(87757),Z=n.n(y),b=n(30381),E=n.n(b),O=(n(52560),n(71577)),S=n(87462),x=n(29439);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={labelCol:{span:6},wrapperCol:{span:16}},j=function(e){var t=e.dispatch,n=l.Z.useForm(),r=(0,x.Z)(n,1)[0],o=(0,a.useState)(!1),d=(0,x.Z)(o,2),s=d[0],u=d[1],f=function(){var e=(0,v.Z)(Z().mark((function e(){var n,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.validateFields();case 2:return n=e.sent,e.next=5,t({type:"codeFlow/createFlow",payload:F({},n)});case 5:(o=e.sent)&&o._id?(h.ZP.success("请求成功"),window.location.href="/#/Code/BasicSetting/Flow/Form?flowId=".concat(o._id)):o.zh_message&&h.ZP.error(o.zh_message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){r.resetFields(),u(!1)};return a.createElement(a.Fragment,null,a.createElement(g.Z,{title:"新建审批流",visible:s,onOk:f,destroyOnClose:!0,onCancel:p},a.createElement(l.Z,{form:r,preserve:!1,className:"affairs-flow-basic"},a.createElement(l.Z.Item,(0,S.Z)({label:"名称",name:"name",rules:[{required:!0,message:"请输入审批流名称"},{pattern:/^\S+$/,message:"审批流名称不能包含空格"}]},C),a.createElement(i.Z,{placeholder:"请输入审批流名称"})),a.createElement(l.Z.Item,(0,S.Z)({label:"审批流类型"},C),c.KoE.description(c.KoE.payment)))),a.createElement(O.Z,{type:"primary",onClick:function(){return u(!0)}},"新增审批流"))},_=n(45430),A=n(88486),D=g.Z.error,I=function(e){var t=e.onShowSizeChange,n=void 0===t?function(){}:t,r=e.onChangePage,o=void 0===r?function(){}:r,l=e.flowList,i=void 0===l?{}:l,d=e.dispatch,u=e.getFlowList,f=void 0===u?function(){}:u,g=i.data,y=void 0===g?[]:g,b=i._meta,O=void 0===b?{}:b,S=function(e){D({title:"提示：",content:e.zh_message,maskClosable:!0,okText:"确定"})},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e&&e._id?(h.ZP.success("请求成功"),f&&f()):(t&&S(e),!t&&e.zh_message&&h.ZP.error(e.zh_message))},P=function(){var e=(0,v.Z)(Z().mark((function e(t){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({type:"codeFlow/setFlowState",payload:{flowId:t,state:c.ZAv.delete}});case 2:n=e.sent,x(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,v.Z)(Z().mark((function e(t){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({type:"codeFlow/setFlowState",payload:{flowId:t,state:c.ZAv.normal}});case 2:n=e.sent,x(n,"enable");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,v.Z)(Z().mark((function e(t){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({type:"codeFlow/setFlowState",payload:{flowId:t,state:c.ZAv.deactivate}});case 2:n=e.sent,x(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e){var t=e.handle_list,n=void 0===t?[]:t,r=_.ZP.canOperateModuleCodeFlowOp(),o=_.ZP.canOperateModuleCodeFlowDetail(),c=n.includes("view")&&o,l=n.includes("edit")&&r,i=n.includes("delete")&&r,d=n.includes("enable")&&r,s=n.includes("disable")&&r;return a.createElement(a.Fragment,null,c&&function(e){return a.createElement("a",{href:"/#/Code/BasicSetting/Flow/Detail?flowId=".concat(e._id)},"查看")}(e),l&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.createElement("a",{href:"/#/Code/BasicSetting/Flow/Form?flowId=".concat(e._id),className:"common-table-list-operate"},"编辑")}(e),i&&function(e){return a.createElement(w.Z,{title:"您是否确定删除该审批流",onConfirm:function(){return P(e._id)},okText:"确定",cancelText:"取消"},a.createElement("a",{className:"common-table-list-operate"},"删除"))}(e),d&&function(e){return a.createElement(w.Z,{title:"您是否确定启用该审批流",onConfirm:function(){return F(e._id)},okText:"确定",cancelText:"取消"},a.createElement("a",{className:"common-table-list-operate"},"启用"))}(e),s&&function(e){return a.createElement(w.Z,{title:"您是否确定停用该审批流",onConfirm:function(){return C(e._id)},okText:"确定",cancelText:"取消"},a.createElement("a",{className:"common-table-list-operate"},"停用"))}(e),0===n.length&&!r&&"--")},k=[{title:"审批流名称",dataIndex:"name"},{title:"成本中心类型",dataIndex:"cost_center_types",render:function(e){return Array.isArray(e)&&e.length>0?e.map((function(e){return c.Xr3.description(e)})).join("，"):"--"}},{title:"创建日期",dataIndex:"created_at",render:function(e){return e?E()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"更新日期",dataIndex:"updated_at",render:function(e){return e?E()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"创建人",dataIndex:["creator_info","name"],render:function(e){return e||"--"}},{title:"描述",dataIndex:"note",render:function(e){return""!==e&&e?a.createElement("div",null,e.length<=8?e:a.createElement(m.Z,{content:a.createElement("div",{className:A.Z["code-flow-list-note"]},e),title:"审批流描述",trigger:"hover"},a.createElement("div",null,e.length<=8?e:e.substr(0,8)))):"--"}},{title:"状态",dataIndex:"state",render:function(e){return e?c.ZAv.description(e):"--"}},{title:"操作",dataIndex:"_id",key:"operate",render:function(e,t){return I(t)}}],L={current:O.page||1,defaultPageSize:30,pageSize:O.page_size||30,showQuickJumper:!0,showSizeChanger:!0,onChange:o,onShowSizeChange:n,showTotal:function(e){return"总共".concat(e,"条")},total:O.result_count,pageSizeOptions:["10","20","30","40"]},z=_.ZP.canOperateModuleCodeFlowOp()?a.createElement(j,{dispatch:d}):"";return a.createElement(s.IT,{title:"审批流列表",titleExt:z},a.createElement(p.Z,{rowKey:function(e,t){return e._id||t},columns:k,dataSource:y,pagination:L,bordered:!0,scroll:{y:500}}))};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=(0,o.connect)((function(e){return{flowList:e.codeFlow.flowList}}))((function(e){var t=e.dispatch,n=e.flowList,r=void 0===n?{}:n,o=(0,a.useRef)({page:1,limit:30});(0,a.useEffect)((function(){return t({type:"codeFlow/getFlowList",payload:L({},o.current)}),function(){t({type:"codeFlow/resetFlowList"})}}),[t]);var l=function(){t({type:"codeFlow/getFlowList",payload:L({},o.current)})},i=function(e,t){o.current=L(L({},o.current),{},{page:e,limit:t}),l()},d={onSearch:function(e){o.current=L(L(L({},o.current),e),{},{page:1,limit:30}),l()},onReset:function(e){o.current=L(L(L({},o.current),e),{},{page:1,limit:30,state:[c.ZAv.draft,c.ZAv.normal,c.ZAv.deactivate]}),l()}},s={onChangePage:i,onShowSizeChange:i,flowList:r,dispatch:t,getFlowList:l};return a.createElement(a.Fragment,null,a.createElement(f,d),a.createElement(I,s))}))},88486:function(e,t){t.Z={"code-flow-list-note":"L6LvS5OvWFo47ttMdWzl","code-flow-node-time-title-wrap":"DlJolND_tSk1nt4RZPzZ","code-flow-node-time-name":"pmiUtGLgXBFRjRSTK5vo","code-flow-node-time-approve-name":"AOAJLXHUzIZvcgLR28sX","code-flow-applicant-node":"Fk0ujLOTmjlywN1F9PmS","code-flow-update-node-title":"YGigFsXncpmdCHaN1Mcs","code-flow-update-node-form":"fYfTgvNcTcj_4GzvMTwj","code-flow-node-round":"LlhEWH9UPfoQ19_dtnYb","code-flow-update-node-approve":"DAlGqqbHwGLEVe1JqVw4","code-flow-update-node-mode":"IS0KqfnRDNHtOh0tqpct","code-flow-update-node-operate":"dP203f1sMZ1atZVHPnzK","code-flow-update-node-operate-modify":"flMDUSOLSmEz7hYJOlje","code-flow-update-node-operate-delete":"CI9K88GyyjoByTWAo9mN","code-flow-update-report-node":"kvBa8Ztd4gbucrRpA1lI","code-flow-update-node-arrow":"dLoy0fZ6T2cSQGAkDx9A","code-flow-update-node-wrap":"CQiDaMmctMy7NEP4RELw","code-flow-update-node-create":"li9lMghyDq8HrhzDD_jx","flow-node-radio-form":"FXXUGMr94oYGsobC3vZA","flow-node-radio-form-item":"W9Vqk7vNbvLuDyXZcnVG","flow-node-radio-form-coopera":"lDYY9Kq553vaSsqPuEdg","flow-node-customize-form":"i8_siaSaN5ANy4yRAhG_","flow-enable-error-prompt":"ubBeGPDP4qS48qoxGkSV","code-flow-basic-form-hightest":"mlzTugcGQIKCbRQRELTR","app-expense-examine-flow-cc-title":"Lx25xDAYqw1yIc_xf4kN","app-expense-examine-flow-cc-comment":"TidC9Vz9YQpMmM44IyWe","app-expense-examine-flow-cc-update-title":"tkO0AMpkNWWxMuyJLzXi","affairs-flow-update-node-cc-wrap":"SlSayhLbffNngtwHPjNR","affairs-flow-update-node-cc-info":"C9QBjpR8R7KmYDPTrPc0","affairs-flow-update-node-cc-info-arrow":"rC11BmJDeQVei8qR5LEI"}}}]);