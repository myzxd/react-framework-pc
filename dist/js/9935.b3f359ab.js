"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[9935],{8212:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(1413),r=n(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},i=n(30076),l=function(e,t){return r.createElement(i.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:t,icon:o}))};l.displayName="EditOutlined";var c=r.forwardRef(l)},61397:function(e,t,n){n(29093);var a=n(16317),r=n(55609),o=n(67294),i=(n(80385),a.Z.Option);t.Z=(0,r.connect)((function(e){return{subjectList:e.codeFlow.subjectList}}))((function(e){var t=e.dispatch,n=e.subjectList,r=void 0===n?{}:n,l=e.value,c=e.onChange,d=e.type,s=e.selectDisabled;(0,o.useEffect)((function(){return t({type:"codeFlow/getSubjectList",payload:{page:1,limit:9999,type:d}}),function(){t({type:"codeFlow/resetSubjectList"})}}),[t,d]);var u=r.data,p=void 0===u?[]:u;return o.createElement(a.Z,{value:l,onChange:c,placeholder:"请选择",mode:"multiple",allowClear:!0,showSearch:!0,optionFilterProp:"children",disabled:s,showArrow:!0},p.map((function(e){return o.createElement(i,{value:"".concat(e._id,"=").concat(e.ac_code),key:e._id},e.name,"(",e.ac_code,")")})))}))},89935:function(e,t,n){n.r(t),n.d(t,{default:function(){return he}});n(52560);var a=n(71577),r=(n(51838),n(48086)),o=n(4942),i=n(15861),l=(n(62004),n(11382)),c=n(29439),d=n(87757),s=n.n(d),u=n(93517),p=n.n(u),f=n(55609),m=n(67294),v=n(93433),g=(n(26574),n(9676)),Z=n(87462),y=(n(55295),n(69713)),w=(n(35668),n(86585)),b=(n(9070),n(20924)),E=(n(29093),n(16317)),_=n(94315),h=n.n(_),C=n(68628),j=n(80385),O=n(96036),P=n(5961),x=n(1846),I=n(88486);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=E.Z.Option,F=function(e){var t=e.value,n=e.onChange,a=(0,m.useState)(t.type),r=(0,c.Z)(a,2),o=r[0],i=r[1],l=(0,m.useState)([]),d=(0,c.Z)(l,2),s=d[0],u=d[1],p=(0,m.useState)([]),f=(0,c.Z)(p,2),v=f[0],g=f[1],Z=function(e){n&&n(N(N({type:o,tags:s,post:v},t),e))},y=function(e){"tags"in t||u(e),Z({tags:e})},w=function(e){"post"in t||g(e),Z({post:e})};return m.createElement("div",{className:I.Z["code-flow-basic-form-hightest"]},m.createElement(E.Z,{allowClear:!0,showSearch:!0,value:t.type,onChange:function(e){i(e),Z({type:e,tags:[],post:[]})},placeholder:"请选择",style:{width:"28%",height:"100%"}},m.createElement(S,{value:j.mqh.tag},j.mqh.description(j.mqh.tag)),m.createElement(S,{value:j.mqh.post},j.mqh.description(j.mqh.post))),o===j.mqh.tag?m.createElement(P.Z,{value:t.tags,onChange:y}):o===j.mqh.post?m.createElement(x.Z,{value:t.post,onChange:w}):void 0)},k=(n(88775),n(12010)),L=k.Z.SHOW_PARENT,A=(0,f.connect)((function(e){return{flowCodeList:e.codeFlow.flowCodeList}}))((function(e){var t=e.value,n=void 0===t?[]:t,a=e.onChange,r=e.flowCodeList,o=void 0===r?[]:r;if(!Array.isArray(o)||o.length<1)return m.createElement(E.Z,{placeholder:"请选择"});var i=[{title:"全部",value:"*=全部",key:"*=全部",children:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return{title:t.name,value:"".concat(t._id,"=").concat(t.name),key:"".concat(t._id,"=").concat(t.name),children:e(t.children)}}))}(o)}],l={treeData:i,value:n,onChange:a,allowClear:!0,treeCheckable:!0,treeDefaultExpandAll:!0,placeholder:"请选择",showCheckedStrategy:L,style:{width:"100%"}};return m.createElement(k.Z,l)})),T=k.Z.SHOW_PARENT,X=(0,f.connect)((function(e){return{flowTeamList:e.codeFlow.flowTeamList}}))((function(e){var t=e.value,n=void 0===t?[]:t,a=e.onChange,r=e.flowTeamList,o=void 0===r?[]:r;if(!Array.isArray(o)||o.length<1)return m.createElement(E.Z,{placeholder:"请选择"});var i=[{title:"全部",value:"*=全部",key:"*=全部",children:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return{title:t.name,value:"".concat(t._id,"=").concat(t.name),key:"".concat(t._id,"=").concat(t.name),children:e(t.children)}}))}(o)}],l={treeData:i,value:n,onChange:a,allowClear:!0,treeCheckable:!0,treeDefaultExpandAll:!0,placeholder:"请选择",showCheckedStrategy:T,style:{width:"100%"}};return m.createElement(k.Z,l)})),q=E.Z.Option,z=b.Z.TextArea,H={labelCol:{span:3},wrapperCol:{span:14}},V=(0,m.forwardRef)((function(e,t){var n=e.flowDetail,a=void 0===n?{}:n,r=e.originCodeList,o=void 0===r?{}:r,i=e.originTeamList,l=void 0===i?{}:i,d=w.Z.useForm(),s=(0,c.Z)(d,1)[0],u=a.cost_center_types,f=void 0===u?[]:u,_=a.state,P=(0,m.useState)(f.includes(j.Xr3.code)),x=(0,c.Z)(P,2),I=x[0],D=x[1],N=(0,m.useState)(f.includes(j.Xr3.team)),S=(0,c.Z)(N,2),k=S[0],L=S[1],T=m.createElement("span",null,"最高审批岗位",m.createElement(y.Z,{title:"按照组织架构层级关系审批时设置终点"},m.createElement(C.Z,{style:{marginLeft:5}}))),V=[m.createElement(w.Z.Item,(0,Z.Z)({label:"审批流名称",name:"name",rules:[{required:!0,message:"请输入审批流名称"},{pattern:/^\S+$/,message:"审批流名称不能包含空格"}]},H),m.createElement(b.Z,{placeholder:"请填写内容"})),m.createElement(w.Z.Item,(0,Z.Z)({label:"审批流类型",className:"affairs-detail-form-item"},H),m.createElement("span",null,"付款类")),m.createElement(w.Z.Item,(0,Z.Z)({label:"适用成本中心场景",name:"type",rules:[{required:!0,message:"请输入适用成本中心场景"}]},H),m.createElement(g.Z.Group,{onChange:function(e){e.includes(j.Xr3.code)||s.setFieldsValue({code:[]}),e.includes(j.Xr3.team)||s.setFieldsValue({team:[]}),D(e.includes(j.Xr3.code)),L(e.includes(j.Xr3.team))},disabled:_===j.ZAv.deactivate},m.createElement(g.Z,{value:j.Xr3.code},j.Xr3.description(j.Xr3.code)),m.createElement(g.Z,{value:j.Xr3.team},j.Xr3.description(j.Xr3.team)))),m.createElement(w.Z.Item,(0,Z.Z)({label:"合并审批",name:"applicationRule",rules:[{required:!0,message:"请选择合并审批"}]},H),m.createElement(E.Z,{placeholder:"请选择合并审批"},m.createElement(q,{value:j.Ni9.continuous},j.Ni9.description(j.Ni9.continuous)),m.createElement(q,{value:j.Ni9.each},j.Ni9.description(j.Ni9.each)))),m.createElement(w.Z.Item,(0,Z.Z)({label:T,name:"highestPost"},H),m.createElement(F,null)),m.createElement(w.Z.Item,(0,Z.Z)({label:"描述",name:"note",rules:[{max:200,message:"字数过多"}]},H),m.createElement(z,{autoSize:{minRows:5},placeholder:"请输入审批流描述(选填)"}))],R=m.createElement(w.Z.Item,(0,Z.Z)({label:"适用code",name:"code",rules:[{required:I,message:"请选择"}]},H),m.createElement(A,null)),G=m.createElement(w.Z.Item,(0,Z.Z)({label:"适用team",name:"team",rules:[{required:k,message:"请选择"}]},H),m.createElement(X,null));I&&V.splice(3,0,R),k&&V.splice(3,0,G);var B={name:p().get(a,"name"),type:p().get(a,"cost_center_types",[]),code:function(){var e,t=p().get(a,"code_list",[]);if(t.find((function(e){return"*"===e._id})))return["*=全部"];var n=(e=[]).concat.apply(e,(0,v.Z)(Object.values(o)));return t.map((function(e){return n.filter((function(t){return t._id===e._id}))[0]||{}})).filter((function(e){return h().existy(e)&&h().not.empty(e)})).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(h().existy(e)&&h().not.empty(e))return"".concat(e._id,"=").concat(e.name)}))}(),team:function(){var e,t=p().get(a,"team_list",[]);if(t.find((function(e){return"*"===e._id})))return["*=全部"];var n=(e=[]).concat.apply(e,(0,v.Z)(Object.values(l)));return t.map((function(e){return n.filter((function(t){return t._id===e._id}))[0]||{}})).filter((function(e){return h().existy(e)&&h().not.empty(e)})).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(h().existy(e)&&h().not.empty(e))return"".concat(e._id,"=").concat(e.name)}))}(),applicationRule:p().get(a,"application_rule"),note:p().get(a,"note"),highestPost:{type:p().get(a,"final_type")?p().get(a,"final_type"):void 0,tags:p().get(a,"final_approval_job_tags",[]),post:p().get(a,"final_approval_job_ids",[])}};return(0,m.useImperativeHandle)(t,(function(){return s})),m.createElement(O.IT,{title:"审批流详情设置",className:"affairs-flow-basic"},m.createElement(w.Z,{form:s,initialValues:B},m.createElement(O.Fp,{items:V,cols:1})))})),R=V,G=(n(21316),n(75443)),B=(n(36037),n(47933)),M=(n(13062),n(71230)),U=(n(89032),n(15746)),W=n(8812),J=n(49101),Y=n(8212),K=n(73171),Q=n(1825),$=(n(48659),n(8240)),ee=(0,f.connect)((function(e){return{depAndPostTree:e.applicationCommon.depAndPostTree}}))((function(e){var t=e.value,n=e.onChange,a=e.dispatch,r=e.depAndPostTree,o=void 0===r?[]:r,i=e.isDisabledDep;(0,m.useEffect)((function(){Array.isArray(o)&&o.length>0||a({type:"applicationCommon/getDepAndPost"})}),[a]);return!Array.isArray(o)||o.length<1?m.createElement(E.Z,{placeholder:"请选择"}):m.createElement(k.Z,{showSearch:!0,style:{width:"100%"},value:t,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"请选择",allowClear:!0,multiple:!0,filterTreeNode:function(e,t){return t.title.indexOf(e)>-1},treeDefaultExpandAll:!0,onChange:n,treeData:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){if(t.node){var n=t.leaf?(0,v.Z)(t.leaf):[],a=t.job_list?(0,v.Z)(t.job_list):[];return{title:t.node.name,value:t.node._id,key:t.node._id,jobId:t.node.job_id,disabled:!!i&&!t.node.job_id,children:e([].concat((0,v.Z)(a),(0,v.Z)(n)))}}}))}(o)})})),te=E.Z.Option,ne=(0,f.connect)((function(e){return{allAccount:e.applicationCommon.allAccount}}))((function(e){var t=e.value,n=e.onChange,a=e.dispatch,r=e.allAccount,o=void 0===r?{}:r;(0,m.useEffect)((function(){o.name&&Array.isArray(o.name)&&o.name.length>0||a({type:"applicationCommon/fetchAllAccountName"})}),[a]);var i=o.name,l=void 0===i?[]:i;return m.createElement(E.Z,{allowClear:!0,showArrow:!0,mode:"multiple",optionFilterProp:"children",value:Array.isArray(l)&&l.length>0?t:void 0,onChange:n,placeholder:"请选择"},l.map((function(e,t){return m.createElement(te,{value:e.id,key:t},e.name)})))}));function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=(0,f.connect)()((function(e){var t=e.visible,n=e.onClose,o=e.dispatch,l=e.flowId,d=e.nodeInfo,u=e.nodeId,p=e.getAffairsFlowNodeList,f=e.isReportNodeState,g=w.Z.useForm(),Z=(0,c.Z)(g,1)[0],y=(0,m.useState)(!1),b=(0,c.Z)(y,2),E=b[0],_=b[1],h=(0,m.useState)(void 0),C=(0,c.Z)(h,2),j=C[0],O=C[1],P=(0,m.useState)(void 0),x=(0,c.Z)(P,2),D=x[0],N=x[1];(0,m.useEffect)((function(){d&&Object.keys(d).length>0&&(O([].concat((0,v.Z)((0,$.Cg)(d,"fixed_department_list",[]).map((function(e){return{_id:e._id,jobId:void 0}}))),(0,v.Z)((0,$.Cg)(d,"fixed_department_job_list",[]).map((function(e){return{_id:e._id,jobId:e.job_info._id}}))))),N([].concat((0,v.Z)((0,$.Cg)(d,"flexible_department_list",[]).map((function(e){return{_id:e._id,jobId:void 0}}))),(0,v.Z)((0,$.Cg)(d,"flexible_department_job_list",[]).map((function(e){return{_id:e._id,jobId:e.job_info._id}}))))))}),[d]);var S=function(){var e=(0,i.Z)(s().mark((function e(){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.validateFields();case 2:return t=e.sent,_(!0),e.next=6,o({type:"codeFlow/setCodeNodeCC",payload:re(re({},t),{},{flowId:l,nodeId:f?void 0:u,fixedDep:j,flexibleDep:f?[]:D})});case 6:(a=e.sent)&&a._id&&(r.ZP.success("请求成功"),p&&p(),o({type:"codeFlow/getApplicantNodeCc",payload:{flowId:l}})),_(!1),n();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return Array.isArray(e)&&e.length>0&&e.forEach((function(e){!function e(n){t[t.length]={_id:n.node?(0,$.Cg)(n,"node.props.value"):(0,$.Cg)(n,"props.value"),jobId:n.node?(0,$.Cg)(n,"node.props.jobId"):(0,$.Cg)(n,"props.jobId")};var a=n.node?n.children:(0,$.Cg)(n,"props.children",[]);a&&Array.isArray(a)&&a.forEach((function(t){return e(t)}))}(e)})),t};return m.createElement(Q.Z,{title:"抄送设置",visible:t,onClose:n,getContainer:!1,width:400,footer:m.createElement("div",{style:{textAlign:"right"}},m.createElement(a.Z,{onClick:function(){return n()}},"取消"),m.createElement(a.Z,{onClick:function(){return S()},type:"primary",loading:E,style:{marginLeft:10}},"确定"))},m.createElement(w.Z,{form:Z,labelAlign:"left",className:"affairs-flow-basic"},m.createElement("span",{className:I.Z["app-expense-examine-flow-cc-title"]},"固定抄送"),m.createElement(w.Z.Item,{label:"可抄送部门/岗位",name:"fixedDep",initialValue:[].concat((0,v.Z)((0,$.Cg)(d,"fixed_department_list",[]).map((function(e){return e._id}))),(0,v.Z)((0,$.Cg)(d,"fixed_department_job_list",[]).map((function(e){return e._id}))))},m.createElement(ee,{onChange:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.allCheckedNodes,r=void 0===a?[]:a,o=F(r);O(o)}})),m.createElement(w.Z.Item,{label:"可抄送成员",name:"fixedUser",initialValue:(0,v.Z)((0,$.Cg)(d,"fixed_account_list",[]).map((function(e){return e._id})))},m.createElement(ne,null)),f?null:m.createElement(m.Fragment,null,m.createElement("span",{className:I.Z["app-expense-examine-flow-cc-title"]},"灵活抄送"),m.createElement(w.Z.Item,{label:"可抄送部门/岗位",name:"flexibleDep",initialValue:[].concat((0,v.Z)((0,$.Cg)(d,"flexible_department_list",[]).map((function(e){return e._id}))),(0,v.Z)((0,$.Cg)(d,"flexible_department_job_list",[]).map((function(e){return e._id}))))},m.createElement(ee,{onChange:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.allCheckedNodes,r=void 0===a?[]:a,o=F(r);N(o)}})),m.createElement(w.Z.Item,{label:"可抄送成员",name:"flexibleUser",initialValue:(0,v.Z)((0,$.Cg)(d,"flexible_account_list",[]).map((function(e){return e._id})))},m.createElement(ne,null)))))})),ie=(n(36616),n(51368)),le=n(20369);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=E.Z.Option,ue=(0,f.connect)((function(e){return{staffList:e.organizationStaffs.staffList}}))((function(e){var t=e.dispatch,n=e.staffList,a=void 0===n?{}:n,r=e.value,o=e.onChange,i=e.departmentId,l=e.disabled,c=void 0!==l&&l,d=e.initValue,s=void 0===d?{}:d,u=a.data,f=void 0===u?[]:u;if((0,m.useEffect)((function(){return i&&t({type:"organizationStaffs/getDepartmentStaffs",payload:{departmentId:i,limit:999,page:1}}),function(){return t({type:"organizationStaffs/resetDepartmentStaffs",payload:{}})}}),[t,i]),Object.keys(a).length<1)return m.createElement(E.Z,{placeholder:"请选择"});var g=(0,v.Z)(f);return s&&Object.keys(s).length>0&&!f.find((function(e){return e._id===s._id}))&&p().get(s,"department_info._id")===i&&Object.keys(a).length>0&&(g=[].concat((0,v.Z)(f),[de(de({},s),{},{isDisabled:!0,job_info:de(de({},s.job_info),{},{name:"".concat(p().get(s,"job_info.name"),"（已删除）")})})])),m.createElement(E.Z,{value:r,placeholder:"请选择",onChange:o,disabled:c,allowClear:!0,showSearch:!0,dropdownMatchSelectWidth:!1,style:{width:"100%"}},g.map((function(e){var t=e.job_info;if(Object.keys(t).length>0)return m.createElement(se,{value:e._id,key:t._id,disabled:e.isDisabled},t.name)})))})),pe=n(61397);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=E.Z.Option,ge=(0,f.connect)()((function(e){var t=e.visible,n=e.onClose,o=e.nodeId,l=e.nodeList,d=void 0===l?[]:l,u=e.updateFlowNode,f=e.flowId,g=e.getFlowNodeList,Z=e.dispatch,y=w.Z.useForm(),_=(0,c.Z)(y,1)[0],h=d.find((function(e){return e._id===o}))||{},C=p().get(h,"skip_condition",[]).find((function(e){return"total_money"===e.field}))||{},P=p().get(h,"skip_condition",[]).find((function(e){return"cost_accounting_id"===e.field}))||{},x=P.data||[],D=(0,m.useState)(h.node_approve_type),N=(0,c.Z)(D,2),S=N[0],F=N[1],k=(0,m.useState)(h.approve_department_id),L=(0,c.Z)(k,2),A=L[0],T=L[1],X=(0,m.useState)(h.approve_department_account_type||j.DXc.principal),q=(0,c.Z)(X,2),z=q[0],H=q[1],V=(0,m.useState)(h.is_skip),R=(0,c.Z)(V,2),G=R[0],M=R[1],U=(0,m.useState)(!C.opt),W=(0,c.Z)(U,2),J=W[0],Y=W[1],K=(0,m.useState)(!P.opt),te=(0,c.Z)(K,2),ae=te[0],re=te[1],oe=(0,m.useState)(!1),ce=(0,c.Z)(oe,2),de=ce[0],se=ce[1],fe=(0,m.useState)(void 0),ge=(0,c.Z)(fe,2),Ze=ge[0],ye=ge[1],we=(0,m.useState)(void 0),be=(0,c.Z)(we,2),Ee=be[0],_e=be[1];if((0,m.useEffect)((function(){if(h&&Object.keys(h).length>0){var e=(0,$.Cg)(h,"carbon_copy_info",{});ye([].concat((0,v.Z)((0,$.Cg)(e,"fixed_department_list",[]).map((function(e){return{_id:e._id,jobId:void 0}}))),(0,v.Z)((0,$.Cg)(e,"fixed_department_job_list",[]).map((function(e){return{_id:e._id,jobId:e.job_info._id}}))))),_e([].concat((0,v.Z)((0,$.Cg)(e,"flexible_department_list",[]).map((function(e){return{_id:e._id,jobId:void 0}}))),(0,v.Z)((0,$.Cg)(e,"flexible_department_job_list",[]).map((function(e){return{_id:e._id,jobId:e.job_info._id}})))))}}),[h]),!t)return m.createElement("div",null);var he,Ce,je,Oe=function(){var e=(0,i.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.validateFields();case 2:t=e.sent,se(!0),u&&u(me(me({},t),{},{nodeId:o,flowId:f,setIsLoading:function(){var e=(0,i.Z)(s().mark((function e(n){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z({type:"codeFlow/setCodeNodeCC",payload:me(me({},t),{},{flowId:f,nodeId:n,fixedDep:Ze,flexibleDep:Ee})});case 2:(a=e.sent)&&a._id&&(r.ZP.success("请求成功"),g()),se(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),"drawer",(function(){se(!1)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(e){_.setFieldsValue({money:void 0}),Y(!e)},xe=function(e){_.setFieldsValue({subject:void 0}),re(!e)},Ie=function(e,t,n){!t||/^\S+$/.test(t)?n():n("节点名称不能包含空格")},De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return Array.isArray(e)&&e.length>0&&e.forEach((function(e){!function e(n){t[t.length]={_id:n.node?(0,$.Cg)(n,"node.props.value"):(0,$.Cg)(n,"props.value"),jobId:n.node?(0,$.Cg)(n,"node.props.jobId"):(0,$.Cg)(n,"props.jobId")};var a=n.node?n.children:(0,$.Cg)(n,"props.children",[]);a&&Array.isArray(a)&&a.forEach((function(t){return e(t)}))}(e)})),t},Ne=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.allCheckedNodes,r=void 0===a?[]:a,o=De(r);ye(o)},Se=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.allCheckedNodes,r=void 0===a?[]:a,o=De(r);_e(o)},Fe=function(){return m.createElement(m.Fragment,null,m.createElement("div",null,"指定部门"),m.createElement(w.Z,{form:_,layout:"vertical",className:"affairs-flow-node"},m.createElement(w.Z.Item,{name:"approveDepartmentId",label:"部门",rules:[{required:!0,message:"请选择"}]},m.createElement(le.Z,{onChange:function(e){return function(e){T(e),A!==e&&Z({type:"organizationStaffs/resetDepartmentStaffs",payload:{}}),_.setFieldsValue({approveJobId:void 0})}(e)}})),m.createElement(w.Z.Item,{name:"approveDepartmentAccountType",label:"部门审批人类型",rules:[{required:!0,message:"请选择"}],className:"affairs-flow-node-report-type"},m.createElement(B.ZP.Group,{onChange:function(e){return t=e.target.value,H(t),void _.setFieldsValue({approveJobId:void 0});var t}},m.createElement(B.ZP,{value:j.DXc.principal,className:I.Z["flow-node-radio-form"]},j.DXc.description(j.DXc.principal)),m.createElement(B.ZP,{value:j.DXc.post,className:I.Z["flow-node-radio-form"]},j.DXc.description(j.DXc.post),m.createElement(w.Z.Item,{name:"approveJobId",className:I.Z["flow-node-radio-form-item"],rules:[{required:z===j.DXc.post,message:"请选择"}]},m.createElement(ue,{departmentId:A,initValue:p().get(h,"approve_department_job_info",{}),disabled:z===j.DXc.principal})))))))},ke={name:h.name,nodeApproveType:h.node_approve_type,isSkip:h.is_skip||!1,upNode:1,directLeader:j.fcD.directLeader,specifyDep:j.fcD.specialPost,approveDepartmentId:h.approve_department_id,approveDepartmentAccountType:h.approve_department_account_type,approveJobId:p().get(h,"approve_department_job_info._id",void 0),moneyPrefix:C.opt,money:void 0!==C.num?C.num/100:void 0,subjectPrefix:P.opt,subject:x.length>0?x.map((function(e){return"".concat(e._id,"=").concat(e.ac_code)})):void 0};return m.createElement(Q.Z,{title:"审批人节点设置",visible:t,onClose:n,getContainer:!1,width:400,footer:m.createElement("div",{style:{textAlign:"right"}},m.createElement(a.Z,{onClick:function(){return n()}},"取消"),m.createElement(a.Z,{loading:de,onClick:function(){return Oe()},type:"primary",style:{marginLeft:10}},"确定"))},m.createElement(w.Z,{layout:"vertical",form:_,initialValues:ke,className:"affairs-flow-node"},(je=[m.createElement(w.Z.Item,{label:"节点名称设置",name:"name",rules:[{required:!0,message:"请输入节点名称"},{validator:Ie}]},m.createElement(b.Z,{placeholder:"请输入",autoComplete:"off"})),m.createElement(w.Z.Item,{label:"节点审批人设置",name:"nodeApproveType",rules:[{required:!0,message:"请输入节点名称"}]},m.createElement(E.Z,{placeholder:"请选择",onChange:function(e){return F(e)}},m.createElement(ve,{value:j.gH5.report},j.gH5.description(j.gH5.report)),m.createElement(ve,{value:j.gH5.coopera},j.gH5.description(j.gH5.coopera))))],m.createElement(O.Fp,{items:je,cols:1}))),S!==j.gH5.coopera?"":m.createElement(m.Fragment,null,m.createElement(w.Z,{form:_,className:"affairs-flow-node"},m.createElement(w.Z.Item,{label:"",name:"specifyDep"},m.createElement(B.ZP.Group,null,m.createElement(B.ZP,{value:j.fcD.specialPost,className:I.Z["flow-node-radio-form-coopera"]},j.fcD.description(j.fcD.specialPost))))),Fe()),m.createElement(w.Z,{form:_,className:"affairs-flow-node"},S!==j.gH5.report?"":m.createElement(m.Fragment,null,m.createElement(w.Z.Item,{name:"upNode"},m.createElement(B.ZP.Group,null,m.createElement(B.ZP,{value:1},"上一节点审批人"))),m.createElement(w.Z,{form:_},m.createElement(w.Z.Item,{name:"directLeader",label:"部门审批人类型",rules:[{required:!0}]},m.createElement(B.ZP.Group,null,m.createElement(B.ZP,{value:j.fcD.directLeader},"直接领导"))))),(he=m.createElement(m.Fragment,null,m.createElement(w.Z.Item,{label:"金额条件",className:"code-flow-form-customize-form"},m.createElement(w.Z.Item,{name:"moneyPrefix",style:{width:"50%"},dependencies:["isSkip","subjectPrefix"],rules:[function(e){var t=e.getFieldValue;return{validator:function(e,n){return t("isSkip")&&(n||t("subjectPrefix"))||!t("isSkip")?Promise.resolve():Promise.reject("请选择")}}}]},m.createElement(E.Z,{placeholder:"请选择",allowClear:!0,onChange:Pe},m.createElement(ve,{value:j.HX5.lessThan},j.HX5.description(j.HX5.lessThan)),m.createElement(ve,{value:j.HX5.moreThan},j.HX5.description(j.HX5.moreThan)))),m.createElement(w.Z.Item,{name:"money",style:{width:"45%"},dependencies:["isSkip","moneyPrefix","subjectPrefix"],rules:[function(e){var t=e.getFieldValue;return{validator:function(e,n){return t("isSkip")&&(n||t("subjectPrefix")&&!t("moneyPrefix"))||!t("isSkip")?Promise.resolve():Promise.reject("请填写")}}}]},m.createElement(ie.Z,{min:0,precision:2,formatter:j.fbc.limitDecimalsFormatter,parser:j.fbc.limitDecimalsParser,style:{width:"100%"},disabled:J}))),m.createElement("div",{style:{marginLeft:60,marginBottom:10}},"满足条件跳过本节点")),Ce=m.createElement(m.Fragment,null,m.createElement(w.Z.Item,{label:"科目条件"},m.createElement(w.Z.Item,{name:"subjectPrefix",dependencies:["isSkip","moneyPrefix"],rules:[function(e){var t=e.getFieldValue;return{validator:function(e,n){return t("isSkip")&&(n||t("moneyPrefix"))||!t("isSkip")?Promise.resolve():Promise.reject("请选择")}}}]},m.createElement(E.Z,{placeholder:"请选择",allowClear:!0,onChange:xe},m.createElement(ve,{value:j.Em4.notContain},j.Em4.description(j.Em4.notContain)))),m.createElement(w.Z.Item,{name:"subject",dependencies:["isSkip","moneyPrefix","subjectPrefix"],rules:[function(e){var t=e.getFieldValue;return{validator:function(e,n){return t("isSkip")&&(Array.isArray(n)&&n.length>0||t("moneyPrefix")&&!t("subjectPrefix"))||!t("isSkip")?Promise.resolve():Promise.reject("请选择")}}}]},m.createElement(pe.Z,{selectDisabled:ae,type:[j.IGK.code,j.IGK.team]})))),m.createElement(m.Fragment,null,m.createElement(w.Z.Item,{name:"isSkip",label:"条件跳过"},m.createElement(B.ZP.Group,{onChange:function(e){return M(e.target.value)}},m.createElement(B.ZP,{value:!0},"是"),m.createElement(B.ZP,{value:!1},"否"))),G?m.createElement(m.Fragment,null,he,Ce):""))),function(){var e=(0,$.Cg)(h,"carbon_copy_info",{}),t={fixedDep:[].concat((0,v.Z)((0,$.Cg)(e,"fixed_department_list",[]).map((function(e){return e._id}))),(0,v.Z)((0,$.Cg)(e,"fixed_department_job_list",[]).map((function(e){return e._id})))),fixedUser:(0,v.Z)((0,$.Cg)(e,"fixed_account_list",[]).map((function(e){return e._id}))),flexibleDep:[].concat((0,v.Z)((0,$.Cg)(e,"flexible_department_list",[]).map((function(e){return e._id}))),(0,v.Z)((0,$.Cg)(e,"flexible_department_job_list",[]).map((function(e){return e._id})))),flexibleUser:(0,v.Z)((0,$.Cg)(e,"flexible_account_list",[]).map((function(e){return e._id})))};return m.createElement(w.Z,{form:_,labelAlign:"left",className:"affairs-flow-basic"},m.createElement("span",{className:I.Z["app-expense-examine-flow-cc-title"]},"固定抄送"),m.createElement(w.Z.Item,{label:"可抄送部门/岗位",name:"fixedDep",initialValue:t.fixedDep},m.createElement(ee,{onChange:Ne})),m.createElement(w.Z.Item,{label:"可抄送成员",name:"fixedUser",initialValue:t.fixedUser},m.createElement(ne,null)),m.createElement("span",{className:I.Z["app-expense-examine-flow-cc-title"]},"灵活抄送"),m.createElement(w.Z.Item,{label:"可抄送部门/岗位",name:"flexibleDep",initialValue:t.flexibleDep},m.createElement(ee,{onChange:Se})),m.createElement(w.Z.Item,{label:"可抄送成员",name:"flexibleUser",initialValue:t.flexibleUser},m.createElement(ne,null)))}())}));function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=E.Z.Option,be=(0,f.connect)((function(e){var t=e.codeFlow;return{flowNodeList:t.flowNodeList,applicantNodeCcInfo:t.applicantNodeCcInfo}}))((function(e){var t=e.flowId,n=e.dispatch,o=e.flowNodeList,l=void 0===o?{}:o,d=e.applicantNodeCcInfo,u=(0,m.useState)(!0),f=(0,c.Z)(u,2),g=f[0],Z=f[1],b=(0,m.useState)(!1),_=(0,c.Z)(b,2),h=_[0],C=_[1],P=(0,m.useState)(!1),x=(0,c.Z)(P,2),D=x[0],N=x[1],S=(0,m.useState)(void 0),F=(0,c.Z)(S,2),k=F[0],L=F[1];(0,m.useEffect)((function(){return t&&n({type:"codeFlow/getFlowNodeList",payload:{flowId:t}}),function(){n({type:"codeFlow/resetFlowNodeList"})}}),[n,t]),(0,m.useEffect)((function(){t&&n({type:"codeFlow/getApplicantNodeCc",payload:{flowId:t}})}),[]);var A=l.data,T=void 0===A?[]:A,X=function(){n({type:"codeFlow/getFlowNodeList",payload:{flowId:t}})},q=function(e){var t=e.isPaymentNode,n=e.nodeId,a=T.find((function(e){return e._id===n}))||{},o=T.map((function(e){return e.is_payment_node})),i=p().get(a,"is_inspect_bill_node",!1);return o.includes(!0)&&t?r.ZP.error("同一个审批流，只能存在一个【标记付款】节点"):i&&t?r.ZP.error("同一个节点，只能标记付款或标记验票"):void H({isPaymentNode:t,nodeId:n})},z=function(e){var t=e.isInspectBillNode,n=e.nodeId,a=T.find((function(e){return e._id===n}))||{},o=T.map((function(e){return e.is_inspect_bill_node})),i=p().get(a,"is_payment_node",!1);return o.includes(!0)&&t?r.ZP.error("同一个审批流，只能存在一个【标记验票】节点"):i&&t?r.ZP.error("同一个节点，只能标记付款或标记验票"):void H({isInspectBillNode:t,nodeId:n})},H=function(){var e=(0,i.Z)(s().mark((function e(a,o,i){var l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({type:"codeFlow/updateFlowNode",payload:ye({flowId:t},a)});case 2:(l=e.sent)&&l._id?(X(),"drawer"===o&&a.setIsLoading&&a.setIsLoading(l._id),"drawer"===o&&N(!1)):(l.zh_message&&r.ZP.error(l.zh_message),i&&i());case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),V=function(){var e=(0,i.Z)(s().mark((function e(t){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({type:"codeFlow/deleteFlowNode",payload:{nodeId:t}});case 2:(a=e.sent)&&a._id?(r.ZP.success("请求成功"),X()):a.zh_message&&r.ZP.error(a.zh_message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e,t){var n=t?e:(0,$.Cg)(e,"carbon_copy_info",{}),a=(0,$.Cg)(n,"fixed_department_job_list",[]).map((function(e){if(e._id)return{_id:e._id,name:e.job_info.name,jobId:e.job_info._id}})),r=(0,$.Cg)(n,"flexible_department_job_list",[]).map((function(e){if(e._id)return{_id:e._id,name:e.job_info.name,jobId:e.job_info._id}})),o=[].concat((0,v.Z)((0,$.Cg)(n,"fixed_department_list",[])),(0,v.Z)(a),(0,v.Z)((0,$.Cg)(n,"fixed_account_list",[]))),i=[].concat((0,v.Z)((0,$.Cg)(n,"flexible_department_list",[])),(0,v.Z)(r),(0,v.Z)((0,$.Cg)(n,"flexible_account_list",[])));return m.createElement(m.Fragment,null,m.createElement(M.Z,{onClick:function(){Q((0,$.Cg)(e,"_id",void 0)),Z(t)},className:I.Z["affairs-flow-update-node-cc-wrap"]},m.createElement(U.Z,{span:20,className:I.Z["affairs-flow-update-node-cc-info"]},m.createElement("div",null,"固定抄送：",m.createElement("span",null,o.slice(0,3).map((function(e){return e.name})).join("、"),o.length>3?m.createElement("span",null,"..."):""))),m.createElement(U.Z,{span:4,className:I.Z["affairs-flow-update-node-cc-info-arrow"]},m.createElement(W.Z,{style:{color:"rgba(0, 0, 0, .4)"}}))),t?null:m.createElement(M.Z,{onClick:function(){Q((0,$.Cg)(e,"_id",void 0)),Z(t)},className:I.Z["affairs-flow-update-node-cc-wrap"]},m.createElement(U.Z,{span:20,className:I.Z["affairs-flow-update-node-cc-info"]},m.createElement("div",null,"灵活抄送：",m.createElement("span",null,i.slice(0,3).map((function(e){return e.name})).join("、"),i.length>3?"...":""))),m.createElement(U.Z,{span:4,className:I.Z["affairs-flow-update-node-cc-info-arrow"]},m.createElement(W.Z,{style:{color:"rgba(0, 0, 0, .4)"}}))))},Q=function(e){L(e),C(!0)},ee=function(e){return m.createElement("div",{className:I.Z["code-flow-update-node-operate"]},m.createElement("div",{className:I.Z["code-flow-update-node-operate-modify"],onClick:function(){return t=e._id,L(t),void N(!0);var t}},m.createElement(Y.Z,null)," 修改"),m.createElement(G.Z,{title:"确认删除当前节点?",onConfirm:function(){return V(e._id)},okText:"删除",cancelText:"取消"},m.createElement("div",{className:I.Z["code-flow-update-node-operate-delete"]},m.createElement(K.Z,null)," 删除")))};return m.createElement(O.IT,{title:"审批流节点设置"},m.createElement(M.Z,null,m.createElement(U.Z,{span:6},m.createElement(M.Z,null,m.createElement(U.Z,{span:20,className:I.Z["code-flow-update-report-node"]},m.createElement("div",{className:I.Z["code-flow-applicant-node"]},m.createElement("span",{className:I.Z["code-flow-update-node-title"]},"申请人"),m.createElement("div",null,R(d,!0)))),m.createElement(U.Z,{span:4,className:I.Z["code-flow-update-node-arrow"]},m.createElement(W.Z,null)))),m.createElement(U.Z,{span:18},m.createElement(M.Z,null,T.map((function(e){return m.createElement(U.Z,{span:8,key:e._id},m.createElement(M.Z,null,m.createElement(U.Z,{span:20,className:I.Z["code-flow-update-node-wrap"]},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e._id,n=e.node_approve_type,a=e.approve_mode,r=e.is_payment_node,o=e.is_inspect_bill_node,i=e.name,l=e.approve_department_info,c=void 0===l?{}:l,d=e.approve_department_job_info,s=void 0===d?{}:d,u=e.approve_department_account_type,f="";return n===j.gH5.report&&(f="直接领导人"),n===j.gH5.coopera&&(u===j.DXc.principal&&(f=m.createElement("span",null,p().get(c,"name")?"".concat(p().get(c,"name"),"  -  "):"",j.DXc.description(u))),u===j.DXc.post&&(f=m.createElement("span",null,p().get(c,"name",""),p().get(s,"job_info.name",void 0)?"  -  ".concat(p().get(s,"job_info.name")):""))),m.createElement("div",{className:I.Z["code-flow-update-node-form"]},m.createElement(y.Z,{title:i},m.createElement("div",{className:I.Z["code-flow-update-node-title"]},m.createElement("span",{className:I.Z["code-flow-node-round"]}),i)),m.createElement(y.Z,{title:f},m.createElement("div",{className:I.Z["code-flow-update-node-approve"]},f)),m.createElement(w.Z,{layout:"vertical",className:"affairs-flow-update-node"},m.createElement(w.Z.Item,{label:"审批规则"},m.createElement("div",{className:I.Z["code-flow-update-node-mode"]},m.createElement(w.Z.Item,null,m.createElement(E.Z,{size:"small",placeholder:"请选择审批规则",value:a,onChange:function(e){return H({approveMode:e,nodeId:t})},style:{width:76}},m.createElement(we,{value:j.Fv8.any},j.Fv8.description(j.Fv8.any)))))),m.createElement(w.Z.Item,{label:"标记付款"},m.createElement(B.ZP.Group,{size:"small",value:r,disabled:n===j.gH5.report,onChange:function(e){return q({isPaymentNode:e.target.value,nodeId:t})}},m.createElement(B.ZP.Button,{value:!1},"否"),m.createElement(B.ZP.Button,{value:!0},"是"))),m.createElement(w.Z.Item,{label:"标记验票"},m.createElement(B.ZP.Group,{size:"small",value:o,disabled:n===j.gH5.report,onChange:function(e){return z({isInspectBillNode:e.target.value,nodeId:t})}},m.createElement(B.ZP.Button,{value:!1},"否"),m.createElement(B.ZP.Button,{value:!0},"是")))),m.createElement("div",null,R(e,!1)))}(e),ee(e)),m.createElement(U.Z,{span:4,className:I.Z["code-flow-update-node-arrow"]},m.createElement(W.Z,null))))})),m.createElement(U.Z,{span:8},m.createElement(M.Z,null,m.createElement(U.Z,{span:20,className:I.Z["code-flow-update-node-create"]},m.createElement(a.Z,{icon:m.createElement(J.Z,null),type:"primary",onClick:function(){return L(void 0),void N(!0)}},"新增节点"))))))),h?m.createElement(oe,{visible:h,onClose:function(){return C(!1)},flowId:t,nodeId:k,nodeInfo:g?d:T.find((function(e){return e._id===k})).carbon_copy_info,getAffairsFlowNodeList:X,isReportNodeState:g}):m.createElement("div",null),D?m.createElement(ge,{visible:D,onClose:function(){return N(!1)},flowId:t,nodeId:k,nodeList:T,updateFlowNode:H,getFlowNodeList:X}):m.createElement("div",null))}));function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=(0,f.connect)((function(e){var t=e.codeFlow;return{flowDetail:t.flowDetail,originCodeList:t.originCodeList,originTeamList:t.originTeamList}}))((function(e){var t=e.flowDetail,n=void 0===t?{}:t,o=e.dispatch,d=e.location,u=e.originCodeList,f=void 0===u?{}:u,v=e.originTeamList,g=void 0===v?{}:v,Z=p().get(d,"query.flowId",void 0),y=(0,m.useState)(!0),w=(0,c.Z)(y,2),b=w[0],E=w[1],_=(0,m.useState)(!0),h=(0,c.Z)(_,2),C=h[0],j=h[1],O=(0,m.useState)(!0),P=(0,c.Z)(O,2),x=P[0],I=P[1];(0,m.useEffect)((function(){return Z&&o({type:"codeFlow/getFlowDetail",payload:{id:Z,onLoading:function(){E(!1)}}}),o({type:"codeFlow/getFlowCodeList",payload:{onLoading:function(){j(!1)}}}),o({type:"codeFlow/getFlowTeamList",payload:{onLoading:function(){I(!1)}}}),function(){o({type:"codeFlow/resetFlowDetail"}),o({type:"codeFlow/resetFlowCodeList"}),o({type:"codeFlow/resetFlowTeamList"}),E(!0),j(!0),I(!0)}}),[o,Z]);var D=(0,m.useRef)();if(b||C||x)return m.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},m.createElement(l.Z,null));var N=function(){var e=(0,i.Z)(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.current.validateFields();case 2:return t=e.sent,e.next=5,o({type:"codeFlow/updateFlow",payload:_e(_e({flowId:Z},t),{},{originCodeList:f,originTeamList:g})});case 5:(n=e.sent)&&n._id?(r.ZP.success("请求成功"),S()):n.zh_message&&r.ZP.error(n.zh_message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){window.location.href="/#/Code/BasicSetting/Flow"};return m.createElement("div",null,m.createElement(R,{ref:D,flowDetail:n,isUpdate:Boolean(Z),originTeamList:g,originCodeList:f}),m.createElement(be,{formRef:D,flowId:Z,flowDetail:n}),m.createElement("div",{style:{textAlign:"center"}},m.createElement(a.Z,{onClick:function(){return S()},style:{marginRight:30}},"取消"),m.createElement(a.Z,{onClick:N,type:"primary"},"确定")))}))},1846:function(e,t,n){n(29093);var a=n(16317),r=n(55609),o=n(67294),i=a.Z.Option;t.Z=(0,r.connect)((function(e){return{staffList:e.organizationStaff.staffList}}))((function(e){var t=e.dispatch,n=e.value,r=e.onChange,l=e.staffList,c=void 0===l?{}:l;(0,o.useEffect)((function(){t({type:"organizationStaff/getStaffList",payload:{page:1,limit:999}})}),[t]);var d=c.data,s=void 0===d?[]:d;return!Array.isArray(s)||s.length<1?o.createElement(a.Z,{style:{width:"70%"},placeholder:"请选择"}):o.createElement(a.Z,{value:n,placeholder:"请选择",onChange:r,style:{width:"70%"},mode:"multiple",showArrow:!0,allowClear:!0,optionFilterProp:"children"},s.map((function(e,t){return o.createElement(i,{value:e._id,key:e._id||t},e.name)})))}))},20369:function(e,t,n){n(88775);var a=n(12010),r=n(55609),o=n(67294);t.Z=(0,r.connect)((function(e){return{departments:e.applicationCommon.departments}}))((function(e){var t=e.departments,n=void 0===t?{}:t,r=e.dispatch,i=e.value,l=e.onChange,c=e.multiple,d=void 0!==c&&c,s=n.default,u=void 0===s?[]:s;(0,o.useEffect)((function(){u&&Object.keys(u).length>0||r({type:"applicationCommon/fetchDepartments"})}),[r]);var p=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){if(t.node)return{title:t.node.name,value:t.node._id,key:t.node._id,children:e(t.leaf)}}))}(u),f={showArrow:!0,treeData:p,treeDefaultExpandAll:!0,value:p.length>0?i:[],filterTreeNode:function(e,t){return t.title.indexOf(e)>-1},onChange:l,showSearch:!0,allowClear:!0,multiple:d,placeholder:"请选择",style:{width:"100%"}};return o.createElement(a.Z,f)}))},5961:function(e,t,n){n(29093);var a=n(16317),r=n(96486),o=n.n(r),i=n(55609),l=n(67294),c=a.Z.Option;t.Z=(0,i.connect)((function(e){return{postTags:e.organizationStaff.postTags}}))((function(e){var t=e.dispatch,n=e.postTags,r=void 0===n?{}:n,i=e.value,d=e.onChange;(0,l.useEffect)((function(){t({type:"organizationStaff/getPostTags"})}),[t]);var s=r.records,u=void 0===s?[]:s,p=o().uniqWith(u,o().isEqual);return l.createElement(a.Z,{value:i,placeholder:"请选择",onChange:d,style:{width:"70%"},allowClear:!0,showSearch:!0,mode:"multiple",showArrow:!0},p.map((function(e,t){return l.createElement(c,{value:e,key:t},e)})))}))},88486:function(e,t){t.Z={"code-flow-list-note":"L6LvS5OvWFo47ttMdWzl","code-flow-node-time-title-wrap":"DlJolND_tSk1nt4RZPzZ","code-flow-node-time-name":"pmiUtGLgXBFRjRSTK5vo","code-flow-node-time-approve-name":"AOAJLXHUzIZvcgLR28sX","code-flow-applicant-node":"Fk0ujLOTmjlywN1F9PmS","code-flow-update-node-title":"YGigFsXncpmdCHaN1Mcs","code-flow-update-node-form":"fYfTgvNcTcj_4GzvMTwj","code-flow-node-round":"LlhEWH9UPfoQ19_dtnYb","code-flow-update-node-approve":"DAlGqqbHwGLEVe1JqVw4","code-flow-update-node-mode":"IS0KqfnRDNHtOh0tqpct","code-flow-update-node-operate":"dP203f1sMZ1atZVHPnzK","code-flow-update-node-operate-modify":"flMDUSOLSmEz7hYJOlje","code-flow-update-node-operate-delete":"CI9K88GyyjoByTWAo9mN","code-flow-update-report-node":"kvBa8Ztd4gbucrRpA1lI","code-flow-update-node-arrow":"dLoy0fZ6T2cSQGAkDx9A","code-flow-update-node-wrap":"CQiDaMmctMy7NEP4RELw","code-flow-update-node-create":"li9lMghyDq8HrhzDD_jx","flow-node-radio-form":"FXXUGMr94oYGsobC3vZA","flow-node-radio-form-item":"W9Vqk7vNbvLuDyXZcnVG","flow-node-radio-form-coopera":"lDYY9Kq553vaSsqPuEdg","flow-node-customize-form":"i8_siaSaN5ANy4yRAhG_","flow-enable-error-prompt":"ubBeGPDP4qS48qoxGkSV","code-flow-basic-form-hightest":"mlzTugcGQIKCbRQRELTR","app-expense-examine-flow-cc-title":"Lx25xDAYqw1yIc_xf4kN","app-expense-examine-flow-cc-comment":"TidC9Vz9YQpMmM44IyWe","app-expense-examine-flow-cc-update-title":"tkO0AMpkNWWxMuyJLzXi","affairs-flow-update-node-cc-wrap":"SlSayhLbffNngtwHPjNR","affairs-flow-update-node-cc-info":"C9QBjpR8R7KmYDPTrPc0","affairs-flow-update-node-cc-info-arrow":"rC11BmJDeQVei8qR5LEI"}}}]);