"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[9908],{9908:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(15671),a=n(43144),o=n(97326),c=n(60136),i=n(82963),s=n(61120),u=n(4942),l=n(67294),p=n(45697),f=n.n(p),d=n(55609),h=(n(9070),n(20924)),v=n(96036);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var a=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var y=function(e){(0,c.Z)(n,e);var t=m(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return e=t.call.apply(t,[this].concat(c)),(0,u.Z)((0,o.Z)(e),"renderSearch",(function(){var t=e.props,n={items:[{label:"标签名称",form:function(e){return e.getFieldDecorator("name")(l.createElement(h.Z,{placeholder:"请输入标签名称"}))}}],onSearch:t.onSearch,onReset:t.onReset};return l.createElement(v.IT,null,l.createElement(v.yL,n))})),e}return(0,a.Z)(n,[{key:"render",value:function(){return this.renderSearch()}}]),n}(l.Component);(0,u.Z)(y,"propTypes",{onSearch:f().func,onReset:f().func}),(0,u.Z)(y,"defaultProps",{onSearch:function(){},onReset:function(){}}),y.propTypes={onSearch:f().func,onReset:f().func},y.defaultProps={onSearch:{},onReset:{}};var g=y,Z=(n(20186),n(75385)),b=(n(52560),n(71577)),S=(n(21316),n(75443)),P=(n(51838),n(48086)),C=n(30381),O=n.n(C),T=(n(52466),n(10642)),k=n(66939);n(98703);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var a=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var w="create",E="update",x=function(e){(0,c.Z)(n,e);var t=j(n);function n(){var e;return(0,r.Z)(this,n),e=t.call(this),(0,u.Z)((0,o.Z)(e),"onSubmit",(function(){var t=e.props,n=t.form,r=t.type,a=t.dispatch,o=t.data,c=void 0===o?{}:o;n.validateFields((function(t,n){if(!t){var o=c._id,i=D(D({id:void 0===o?void 0:o},n),{},{onSuccessCallback:e.onSuccessCallback,onFailureCallback:e.onFailureCallback});e.private.isSubmit&&(r===w&&a({type:"districtTag/createTag",payload:i}),r===E&&a({type:"districtTag/updateTag",payload:i})),e.private.isSubmit=!1}}))})),(0,u.Z)((0,o.Z)(e),"onCancel",(function(){var t=e.props.onCancel;t&&t()})),(0,u.Z)((0,o.Z)(e),"onSuccessCallback",(function(){var t=e.props.onSearch;P.ZP.success("操作成功"),e.onCancel(),t&&t()})),(0,u.Z)((0,o.Z)(e),"onFailureCallback",(function(t){P.ZP.error(t.zh_message),e.onCancel()})),(0,u.Z)((0,o.Z)(e),"renderForm",(function(){var t=e.props,n=t.form,r=t.data,a=[{label:"标签名称",form:(0,n.getFieldDecorator)("name",{rules:[{required:!0,message:"请输入标签名称"},{min:2,message:"标签名称为2-32个字符"},{max:32,message:"标签名称为2-32个字符"},{pattern:/^\S+$/,message:"标签名称不能包含空格"}],initialValue:r.name})(l.createElement(h.Z,{placeholder:"请输入标签名称"}))}];return l.createElement(v.KP,{items:a,cols:1,layout:{labelCol:{span:6},wrapperCol:{span:18}}})})),(0,u.Z)((0,o.Z)(e),"renderMadal",(function(){var t=e.props,n=t.visible,r=t.type===E?"编辑标签":"添加标签";return l.createElement(T.Z,{title:r,visible:n,onOk:e.onSubmit,onCancel:e.onCancel,okText:"确认",cancelText:"取消"},e.renderForm())})),e.private={isSubmit:!0},e}return(0,a.Z)(n,[{key:"render",value:function(){return this.renderMadal()}}]),n}(l.Component);x.propTypes={visible:f().bool,form:f().object,type:f().string,dispatch:f().func,onCancel:f().func,data:f().object,onSearch:f().func},x.defaultProps={visible:!1,form:{},type:w,dispatch:function(){},onCancel:function(){},data:{},onSearch:function(){}};var _=k.Z.create()(x),F=n(45430),B="h9EoQ5ltlzRursIQwqvs";function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var a=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var z="create",I="update",Y=function(e){(0,c.Z)(n,e);var t=M(n);function n(e){var a;return(0,r.Z)(this,n),a=t.call(this,e),(0,u.Z)((0,o.Z)(a),"onShow",(function(e,t){a.setState({visible:!0,type:e,updateData:t})})),(0,u.Z)((0,o.Z)(a),"onCancel",(function(){a.setState({visible:!1,updateData:void 0})})),(0,u.Z)((0,o.Z)(a),"onDelete",(function(e){(0,a.props.dispatch)({type:"districtTag/deleteTag",payload:{id:e,onSuccessCallback:a.onSuccessCallback,onFailureCallback:a.onFailureCallback}})})),(0,u.Z)((0,o.Z)(a),"onSuccessCallback",(function(){var e=a.props.onSearch;P.ZP.success("操作成功"),e&&e()})),(0,u.Z)((0,o.Z)(a),"onFailureCallback",(function(e){e.zh_message&&P.ZP.success(e.zh_message)})),(0,u.Z)((0,o.Z)(a),"renderContent",(function(){var e=a.props,t=e.data,n=void 0===t?{}:t,r=e.onChangePage,o=n.data,c=void 0===o?[]:o,i=n._meta,s=(void 0===i?{}:i).result_count,u=void 0===s?0:s,p=[{title:"标签名称",dataIndex:"name",key:"name"},{title:"创建时间",dataIndex:"created_at",key:"created_at",render:function(e){return e?O()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"更新时间",dataIndex:"updated_at",key:"updated_at",render:function(e){return e?O()(String(e)).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"最新操作人",dataIndex:["operator_info","name"],render:function(e){return e||"--"}},{title:"操作",dataIndex:"_id",key:"operate",render:function(e,t){var n=F.ZP.canOperateAssectsAdministrationTagUpdate()?l.createElement("a",{onClick:function(){return a.onShow(I,t)}},"编辑"):null,r=F.ZP.canOperateAssectsAdministrationTagDelete()?l.createElement(S.Z,{title:"停用该标签会同步移除商圈下的该条标签信息，请确认是否停用该标签",onConfirm:function(){return a.onDelete(e)},okText:"确认",cancelText:"取消"},l.createElement("a",{className:B},"停用")):null;return l.createElement("div",null,n,r,n||r?null:"--")}}],f={current:a.props.page,defaultPageSize:30,onChange:r,total:u,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:r},d=F.ZP.canOperateAssectsAdministrationTagCreate()?l.createElement(b.Z,{type:"primary",onClick:function(){return a.onShow(z)}},"添加标签"):null;return l.createElement(v.IT,{title:"标签列表",titleExt:d},l.createElement(Z.Z,{rowKey:function(e,t){return e._id||t},dataSource:c,columns:p,pagination:f}))})),(0,u.Z)((0,o.Z)(a),"renderModal",(function(){var e=a.state,t=e.visible,n=e.type,r=e.updateData,o=a.props,c=o.dispatch,i=o.onSearch;if(t)return l.createElement(_,{visible:t,type:n,dispatch:c,onCancel:a.onCancel,data:r,onSearch:i})})),a.state={visible:!1,type:void 0,updateData:void 0},a}return(0,a.Z)(n,[{key:"render",value:function(){return l.createElement("div",null,this.renderContent(),this.renderModal())}}]),n}(l.Component);Y.propTypes={data:f().object,onChangePage:f().func,dispatch:f().func,onSearch:f().func},Y.defaultProps={data:{},onChangePage:function(){},dispatch:function(){},onSearch:function(){}};var A=Y;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var a=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var K=function(e){(0,c.Z)(n,e);var t=q(n);function n(e){var a;return(0,r.Z)(this,n),a=t.call(this,e),(0,u.Z)((0,o.Z)(a),"onSearch",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a.private.searchParams,n=Q(Q({},t),e);a.private.searchParams=Q({},n),a.getDistrictTags(n)})),(0,u.Z)((0,o.Z)(a),"onReset",(function(){var e={limit:30,page:1};a.private.searchParams=Q({},e),a.getDistrictTags(e)})),(0,u.Z)((0,o.Z)(a),"onChangePage",(function(e,t){var n=a.private.searchParams;n.page=e,n.limit=t,a.onSearch(n)})),(0,u.Z)((0,o.Z)(a),"getDistrictTags",(function(e){(0,a.props.dispatch)({type:"districtTag/getDistrictTags",payload:e})})),a.state={},a.private={searchParams:{limit:30,page:1}},a}return(0,a.Z)(n,[{key:"componentDidMount",value:function(){this.getDistrictTags(Q({},this.private.searchParams))}},{key:"componentWillUnmount",value:function(){(0,this.props.dispatch)({type:"districtTag/resetDistrictTags",payload:{}})}},{key:"render",value:function(){var e=this.props,t=e.districtTags,n=e.dispatch,r=this.private.searchParams.page;return l.createElement("div",null,l.createElement(g,{onSearch:this.onSearch,onReset:this.onReset}),l.createElement(A,{data:t,dispatch:n,onChangePage:this.onChangePage,onSearch:this.onSearch,page:r}))}}]),n}(l.Component);K.propTypes={districtTags:f().object},K.defaultProps={districtTags:{}};var U=(0,d.connect)((function(e){return{districtTags:e.districtTag.districtTags}}))(K)}}]);