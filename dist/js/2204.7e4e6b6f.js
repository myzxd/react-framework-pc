"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[2204],{62204:function(e,t,n){n.r(t),n.d(t,{default:function(){return et}});var o,r=n(15671),a=n(97326),i=n(60136),l=n(82963),c=n(61120),s=n(4942),p=n(67294),u=n(96036),f=(n(52560),n(71577)),m=(n(51838),n(48086)),d=n(71002),y=n(94315),h=n.n(y),C=n(96486),g=n.n(C),v=n(93517),w=n.n(v),Z=n(55609),b=n(45697),x=n.n(b),E=n(66939),F=(n(98703),n(7145)),_=n.n(F),N=n(97116),D=N.Iq.platform(),O=(o={},D.forEach((function(e){o[e.id]={accountings:{pledge_accounting_id:{5:"",4:"",3:"",2:""},agent_accounting_id:{5:"",4:"",3:"",2:""},rent_accounting_id:{5:"",4:"",3:"",2:""},lost_accounting_id:{5:"",4:"",3:"",2:""}},init:{flow_id:"",cost_group_id:""},period:{flow_id:"",cost_group_id:""},break:{flow_id:"",cost_group_id:""}}})),o),j="eiasIztrQdwIt3IEFfm6",q="bi9ZHRMAAD0OKsU2Gesn",P="UElEAu13Ukbr98WNRBBo",S=(n(29093),n(16317)),k=n(80385);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var R=S.Z.Option,G=function(e){(0,i.Z)(n,e);var t=K(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"onChangeSupper",(function(t,n,o){e.props.onChangeSupper(t,n,o)})),(0,s.Z)((0,a.Z)(e),"onChangePlatform",(function(t,n,o){e.props.onChangePlatform(t,n,o)})),(0,s.Z)((0,a.Z)(e),"onChangeCity",(function(t,n,o){e.props.onChangeCity(t,n,o)})),(0,s.Z)((0,a.Z)(e),"onChangeBizDistrict",(function(t,n,o){e.props.onChangeBizDistrict(t,n,o)})),(0,s.Z)((0,a.Z)(e),"renderContent",(function(t,n){var o=e.props,r=o.accountings,a=o.subjectsData,i="";"pledge_accounting_id"===t&&(i="押金科目设置"),"agent_accounting_id"===t&&(i="中介费科目设置"),"rent_accounting_id"===t&&(i="房租科目设置"),"lost_accounting_id"===t&&(i="押金损失科目设置");var l=a.filter((function(e){return e.costCenterType===k.F$Y.district})),c=a.filter((function(e){return e.costCenterType===k.F$Y.city})),s=a.filter((function(e){return e.costCenterType===k.F$Y.headquarter})),f=a.filter((function(e){return e.costCenterType===k.F$Y.project})),m=[{label:"平台成本科目",layout:{labelCol:{span:5},wrapperCol:{span:19}},form:p.createElement(S.Z,{placeholder:"请选择",showSearch:!0,allowClear:!0,style:{width:"100%"},optionFilterProp:"children",value:r[t][k.F$Y.project]||void 0,onChange:function(n){return e.onChangePlatform(n,t,k.F$Y.project)}},f.map((function(e){return p.createElement(R,{key:e.id,value:e.id},"".concat(e.name,"(").concat(e.accountingCode,")"))})))},{label:"供应商成本科目",layout:{labelCol:{span:5},wrapperCol:{span:19}},form:p.createElement(S.Z,{placeholder:"请选择",showSearch:!0,style:{width:"100%"},allowClear:!0,optionFilterProp:"children",value:r[t][k.F$Y.headquarter]||void 0,onChange:function(n){return e.onChangeSupper(n,t,k.F$Y.headquarter)}},s.map((function(e){return p.createElement(R,{key:e.id,value:e.id},"".concat(e.name,"(").concat(e.accountingCode,")"))})))},{label:"城市成本科目",layout:{labelCol:{span:5},wrapperCol:{span:19}},form:p.createElement(S.Z,{placeholder:"请选择",showSearch:!0,allowClear:!0,style:{width:"100%"},optionFilterProp:"children",value:r[t][k.F$Y.city]||void 0,onChange:function(n){return e.onChangeCity(n,t,k.F$Y.city)}},c.map((function(e){return p.createElement(R,{key:e.id,value:e.id},"".concat(e.name,"(").concat(e.accountingCode,")"))})))},{label:"商圈成本科目",layout:{labelCol:{span:5},wrapperCol:{span:19}},form:p.createElement(S.Z,{placeholder:"请选择",style:{width:"100%"},showSearch:!0,allowClear:!0,optionFilterProp:"children",value:r[t][k.F$Y.district]||void 0,onChange:function(n){return e.onChangeBizDistrict(n,t,k.F$Y.district)}},l.map((function(e){return p.createElement(R,{key:e.id,value:e.id},"".concat(e.name,"(").concat(e.accountingCode,")"))})))}];return p.createElement(u.IT,{title:i,key:n},p.createElement(u.KP,{items:m,cols:2}))})),(0,s.Z)((0,a.Z)(e),"render",(function(){var t=e.props.accountings,n=Object.keys(t);return p.createElement("div",{style:{marginTop:20}},n.map((function(t,n){return e.renderContent(t,n)})))})),e}return n}(p.Component);(0,s.Z)(G,"propTypes",{accountings:x().object,subjectsData:x().array}),(0,s.Z)(G,"defaultProps",{accountings:{},subjectsData:[]});var B=G;function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var T=S.Z.Option,A=function(e){(0,i.Z)(n,e);var t=I(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"getAccountingsByConfig",(function(){var t=e.props.examineConfig,n=[];return Object.keys(t.accountings).forEach((function(e){Object.keys(t.accountings[e]).forEach((function(o){n.push(t.accountings[e][o])}))})),n})),(0,s.Z)((0,a.Z)(e),"getFlowsByConfig",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.props.examineConfig,o={};return Object.keys(n).forEach((function(e){if("accountings"!==e&&e!==t){var r=n[e].flow_id,a=n[e].cost_group_id;void 0!==o[r]?o[r].push(a):o[r]=[a]}})),o})),(0,s.Z)((0,a.Z)(e),"getCostCatalogByConfig",(function(t,n){var o=e.getFlowsByConfig(n);return void 0!==o[t]?o[t].filter((function(e){return""!==e})):[]})),(0,s.Z)((0,a.Z)(e),"getFlowDetailById",(function(t){var n;return e.props.examineFlows.forEach((function(e){e.id===t&&(n=e)})),n})),(0,s.Z)((0,a.Z)(e),"getFilteredCostCatalog",(function(t,n){if(h().empty(t))return[];var o=e.getFlowDetailById(t);if(h().not.existy(o)||h().empty(o))return[];var r=[],a=e.getAccountingsByConfig(),i=e.getFlowsByConfig(n);return w().get(o,"costCatalogScopeList",[]).forEach((function(e){var t=e.accountingIds;!1!==a.every((function(e){return t.includes(e)}))&&(void 0!==i[o.id]&&-1!==i[o.id].indexOf(e.id)||r.push(e))})),r})),(0,s.Z)((0,a.Z)(e),"renderContent",(function(t,n){var o=e.props,r=o.examineConfig,a=o.examineFlows,i="";"init"===t&&(i="新租／续签"),"period"===t&&(i="续租"),"break"===t&&(i="断租／退租");var l=r[t].flow_id,c=!1;a.find((function(e){l&&e.id===l&&(c=!0)}));var s=r[t].flow_id||void 0;c||(s=void 0);var f=e.getFilteredCostCatalog(l,t),m=[{label:"审批流名称",form:p.createElement(S.Z,{placeholder:"请选择",value:s,showSearch:!0,allowClear:!0,style:{width:"100%"},optionFilterProp:"children",onChange:function(n){e.props.onChangeExamine(n,t)}},a.map((function(e){return p.createElement(T,{key:e.id,value:"".concat(e.id)},e.name)})))},{label:"费用分组",form:p.createElement(S.Z,{placeholder:"请选择",value:r[t].cost_group_id||void 0,showSearch:!0,allowClear:!0,style:{width:"100%"},optionFilterProp:"children",onChange:function(o){return e.props.onChangeExpenseType(o,t,n)}},f.map((function(e,t){return p.createElement(T,{value:e.id,key:t},e.name)})))}];return p.createElement(u.IT,{title:i,key:n},p.createElement(u.KP,{items:m,cols:2,layout:{labelCol:{span:5},wrapperCol:{span:19}}}))})),(0,s.Z)((0,a.Z)(e),"render",(function(){var t=e.props.examineConfig,n=Object.keys(t).slice(1);return p.createElement("div",null,n.map((function(t,n){return e.renderContent(t,n)})))})),e}return n}(p.Component);(0,s.Z)(A,"propTypes",{examineConfig:x().object,examineFlows:x().array}),(0,s.Z)(A,"defaultProps",{examineConfig:{},examineFlows:[]});var V=A;function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var L=N.Iq.platform(),Y=function(e){(0,i.Z)(n,e);var t=M(n);function n(e){var o;(0,r.Z)(this,n),o=t.call(this,e),(0,s.Z)((0,a.Z)(o),"componentDidMount",(function(){var e=o.state.platformCodes;o.props.dispatch({type:"expenseExamineFlow/fetchExamineFlows",payload:{page:1,limit:1e3,platformCodes:e,isNewInterface:!1,state:k.BsX.normal,approvalType:k.ZBL.housing}}),o.props.dispatch({type:"expenseSubject/fetchExpenseSubjects",payload:{page:1,limit:1e3,state:[k.NF3.normal]}});var t={feature:"house_contract",platforms:L.map((function(e){return e.id}))};o.props.dispatch({type:"expenseExamineFlow/fetchExamineFlowConfig",payload:t})})),(0,s.Z)((0,a.Z)(o),"componentDidUpdate",(function(e){if(e.examineFlowConfig!==o.props.examineFlowConfig){var t=w().get(o.props,"examineFlowConfig",O),n={};L.forEach((function(e){h().existy(t[e.id])&&h().not.empty(t[e.id])?n[e.id]=t[e.id]:n[e.id]=O[e.id]})),o.setState({examineFlowConfig:n})}})),(0,s.Z)((0,a.Z)(o),"onChangeActiveKey",(function(e){o.setState({platformCodes:e}),o.props.dispatch({type:"expenseExamineFlow/fetchExamineFlows",payload:{page:1,limit:1e3,platformCodes:e,state:k.BsX.normal,approvalType:k.ZBL.housing}})})),(0,s.Z)((0,a.Z)(o),"onChangeAccountings",(function(e,t,n){var r=o.state,a=r.platformCodes,i=r.examineFlowConfig;Object.keys(i[a]).slice(1).forEach((function(e){i[a][e].cost_group_id=""})),i[a].accountings[t][n]=e,o.setState({examineFlowConfig:i})})),(0,s.Z)((0,a.Z)(o),"onChangeExamine",(function(e,t){var n=o.state,r=n.examineFlowConfig,a=n.platformCodes;o.setState({examineFlowConfig:_()(r,(0,s.Z)({},a,(0,s.Z)({},t,{flow_id:{$set:e},cost_group_id:{$set:""}})))})})),(0,s.Z)((0,a.Z)(o),"onChangeExpenseType",(function(e,t){var n=o.state,r=n.examineFlowConfig;r[n.platformCodes][t].cost_group_id=e,o.setState({examineFlowConfig:r})})),(0,s.Z)((0,a.Z)(o),"onJudgeEmpty",(function(e){var t=!1;return function e(n){for(var o in n)"object"===(0,d.Z)(n[o])?e(n[o]):(h().not.existy(n[o])||h().empty(n[o]))&&(t=!0)}(e),t})),(0,s.Z)((0,a.Z)(o),"onGetObjectKeys",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],n=function e(n){for(var o in n)"object"===(0,d.Z)(n[o])?e(n[o]):t.push(o)};return n(e),t})),(0,s.Z)((0,a.Z)(o),"onVerifyExamineFlowConfig",(function(){var e,t=o.state.examineFlowConfig;if(L.forEach((function(n){var r=o.onGetObjectKeys(O[n.id]),a=o.onGetObjectKeys(t[n.id]);(o.onJudgeEmpty(t[n.id])||r.length!==a.length)&&(e=!0,m.ZP.error("您的".concat(n.name,"审批流配置还有未选中项!")))})),!0!==e)return!0})),(0,s.Z)((0,a.Z)(o),"onVerifyOption",(function(){var e=o.state,t=e.examineFlowConfig,n=e.platformCodes;return!o.onJudgeEmpty(t[n])||(m.ZP.error("您的".concat(n,"审批流配置还有未选中项!")),!1)})),(0,s.Z)((0,a.Z)(o),"onSubmit",(function(){var e=o.state,t=e.examineFlowConfig,n=e.platformCodes,r=H(H({},w().get(o.props,"examineFlowConfig",{})),{},(0,s.Z)({},n,t[n])),a=o.onVerifyOption(),i={feature:"house_contract",platforms:L.map((function(e){return e.id})),options:r,onSuccessCallback:o.onSuccessCallback};a&&o.props.dispatch({type:"expenseExamineFlow/updateExamineFlowConfig",payload:i})})),(0,s.Z)((0,a.Z)(o),"onSuccessCallback",(function(){window.location.href="/#/Expense/ExamineFlow/Process"})),(0,s.Z)((0,a.Z)(o),"renderTabs",(function(){var e=o.state.platformCodes,t={items:L.map((function(e){return{key:e.id,title:e.name,content:o.renderContent(e.id)}})),defaultActiveKey:e,onChange:o.onChangeActiveKey};return p.createElement(u.DF,t)})),(0,s.Z)((0,a.Z)(o),"renderContent",(function(e){var t=o.props,n=t.examineList,r=t.subjectsData,a=o.state.examineFlowConfig,i={subjectsData:w().get(r,"data",[]),accountings:a[e].accountings,onChangeSupper:o.onChangeAccountings,onChangePlatform:o.onChangeAccountings,onChangeBizDistrict:o.onChangeAccountings,onChangeCity:o.onChangeAccountings},l={examineFlows:w().get(n,"data",[]),examineConfig:a[e],onChangeExpenseType:o.onChangeExpenseType,onChangeExamine:o.onChangeExamine,form:o.props.form};return p.createElement("div",null,p.createElement(B,i),p.createElement(V,l))})),(0,s.Z)((0,a.Z)(o),"render",(function(){return p.createElement("div",{className:j},o.renderTabs(),p.createElement("div",{className:q},p.createElement(f.Z,{type:"primary",onClick:o.onSubmit,className:P},"确定"),p.createElement(f.Z,{type:"default",onClick:function(){window.location.href="/#/Expense/ExamineFlow/Process"}},"取消")))}));var i,l=w().get(e,"examineFlowConfig",O),c={};return L.forEach((function(e){h().existy(l[e.id])&&h().not.empty(l[e.id])?c=g().cloneDeep(l):c[e.id]=O[e.id]})),h().existy(L)&&h().not.empty(L)&&(i=L[0].id),o.state={examineFlowConfig:c,platformCodes:i},o.private={isSubmit:!0},o}return n}(p.Component);(0,s.Z)(Y,"propTypes",{examineList:x().object,subjectsData:x().object}),(0,s.Z)(Y,"defaultProps",{examineList:{},subjectsData:{}});var $=E.Z.create()((0,Z.connect)((function(e){var t=e.expenseExamineFlow;return{examineFlowConfig:t.examineFlowConfig,examineList:t.examineList,subjectsData:e.expenseSubject.subjectsData}}))(Y)),W=n(87462),U=n(43144),X=n(49101),Q=n(1058),J=n(1413),ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},te=n(30076),ne=function(e,t){return p.createElement(te.Z,(0,J.Z)((0,J.Z)({},e),{},{ref:t,icon:ee}))};ne.displayName="CopyOutlined";var oe=p.forwardRef(ne),re=n(88144),ae="A8V8sIP10EBgZ5jyyO4I",ie="d7ocYOdvxH04ScbURz2g",le="tBXlzk211l962miPBVzD";function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var ue={openCreate:"openCreate",openDelete:"openDelete"},fe=function(e){(0,i.Z)(n,e);var t=pe(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"onChange",(function(t){var n=e.props,o=n.operateKey,r=n.onChange,a=n.uniqueKey;r&&r(o,se(se({},t),{},{uniqueKey:a}))})),(0,s.Z)((0,a.Z)(e),"onChangeExamineFlow",(function(t,n){var o=e.props.value,r=void 0===o?{}:o,a=n.name;e.onChange(se(se({},r),{},{platformName:a,examineFlow:t}))})),(0,s.Z)((0,a.Z)(e),"onChangeSupplier",(function(t,n,o){var r=e.props,a=r.value,i=void 0===a?{}:a,l=r.form,c=i.examineFlow,s=i.platformName,p=i.domain,u=[];n.forEach((function(e){u.push(w().get(e,"props.children",""))})),!0!==o&&(p=k.G5q.supplier),!0===o&&(p=k.G5q.platform),e.onChange({examineFlow:c,supplier:t,city:[],cityCodes:[],district:[],domain:p,supplierName:u,cityName:[],districtName:[],platformName:s}),l.setFieldsValue({cities:[]}),l.setFieldsValue({districts:[]})})),(0,s.Z)((0,a.Z)(e),"onChangeCity",(function(t,n,o){var r=e.props,a=r.value,i=void 0===a?{}:a,l=r.form,c=i.examineFlow,s=i.supplier,p=i.supplierName,u=i.platformName,f=i.domain,m=[];n.forEach((function(e){m.push(w().get(e,"props.children",""))})),!0===o&&(f=k.G5q.supplier),!0===o&&f===k.G5q.platform&&(f=k.G5q.platform),!0===o&&f===k.G5q.supplier&&(f=k.G5q.supplier),!0!==o||f!==k.G5q.city&&f!==k.G5q.district||(f=k.G5q.supplier),!0===o&&1===t.length&&(f=k.G5q.city),!0!==o&&(f=k.G5q.city);var d=n.map((function(e){return e.props.spell}));e.onChange({examineFlow:c,supplier:s,city:d,cityCodes:t,district:[],domain:f,platformName:u,supplierName:p,cityName:m,districtName:[]}),l.setFieldsValue({districts:[]})})),(0,s.Z)((0,a.Z)(e),"onChangeDistrict",(function(t,n,o){var r=e.props.value,a=void 0===r?{}:r,i=a.examineFlow,l=a.supplier,c=a.city,s=a.cityCodes,p=a.supplierName,u=a.cityName,f=a.platformName,m=a.domain,d=[];n.forEach((function(e){d.push(w().get(e,"props.children",""))})),!0===o&&m===k.G5q.platform&&(m=k.G5q.platform),!0===o&&m===k.G5q.supplier&&(m=k.G5q.supplier),!0===o&&m===k.G5q.city&&(m=k.G5q.city),!0===o&&m===k.G5q.district&&(m=k.G5q.city),!0===o&&1===t.length&&(m=k.G5q.district),!0===o&&m===k.G5q.district&&(m=k.G5q.city),!0!==o&&(m=k.G5q.district),e.onChange({examineFlow:i,supplier:l,city:c,cityCodes:s,district:t,domain:m,platformName:f,supplierName:p,cityName:u,districtName:d})})),(0,s.Z)((0,a.Z)(e),"onCreate",(function(){var t=e.props,n=t.operateKey,o=t.onCreate;o&&o(n)})),(0,s.Z)((0,a.Z)(e),"onDelete",(function(){var t=e.props,n=t.operateKey,o=t.onDelete;o&&o(n)})),(0,s.Z)((0,a.Z)(e),"onCopy",(function(){var t=e.props,n=t.onCopy,o=t.value;n&&n(o)})),(0,s.Z)((0,a.Z)(e),"renderDetail",(function(){var t=e.props,n=t.value,o=void 0===n?{}:n,r=t.form,a=void 0===r?{}:r,i=t.platformCodes,l=a.getFieldDecorator,c=o.supplierName,s=o.cityName,u=o.districtName,f=o.platformName;return[{label:"审批流",span:5,layout:{labelCol:{span:8},wrapperCol:{span:16}},form:l("examineFlowName",{rules:[{required:!0}]})(p.createElement("span",null,f))},{label:"平台",span:2,layout:{labelCol:{span:12},wrapperCol:{span:12}},form:p.createElement("span",null,N.Iq.platformFilter(i))},{label:"供应商",span:5,layout:{labelCol:{span:8},wrapperCol:{span:16,style:{overflowY:"auto",maxHeight:"80px"}}},form:l("suppliersName",{rules:[{required:!0}]})(p.createElement("div",null,c?c.map((function(e,t){return p.createElement("p",{key:t},e)})):""))},{label:"城市",span:4,layout:{labelCol:{span:8},wrapperCol:{span:16,style:{overflowY:"auto",maxHeight:"80px"}}},form:l("citiesName",{rules:[{required:!0}]})(p.createElement("div",null,s?s.map((function(e,t){return p.createElement("p",{key:t},e)})):""))},{label:"商圈",span:5,layout:{labelCol:{span:6},wrapperCol:{span:18,style:{overflowY:"auto",maxHeight:"80px"}}},form:l("districtsName",{rules:[{required:!0}]})(p.createElement("div",null,u?u.map((function(e,t){return p.createElement("p",{key:t},e)})):""))}]})),(0,s.Z)((0,a.Z)(e),"renderForm",(function(){var t=e.props,n=t.value,o=void 0===n?{}:n,r=t.form,a=void 0===r?{}:r,i=t.uniqueKey,l=void 0===i?void 0:i,c=t.platformCodes,s=a.getFieldDecorator,u=o.supplier,f=void 0===u?[]:u,m=o.city,d=void 0===m?[]:m,y=o.cityCodes,h=void 0===y?[]:y,C=o.district,g=void 0===C?[]:C,v=o.examineFlow;return[{label:"审批流",span:5,layout:{labelCol:{span:8},wrapperCol:{span:16}},form:s("examineFlow",{rules:[{required:!0,message:"请选择审批流"}],initialValue:(void 0===v?void 0:v)||[]})(p.createElement(re.Z6,{className:ae,namespace:l,placeholder:"请选择审批流",platformCodes:c,bizType:k.z_o.noCostOf,onChange:e.onChangeExamineFlow,approvalType:k.ZBL.salaryRules}))},{label:"平台",span:2,layout:{labelCol:{span:12},wrapperCol:{span:12}},form:p.createElement("span",null,N.Iq.platformFilter(c))},{label:"供应商",span:5,layout:{labelCol:{span:8},wrapperCol:{span:16}},form:s("suppliers",{rules:[{required:!0,message:"请选择供应商"}],initialValue:f||[]})(p.createElement(re.o2,{style:{width:"100%"},className:"maxHeight",mode:"multiple",showArrow:!0,allowClear:!0,enableSelectAll:!0,optionFilterProp:"children",placeholder:"请选择供应商",namespace:l,state:k.Acu.enable,platforms:c,onChange:e.onChangeSupplier}))},{label:"城市",span:4,layout:{labelCol:{span:8},wrapperCol:{span:16}},form:s("cities",{rules:[{required:!0,message:"请选择城市"}],initialValue:h||[]})(p.createElement(re.Wn,{style:{width:"100%"},className:"maxHeight",mode:"multiple",showArrow:!0,allowClear:!0,enableSelectAll:!0,isExpenseModel:!0,placeholder:"请选择城市",optionFilterProp:"children",namespace:l,platforms:c,suppliers:f,onChange:e.onChangeCity}))},{label:"商圈",span:5,layout:{labelCol:{span:6},wrapperCol:{span:18}},form:s("districts",{rules:[{required:!0,message:"请选择商圈"}],initialValue:g||[]})(p.createElement(re.Wc,{style:{width:"100%"},className:"maxHeight",mode:"multiple",showArrow:!0,allowClear:!0,enableSelectAll:!0,placeholder:"请选择商圈",optionFilterProp:"children",namespace:l,platforms:c,suppliers:f,cities:d,onChange:e.onChangeDistrict}))}]})),e}return(0,U.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.config,n=void 0===t?[]:t,o=e.isEdit,r=void 0!==o&&o?this.renderForm():this.renderDetail();return n.includes(ue.openCreate)&&n.includes(ue.openDelete)?r[r.length]={span:3,layout:{labelCol:{span:0},wrapperCol:{span:22,push:2}},form:p.createElement("div",null,p.createElement(f.Z,{className:ie,onClick:this.onCreate,shape:"circle",icon:p.createElement(X.Z,null)}),p.createElement(f.Z,{className:ie,onClick:this.onDelete,shape:"circle",icon:p.createElement(Q.Z,null)}),p.createElement(f.Z,{shape:"circle",icon:p.createElement(oe,null),onClick:this.onCopy}))}:n.includes(ue.openCreate)?r[r.length]={span:3,layout:{labelCol:{span:0},wrapperCol:{span:22,push:2}},form:p.createElement("div",null,p.createElement(f.Z,{onClick:this.onCreate,shape:"circle",icon:p.createElement(X.Z,null)}),p.createElement(f.Z,{className:le,shape:"circle",icon:p.createElement(oe,null),onClick:this.onCopy}))}:n.includes(ue.openDelete)&&(r[r.length]={span:3,layout:{labelCol:{span:0},wrapperCol:{span:22,push:2}},form:p.createElement("div",null,p.createElement(f.Z,{onClick:this.onDelete,shape:"circle",icon:p.createElement(Q.Z,null)}),p.createElement(f.Z,{className:le,shape:"circle",icon:p.createElement(oe,null),onClick:this.onCopy}))}),p.createElement("div",null,p.createElement(u.KP,{items:r}))}}]),n}(p.Component);(0,s.Z)(fe,"propTypes",{value:x().object,platformCodes:x().string,config:x().array,isEdit:x().bool,onChange:x().func,uniqueKey:x().string,operateKey:x().number,onCreate:x().func,onDelete:x().func,onCopy:x().func}),(0,s.Z)(fe,"defaultProps",{value:{},platformCodes:"",config:[],isEdit:!0,onChange:function(){},uniqueKey:"",operateKey:0,onCreate:function(){},onDelete:function(){},onCopy:function(){}});var me=E.Z.create()(fe);me.itemsConfig=ue;var de=me,ye="Lmwbxv2hmcLVvzluyCXm",he="fJ0tSKxOuVvyXmS9FfKE",Ce="Tcn__UABrpdnAHmhaSTr";function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var ve=de.itemsConfig,we=N.Iq.platform(),Ze=function(e){(0,i.Z)(n,e);var t=ge(n);function n(){var e,o;return(0,r.Z)(this,n),e=t.call(this),(0,s.Z)((0,a.Z)(e),"componentDidMount",(function(){var t={platforms:we.map((function(e){return e.id}))};e.props.dispatch({type:"expenseExamineFlow/fetchSalaryPlanConfig",payload:t})})),(0,s.Z)((0,a.Z)(e),"onChangeActiveKey",(function(t){e.setState({platformCodes:t})})),(0,s.Z)((0,a.Z)(e),"onChangeItems",(function(t,n){var o=e.state,r=o.examineFlowConfig,a=o.platformCodes,i={platform_code:a,flow_id:n.examineFlow,supplier_ids:n.supplier,city_codes:n.cityCodes,city_spelling_list:n.city,biz_district_ids:n.district,domain:n.domain,uniqueKey:n.uniqueKey,supplierName:n.supplierName,cityName:n.cityName,districtName:n.districtName,platformName:n.platformName};w().set(r[a],"".concat(t),i),e.setState({examineFlowConfig:r})})),(0,s.Z)((0,a.Z)(e),"onDelete",(function(t){var n=e.state,o=n.platformCodes,r=n.examineFlowConfig;r[o]&&(r[o].splice(t,1),e.setState({examineFlowConfig:r}))})),(0,s.Z)((0,a.Z)(e),"onCreate",(function(t){var n=e.state,o=n.platformCodes,r=n.examineFlowConfig,a=w().get(r[o],"".concat(t));if(h().not.existy(a.flow_id)||h().empty(a.supplier_ids)||h().empty(a.city_codes)||h().empty(a.biz_district_ids))return m.ZP.error("您的配置项还没填写完成");r[o]&&r[o].push({uniqueKey:Math.random().toString(36).substr(2)}),e.setState({examineFlowConfig:r})})),(0,s.Z)((0,a.Z)(e),"onCopy",(function(t){var n=e.state,o=n.platformCodes,r=n.examineFlowConfig,a=w().get(r[o],"".concat(r[o].length-1));if(1!==r[o].length&&(h().not.existy(a.flow_id)||h().empty(a.supplier_ids)||h().empty(a.city_codes)||h().empty(a.biz_district_ids))&&r[o].pop(),h().not.existy(t.examineFlow)||h().empty(t.supplier)||h().empty(t.cityCodes)||h().empty(t.district))return m.ZP.error("您的配置项还没填写完成");var i={flow_id:t.examineFlow,supplier_ids:t.supplier,city_codes:t.cityCodes,biz_district_ids:t.district,domain:t.domain,uniqueKey:Math.random().toString(36).substr(2),supplierName:t.supplierName,cityName:t.cityName,districtName:t.districtName,platformName:t.platformName};r[o]&&(r[o].push(i),e.setState({examineFlowConfig:r}))})),(0,s.Z)((0,a.Z)(e),"onVerify",(function(e){var t=!0;return e.forEach((function(e){h().empty(e)&&(t=!1),h().existy(e.flow_id)||(t=!1),h().empty(e.supplier_ids)&&(t=!1),h().empty(e.biz_district_ids)&&(t=!1),h().empty(e.city_codes)&&(t=!1),h().existy(e.domain)||(t=!1)})),t})),(0,s.Z)((0,a.Z)(e),"onSubmit",(function(){var t=e.state,n=t.examineFlowConfig,o=t.platformCodes,r=t.submitConfig,a={};if(we.forEach((function(e){o===e.id?a[o]=n[o]:a[e.id]=r[e.id]})),!e.onVerify(a[o]))return m.ZP.error("您的审批流配置（服务费规则配置）还有未选中项!");e.props.dispatch({type:"expenseExamineFlow/updateSalaryPlanConfig",payload:{platforms:we.map((function(e){return e.id})),options:a,onSuccessCallback:e.onSuccessCallback}})})),(0,s.Z)((0,a.Z)(e),"onSuccessCallback",(function(){window.location.href="/#/Expense/ExamineFlow/Process"})),(0,s.Z)((0,a.Z)(e),"renderTabs",(function(){var t=e.state.platformCodes,n={items:we.map((function(t){return{key:t.id,title:t.name,content:e.renderContent(t.id)}})),defaultActiveKey:t,onChange:e.onChangeActiveKey};return p.createElement(u.DF,n)})),(0,s.Z)((0,a.Z)(e),"renderContent",(function(){var t=e.state,n=t.platformCodes,o=void 0===n?void 0:n,r=t.examineFlowConfig,a=void 0===r?{}:r;a[o]&&!h().empty(a[o])||(a[o]=[{}]);var i=a[o];return p.createElement("div",{className:Ce},i.map((function(t,n,r){var a=r.length,l=[];1===a?l.push(ve.openCreate):n===a-1?l.push(ve.openCreate,ve.openDelete):l.push(ve.openDelete);var c=!1;1!==i.length&&n!==i.length-1||(c=!0);var s=t.uniqueKey?t.uniqueKey:"salaryPlan".concat(o).concat(t.flow_id).concat(n),u={config:l,uniqueKey:s,isEdit:c,platformCodes:o,onCreate:e.onCreate,onDelete:e.onDelete,onCopy:e.onCopy,onChange:e.onChangeItems,value:{examineFlow:t.flow_id,supplier:t.supplier_ids,city:t.city_spelling_list,cityCodes:t.city_codes,district:t.biz_district_ids,domain:t.domain,supplierName:t.supplierName,cityName:t.cityName,districtName:t.districtName,platformName:t.platformName},operateKey:n};return p.createElement(de,(0,W.Z)({key:s},u))})))})),h().existy(we)&&h().not.empty(we)&&(o=we[0].id),e.state={platformCodes:o,examineFlowConfig:void 0,submitConfig:void 0},e}return(0,U.Z)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"expenseExamineFlow/resetSalaryPlanConfig"})}},{key:"render",value:function(){return p.createElement("div",null,this.renderTabs(),p.createElement("div",{className:ye},p.createElement(f.Z,{type:"primary",onClick:this.onSubmit,className:he},"确定"),p.createElement(f.Z,{type:"default",onClick:function(){window.location.href="/#/Expense/ExamineFlow/Process"}},"取消")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.examineFlowConfig,o=void 0===n?void 0:n,r=t.submitConfig,a=void 0===r?void 0:r,i=e.salaryPlanConfig,l=void 0===i?{}:i;return void 0===o&&Object.keys(l).length>0?{examineFlowConfig:g().cloneDeep(l)}:void 0===a&&Object.keys(l).length>0?{submitConfig:g().cloneDeep(l)}:null}}]),n}(p.Component);var be=(0,Z.connect)((function(e){return{salaryPlanConfig:e.expenseExamineFlow.salaryPlanConfig}}))(Ze),xe=n(8240);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var Ne=u.Hr.Option,De=function(e){(0,i.Z)(n,e);var t=_e(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"componentDidMount",(function(){var t=e.props,n=t.flowId,o=t.namespace;h().existy(n)&&e.props.dispatch({type:"expenseExamineFlow/fetchExamineFlowDetail",payload:{id:n,namespace:o}})})),(0,s.Z)((0,a.Z)(e),"render",(function(){var t=e.props,n=t.examineFlowDetail,o=void 0===n?{}:n,r=t.namespace,a=w().get(o,r,{}),i=[];h().existy(a)&&h().existy(a.costCatalogScopeList)&&h().array(a.costCatalogScopeList)&&(i=a.costCatalogScopeList);var l=i.map((function(e){return p.createElement(Ne,{key:e.id,value:"".concat(e.id)},e.name)})),c=Fe({},e.props),s=(0,xe.CE)(["dispatch","flowId","namespace","examineFlowDetail"],c);return p.createElement(u.Hr,s,l)})),e}return(0,U.Z)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.namespace,o=t.flowId,r=t.examineFlowDetail,a=t.dispatch;g().isEqual(o,e.flowId)&&g().isEqual(n,e.namespace)||!(Object.keys(w().get(r,n,{})).length<=0)||a({type:"expenseExamineFlow/fetchExamineFlowDetail",payload:{id:o,namespace:n}})}}]),n}(p.Component);(0,s.Z)(De,"propTypes",{flowId:x().string,namespace:x().string,examineFlowDetail:x().object}),(0,s.Z)(De,"defaultProps",{flowId:"",namespace:"default",examineFlowDetail:{}});var Oe=(0,Z.connect)((function(e){return{examineFlowDetail:e.expenseExamineFlow.examineFlowDetail}}))(De);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var Se=u.Hr.Option,ke=function(e){(0,i.Z)(n,e);var t=Pe(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"componentDidMount",(function(){var t=e.props,n=t.flowId,o=t.namespace;h().existy(n)&&e.props.dispatch({type:"expenseExamineFlow/fetchExamineFlowDetail",payload:{id:n,namespace:o}})})),(0,s.Z)((0,a.Z)(e),"render",(function(){var t=e.props,n=t.examineFlowDetail,o=t.typeId,r=t.namespace,a=t.showDisabledSubject,i=w().get(n,r,{}),l=[],c=[];h().existy(i)&&h().existy(i.costCatalogScopeList)&&h().array(i.costCatalogScopeList)&&(l=i.costCatalogScopeList.find((function(e){return e.id===o}))),h().existy(l)&&h().not.empty(l)&&(c=l.accountingList);var s=(a?c.filter((function(e){return[k.NF3.normal,k.NF3.disable].indexOf(e.state)>-1})):c.filter((function(e){return[k.NF3.normal].indexOf(e.state)>-1}))).map((function(e){return p.createElement(Se,{key:e.id,value:"".concat(e.id),disabled:e.state===k.NF3.disable},"".concat(e.name,"(").concat(e.accountingCode,")").concat(e.state===k.NF3.disable?"(停用)":""))})),f=qe({},e.props),m=(0,xe.CE)(["dispatch","flowId","typeId","namespace","examineFlowDetail","showDisabledSubject"],f);return p.createElement(u.Hr,m,s)})),e}return(0,U.Z)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.namespace,o=t.flowId,r=t.examineFlowDetail,a=t.dispatch,i=t.typeId;g().isEqual(o,e.flowId)&&g().isEqual(i,e.typeId)||!(Object.keys(w().get(r,n,{})).length<=0)||a({type:"expenseExamineFlow/fetchExamineFlowDetail",payload:{id:o,namespace:n}})}}]),n}(p.Component);(0,s.Z)(ke,"propTypes",{flowId:x().string,typeId:x().string,namespace:x().string,examineFlowDetail:x().object,showDisabledSubject:x().bool}),(0,s.Z)(ke,"defaultProps",{flowId:"",typeId:"",namespace:"default",examineFlowDetail:{},showDisabledSubject:!1});var Ke=(0,Z.connect)((function(e){return{examineFlowDetail:e.expenseExamineFlow.examineFlowDetail}}))(ke),Re="Xu77PQrQR89WCnqCw23W",Ge="ukZRvdzC0W5et_EXsWIM";function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var Ae={openCreate:"openCreate",openDelete:"openDelete"},Ve=function(e){(0,i.Z)(n,e);var t=Te(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,a.Z)(e),"onChange",(function(t){var n=e.props,o=n.operateKey,r=n.onChange,a=n.uniqueKey;r&&r(o,Ie(Ie({},t),{},{uniqueKey:a}))})),(0,s.Z)((0,a.Z)(e),"onChangeExamineFlow",(function(t,n){var o=e.props,r=o.form,a=void 0===r?{}:r,i=o.value,l=void 0===i?{}:i,c=n.name;e.onChange(Ie(Ie({},l),{},{examineFlow:t,expenseType:void 0,subject:void 0,typeName:void 0,subjectName:void 0,platformName:c})),a.setFieldsValue({type:[],subject:[]})})),(0,s.Z)((0,a.Z)(e),"onChangeType",(function(t,n){var o=e.props,r=o.form,a=void 0===r?{}:r,i=o.value,l=void 0===i?{}:i,c=n.props?n.props.children:"";e.onChange(Ie(Ie({},l),{},{expenseType:t,subject:void 0,typeName:c,subjectName:void 0})),a.setFieldsValue({subject:[]})})),(0,s.Z)((0,a.Z)(e),"onChangeSubject",(function(t,n){var o=e.props.value,r=void 0===o?{}:o,a=n.props?n.props.children:"";e.onChange(Ie(Ie({},r),{},{subject:t,subjectName:a}))})),(0,s.Z)((0,a.Z)(e),"onChangeSupplier",(function(t,n,o){var r=e.props,a=r.form,i=void 0===a?{}:a,l=r.value,c=void 0===l?{}:l,s=c.domain,p=[];n.forEach((function(e){p.push(w().get(e,"props.children",""))})),!0!==o&&(s=k.G5q.supplier),!0===o&&(s=k.G5q.platform),e.onChange(Ie(Ie({},c),{},{supplier:t,city:[],cityCodes:[],district:[],domain:s,supplierName:p,cityName:[],districtName:[]})),i.setFieldsValue({cities:[],districts:[]})})),(0,s.Z)((0,a.Z)(e),"onChangeCity",(function(t,n,o){var r=e.props,a=r.form,i=void 0===a?{}:a,l=r.value,c=void 0===l?{}:l,s=c.domain,p=[];n.forEach((function(e){p.push(w().get(e,"props.children",""))})),!0===o&&(s=k.G5q.supplier),!0===o&&s===k.G5q.platform&&(s=k.G5q.platform),!0===o&&s===k.G5q.supplier&&(s=k.G5q.supplier),!0!==o||s!==k.G5q.city&&s!==k.G5q.district||(s=k.G5q.supplier),!0===o&&1===t.length&&(s=k.G5q.city),!0!==o&&(s=k.G5q.city);var u=n.map((function(e){return e.props.spell}));e.onChange(Ie(Ie({},c),{},{city:u,cityCodes:t,district:[],domain:s,cityName:p,districtName:[]})),i.setFieldsValue({districts:[]})})),(0,s.Z)((0,a.Z)(e),"onChangeDistrict",(function(t,n,o){var r=e.props.value,a=void 0===r?{}:r,i=a.domain,l=[];n.forEach((function(e){l.push(w().get(e,"props.children",""))})),!0===o&&i===k.G5q.platform&&(i=k.G5q.platform),!0===o&&i===k.G5q.supplier&&(i=k.G5q.supplier),!0===o&&i===k.G5q.city&&(i=k.G5q.city),!0===o&&i===k.G5q.district&&(i=k.G5q.city),!0===o&&1===t.length&&(i=k.G5q.district),!0===o&&i===k.G5q.district&&(i=k.G5q.city),!0!==o&&(i=k.G5q.district),e.onChange(Ie(Ie({},a),{},{district:t,domain:i,districtName:l}))})),(0,s.Z)((0,a.Z)(e),"onCreate",(function(){var t=e.props,n=t.operateKey,o=t.onCreate;o&&o(n)})),(0,s.Z)((0,a.Z)(e),"onDelete",(function(){var t=e.props,n=t.operateKey,o=t.onDelete;o&&o(n)})),(0,s.Z)((0,a.Z)(e),"onCopy",(function(){var t=e.props,n=t.value,o=void 0===n?{}:n,r=t.onCopy;r&&r(o)})),(0,s.Z)((0,a.Z)(e),"renderDetail",(function(){var t=e.props,n=t.form,o=void 0===n?{}:n,r=t.value,a=void 0===r?{}:r,i=t.platformCodes,l=o.getFieldDecorator,c=a.supplierName,s=a.cityName,u=a.districtName,f=a.platformName,m=a.typeName,d=a.subjectName;return[{label:"审批流",span:4,form:l("examineFlowName",{rules:[{required:!0}]})(p.createElement("span",null,f))},{label:"费用分组",span:3,layout:{labelCol:{span:10},wrapperCol:{span:14}},form:l("typeName",{rules:[{required:!0}]})(p.createElement("span",null,m))},{label:"科目",span:3,layout:{labelCol:{span:10,pull:4},wrapperCol:{span:14,pull:4}},form:l("subjectName",{rules:[{required:!0}]})(p.createElement("span",null,d))},{label:"平台",span:2,layout:{labelCol:{span:10,pull:6},wrapperCol:{span:14,pull:6}},form:p.createElement("span",null,N.Iq.platformFilter(i))},{label:"供应商",span:3,layout:{labelCol:{span:8,pull:6},wrapperCol:{span:16,pull:6,style:{overflowY:"auto",maxHeight:"80px"}}},form:l("suppliersName",{rules:[{required:!0}]})(p.createElement("div",null,c?c.map((function(e,t){return p.createElement("p",{key:t},e)})):""))},{label:"城市",span:3,layout:{labelCol:{span:8,pull:4},wrapperCol:{span:16,pull:4,style:{overflowY:"auto",maxHeight:"80px"}}},form:l("citiesName",{rules:[{required:!0}]})(p.createElement("div",null,s?s.map((function(e,t){return p.createElement("p",{key:t},e)})):""))},{label:"商圈",span:4,layout:{labelCol:{span:6},wrapperCol:{span:18,style:{overflowY:"auto",maxHeight:"80px"}}},form:l("districtsName",{rules:[{required:!0}]})(p.createElement("div",null,u?u.map((function(e,t){return p.createElement("p",{key:t},e)})):""))}]})),(0,s.Z)((0,a.Z)(e),"renderForm",(function(){var t=e.props,n=t.value,o=void 0===n?{}:n,r=t.form,a=void 0===r?{}:r,i=t.uniqueKey,l=void 0===i?void 0:i,c=t.platformCodes,s=a.getFieldDecorator,u=o.supplier,f=o.city,m=o.cityCodes,d=o.district,y=o.examineFlow,h=o.expenseType,C=o.subject;return[{label:"审批流",span:4,form:s("examineFlow",{rules:[{required:!0,message:"请选择审批流"}],initialValue:y||[]})(p.createElement(re.Z6,{style:{width:"100%"},namespace:l,placeholder:"请选择审批流",platformCodes:c,bizType:k.z_o.costOf,onChange:e.onChangeExamineFlow,approvalType:k.ZBL.salaryIssue}))},{label:"费用分组",span:3,layout:{labelCol:{span:10},wrapperCol:{span:14}},form:s("type",{rules:[{required:!0,message:"请选择费用分组"}],initialValue:h||[]})(p.createElement(Oe,{placeholder:"请选择费用分组",namespace:l,style:{width:"100%"},flowId:y,onChange:e.onChangeType}))},{label:"科目",span:3,layout:{labelCol:{span:10,pull:4},wrapperCol:{span:14,pull:4}},form:s("subject",{rules:[{required:!0,message:"请选择科目"}],initialValue:C||[]})(p.createElement(Ke,{placeholder:"请选择科目",namespace:l,style:{width:"100%"},flowId:y,typeId:h,showDisabledSubject:!0,onChange:e.onChangeSubject}))},{label:"平台",span:2,layout:{labelCol:{span:10,pull:6},wrapperCol:{span:14,pull:6}},form:p.createElement("span",null,N.Iq.platformFilter(c))},{label:"供应商",span:3,layout:{labelCol:{span:8,pull:6},wrapperCol:{span:16,pull:6}},form:s("suppliers",{rules:[{required:!0,message:"请选择供应商"}],initialValue:u||[]})(p.createElement(re.o2,{style:{width:150},className:"maxHeight",mode:"multiple",showArrow:!0,allowClear:!0,enableSelectAll:!0,optionFilterProp:"children",placeholder:"请选择供应商",namespace:l,state:k.Acu.enable,platforms:c,onChange:e.onChangeSupplier}))},{label:"城市",span:3,layout:{labelCol:{span:8,pull:4},wrapperCol:{span:16,pull:4}},form:s("cities",{rules:[{required:!0,message:"请选择城市"}],initialValue:m||[]})(p.createElement(re.Wn,{style:{width:150},className:"maxHeight",mode:"multiple",allowClear:!0,showArrow:!0,enableSelectAll:!0,isExpenseModel:!0,placeholder:"请选择城市",optionFilterProp:"children",namespace:l,platforms:c,suppliers:u,onChange:e.onChangeCity}))},{label:"商圈",span:4,layout:{labelCol:{span:6},wrapperCol:{span:18}},form:s("districts",{rules:[{required:!0,message:"请选择商圈"}],initialValue:d||[]})(p.createElement(re.Wc,{style:{width:"100%"},className:"maxHeight",mode:"multiple",allowClear:!0,showArrow:!0,enableSelectAll:!0,placeholder:"请选择商圈",optionFilterProp:"children",namespace:l,platforms:c,suppliers:u,cities:f,onChange:e.onChangeDistrict}))}]})),e}return(0,U.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.config,n=void 0===t?[]:t,o=e.isEdit,r=void 0===o||o?this.renderForm():this.renderDetail();return n.includes(Ae.openCreate)&&n.includes(Ae.openDelete)?r.push({span:2,layout:{labelCol:{span:0},wrapperCol:{span:22}},form:p.createElement("div",null,p.createElement(f.Z,{className:Re,onClick:this.onCreate,shape:"circle",icon:p.createElement(X.Z,null)}),p.createElement(f.Z,{className:Re,onClick:this.onDelete,shape:"circle",icon:p.createElement(Q.Z,null)}),p.createElement(f.Z,{shape:"circle",icon:p.createElement(oe,null),onClick:this.onCopy}))}):n.includes(Ae.openCreate)?r.push({span:2,layout:{labelCol:{span:0},wrapperCol:{span:22}},form:p.createElement("div",null,p.createElement(f.Z,{onClick:this.onCreate,shape:"circle",icon:p.createElement(X.Z,null)}),p.createElement(f.Z,{className:Ge,shape:"circle",icon:p.createElement(oe,null),onClick:this.onCopy}))}):n.includes(Ae.openDelete)&&r.push({span:2,layout:{labelCol:{span:0},wrapperCol:{span:22}},form:p.createElement("div",null,p.createElement(f.Z,{onClick:this.onDelete,shape:"circle",icon:p.createElement(Q.Z,null)}),p.createElement(f.Z,{className:Ge,shape:"circle",icon:p.createElement(oe,null),onClick:this.onCopy}))}),p.createElement("div",null,p.createElement(u.KP,{items:r,style:{minWidth:1600}}))}}]),n}(p.Component);(0,s.Z)(Ve,"propTypes",{value:x().object,platformCodes:x().string,config:x().array,isEdit:x().bool,onChange:x().func,uniqueKey:x().string,operateKey:x().number,onCreate:x().func,onDelete:x().func,onCopy:x().func}),(0,s.Z)(Ve,"defaultProps",{value:{},platformCodes:"",config:[],isEdit:!0,onChange:function(){},uniqueKey:"",operateKey:0,onCreate:function(){},onDelete:function(){},onCopy:function(){}});var ze=E.Z.create()(Ve);ze.itemsConfig=Ae;var He=ze,Me="roCxMfmFOiPEuiy_BogQ",Le="n_4ZHTbjAzitLMUZZnKf",Ye="MoWKfGG0aQX6xMppBaTC";function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var We=He.itemsConfig,Ue=N.Iq.platform(),Xe=function(e){(0,i.Z)(n,e);var t=$e(n);function n(){var e,o;return(0,r.Z)(this,n),e=t.call(this),(0,s.Z)((0,a.Z)(e),"componentDidMount",(function(){var t={platforms:Ue.map((function(e){return e.id}))};e.props.dispatch({type:"expenseExamineFlow/fetchSalaryDistribute",payload:t})})),(0,s.Z)((0,a.Z)(e),"onChangeActiveKey",(function(t){e.setState({platformCodes:t})})),(0,s.Z)((0,a.Z)(e),"onChangeItems",(function(t,n){var o=e.state,r=o.examineFlowConfig,a=void 0===r?{}:r,i=o.platformCodes,l={platform_code:i,flow_id:n.examineFlow,cost_group_id:n.expenseType,cost_accounting_id:n.subject,supplier_ids:n.supplier,city_codes:n.cityCodes,city_spelling_list:n.city,biz_district_ids:n.district,domain:n.domain,uniqueKey:n.uniqueKey,supplierName:n.supplierName,cityName:n.cityName,districtName:n.districtName,platformName:n.platformName,subjectName:n.subjectName,typeName:n.typeName};w().set(a[i],"".concat(t),l),e.setState({examineFlowConfig:a})})),(0,s.Z)((0,a.Z)(e),"onDelete",(function(t){var n=e.state,o=n.platformCodes,r=n.examineFlowConfig,a=void 0===r?{}:r;a[o]&&a[o].splice(t,1),e.setState({examineFlowConfig:a})})),(0,s.Z)((0,a.Z)(e),"onCreate",(function(t){var n=e.state,o=n.platformCodes,r=n.examineFlowConfig,a=void 0===r?{}:r,i=w().get(a[o],"".concat(t));if(h().not.existy(i.flow_id)||h().empty(i.supplier_ids)||h().empty(i.city_codes)||h().empty(i.biz_district_ids)||h().not.existy(i.cost_accounting_id)||h().not.existy(i.cost_group_id))return m.ZP.error("您的配置项还没填写完成");a[o]&&a[o].push({uniqueKey:Math.random().toString(36).substr(2)}),e.setState({examineFlowConfig:a})})),(0,s.Z)((0,a.Z)(e),"onCopy",(function(t){var n=e.state,o=n.platformCodes,r=n.examineFlowConfig,a=void 0===r?{}:r,i=w().get(a[o],"".concat(a[o].length-1));if(1!==a[o].length&&(h().not.existy(i.flow_id)||h().empty(i.supplier_ids)||h().empty(i.city_codes)||h().empty(i.biz_district_ids)||h().not.existy(i.cost_accounting_id)||h().not.existy(i.cost_group_id))&&a[o].pop(),h().not.existy(t.examineFlow)||h().empty(t.supplier)||h().empty(t.cityCodes)||h().empty(t.district)||h().not.existy(t.subject)||h().not.existy(t.expenseType))return m.ZP.error("您的配置项还没填写完成");var l={flow_id:t.examineFlow,cost_group_id:t.subject,cost_accounting_id:t.expenseType,supplier_ids:t.supplier,city_codes:t.cityCodes,biz_district_ids:t.district,domain:t.domain,uniqueKey:Math.random().toString(36).substr(2),supplierName:t.supplierName,cityName:t.cityName,districtName:t.districtName,platformName:t.platformName,typeName:t.typeName,subjectName:t.subjectName};a[o]&&a[o].push(l),e.setState({examineFlowConfig:a})})),(0,s.Z)((0,a.Z)(e),"onVerify",(function(e){var t=!0;return e.forEach((function(e){h().empty(e)&&(t=!1),h().existy(e.flow_id)||(t=!1),h().existy(e.cost_accounting_id)||(t=!1),h().existy(e.cost_group_id)||(t=!1),h().empty(e.supplier_ids)&&(t=!1),h().empty(e.biz_district_ids)&&(t=!1),h().empty(e.city_codes)&&(t=!1),h().existy(e.domain)||(t=!1)})),t})),(0,s.Z)((0,a.Z)(e),"onSubmit",(function(){var t=e.state,n=t.examineFlowConfig,o=void 0===n?{}:n,r=t.platformCodes,a=t.submitConfig,i=void 0===a?{}:a,l={};if(Ue.forEach((function(e){r===e.id?l[r]=o[r]:l[e.id]=i[e.id]})),!e.onVerify(l[r]))return m.ZP.error("您的审批流配置（服务费发放配置）还有未选中项!");e.props.dispatch({type:"expenseExamineFlow/updateSalaryDistribute",payload:{platforms:Ue.map((function(e){return e.id})),options:l,onSuccessCallback:e.onSuccessCallback}})})),(0,s.Z)((0,a.Z)(e),"onSuccessCallback",(function(){window.location.href="/#/Expense/ExamineFlow/Process"})),(0,s.Z)((0,a.Z)(e),"renderTabs",(function(){var t=e.state.platformCodes,n={items:Ue.map((function(t){return{key:t.id,title:t.name,content:e.renderContent(t.id)}})),defaultActiveKey:t,onChange:e.onChangeActiveKey};return p.createElement(u.DF,n)})),(0,s.Z)((0,a.Z)(e),"renderContent",(function(){var t=e.state,n=t.platformCodes,o=t.examineFlowConfig,r=void 0===o?{}:o;r[n]&&!h().empty(r[n])||(r[n]=[{}]);var a=r[n];return p.createElement("div",{className:Ye},a.map((function(t,o,r){var i=r.length,l=[];1===i?l.push(We.openCreate):o===i-1?l.push(We.openCreate,We.openDelete):l.push(We.openDelete);var c=!1;1!==a.length&&o!==a.length-1||(c=!0);var s=t.uniqueKey?t.uniqueKey:"salaryIssue".concat(n).concat(t.flow_id).concat(o),u={config:l,uniqueKey:s,isEdit:c,platformCodes:n,onCreate:e.onCreate,onDelete:e.onDelete,onCopy:e.onCopy,onChange:e.onChangeItems,value:{examineFlow:t.flow_id,expenseType:t.cost_group_id,subject:t.cost_accounting_id,supplier:t.supplier_ids,city:t.city_spelling_list,cityCodes:t.city_codes,district:t.biz_district_ids,domain:t.domain,supplierName:t.supplierName,cityName:t.cityName,districtName:t.districtName,platformName:t.platformName,subjectName:t.subjectName,typeName:t.typeName},operateKey:o};return p.createElement(He,(0,W.Z)({key:s},u))})))})),h().existy(Ue)&&h().not.empty(Ue)&&(o=Ue[0].id),e.state={platformCodes:o,examineFlowConfig:void 0,submitConfig:void 0},e}return(0,U.Z)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"expenseExamineFlow/resetSalaryDistribute"})}},{key:"render",value:function(){return p.createElement("div",null,this.renderTabs(),p.createElement("div",{className:Me},p.createElement(f.Z,{type:"primary",onClick:this.onSubmit,className:Le},"确定"),p.createElement(f.Z,{type:"default",onClick:function(){window.location.href="/#/Expense/ExamineFlow/Process"}},"取消")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.examineFlowConfig,o=void 0===n?void 0:n,r=t.submitConfig,a=void 0===r?void 0:r,i=e.salaryDistribute,l=void 0===i?{}:i;return void 0===o&&Object.keys(l).length>0?{examineFlowConfig:g().cloneDeep(l)}:void 0===a&&Object.keys(l).length>0?{submitConfig:g().cloneDeep(l)}:null}}]),n}(p.Component);var Qe=(0,Z.connect)((function(e){return{salaryDistribute:e.expenseExamineFlow.salaryDistribute}}))(Xe);function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return(0,l.Z)(this,n)}}var et=function(e){(0,i.Z)(n,e);var t=Je(n);function n(e){var o;return(0,r.Z)(this,n),o=t.call(this,e),(0,s.Z)((0,a.Z)(o),"renderCoreTabs",(function(){var e={items:[{title:k._6D.description("house_contract"),key:k._6D.houseManage,content:p.createElement($,null)},{title:k._6D.description("salary_plan"),key:k._6D.salaryPlan,content:p.createElement(be,null)},{title:k._6D.description("salary_payment"),key:k._6D.salaryIssue,content:p.createElement(Qe,null)}],type:"card",defaultActiveKey:k._6D.houseManage};return p.createElement(u.DF,e)})),(0,s.Z)((0,a.Z)(o),"render",(function(){return p.createElement("div",null,o.renderCoreTabs())})),o.state={},o.private={},o}return n}(p.Component)}}]);