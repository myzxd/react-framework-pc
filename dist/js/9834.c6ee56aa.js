"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[9834],{19834:function(e,t,n){n.r(t),n.d(t,{default:function(){return B}});n(51838);var r=n(48086),a=n(15671),o=n(43144),i=n(97326),c=n(60136),l=n(82963),s=n(61120),p=n(4942),u=n(55609),m=n(45697),d=n.n(m),f=n(67294),v=n(96036),h=n(45430),y=n(80385),Z=(n(21316),n(75443)),E=(n(52560),n(71577)),x=(n(9070),n(20924)),b=(n(54071),n(14072)),O=(n(29093),n(16317)),T=n(30381),w=n.n(T),k=(n(52466),n(10642)),g=n(71002),C=(n(39305),n(97880)),_=n(66939),D=(n(98703),n(88144)),F=n(53132);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var a=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var I=C.Z.Step,P=function(e){(0,c.Z)(n,e);var t=S(n);function n(){var e;return(0,a.Z)(this,n),e=t.call(this),(0,p.Z)((0,i.Z)(e),"onAdd",(function(){e.setState({visible:!0})})),(0,p.Z)((0,i.Z)(e),"onSubmit",(function(){e.props.form.validateFields((function(t,n){if(!t){var r={examineFlowId:n.examineFlowId,approvalType:y.ZBL.overTime,onSuccessCallback:e.onSuccessCallback,onFailureCallback:e.onFailureCallback};e.private.isSubmit&&(e.props.dispatch({type:"expenseExamineOrder/createExamineOrder",payload:r}),e.private.isSubmit=!1)}}))})),(0,p.Z)((0,i.Z)(e),"onSuccessCallback",(function(e){e&&e._id&&(window.location.href="/#/Expense/Attendance/OverTime/Create?applicationOrderId=".concat(e._id))})),(0,p.Z)((0,i.Z)(e),"onFailureCallback",(function(t){e.private.isSubmit=!0,t&&t.zh_message&&r.ZP.error(t.zh_message),e.setState({visible:!1,flowId:void 0})})),(0,p.Z)((0,i.Z)(e),"onCancel",(function(){e.setState({visible:!1,flowId:void 0}),(0,e.props.dispatch)({type:"expenseExamineFlow/resetExamineFlowDetail",payload:{}})})),(0,p.Z)((0,i.Z)(e),"onChangeExamineFlow",(function(t){var n=e.props.dispatch;e.setState({flowId:t}),n({type:"expenseExamineFlow/fetchExamineDetail",payload:{id:t}})})),(0,p.Z)((0,i.Z)(e),"reduceAccountList",(function(e){return!e||"object"===(0,g.Z)(e)&&Array===e.constructor&&0===e.length?"无":e.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),"")})),(0,p.Z)((0,i.Z)(e),"renderNodeListText",(function(t,n){var r=t&&"object"===(0,g.Z)(t)&&Array===t.constructor?t.reduce((function(t,n,r){return 0===r?"".concat(n.post_name,"(").concat(e.reduceAccountList(n.account_info_list),")"):"".concat(t,", ").concat(n.post_name,"(").concat(e.reduceAccountList(n.account_info_list),")")}),""):"",a=n&&"object"===(0,g.Z)(n)&&Array===n.constructor?n.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),""):"";return r&&a?"".concat(r,", ").concat(a):r||a})),(0,p.Z)((0,i.Z)(e),"renderForm",(function(){var t=e.props.form.getFieldDecorator,n={onChange:e.onChangeExamineFlow,bizType:y.z_o.noCostOf,showSearch:!0,optionFilterProp:"children",placeholder:"请选择审批流",namespace:"overTime",state:[y.BsX.normal],style:{width:"100%"},approvalType:y.ZBL.overTime},r=[{label:"审批类型",form:"加班申请"},{label:"审批流",form:t("examineFlowId",{rules:[{required:!0,message:"请选择审批流"}],initialValue:void 0})(f.createElement(D.Z6,n))}];return f.createElement(v.KP,{items:r,cols:1,layout:{labelCol:{span:6},wrapperCol:{span:18}}})})),(0,p.Z)((0,i.Z)(e),"renderFlowNodes",(function(){var t=e.props.examineDetail,n=void 0===t?{}:t,r=e.state.flowId,a=n.nodeList,o=void 0===a?[]:a;return 0!==o.length&&r?o.map((function(t,n){return f.createElement(C.Z,{direction:"vertical",key:n,current:n+1},f.createElement(I,{title:"节点-".concat(n+1),description:e.renderNodeListText(t.postList,t.accountList)}))})):""})),(0,p.Z)((0,i.Z)(e),"renderModal",(function(){var t=e.state.visible,n=(0,i.Z)(e),r=n.onSubmit,a=n.onCancel;return!1===t?null:f.createElement(k.Z,{title:"新建申请",visible:t,onOk:r,onCancel:a,okText:"确认",cancelText:"取消"},e.renderForm(),e.renderFlowNodes())})),(0,p.Z)((0,i.Z)(e),"renderButton",(function(){return f.createElement(E.Z,{type:"primary",onClick:e.onAdd,className:F.Z["app-comp-expense-overTime-create-button"]},"新建加班审批")})),e.state={visible:!1,flowId:void 0},e.private={isSubmit:!0},e}return(0,o.Z)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"expenseExamineFlow/resetExamineFlowDetail",payload:{}})}},{key:"render",value:function(){return f.createElement("div",{className:F.Z["app-comp-expense-overTime-create-wrap"]},this.renderButton(),this.renderModal())}}]),n}(f.Component);var L=(0,u.connect)((function(e){return{examineDetail:e.expenseExamineFlow.examineDetail}}))(_.Z.create()(P)),A=O.Z.Option,H=b.Z.RangePicker,U=function(e){var t=e.activeKey,n=e.onSearch,r=e.onReset,a=e.onHookForm,o=e.onExportEXCEL,i=function(){o&&o()};return function(){var e=[{label:"加班单号",form:function(e){return e.getFieldDecorator("orderId")(f.createElement(x.Z,{placeholder:"请输入加班单号"}))}},{label:"实际加班人",form:function(e){return e.getFieldDecorator("applyOverTimePerson")(f.createElement(x.Z,{placeholder:"请输入实际加班人"}))}},{label:"主题标签",form:function(e){return e.getFieldDecorator("themeTag")(f.createElement(O.Z,{mode:"multiple",showArrow:!0,allowClear:!0,placeholder:"请选择主题标签"},f.createElement(A,{key:"1",value:y.OcE.product},"".concat(y.OcE.description(y.OcE.product))),f.createElement(A,{key:"2",value:y.OcE.data},"".concat(y.OcE.description(y.OcE.data))),f.createElement(A,{key:"3",value:y.OcE.mobile},"".concat(y.OcE.description(y.OcE.mobile))),f.createElement(A,{key:"4",value:y.OcE.rearEnd},"".concat(y.OcE.description(y.OcE.rearEnd))),f.createElement(A,{key:"5",value:y.OcE.frontEnd},"".concat(y.OcE.description(y.OcE.frontEnd))),f.createElement(A,{key:"6",value:y.OcE.implement},"".concat(y.OcE.description(y.OcE.implement))),f.createElement(A,{key:"7",value:y.OcE.qualityInspection},"".concat(y.OcE.description(y.OcE.qualityInspection)))))}},{label:"流程状态",form:function(e){return e.getFieldDecorator("state")(f.createElement(O.Z,{allowClear:!0,placeholder:"请选择流程状态"},f.createElement(A,{value:y.DU5.processing},y.DU5.description(y.DU5.processing)),f.createElement(A,{value:y.DU5.finish},y.DU5.description(y.DU5.finish)),f.createElement(A,{value:y.DU5.close},y.DU5.description(y.DU5.close))))}},{label:"开始时间",form:function(e){return e.getFieldDecorator("startTime",{initialValue:null})(f.createElement(H,{format:"YYYY-MM-DD",showTime:{defaultValue:[w()("00:00:00","HH:mm:ss"),w()("23:59:59","HH:mm:ss")]},className:F.Z["app-comp-expense-overtime-search-time"]}))}},{label:"结束时间",form:function(e){return e.getFieldDecorator("endTime",{initialValue:null})(f.createElement(H,{format:"YYYY-MM-DD",showTime:{defaultValue:[w()("00:00:00","HH:mm:ss"),w()("23:59:59","HH:mm:ss")]},className:F.Z["app-comp-expense-overtime-search-time"]}))}}],o=[],c=f.createElement(Z.Z,{title:"创建下载任务？",onConfirm:i,okText:"确认",cancelText:"取消",key:"export"},f.createElement(E.Z,{type:"primary",className:F.Z["app-comp-expense-overtime-export"]},"导出EXCEL"));Number(t)===y.UWs.mine&&o.push(f.createElement(L,{key:"createModal"})),h.ZP.canOperateExpenseOverTimeAll()&&o.push(c);var l={items:e,onSearch:n,onReset:r,onHookForm:a,operations:o};return f.createElement(v.yL,l)}()},j=(n(20186),n(75385)),M=function(e){var t,n,r=e.dataList,a=e.onChangePage,o=r.data,i=void 0===o?[]:o,c=r._meta,l=(void 0===c?{}:c).result_count;return t=[{title:"加班单号",dataIndex:"_id",key:"_id",width:230,fixed:"left",render:function(e){return f.createElement("div",{className:F.Z["app-comp-expense-overTime-table-line"]},e)}},{title:"主题标签",dataIndex:"tags",key:"tags",width:100,render:function(e){return Array.isArray(e)&&e.length>0?y.OcE.description(e[0]):"--"}},{title:"项目",dataIndex:"platform_name",key:"platform_name",width:70,render:function(e){return e||"--"}},{title:"城市",dataIndex:"city_name",key:"city_name",width:70,render:function(e){return e||"--"}},{title:"团队",dataIndex:"biz_district_name",key:"biz_district_name",width:150,render:function(e){return e||"--"}},{title:"实际加班人",dataIndex:"actual_apply_name",key:"actual_apply_name",width:100,render:function(e){return e||"--"}},{title:"审批流",dataIndex:"application_order_info",key:"flow_info",width:150,render:function(e){var t=e.flow_info,n=void 0===t?{}:t;return n.name?f.createElement("div",{className:F.Z["app-comp-expense-overtime-table-line"]},n.name):"--"}},{title:"流程状态",dataIndex:"state",key:"state",width:100,render:function(e){return y.DU5.description(e)}},{title:"当前节点",dataIndex:"application_order_info",key:"currentFlowNode",width:120,render:function(e){var t=e.current_flow_node_info,n=void 0===t?{}:t;if(n){var r=n.name,a=n.account_list,o="";return a.length>0&&(o="(",a.map((function(e){o+=e.name})),o+=")"),f.createElement("div",{className:F.Z["app-comp-expense-overtime-table-line"]},"".concat(r).concat(o))}return"--"}},{title:"开始时间",dataIndex:"start_at",key:"start_at",width:180,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"结束时间",dataIndex:"end_at",key:"end_at",width:180,render:function(e){return e?w()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"加班时长（小时）",dataIndex:"duration",key:"duration",width:120,render:function(e){return e||"--"}},{title:"操作",dataIndex:"operate",key:"operate",render:function(e,t){var n=t._id;return f.createElement("a",{key:"detail",href:"/#/Expense/Attendance/OverTime/Detail?overTimeId=".concat(n),target:"_blank",rel:"noopener noreferrer"},"查看")}}],n={defaultPageSize:30,onChange:a,total:l,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:a},f.createElement(v.IT,{title:"加班列表"},f.createElement(j.Z,{rowKey:function(e){return e._id},dataSource:i,columns:t,bordered:!0,pagination:n,scroll:{x:1640,y:400}}))},N=n(97116);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var a=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var z=function(e){(0,c.Z)(n,e);var t=R(n);function n(e){var o;return(0,a.Z)(this,n),o=t.call(this,e),(0,p.Z)((0,i.Z)(o),"onHookForm",(function(e){o.setState({form:e})})),(0,p.Z)((0,i.Z)(o),"onSearch",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o.state.activeKey,n=o.private.searchParams,r=n.limit,a=n.page,i=Y(Y({},e),{},{page:a||1,limit:r||30,selectKey:t});o.private.searchParams=Y({},i),Number(t)===y.UWs.mine&&(i.applyAccountId=N.Iq.account.id),o.props.dispatch({type:"expenseOverTime/fetchOverTimeList",payload:i})})),(0,p.Z)((0,i.Z)(o),"onReset",(function(){o.onSearch({})})),(0,p.Z)((0,i.Z)(o),"onExportEXCEL",(function(){var e=o.state,t=e.form,n=e.activeKey,a=o.props.dispatch;t.validateFields((function(e,t){if(!e){var o=Y(Y({},t),{},{onSuccessCallback:function(){return r.ZP.success("请求成功")}});Number(n)===y.UWs.mine&&(o.applyAccountId=N.Iq.account.id),a({type:"expenseOverTime/exportOverTime",payload:o})}}))})),(0,p.Z)((0,i.Z)(o),"onChangePage",(function(e,t){var n=o.private.searchParams;n.page=e,n.limit=t,o.onSearch(n)})),(0,p.Z)((0,i.Z)(o),"onChangeTab",(function(e){o.setState({activeKey:e},(function(){return o.onSearch()}))})),(0,p.Z)((0,i.Z)(o),"renderSearch",(function(){var e=(0,i.Z)(o),t=e.onSearch,n=e.onReset,r=e.onHookForm,a=e.onExportEXCEL,c=o.state.activeKey;return f.createElement(U,{activeKey:c,onSearch:t,onReset:n,onHookForm:r,onExportEXCEL:a})})),(0,p.Z)((0,i.Z)(o),"renderContent",(function(){var e=o.state.activeKey,t=o.props,n=t.overTimeMineList,r=t.overTimeAllList,a=Number(e)===y.UWs.mine?Y({},n):Y({},r);return f.createElement(M,{dataList:a,onChangePage:o.onChangePage})})),(0,p.Z)((0,i.Z)(o),"renderTabContent",(function(){return f.createElement("div",null,o.renderSearch(),o.renderContent())})),(0,p.Z)((0,i.Z)(o),"renderTabs",(function(){var e=[];return h.ZP.canOperateExpenseOverTimeMy()&&e.push({title:"我的",content:o.renderTabContent(),key:y.UWs.mine}),h.ZP.canOperateExpenseOverTimeAll()&&e.push({title:"全部",content:o.renderTabContent(),key:y.UWs.all}),f.createElement(v.DF,{items:e,onChange:o.onChangeTab,defaultActiveKey:"".concat(y.UWs.mine)})})),(0,p.Z)((0,i.Z)(o),"render",(function(){return o.renderTabs()})),o.state={activeKey:"".concat(y.UWs.mine),form:void 0},o.private={searchParams:{limit:30,page:1,applyAccountId:N.Iq.account.id}},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this.state.activeKey;(0,this.props.dispatch)({type:"expenseOverTime/fetchOverTimeList",payload:Y({selectKey:e},this.private.searchParams)})}},{key:"componentWillUnmount",value:function(){(0,this.props.dispatch)({type:"expenseOverTime/resetOverTimeList",payload:{}})}}]),n}(f.Component);(0,p.Z)(z,"propTypes",{overTimeMineList:d().object,overTimeAllList:d().object,dispatch:d().func}),(0,p.Z)(z,"defaultProps",{overTimeMineList:{},overTimeAllList:[],dispatch:function(){}});var B=(0,u.connect)((function(e){var t=e.expenseOverTime;return{overTimeMineList:t.overTimeMineList,overTimeAllList:t.overTimeAllList}}))(z)},53132:function(e,t){t.Z={"app-comp-expense-overTime-create-wrap":"XeKS2tEIUk6HjEZsWwtP","app-comp-expense-overTime-create-button":"fyCHrtBlHYIzRM4hhqAi","app-comp-expense-overTime-table-line":"kjFNO_5z35G5EI6A6Hce","app-comp-expense-overTime-current-node-colored":"NEE_rXOkr4GOU8PlQ2VC","app-comp-expense-overTime-current-node-line":"Aod_HP3AVNT08dBok9H0","app-comp-overTime-create-operate-wrap":"ixzSM5joc8aZHZhKns5s","app-comp-overTime-create-operate-next":"cLaYX0ePpbjrsUhFhKBj","app-comp-expense-overtime-export":"VfKZ09iJo1yVFhh4NWsm","app-comp-expense-overtime-search-time":"uPizjqKM6KOpYlVWzZYx"}}}]);