"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[5565],{96926:function(e,t,n){n.d(t,{Z:function(){return q}});n(35668);var a=n(86585),r=n(87462),o=n(67294),l=n(93517),c=n.n(l),i=n(45697),u=n.n(i),s=n(96036),m=n(80385),d=(n(52560),n(71577)),p=(n(36037),n(47933)),f=n(4942),h=n(29439),v=(n(52466),n(10642)),y=n(93433),b=n(15861),E=n(87757),g=n.n(E),Z=n(88144),_={labelCol:{span:8},wrapperCol:{span:10}},I=function(e){var t=e.visible,n=e.setDepartmentVisible,l=e.changeValue,c=e.departmentInfo,i=a.Z.useForm(),u=(0,h.Z)(i,1)[0],m=(0,o.useRef)([]),d=function(e){var t=[];return e.forEach((function(e){t.some((function(t){return t.id===e.id}))||t.push(e)})),t},p=function(){var e=(0,b.Z)(g().mark((function e(){var t,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.validateFields();case 2:t=m.current,a=[].concat((0,y.Z)(t),(0,y.Z)(c)),l("departmentInfo",d(a)),u.resetFields(),n(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=[o.createElement(a.Z.Item,{name:"departmentIds",label:"添加部门",rules:[{required:!0,message:"请选择"}]},o.createElement(Z.MG,{isAuthorized:!0,multiple:!0,onChange:function(e,t){m.current=e.map((function(e,n){return{id:e,name:t[n]}}))},filterTreeNode:function(e,t){return!!(e.trim()&&t&&t.props&&-1!==t.props.title.trim().indexOf(e.trim()))}}))];return o.createElement(v.Z,{title:"添加部门",visible:t,onOk:p,onCancel:function(){n(!1)}},o.createElement(a.Z,(0,r.Z)({form:u},_),o.createElement(s.Fp,{items:f,cols:1})))},O=function(){};I.propTypes={visible:u().bool,setDepartmentVisible:u().func,changeValue:u().func,departmentInfo:u().array},I.defaultProps={visible:!1,setDepartmentVisible:O,changeValue:O,departmentInfo:[{}]};var k=I,w={labelCol:{span:8},wrapperCol:{span:10}},S=function(e){var t=e.visible,n=e.setAccountVisible,l=e.changeValue,c=e.accountInfo,i=a.Z.useForm(),u=(0,h.Z)(i,1)[0],m=(0,o.useRef)([]),d=function(e){var t=[];return e.forEach((function(e){t.some((function(t){return t.id===e.id}))||t.push(e)})),t},p=function(){var e=(0,b.Z)(g().mark((function e(){var t,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.validateFields();case 2:t=m.current.map((function(e){return{id:e.payload.account_id,name:e.payload.name}})),a=[].concat((0,y.Z)(t),(0,y.Z)(c)),l("accountInfo",d(a)),u.resetFields(),n(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=[o.createElement(a.Z.Item,{name:"accountIds",label:"添加成员",rules:[{required:!0,message:"请选择"}]},o.createElement(Z.kl,{mode:"multiple",showArrow:!0,placeholder:"请选择成员",showSearch:!0,optionFilterProp:"children",onChange:function(e,t){m.current=t}}))];return o.createElement(v.Z,{title:"添加成员",visible:t,onOk:p,onCancel:function(){n(!1)}},o.createElement(a.Z,(0,r.Z)({form:u},w),o.createElement(s.Fp,{items:f,cols:1})))},C=function(){};S.propTypes={visible:u().bool,setAccountVisible:u().func,changeValue:u().func,accountInfo:u().array},S.defaultProps={visible:!1,setAccountVisible:C,changeValue:C,accountInfo:[{}]};var D=S,P="yC2Zm4yN4EvDNZioKYs9",j="LRFW8Do9vTZykibh9MxM",V="BZL8_GKS3Yl8JpV1MSq7";function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(e){var t=e.value,n=e.onChange,a=e.authorityDetail,r=(0,o.useState)(!1),l=(0,h.Z)(r,2),c=l[0],i=l[1],u=(0,o.useState)(!1),s=(0,h.Z)(u,2),v=s[0],y=s[1],b=function(){n(M(M({},t),{},{accountInfo:[],departmentInfo:[]}))},E=function(e,a){n(M(M({},t),{},(0,f.Z)({},e,a)))},g=function(e){e.target.value!==m.MmK.all?n({state:e.target.value,accountInfo:a.accountInfo,departmentInfo:a.departmentInfo}):n({state:e.target.value,accountInfo:[],departmentInfo:[]})};(0,o.useEffect)((function(){t.state===m.MmK.all&&b()}),[]);var Z,_,I;return o.createElement(o.Fragment,null,(Z=t.state,_=t.accountInfo,I=t.departmentInfo,o.createElement("div",{className:P},o.createElement("div",null,o.createElement(p.ZP.Group,{defaultValue:Z,onChange:g},o.createElement(p.ZP,{value:m.MmK.all},m.MmK.description(m.MmK.all)),o.createElement(p.ZP,{value:m.MmK.section},m.MmK.description(m.MmK.section)))),o.createElement("div",null,o.createElement(d.Z,{className:j,type:"primary",disabled:Z===m.MmK.all,onClick:function(){i(!0)}},"添加成员"),o.createElement(d.Z,{className:j,type:"primary",disabled:Z===m.MmK.all,onClick:function(){y(!0)}},"添加部门"),o.createElement(d.Z,{type:"primary",disabled:Z===m.MmK.all,onClick:b},"清空")),o.createElement("div",{className:V},function(e,t){return e.concat(t).reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),"")}(_,I)))),o.createElement(D,{accountInfo:t.accountInfo,changeValue:E,visible:c,setAccountVisible:i}),o.createElement(k,{departmentInfo:t.departmentInfo,changeValue:E,visible:v,setDepartmentVisible:y}))};x.propTypes={value:u().object,onChange:u().func,authorityDetail:u().object},x.defaultProps={value:{},onChange:function(){},authorityDetail:{}};var K=x,A={labelCol:{span:5},wrapperCol:{span:19}},T=function(e){var t=e.detail,n={state:c().get(t,"look_acl",m.MmK.section),accountInfo:c().get(t,"look_account_info_list",[]).map((function(e){return{id:e._id,name:e.name}})),departmentInfo:c().get(t,"look_department_info_list",[]).map((function(e){return{id:e._id,name:e.name}}))};return o.createElement(o.Fragment,null,[{item:[o.createElement(a.Z.Item,(0,r.Z)({},A,{name:"lookAccountInfo",label:"可见成员",rules:[{required:!0,message:"请选择"}]}),o.createElement(K,{authorityDetail:n}))]}].map((function(e,t){return o.createElement(s.Fp,{key:t,items:e.item,cols:e.col||2})})))};T.propTypes={detail:u().object},T.defaultProps={detail:{}};var q=T},76033:function(e,t,n){var a=n(93433),r=(n(29093),n(16317)),o=n(67294),l=n(55609),c=n(45697),i=n.n(c),u=r.Z.Option;function s(e){var t=e.dispatch,n=e.company,l=void 0===n?{}:n,c=e.onChange,i=e.value,s=e.otherChild,m=l.data,d=void 0===m?[]:m;(0,o.useEffect)((function(){t({type:"sharedCompany/getSharedCompany",payload:{_meta:{page:1,limit:9999}}})}),[t]);return o.createElement(r.Z,{placeholder:"请选择",allowClear:!0,showSearch:!0,optionFilterProp:"children",onChange:c,value:i},!s._id||d.some((function(e){return e._id===s._id}))?d.map((function(e){return o.createElement(u,{value:e._id,key:e._id,child:e},e.name)})):[].concat((0,a.Z)(d),[s]).map((function(e){return e._id===s._id?o.createElement(u,{disabled:!0,value:e._id,key:e._id,child:e},e.name):o.createElement(u,{value:e._id,key:e._id,child:e},e.name)})))}s.propTypes={otherChild:i().object},s.defaultProps={otherChild:{}};t.Z=(0,l.connect)((function(e){return{company:e.sharedCompany.company}}))(s)},15565:function(e,t,n){n(52560);var a=n(71577),r=n(87462),o=n(4942),l=(n(51838),n(48086)),c=n(15861),i=(n(35668),n(86585)),u=n(29439),s=(n(9070),n(20924)),m=(n(29093),n(16317)),d=n(87757),p=n.n(d),f=n(93517),h=n.n(f),v=n(30381),y=n.n(v),b=n(67294),E=n(55609),g=n(96036),Z=n(86221),_=n(76033),I=n(96926),O=n(97116),k=n(80385),w=n(88144);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D={labelCol:{span:9},wrapperCol:{span:15}},P={labelCol:{span:3},wrapperCol:{span:21}},j=m.Z.Option,V=s.Z.TextArea;t.Z=(0,E.connect)((function(e){return{enumeratedValue:e.codeRecord.enumeratedValue,sealDetail:e.sharedSeal.sealDetail}}),(function(e){return{getSealDetail:function(t){return e({type:"sharedSeal/getSharedSealDetail",payload:t})},resetSealDetail:function(){return e({type:"sharedSeal/resetSharedSealDetail",payload:{}})},updateSharedSeal:function(t){return e({type:"sharedSeal/updateSharedSeal",payload:t})},createSharedSeal:function(t){return e({type:"sharedSeal/createSharedSeal",payload:t})},getEnumer:function(){return e({type:"codeRecord/getEnumeratedValue",payload:{}})},resetEnumer:function(){return e({type:"codeRecord/resetEnumerateValue",payload:{}})}}}))((function(e){var t=e.createSharedSeal,n=e.updateSharedSeal,o=e.sealDetail,d=void 0===o?{}:o,f=e.location,v=void 0===f?{}:f,E=e.getSealDetail,S=e.resetSealDetail,F=e.isUpdate,M=void 0!==F&&F,x=e.getEnumer,K=e.resetEnumer,A=e.enumeratedValue,T=void 0===A?{}:A,q=i.Z.useForm(),N=(0,u.Z)(q,1)[0],R=v.query,Y=void 0===R?{}:R,L=(0,b.useState)(void 0),U=(0,u.Z)(L,2),B=U[0],G=U[1];if((0,b.useEffect)((function(){return x(),function(){K()}}),[]),(0,b.useEffect)((function(){return Y.id&&E({id:Y.id}),function(){return S()}}),[E,S,Y.id]),(0,b.useEffect)((function(){M&&d&&Object.keys(d).length>0&&G(h().get(d,"seal_type",void 0))}),[d,M]),M&&(!d||Object.keys(d).length<=0))return b.createElement("div",null);var z,J=d.state,W=d.borrow_state,X=void 0===W?void 0:W,H=d.expected_return_date,Q=void 0===H?void 0:H,$=function(){var e=(0,c.Z)(p().mark((function e(){var a,r,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.validateFields();case 2:if(a=e.sent,(r=a.lookAccountInfo).state!==k.MmK.section||0!==r.accountInfo.length||0!==r.departmentInfo.length){e.next=6;break}return e.abrupt("return",l.ZP.error("请选择指定范围"));case 6:if(!M){e.next=12;break}return e.next=9,n(C(C({},a),{},{_id:Y.id}));case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,t(C({},a));case 14:e.t0=e.sent;case 15:(o=e.t0)&&o._id&&(l.ZP.success("请求成功"),window.location.href="/#/Shared/Seal");case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=[b.createElement(i.Z.Item,{name:"name",label:"印章名称",rules:[{required:!0,message:"请填写印章名称"}]},b.createElement(s.Z,{placeholder:"请输入"})),b.createElement(i.Z.Item,{name:"firm_id",label:"公司名称",rules:[{required:!0,message:"请选择公司"}]},b.createElement(_.Z,{otherChild:O.P6.dotOptimal(d,"firm_info",{})})),b.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginLeft:20}},b.createElement(i.Z.Item,{label:"印章类型",name:"seal_type",rules:[{required:!0,message:"请选择印章类型"}],style:B!==k.fZ1.other?{width:"100%"}:{width:"50%"}},b.createElement(m.Z,{placeholder:"请选择",onChange:function(e){G(e),N.setFieldsValue({other_seal:void 0})}},(z=T.seal_types||[],z.length>0?z.map((function(e){return b.createElement(j,{value:e.value},e.name)})):[]))),b.createElement(i.Z.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.seal_type!==t.seal_type}},(function(e){return(0,e.getFieldValue)("seal_type")===k.fZ1.other?b.createElement(i.Z.Item,{name:"other_seal",style:{width:"50%",marginLeft:10}},b.createElement(s.Z,{placeholder:"请输入"})):null}))),b.createElement(i.Z.Item,{name:"keep_account_id",label:"印章保管人",rules:[{required:!0,message:"请选择印章保管人"}]},b.createElement(w.kl,{placeholder:"请选择",showSearch:!0,optionFilterProp:"children",fareManagerInfo:O.P6.dotOptimal(d,"keep_account_info",{})}))],te=[b.createElement(i.Z.Item,(0,r.Z)({name:"note",label:"备注"},P),b.createElement(V,{rows:4,placeholder:"请输入"})),b.createElement(i.Z.Item,(0,r.Z)({label:"附件",name:"asset_keys"},P),b.createElement(Z.uA,{domain:Z.uA.UploadDomains.OAUploadDomain}))],ne=[b.createElement(i.Z.Item,{label:"印章状态"},J?k.Xf4.description(J):"--"),b.createElement(i.Z.Item,{label:"借用状态"},X?k.hEf.description(X):"--"),b.createElement(i.Z.Item,{label:"借用人"},h().get(d,"borrower_info.name","--")),b.createElement(i.Z.Item,{label:"预计归还时间"},Q?y()(String(Q)).format("YYYY-MM-DD"):"--")],ae={name:h().get(d,"name",void 0),firm_id:h().get(d,"firm_info._id",void 0),seal_type:h().get(d,"seal_type",void 0),keep_account_id:h().get(d,"keep_account_info._id",void 0),note:h().get(d,"note",void 0),state:h().get(d,"state",void 0),borrow_state:h().get(d,"borrow_state",void 0),asset_keys:Z.uA.getInitialValue(d,"asset_infos",{}),other_seal:h().get(d,"other_seal",void 0),lookAccountInfo:{state:h().get(d,"look_acl",k.MmK.section),accountInfo:h().get(d,"look_account_info_list",[]).map((function(e){return{id:e._id,name:e.name}})),departmentInfo:h().get(d,"look_department_info_list",[]).map((function(e){return{id:e._id,name:e.name}}))}};return b.createElement(i.Z,(0,r.Z)({},D,{form:N,initialValues:ae}),b.createElement(g.IT,null,b.createElement(g.Fp,{items:ee}),b.createElement(g.Fp,{items:te,cols:1}),M?b.createElement(g.Fp,{items:ne}):"",b.createElement(g.IT,{title:"权限"},b.createElement(I.Z,{detail:d})),b.createElement("div",{style:{textAlign:"center"}},b.createElement(a.Z,{type:"primary",onClick:$},"保存"))))}))}}]);