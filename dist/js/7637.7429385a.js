"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[7637],{57637:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});n(20186);var r=n(75385),a=(n(55295),n(69713)),o=n(71002),i=n(15671),c=n(43144),s=n(97326),l=n(60136),p=n(82963),u=n(61120),d=n(4942),m=n(94315),f=n.n(m),y=n(93517),h=n.n(y),g=n(30381),v=n.n(g),Z=n(55609),_=n(67294),w=n(96036),x=n(45430),E=n(80385),D=(n(9070),n(20924)),S=(n(21316),n(75443)),C=(n(52560),n(71577)),k=(n(51838),n(48086)),b=(n(54071),n(14072)),I=(n(29093),n(16317)),R=n(88144),T=n(97116);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var a=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var O=I.Z.Option,Y=b.Z.RangePicker,F=function(e){(0,l.Z)(n,e);var t=P(n);function n(e){var r;return(0,i.Z)(this,n),r=t.call(this,e),(0,d.Z)((0,s.Z)(r),"onReset",(function(){var e=r.props.onSearch;e&&e({page:1,limit:30})})),(0,d.Z)((0,s.Z)(r),"onSearch",(function(e){var t=r.props.onSearch,n=e.suppliers,a=e.platforms,o=e.cities,i=e.districts,c=e.repaymentsOrderId,s=e.state,l=e.repaymentTime,p=h().has(l,"0")?v()(l[0]).format("YYYYMMDD"):"",u=h().has(l,"0")?v()(l[1]).format("YYYYMMDD"):"";t&&t({suppliers:n,platforms:a,cities:o,districts:i,state:s,repaymentsOrderId:c,repaymentStartTime:p,repaymentEndTime:u})})),(0,d.Z)((0,s.Z)(r),"onToggle",(function(e){var t=r.props.onToggle;t&&t(e)})),(0,d.Z)((0,s.Z)(r),"onHookForm",(function(e){r.setState({form:e})})),(0,d.Z)((0,s.Z)(r),"onDownloadSuccess",(function(){k.ZP.success("还款数据导出成功")})),(0,d.Z)((0,s.Z)(r),"onDownloadFailure",(function(){k.ZP.error("还款数据导出失败")})),(0,d.Z)((0,s.Z)(r),"onDownload",(function(){r.state.form.validateFields((function(e,t){var n=t.suppliers,a=t.platforms,o=t.cities,i=t.districts,c=t.repaymentsOrderId,s=t.state,l=t.repaymentTime,p=h().has(l,"0")?v()(l[0]).format("YYYYMMDD"):"",u=h().has(l,"0")?v()(l[1]).format("YYYYMMDD"):"";if(E.CyZ.mine===r.props.activeKey){var d={suppliers:n,platforms:a,cities:o,districts:i,state:s,repaymentsOrderId:c,repaymentStartTime:p,repaymentEndTime:u,applyAccountId:T.Iq.account.id};r.props.dispatch({type:"borrowingRepayment/repaymentsDownloadTemplate",payload:{params:d,onSuccessCallback:r.onDownloadSuccess,onFailureCallback:r.onDownloadFailure}})}else{var m={suppliers:n,platforms:a,cities:o,districts:i,state:s,repaymentsOrderId:c,repaymentStartTime:p,repaymentEndTime:u};r.props.dispatch({type:"borrowingRepayment/repaymentsDownloadTemplate",payload:{params:m,onSuccessCallback:r.onDownloadSuccess,onFailureCallback:r.onDownloadFailure}})}}))})),(0,d.Z)((0,s.Z)(r),"disableDateOfMonth",(function(e){return e&&e>new Date})),(0,d.Z)((0,s.Z)(r),"renderSearchForm",(function(){var e=r.props.expand,t={items:[{label:"还款单号",form:function(e){return e.getFieldDecorator("repaymentsOrderId")(_.createElement(D.Z,{placeholder:"请输入还款单号"}))}},{label:"还款时间",form:function(e){return e.getFieldDecorator("repaymentTime",{initialValue:null})(_.createElement(Y,{format:"YYYY-MM-DD"}))}},{label:"流程状态",form:function(e){return e.getFieldDecorator("state")(_.createElement(I.Z,{allowClear:!0,placeholder:"请选择流程状态"},_.createElement(O,{value:E.DU5.processing},E.DU5.description(E.DU5.processing)),_.createElement(O,{value:E.DU5.finish},E.DU5.description(E.DU5.finish)),_.createElement(O,{value:E.DU5.close},E.DU5.description(E.DU5.close))))}}],operations:_.createElement(S.Z,{placement:"top",title:"是否导出还款列表数据?",okText:"确认",onConfirm:function(){r.onDownload()},cancelText:"取消"},_.createElement(C.Z,{type:"primary"},"导出EXCEL")),expand:e,isExpenseModel:!0,onReset:r.onReset,onSearch:r.onSearch,onToggle:r.onToggle,onHookForm:r.onHookForm,namespace:"repayment".concat(r.props.activeKey)};return _.createElement(w.IT,null,_.createElement(R.p8,t))})),(0,d.Z)((0,s.Z)(r),"render",(function(){return _.createElement("div",null,r.renderSearchForm())})),r.state={form:void 0},r}return n}(_.Component);var M=(0,Z.connect)((function(e){return{borrowingRepayment:e.borrowingRepayment}}))(F),N="Vg4OFJzRMTrkcIapJgx5",H="SzMuTk20hiooyQijqjCk",U="tFLRPwo8pRoPkGHfH8l7",z="Q0uoCkI1Ao2Obcqrxi28",A="lheJQGVTRWrxyCShTPnE";function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var a=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var B=function(e){(0,l.Z)(n,e);var t=K(n);function n(e){var c;return(0,i.Z)(this,n),c=t.call(this,e),(0,d.Z)((0,s.Z)(c),"onSearch",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=c.state.activeKey;c.setState({searchInfo:e}),c.private.searchParams=e,(f().not.existy(c.private.searchParams.page)||f().empty(c.private.searchParams.page))&&(c.private.searchParams.page=1),(f().not.existy(c.private.searchParams.limit)||f().empty(c.private.searchParams.limit))&&(c.private.searchParams.limit=30),Number(t)===E.CyZ.mine&&(c.private.searchParams.applyAccountId=T.Iq.account.id),c.props.dispatch({type:"borrowingRepayment/fetchRepaymentOrders",payload:c.private.searchParams})})),(0,d.Z)((0,s.Z)(c),"onChangePage",(function(e,t){var n=c.private.searchParams;n.page=e,n.limit=t,c.onSearch(n)})),(0,d.Z)((0,s.Z)(c),"onShowSizeChange",(function(e,t){var n=c.private.searchParams;n.page=e,n.limit=t,c.onSearch(n)})),(0,d.Z)((0,s.Z)(c),"onChangeTab",(function(e){(0,c.props.dispatch)({type:"borrowingRepayment/resetRepaymentOrders"}),c.setState({activeKey:e},(function(){return c.onSearch()}))})),(0,d.Z)((0,s.Z)(c),"onToggle",(function(e){c.setState({isShowExpand:e})})),(0,d.Z)((0,s.Z)(c),"renderSearch",(function(){var e=(0,s.Z)(c).onSearch,t=c.state,n=t.activeKey,r=t.isShowExpand;return _.createElement(M,{onSearch:e,activeKey:n,expand:r,onToggle:c.onToggle})})),(0,d.Z)((0,s.Z)(c),"renderCurrentFlowNodeInfo",(function(e){var t=h().get(e,"current_pending_account_list",[]),n=h().get(e,"state"),r=h().get(e,"current_flow_node",""),i=h().get(e,"current_flow_node_info",{}),c=h().get(e,"apply_account_info",{});if(i&&i.name&&f().existy(r)){var s=h().get(i,"account_list",[]),l=h().get(i,"post_list",[]),p=[],u=[];s.forEach((function(e){var n=e;void 0!==t.find((function(t){return t._id===e._id}))?n.isHeight=!0:n.isHeight=!1,p.push(n)})),l&&"object"===(0,o.Z)(l)&&Array===l.constructor&&l.forEach((function(e){var n=e;t.some((function(e){return n.account_info_list.some((function(t){return t._id===e.id||e._id}))}))?n.isHeight=!0:n.isHeight=!1,u.push(n)}));var d=_.createElement("span",null,i.name,"(",_.createElement("span",null,u.map((function(e,t){return _.createElement("span",{style:!0===e.isHeight?{color:"#F5A623"}:null,key:"postData".concat(t)},e.post_name,"(",e.account_info_list.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),""),")",t!==u.length-1?" , ":null)}))),u&&p&&u.length>0&&p.length>0?", ":"",_.createElement("span",null,p.map((function(e,t){return _.createElement("span",{style:!0===e.isHeight?{color:"#F5A623"}:null,key:"data".concat(t)},e.name,t!==p.length-1?" , ":null)}))),")");return _.createElement(a.Z,{title:d},_.createElement("div",{className:N},"".concat(i.name,"(").concat(f().not.empty(t)?t.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),""):"",")").length>=10?"".concat("".concat(i.name,"(").concat(f().not.empty(t)?t.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),""):"",")").substring(0,10),"..."):"".concat(i.name,"(").concat(f().not.empty(t)?t.reduce((function(e,t,n){return 0===n?t.name:"".concat(e,", ").concat(t.name)}),""):"",")")))}return f().not.existy(r)&&n===E.DU5.processing?"提报节点(".concat(c.name,")"):"--"})),(0,d.Z)((0,s.Z)(c),"renderContent",(function(){var e=c.props.repaymentOrders,t=h().get(e,"data",[]),n=h().get(e,"_meta",{}),a=h().get(n,"result_count",0),o=[{title:"还款单号",dataIndex:"_id",key:"_id",width:100,fixed:"left",render:function(e){return _.createElement("div",{className:A},e)}},{title:"借款单号",dataIndex:"loan_order_id",width:100,fixed:"left",render:function(e){return _.createElement("div",{className:A},e)}},{title:"平台",dataIndex:"application_order_info",key:"platformNames",width:70,fixed:"left",render:function(e){var t=h().get(e,"platform_names",[]);return f().empty(t)?"--":t}},{title:"供应商",dataIndex:"application_order_info",key:"supplierNames",width:150,fixed:"left",render:function(e){var t=h().get(e,"supplier_names",[]);return f().empty(t)?"--":t}},{title:"城市",dataIndex:"application_order_info",key:"cityNames",width:70,fixed:"left",render:function(e){var t=h().get(e,"city_names",[]);return f().empty(t)?"--":t}},{title:"商圈",dataIndex:"application_order_info",key:"bizDistrictNames",width:150,fixed:"left",render:function(e){var t=h().get(e,"biz_district_names",[]);return f().empty(t)?"--":t}},{title:"申请人 ",dataIndex:"apply_account_info",key:"apply_account_info.name",width:70,fixed:"left",render:function(e){var t=h().get(e,"name");return _.createElement("div",{className:H},t)}},{title:"还款金额",dataIndex:"repayment_money",key:"repayment_money",width:100,render:function(e){return e?E.fbc.exchangePriceCentToMathFormat(e):"--"}},{title:"审批流",dataIndex:"application_order_info",key:"application_order_info.flow_info",width:160,render:function(e){var t=h().get(e,"flow_info.name",void 0);return _.createElement("div",{className:U},t)||"--"}},{title:"流程状态",dataIndex:"state",key:"state",width:100,render:function(e){return E.DU5.description(e)||"--"}},{title:"当前节点",dataIndex:"application_order_info",key:"currentFlowNodeInfo",width:150,render:function(e){return c.renderCurrentFlowNodeInfo(e)}},{title:"还款时间",dataIndex:"done_at",key:"done_at",render:function(e){return e?v()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"操作",dataIndex:"operation",key:"operation",width:100,fixed:"right",render:function(e,t){var n=t.application_order_id,r=t._id,a=[];return x.ZP.canOperateExpenseRepaymentOrderDetail()&&a.push(_.createElement("a",{key:"detail",href:"/#/Expense/BorrowingRepayments/Repayments/Detail?orderId=".concat(n,"&repaymentOrderId=").concat(r),target:"_blank",rel:"noopener noreferrer",className:z},"查看")),a}}],i={defaultPageSize:30,onChange:c.onChangePage,total:a,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:c.onShowSizeChange},s=c.private.searchParams.page;return s&&(i.current=s),_.createElement(w.IT,{title:"还款列表"},_.createElement(r.Z,{rowKey:function(e){return e._id},dataSource:t,columns:o,bordered:!0,pagination:i,scroll:{x:1470,y:400}}))})),(0,d.Z)((0,s.Z)(c),"renderTabContent",(function(){return _.createElement("div",null,c.renderSearch(),c.renderContent())})),(0,d.Z)((0,s.Z)(c),"renderTabs",(function(){var e=[];return x.ZP.canOperateExpenseRepaymentOrderMy()&&e.push({title:"我的",content:c.renderTabContent(E.CyZ.mine),key:E.CyZ.mine}),x.ZP.canOperateExpenseRepaymentOrderAll()&&e.push({title:"全部",content:c.renderTabContent(E.CyZ.all),key:E.CyZ.all}),_.createElement(w.DF,{items:e,onChange:c.onChangeTab,defaultActiveKey:"".concat(E.CyZ.mine)})})),(0,d.Z)((0,s.Z)(c),"render",(function(){return _.createElement("div",null,c.renderTabs())})),c.state={activeKey:E.CyZ.mine,isShowExpand:!0},c.private={searchParams:{limit:30,page:1,applyAccountId:T.Iq.account.id}},c}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"borrowingRepayment/fetchRepaymentOrders",payload:this.private.searchParams})}},{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"borrowingRepayment/resetBorrowingOrders"})}}]),n}(_.Component);var q=(0,Z.connect)((function(e){return{repaymentOrders:e.borrowingRepayment.repaymentOrders}}))(B)}}]);