"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[5053],{75053:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});n(20186);var r=n(75385),a=(n(21316),n(75443)),o=(n(52560),n(71577)),c=(n(51838),n(48086)),i=n(15671),u=n(43144),s=n(97326),l=n(60136),p=n(82963),d=n(61120),f=n(4942),m=n(67294),h=n(55609),y=n(45697),g=n.n(y),v=n(96036),Z=(n(54071),n(14072)),x=n(30381),P=n.n(x),S=n(88144);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var _=Z.Z.MonthPicker,B=function(e){(0,l.Z)(n,e);var t=k(n);function n(){var e;(0,i.Z)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),(0,f.Z)((0,s.Z)(e),"onSearch",(function(t){var n=e.props.onSearch,r=t.platforms,a=t.suppliers,o=t.cities,c=t.districts,i=t.industryCode,u=t.budgetTime,s={platforms:r,suppliers:a,cities:o,districts:c,industryCode:i,budgetTime:u?P()(u).format("YYYYMM"):"",page:1,limit:30};n&&n(s)})),(0,f.Z)((0,s.Z)(e),"onReset",(function(){var t=e.props.onSearch;t&&t({page:1,limit:30})})),(0,f.Z)((0,s.Z)(e),"render",(function(){var t={items:[{label:"预算周期",form:function(e){return e.getFieldDecorator("budgetTime",{initialValue:null})(m.createElement(_,{placeholder:"请选择预算周期"}))}}],specialItems:[{label:"所属场景",form:function(e){return e.getFieldDecorator("industryCode")(m.createElement(S.UU,{enumeratedType:"industry",showArrow:!0,mode:"multiple"}))}}],isExpenseModel:!0,onReset:e.onReset,onSearch:e.onSearch};return m.createElement(v.IT,null,m.createElement(S.p8,t))})),e}return n}(m.Component);(0,f.Z)(B,"propTypes",{onSearch:g().func}),(0,f.Z)(B,"defaultProps",{onSearch:function(){}});var C=B,E=n(45430),b="AOoqQQ3kgTPUozwGq5tg",w="fpvJIaMPdMOijRY6Ygnr";function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var R=function(e){(0,l.Z)(n,e);var t=I(n);function n(e){var u;return(0,i.Z)(this,n),u=t.call(this,e),(0,f.Z)((0,s.Z)(u),"onSearch",(function(e){u.private.searchParams=e,u.private.searchParams.page||(u.private.searchParams.page=1),u.private.searchParams.limit||(u.private.searchParams.limit=30),u.props.dispatch({type:"expenseBudget/fetchExpenseBudgetList",payload:u.private.searchParams})})),(0,f.Z)((0,s.Z)(u),"onChangePage",(function(e,t){u.private.searchParams.page=e,u.private.searchParams.limit=t,u.onSearch(u.private.searchParams)})),(0,f.Z)((0,s.Z)(u),"onShowSizeChange",(function(e,t){u.private.searchParams.page=e,u.private.searchParams.limit=t,u.onSearch(u.private.searchParams)})),(0,f.Z)((0,s.Z)(u),"onDownload",(function(){u.props.dispatch({type:"expenseBudget/downloadTemplate",payload:{onSuccessCallback:function(){return c.ZP.success("下载模板成功")},onFailureCallback:function(){return c.ZP.error("下载模板失败")}}})})),(0,f.Z)((0,s.Z)(u),"onUploadSuccess",(function(e){u.props.dispatch({type:"expenseBudget/uploadExpenseBudget",payload:{file:e,onSuccessCallback:function(){return c.ZP.success("上传费用预算成功")},onFailureCallback:function(){return c.ZP.error("上传费用预算失败")}}})})),(0,f.Z)((0,s.Z)(u),"onUploadFailure",(function(e){c.ZP.error(e.zh_message)})),(0,f.Z)((0,s.Z)(u),"renderSearch",(function(){var e=(0,s.Z)(u).onSearch;return m.createElement(C,{onSearch:e})})),(0,f.Z)((0,s.Z)(u),"renderContent",(function(){var e=u.private.searchParams.page,t=u.props,n=t.expenseBudgetData,c=t.enumeratedValue,i=(void 0===c?{}:c).industry,s=void 0===i?[]:i;if(0===Object.keys(n).length)return null;var l=n.data,p=n.meta,d=[{title:"所属场景",dataIndex:"industry_code",key:"industry_code",render:function(e){if(!e)return"--";var t=(s.find((function(t){return t.value===e}))||{}).name;return(void 0===t?void 0:t)||"--"}},{title:"平台",dataIndex:"platform_name",key:"platform_name",render:function(e){return e||"--"}},{title:"供应商",dataIndex:"supplier_name",key:"supplier_name",render:function(e){return e||"--"}},{title:"城市",dataIndex:"city_name",key:"city_name",render:function(e){return e||"--"}},{title:"商圈",dataIndex:"biz_district_name",key:"biz_district_name",render:function(e){return e||"--"}},{title:"科目编码",dataIndex:"cost_accounting_code",key:"cost_accounting_code",render:function(e){return e||"--"}},{title:"科目名称",dataIndex:"cost_accounting_name",key:"cost_accounting_name",render:function(e){return e||"--"}},{title:"级别",dataIndex:"level",key:"level",render:function(e){return e||"--"}},{title:"预算",dataIndex:"budget_money",key:"budget_money",render:function(e){return e}},{title:"单位",dataIndex:"unit",key:"unit",render:function(e){return e||"--"}},{title:"预算周期",dataIndex:"budget_time",key:"budget_time",render:function(e){return e||"--"}}],f={showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:30,onShowSizeChange:u.onShowSizeChange,total:p.count,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],onChange:u.onChangePage},h="";return E.ZP.canOperateExpenseBudgetDownTemplate()&&(h=m.createElement("div",null,m.createElement("span",{className:b},"模板更新时间：2019-07-16"),m.createElement(a.Z,{placement:"top",title:"是否下载模板?",okText:"确认",onConfirm:function(){u.onDownload()},cancelText:"取消"},m.createElement(o.Z,{type:"primary",className:w},"下载模板")),E.ZP.canOperateExpenseBudgetUpload()?m.createElement(v.zI,{domain:"cost",namespace:u.private.namespace,onSuccess:u.onUploadSuccess,onFailure:u.onUploadFailure}):null)),e&&(f.current=e),m.createElement(v.IT,{title:"费用预算列表",titleExt:h},m.createElement(r.Z,{columns:d,pagination:f,rowKey:function(e,t){return t},dataSource:l,bordered:!0}))})),u.private={searchParams:{},namespace:"namespace".concat(Math.floor(1e5*Math.random()))},u}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"expenseBudget/fetchExpenseBudgetList"})}},{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"expenseBudget/reduceExpenseBudget",payload:{}}),this.props.dispatch({type:"applicationCommon/resetEnumeratedValue",payload:{}})}},{key:"render",value:function(){return m.createElement("div",null,this.renderSearch(),this.renderContent())}}]),n}(m.Component);(0,f.Z)(R,"propTypes",{expenseBudgetData:g().object,dispatch:g().func}),(0,f.Z)(R,"defaultProps",{expenseBudgetData:{},dispatch:function(){}});var T=(0,h.connect)((function(e){return{expenseBudgetData:e.expenseBudget.expenseBudgetData,enumeratedValue:e.applicationCommon.enumeratedValue}}))(R)}}]);