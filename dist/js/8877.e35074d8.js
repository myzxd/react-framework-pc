"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[8877],{28877:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});n(20186);var a=n(75385),r=(n(52560),n(71577)),i=(n(21316),n(75443)),o=(n(55295),n(69713)),l=(n(35668),n(86585)),c=n(87462),s=n(29439),u=n(93517),p=n.n(u),d=n(94315),m=n.n(d),f=n(55609),y=n(30381),v=n.n(y),g=n(67294),h=n(96036),E=n(80385),b=(n(52466),n(10642)),C=n(4942),Z=n(15861),w=n(87757),O=n.n(w),_=n(45697),P=n.n(_),k=(n(98703),n(88144)),x=(n(29093),n(16317)),I=n(97116),S=n(8240),j=x.Z.Option;var F=(0,f.connect)((function(e){return{contractTemplates:e.systemContractTemplate.contractTemplates}}))((function(e){var t=e.dispatch,n=e.contractTemplates,a=I.P6.dotOptimal(n,"data",[]);(0,g.useEffect)((function(){return t({type:"systemContractTemplate/fetchContractTemplates",payload:{meta:{page:1,limit:0},state:E.kXG.on}}),function(){t({type:"systemContractTemplate/reduceContractTemplates",payload:{}})}}),[t]);var r=(0,S.CE)(["dispatch","contractTemplates"],e);return g.createElement(x.Z,r,a.map((function(e){return g.createElement(j,{key:e._id,value:e._id},e.name)})))}));function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,C.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onCancel,n=e.visible,a=e.id,r=void 0===a?void 0:a,i=e.dispatch,o=l.Z.useForm(),u=(0,s.Z)(o,1),d=u[0],m=(0,g.useState)(void 0),f=(0,s.Z)(m,2),y=f[0],v=f[1],C=(0,g.useState)(void 0),w=(0,s.Z)(C,2),_=w[0],P=w[1],x=(0,g.useState)(void 0),I=(0,s.Z)(x,2),S=I[0],j=I[1];(0,g.useEffect)((function(){V()}),[n]);var M=function(){V(),t(),void 0!==r&&i({type:"systemManage/fetchContractConfigurationList",payload:{id:r}})},D=function(){var e=(0,Z.Z)(O().mark((function e(){var t,n;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.validateFields();case 2:t=e.sent,n=T(T({},t),{},{industry:S,id:r,onSuccessCallback:M}),i({type:"systemManage/contractUpdateCreate",payload:n});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){t&&t(),V()},V=function(){j(void 0),v(void 0),P(void 0),d.resetFields()},L=function(e,t){var n=p().get(t,"props.industry",void 0);j(n),v(e),P(void 0),d.setFieldsValue({suppliers:void 0}),d.setFieldsValue({cities:[]})},z=function(e){P(e),d.setFieldsValue({cities:[]})},A=function(e){e.map((function(e){if("all"===e)return d.setFieldsValue({cities:["all"]})}))},Y={labelCol:{span:6},wrapperCol:{span:14}},H=[g.createElement(l.Z.Item,(0,c.Z)({label:"平台",name:"platforms",rules:[{required:!0,message:"请选择平台"}]},Y),g.createElement(k.Yg,{allowClear:!0,optionFilterProp:"children",placeholder:"请选择平台",onChange:L})),g.createElement(l.Z.Item,(0,c.Z)({label:"供应商",name:"suppliers",rules:[{required:!0,message:"请选择供应商"}]},Y),g.createElement(k.o2,{state:E.Acu.enable,allowClear:!0,placeholder:"请选择供应商",platforms:y,onChange:z})),g.createElement(l.Z.Item,(0,c.Z)({label:"城市",name:"cities",rules:[{required:!0,message:"请选择城市"}]},Y),g.createElement(k.Gv,{className:"maxHeight",allowClear:!0,showArrow:!0,mode:"multiple",placeholder:"请选择城市",suppliers:_,platforms:y,onChange:A,isExpenseModel:!0})),g.createElement(l.Z.Item,(0,c.Z)({label:"合同模版",name:"template",rules:[{required:!0,message:"请选择合同模版"}]},Y),g.createElement(F,{allowClear:!0,placeholder:"请选择合同模版",showSearch:!0,optionFilterProp:"children"}))];return g.createElement(b.Z,{title:"新增",visible:n,onOk:D,onCancel:q,okText:"确认",cancelText:"取消"},g.createElement(l.Z,{layout:"horizontal",form:d},g.createElement(h.Fp,{items:H,cols:1})))};D.propTypes={onCancel:P().func,visible:P().bool},D.defaultProps={onCancel:function(){},visible:!1};var q=(0,f.connect)((function(e){return{systemManage:e.systemManage}}))(D);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,C.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onCancel,n=e.visible,a=e.id,r=void 0===a?void 0:a,i=e.dispatch,o=e.data,u=l.Z.useForm(),d=(0,s.Z)(u,1),m=d[0],f=(0,g.useState)(void 0),y=(0,s.Z)(f,2),v=y[0],C=y[1],w=(0,g.useState)(void 0),_=(0,s.Z)(w,2),P=_[0],x=_[1],I=(0,g.useState)(void 0),S=(0,s.Z)(I,2),j=S[0],M=S[1];(0,g.useEffect)((function(){V()}),[n]),(0,g.useEffect)((function(){o&&m.setFieldsValue({platforms:p().get(o,"platform_code",void 0),cities:p().get(o,"city_codes",void 0),suppliers:p().get(o,"supplier_id",void 0),template:p().get(o,"template_info._id",void 0)})}),[o]);var T=function(){V(),t(),void 0!==r&&i({type:"systemManage/fetchContractConfigurationList",payload:{id:r}})},D=function(){var e=(0,Z.Z)(O().mark((function e(){var t,n,a,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.validateFields();case 2:t=e.sent,n=p().get(o,"_id",void 0),a=j||p().get(o,"industry_code",0),r=L(L({},t),{},{industry:a,id:n,onSuccessCallback:T}),i({type:"systemManage/updateCompany",payload:r});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){t&&t(),V()},V=function(){M(void 0),C(void 0),x(void 0),m.resetFields()},z=function(e,t){var n=p().get(t,"props.industry",void 0);M(n),C(e),x(void 0),m.setFieldsValue({suppliers:void 0}),m.setFieldsValue({cities:[]})},A=function(e){x(e),m.setFieldsValue({cities:[]})},Y=function(e){e.map((function(e){if("all"===e)return m.setFieldsValue({cities:["all"]})}))},H=v||p().get(o,"platform_code",void 0),B=P||p().get(o,"supplier_id",void 0),G={labelCol:{span:6},wrapperCol:{span:14}},J=[g.createElement(l.Z.Item,(0,c.Z)({label:"平台",name:"platforms",rules:[{required:!0,message:"请选择平台"}]},G),g.createElement(k.Yg,{allowClear:!0,placeholder:"请选择平台",onChange:z,disabled:!0})),g.createElement(l.Z.Item,(0,c.Z)({label:"供应商",name:"suppliers",rules:[{required:!0,message:"请选择供应商"}]},G),g.createElement(k.o2,{state:E.Acu.enable,allowClear:!0,placeholder:"请选择供应商",platforms:H,onChange:A,disabled:!0})),g.createElement(l.Z.Item,(0,c.Z)({label:"城市",name:"cities",rules:[{required:!0,message:"请选择城市"}]},G),g.createElement(k.Gv,{className:"maxHeight",allowClear:!0,showArrow:!0,mode:"multiple",placeholder:"请选择城市",suppliers:B,platforms:H,onChange:Y,isExpenseModel:!0})),g.createElement(l.Z.Item,(0,c.Z)({label:"合同模版",name:"template",rules:[{required:!0,message:"请选择合同模版"}]},G),g.createElement(F,{allowClear:!0,placeholder:"请选择合同模版",showSearch:!0,optionFilterProp:"children"}))];return g.createElement(b.Z,{title:"编辑",visible:n,onOk:D,onCancel:q,okText:"确认",cancelText:"取消"},g.createElement(l.Z,{layout:"horizontal",form:m},g.createElement(h.Fp,{items:J,cols:1})))};z.propTypes={onCancel:P().func,visible:P().bool,data:P().object},z.defaultProps={onCancel:function(){},visible:!1,data:{}};var A=(0,f.connect)((function(){return{}}))(z),Y=(n(20559),n(99683)),H=(n(62004),n(11382)),B=n(67724),G=n(8812);var J=(0,f.connect)((function(e){return{previewContract:e.systemManage.previewContract}}))((function(e){var t,n=e.dispatch,a=e.previewContract,r=e.previewId,i=(0,g.useState)(!1),o=(0,s.Z)(i,2),l=o[0],c=o[1];return(0,g.useEffect)((function(){return c(!0),n({type:"systemManage/fetchPreviewContract",payload:{id:r,onLoading:function(){c(!1)}}}),function(){n({type:"systemManage/reducePreviewContract",payload:{}})}}),[n,r]),g.createElement(b.Z,{title:"预览合同",visible:!0,onCancel:function(){e.onCancel&&e.onCancel()},footer:null},g.createElement("div",{style:{width:"100%",height:500,padding:"20px",background:"#f7f7f7",overflowY:"scroll"}},(t=I.P6.dotOptimal(a,"contract_images",[]),l?g.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}," ",g.createElement(H.Z,null)):m().not.existy(t)||m().empty(t)?g.createElement(Y.ZP,{status:"error",title:"请重试"}):t.map((function(e,n){return g.createElement(g.Fragment,{key:n},g.createElement("img",{style:{width:"100%",height:"auto"},src:"data:image/png;base64,".concat(e),role:"presentation"}),g.createElement("div",{style:{height:25,lineHeight:"25px",textAlign:"center"}},g.createElement(B.Z,null)," ",g.createElement("span",{style:{color:"#1676ff"}},n+1," ")," / ",t.length," ",g.createElement(G.Z,null)))})))))})),K=n(94148);var N=(0,f.connect)((function(e){var t=e.systemManage,n=t.contractDetail,a=void 0===n?{}:n,r=t.configurationData;return{contractDetail:a,configurationData:void 0===r?{}:r}}))((function(e){var t=(0,g.useState)(!1),n=(0,s.Z)(t,2),u=n[0],d=n[1],f=(0,g.useState)(!1),y=(0,s.Z)(f,2),b=y[0],C=y[1],Z=(0,g.useState)({}),w=(0,s.Z)(Z,2),O=w[0],_=w[1],P=(0,g.useState)(!1),k=(0,s.Z)(P,2),x=k[0],I=k[1],S=(0,g.useState)(),j=(0,s.Z)(S,2),F=j[0],M=j[1],T={searchParams:{meta:{page:1,limit:30}}};(0,g.useEffect)((function(){var t=e.location.query.id;void 0!==t&&(e.dispatch({type:"systemManage/fetchContractDetail",payload:{id:t}}),e.dispatch({type:"systemManage/fetchContractConfigurationList",payload:{id:t}}))}),[]);var D,V,L,z,Y,H,B,G,N,Q,U,W=function(){var t=e.location.query.id,n=T.searchParams,a=n.page,r=n.limit;e.dispatch({type:"systemManage/fetchContractConfigurationList",payload:{id:t,page:a,limit:r}})},X=function(t,n){var a=e.location.query.id;T.searchParams.page=t,T.searchParams.limit=n,e.dispatch({type:"systemManage/fetchContractConfigurationList",payload:{id:a,page:t,limit:n}})},R=function(t,n){var a=e.location.query.id;T.searchParams.page=t,T.searchParams.limit=n,e.dispatch({type:"systemManage/fetchContractConfigurationList",payload:{id:a,page:t,limit:n}})},$=function(){C(!0)},ee=function(){C(!1)},te=function(){d(!1),_({})};return g.createElement("div",null,(G={wordWrap:"break-word",wordreBak:"break-all"},N=p().get(e,"contractDetail",{}),Q={labelCol:{span:7},wrapperCol:{span:17}},U=[g.createElement(l.Z.Item,(0,c.Z)({label:"公司名称"},Q),g.createElement("div",{style:G},p().get(N,"name",void 0)||"--")),g.createElement(l.Z.Item,(0,c.Z)({label:"统一社会信用代码"},Q),g.createElement("div",{style:G},p().get(N,"credit_no",void 0)||"--")),g.createElement(l.Z.Item,(0,c.Z)({label:"法人"},Q),g.createElement("div",{style:G},p().get(N,"legal_person",void 0)||"--")),g.createElement(l.Z.Item,(0,c.Z)({label:"电话"},Q),g.createElement("div",{style:G},p().get(N,"phone",void 0)||"--")),g.createElement(l.Z.Item,(0,c.Z)({label:"地址"},Q),g.createElement("div",{style:G},p().get(N,"address",void 0)||"--")),g.createElement(l.Z.Item,(0,c.Z)({label:"是否允许电子签"},Q),g.createElement("div",{style:G},E.gtZ.description(p().get(N,"is_electronic_sign",!1)))),g.createElement(l.Z.Item,(0,c.Z)({label:"状态"},Q),g.createElement("div",null,p().get(N,"state",void 0)?E._zp.description(p().get(N,"state",void 0)):"--"))],g.createElement(h.IT,null,g.createElement(h.Fp,{items:U,cols:3}))),(V=p().get(e,"configurationData.data",[]),L=p().get(e,"configurationData._meta.result_count",0),z=T.searchParams.page,Y=[{title:"平台",dataIndex:"platform_name",key:"platform_name",render:function(e){return e||"--"}},{title:"供应商",dataIndex:"supplier_name",key:"supplier_name",render:function(e){return e||"--"}},{title:"城市",dataIndex:"city_list",key:"city_list",render:function(e){return m().not.existy(e)||m().empty(e)||m().not.array(e)?"全部":1===e.length?e[0].city_name:g.createElement(o.Z,{title:e.map((function(e){return e.city_name})).join(" , ")},g.createElement("span",null,p().get(e,"0.city_name")," 等",e.length,"条"))}},{title:"创建时间",dataIndex:"created_at",key:"created_at",render:function(e){return e?v()(e).format("YYYY-MM-DD HH:mm"):"--"}},{title:"最新操作人",dataIndex:"operator_info",key:"operator_info",render:function(e){return e&&(e.name||e.phone)?e.name&&e.phone?"".concat(e.name,"(").concat(e.phone,")"):e.name:"--"}},{title:"合同模板名称",dataIndex:["template_info","name"],key:["template_info","name"],render:function(e){return e||"--"}},{title:"操作",dataIndex:"operation",key:"operation",render:function(t,n){return g.createElement("div",null,g.createElement("a",{className:K.Z["app-comp-system-update-btn"],onClick:function(){!function(e){d(!0),_(e)}(n)}},"编辑"),g.createElement(i.Z,{title:"确定要删除吗?",onConfirm:function(){return t=n._id,void e.dispatch({type:"systemManage/deleteContractConfiguration",payload:{id:t,onSuccessCallback:W}});var t},okText:"确定",cancelText:"取消"},g.createElement("a",null,"删除")),n.template_id?g.createElement("a",{style:{marginLeft:10},onClick:function(){return function(e){I(!0),M(e._id)}(n)}},"预览合同"):null)}}],H={current:void 0===z?1:z,defaultPageSize:30,onChange:X,showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:R,showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],total:L},B=g.createElement(r.Z,{type:"primary",onClick:$},"新增"),g.createElement(h.IT,{title:"合同甲方配置列表",titleExt:B},g.createElement(a.Z,{rowKey:function(e,t){return t},pagination:H,columns:Y,dataSource:V,bordered:!0}))),(D=e.location.query.id,g.createElement("div",null,g.createElement(q,{onCancel:ee,visible:b,id:D}),g.createElement(A,{onCancel:te,visible:u,data:O,id:D}))),x?g.createElement(J,{onCancel:function(){I(!1),M(void 0)},previewId:F}):null)}))},94148:function(e,t){t.Z={"app-comp-system-company-btn":"H162Mf6mJs0P_xKFVTsg","app-comp-system-update-btn":"BnlzMJAEdKLqqevDxVbA"}}}]);