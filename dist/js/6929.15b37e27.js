"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[6929],{66929:function(e,t,n){n.r(t),n.d(t,{default:function(){return G}});n(20186);var r=n(75385),o=(n(52560),n(71577)),a=n(29439),c=n(67294),i=n(55609),p=n(66939),l=(n(98703),n(93517)),s=n.n(l),u=n(96036),m=n(80385),f=(n(52466),n(10642)),d=(n(9070),n(20924)),y=n(4942),b=n(45697),v=n.n(b);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,y.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(){};function Z(e){var t,n,r,o,a=e.visible,i=e.dataSource,p=e.onCreateSuccess,l=function(){e.form.resetFields(),p()};return c.createElement(f.Z,{title:"编辑推荐公司信息",cancelText:"取消",okText:"保存",visible:a,onOk:function(){var t=i._id;e.form.validateFields((function(n,r){n||e.dispatch({type:"systemRecommendedCompany/updateCompany",payload:g({recommendedCompanyId:t,onSuccessCallback:l},r)})}))},onCancel:function(){e.form.resetFields(),e.onCancel()}},(t=e.form.getFieldDecorator,n=i.name,r=i.abbreviation,o=[{label:"推荐公司",form:t("name",{initialValue:n,rules:[{required:!0,transform:function(e){return e.trim()},message:"请填写"}]})(c.createElement(d.Z,{maxLength:100}))},{label:"公司简称",form:t("abbreviation",{initialValue:r})(c.createElement(d.Z,{maxLength:100}))}],c.createElement(u.KP,{items:o,layout:{labelCol:{span:5},wrapperCol:{span:17}}})))}Z.propTypes={dataSource:v().object.isRequired,visible:v().bool,onCreateSuccess:v().func.isRequired,onCancel:v().func.isRequired},Z.defaultProps={dataSource:{},visible:!1,onCreateSuccess:h,onCancel:h};var O=(0,i.connect)()(p.Z.create()(Z)),R=n(15671),S=n(43144),E=n(97326),P=n(60136),j=n(82963),w=n(61120),k=n(88144),D=(n(29093),n(16317)),I=n(94315),x=n.n(I),F=n(8240);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,y.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,w.Z)(e);if(t){var o=(0,w.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,j.Z)(this,n)}}var A=D.Z.Option,B="recomendedCompany",N="supplierall",L=function(e){(0,P.Z)(n,e);var t=T(n);function n(){var e;(0,R.Z)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),(0,y.Z)((0,E.Z)(e),"componentDidMount",(function(){var t=e.props.platform;x().not.empty(t)&&e.props.dispatch({type:"applicationCommon/fetchSuppliers",payload:{namespace:B,platforms:[t]}})})),(0,y.Z)((0,E.Z)(e),"componentDidUpdate",(function(t){e.props.platform!==t.platform&&(""===e.props.platform?e.props.dispatch({type:"applicationCommon/resetSuppliers",payload:{namespace:B}}):e.props.dispatch({type:"applicationCommon/fetchSuppliers",payload:{namespace:B,platforms:[e.props.platform]}}))})),(0,y.Z)((0,E.Z)(e),"componentWillUnmount",(function(){e.props.dispatch({type:"applicationCommon/resetSuppliers",payload:{namespace:B}})})),(0,y.Z)((0,E.Z)(e),"onChangeSuppliers",(function(t){e.props.onChange(t)})),(0,y.Z)((0,E.Z)(e),"renderOptions",(function(){var t=e.props,n=t.platform,r=t.serviceRange;if(""===n)return null;if(void 0!==r.find((function(e){return e.domain===m.LLD.platform&&e.platform_code===n})))return null;var o=s().get(e.props,"suppliers.".concat(B),[]),a=[];o.forEach((function(e){var t=!1;r.forEach((function(n){e.supplier_id===n.supplier_id&&(t=!0)})),!1===t&&a.push(e)}));var i=a.map((function(e){return c.createElement(A,{value:e.supplier_id,key:e.supplier_id},e.supplier_name)}));return a.length>0&&i.unshift(c.createElement(A,{value:N,key:N},"全部")),i})),e}return(0,S.Z)(n,[{key:"render",value:function(){var e=q(q({},this.props),{},{onChange:this.onChangeSuppliers}),t=(0,F.CE)(["serviceRange","dispatch"],e);return c.createElement(D.Z,t,this.renderOptions())}}]),n}(c.Component);(0,y.Z)(L,"propTypes",{platform:v().string,serviceRange:v().array,onChange:v().func}),(0,y.Z)(L,"defaultProps",{platform:"",serviceRange:[],onChange:function(){}});var U=(0,i.connect)((function(e){return{suppliers:e.applicationCommon.suppliers}}))(L),V="xlqywsQIUSuD_mgCDzbq";function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,y.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,w.Z)(e);if(t){var o=(0,w.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,j.Z)(this,n)}}var H=function(){},Q=function(e){(0,P.Z)(n,e);var t=W(n);function n(){var e;(0,R.Z)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),(0,y.Z)((0,E.Z)(e),"onCancelCallback",(function(){e.props.form.resetFields(),e.props.onCancel()})),(0,y.Z)((0,E.Z)(e),"onCreateSuccessCallback",(function(){e.props.form.resetFields(),e.props.onCreateSuccess()})),(0,y.Z)((0,E.Z)(e),"onChangePlatform",(function(){e.props.form.resetFields(["supplierIds"])})),(0,y.Z)((0,E.Z)(e),"onSubmit",(function(){e.props.form.validateFields((function(t,n){t||e.props.dispatch({type:"systemRecommendedCompany/createServiceRange",payload:z(z({},n),{},{recommendedCompanyId:e.props.recommendedCompanyId,onSuccessCallback:e.onCreateSuccessCallback})})}))})),(0,y.Z)((0,E.Z)(e),"renderForm",(function(){var t=e.props.form.getFieldDecorator,n=e.props.form.getFieldValue("platformCode")||"",r=[{label:"平台",form:t("platformCode",{rules:[{required:!0,message:"请选择"}]})(c.createElement(k.Yg,{onChange:e.onChangePlatform,placeholder:"请选择平台",className:V}))},{label:"供应商",form:t("supplierIds",{rules:[{required:!0,message:"请选择"}]})(c.createElement(U,{allowClear:!0,mode:"multiple",showArrow:!0,placeholder:"请选择供应商",className:V,serviceRange:e.props.serviceRange,platform:n}))}];return c.createElement(u.KP,{items:r,layout:{labelCol:{span:5},wrapperCol:{span:17}}})})),e}return(0,S.Z)(n,[{key:"render",value:function(){var e=this.props.visible;return c.createElement(f.Z,{title:"新增推荐公司关系",cancelText:"取消",okText:"保存",visible:e,onOk:this.onSubmit,onCancel:this.onCancelCallback},this.renderForm())}}]),n}(c.Component);(0,y.Z)(Q,"propTypes",{visible:v().bool,recommendedCompanyId:v().string.isRequired,serviceRange:v().array,onCreateSuccess:v().func.isRequired,onCancel:v().func.isRequired}),(0,y.Z)(Q,"defaultProps",{visible:!1,recommendedCompanyId:"",serviceRange:[],onCreateSuccess:H,onCancel:H});var M=(0,i.connect)()(p.Z.create()(Q)),X=n(45430),Y=n(98258);var G=(0,i.connect)((function(e){var t=e.systemRecommendedCompany;return{serviceRange:t.serviceRange,companyDetail:t.companyDetail}}))(p.Z.create()((function(e){var t=(0,c.useState)(!1),n=(0,a.Z)(t,2),i=n[0],p=n[1],l=(0,c.useState)(!1),f=(0,a.Z)(l,2),d=f[0],y=f[1],b={recommendedCompanyId:s().get(e,"location.query.id",void 0)},v=function(){e.dispatch({type:"systemRecommendedCompany/fetchServiceRange",payload:{recommendedCompanyId:b.recommendedCompanyId}})},C=function(){e.dispatch({type:"systemRecommendedCompany/fetchCompanyDetail",payload:{recommendedCompanyId:b.recommendedCompanyId}})};(0,c.useEffect)((function(){return v(),C(),function(){e.dispatch({type:"systemRecommendedCompany/resetServiceRange"}),e.dispatch({type:"systemRecommendedCompany/resetCompanyDetail"})}}),[]);var g,h,Z,R,S,E,P,j,w=function(e){p(e)},k=function(t,n){e.dispatch({type:"systemRecommendedCompany/changeServiceRangeState",payload:{serviceRangeId:t,state:n,onSuccessCallback:function(){v()}}})},D=function(){w(!1),C()},I=function(e){y(e)},x=function(){I(!1),v()};return c.createElement("div",null,(h=s().get(e,"companyDetail",{}),Z=h.name,R=h.abbreviation,S=h.code,E=h.state,P={wordWrap:"break-word",wordBreak:"break-all"},j=[{label:"推荐公司",span:5,form:c.createElement("div",{style:P},Z)},{label:"公司简称",span:5,form:c.createElement("div",{style:P},R)||"--"},{label:"公司代号",span:5,form:S?c.createElement("div",{style:P,className:Y.Z["app-comp-system-detail-form-item-code"]},S):"--"},{label:"状态",span:5,form:m.J1k.description(E)},{label:"",span:4,form:X.ZP.canOperateSystemRecommendedCompanyUpdate()?c.createElement(o.Z,{type:"primary",onClick:function(){return w(!0)}},"编辑"):null}],c.createElement(u.IT,null,c.createElement(u.KP,{items:j,cols:6,layout:{labelCol:{span:8},wrapperCol:{span:16}}}))),function(){var t=s().get(e,"serviceRange.data",[]),n=[{title:"服务平台",dataIndex:"platform_name"},{title:"服务供应商范围",render:function(e){return e.domain===m.LLD.platform?"全部":e.supplier_name}},{title:"状态",dataIndex:"state",render:function(e){return m.lx6.description(e)}},{title:"操作",render:function(e){var t=null;return!1===X.ZP.canOperateSystemRecommendedCompanyUpdate()||(e.state===m.lx6.on?t=c.createElement("a",{className:Y.Z["app-comp-system-detail-table-btn"],onClick:function(){return k(e._id,m.lx6.off)}},"停用"):e.state===m.lx6.off&&(t=c.createElement("span",null,c.createElement("a",{className:Y.Z["app-comp-system-detail-table-btn"],onClick:function(){return k(e._id,m.lx6.deleted)}},"删除"),c.createElement("a",{className:Y.Z["app-comp-system-detail-table-btn"],onClick:function(){return k(e._id,m.lx6.on)}},"启用")))),t}}],a=null;return X.ZP.canOperateSystemRecommendedCompanyUpdate()&&(a=c.createElement(o.Z,{type:"primary",onClick:function(){return I(!0)}},"添加")),c.createElement(u.IT,{title:"推荐公司服务范围列表",titleExt:a},c.createElement(r.Z,{rowKey:function(e){return e._id},pagination:!1,columns:n,dataSource:t}))}(),function(){var t=s().get(e,"companyDetail",{});return c.createElement(O,{visible:i,dataSource:t,onCreateSuccess:D,onCancel:function(){return w(!1)}})}(),(g=s().get(e,"serviceRange.data",[]),c.createElement(M,{visible:d,recommendedCompanyId:b.recommendedCompanyId,serviceRange:g,onCreateSuccess:x,onCancel:function(){return I(!1)}})))})))},98258:function(e,t){t.Z={"app-comp-system-detail-form-item-code":"w4AGug26wHFtakIxvjtk","app-comp-system-detail-table-btn":"NAglS9mnkHTmeCAQEb0M","app-comp-system-recommend-table-td-code":"zvZzwtHRZXlAX6fdTAzo","app-comp-system-recommend-table-btn":"jr0V6IllVKBlVIoAPQW5","app-comp-system-recommend-table-detail-btn":"nvgEgtULY0AWcdONi0xF"}}}]);