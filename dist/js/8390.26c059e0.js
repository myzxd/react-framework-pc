"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[8390],{12213:function(e,t,n){n(52466);var a=n(10642),r=(n(52560),n(71577)),o=n(4942),c=n(93517),i=n.n(c),l=n(94315),s=n.n(l),p=n(55609),u=n(67294);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=(0,p.connect)((function(e){return{teamManager:e.teamManager}}))((function(e){var t,n,o,c,l,p=e.dispatch,d=e.onDistrictHandleCancel,f=e.isDistrictModal,y=function(){var t=e.api,n=void 0===t?void 0:t,a=e.paramsInfo,r=void 0===a?{}:a,o=e.updateListCallback,c=e.onCancel,i=e.knightInfo.map((function(e){return e.biz_district_id})),l=m(m({},r),{},{districtId:i,onSuccessCallBack:function(){o&&o(),d&&d(),c&&c()}});p({type:n,payload:l})};return u.createElement(a.Z,{visible:f,onOk:y,onCancel:function(){var t=e.onClickUpdateOwner,n=e.detail;d&&d(),t&&t(n)},footer:[u.createElement(r.Z,{key:"yes",type:"primary",onClick:y},"是"),u.createElement(r.Z,{key:"no",onClick:function(){var t=e.api,n=void 0===t?void 0:t,a=e.paramsInfo,r=void 0===a?{}:a,o=e.updateListCallback,c=e.onCancel,i=m(m({},r),{},{onSuccessCallBack:function(){d&&d(),o&&o(),c&&c()}});p({type:n,payload:i})}},"否")]},(t=e.detail,n=e.knightInfo,o=s().not.empty(n)&&n.length>0?n:[],c=i().get(t,"staff_info.name")?i().get(t,"staff_info.name","--"):i().get(t,"owner_info.staff_info.name"),l=o.map((function(e){return e.biz_district_name})),u.createElement("div",{style:{textAlign:"center"}},u.createElement("span",null,"是否同时将".concat(c||"--","的骑士账号移出")),u.createElement("a",null,l&&s().not.empty(l)?l.join(","):""),u.createElement("span",null,"（当前业主有骑士身份的商圈）？"))))}))},78890:function(e,t,n){var a=n(15671),r=n(43144),o=n(97326),c=n(60136),i=n(82963),l=n(61120),s=n(4942),p=n(94315),u=n.n(p),d=n(93517),m=n.n(d),f=n(45697),y=n.n(f),h=n(67294),b=n(55609),O=n(96036),g=n(80385),v=n(8240);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.Z)(e);if(t){var r=(0,l.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,i.Z)(this,n)}}var D=O.Hr.Option,w=function(e){(0,c.Z)(n,e);var t=Z(n);function n(e){var r;return(0,a.Z)(this,n),r=t.call(this,e),(0,s.Z)((0,o.Z)(r),"onSearch",(function(e){if(e&&!0===/^[A-Za-z0-9]{15,18}$/g.test(e)){var t=r.onReplaceReg(/\w/g,e);r.props.dispatch({type:"employeeManage/fetchEmployees",payload:{onFailureCallback:function(){setTimeout((function(){r.setState({employeesData:[{identity_card_id:t}]})}),50)},identityCardId:t,isAll:!0,fileType:"second",state:[g.G8O.pending,g.G8O.normal,g.G8O.replace,g.G8O.pendingReview,g.G8O.repair]}})}})),(0,s.Z)((0,o.Z)(r),"onChange",(function(e){if(e){var t=r.onReplaceReg(/\w/g,e),n=r.state.employeesData.filter((function(e){return e.identity_card_id===t})),a=n.length>0?n[0]:{};r.props.onChange&&r.props.onChange(t,a)}void 0===e&&(r.props.dispatch({type:"employeeManage/resetEmployees",payload:{fileType:"second"}}),r.props.onChange&&r.props.onChange(void 0,{}))})),r.state={employeesData:m().get(r.props,"employeesSecond.data",[])},r}return(0,r.Z)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props.employeesSecond;e.employeesSecond!==t&&this.setState({employeesData:m().get(this.props,"employeesSecond.data",[])})}},{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"employeeManage/resetEmployees",payload:{fileType:"second"}})}},{key:"onReplaceReg",value:function(e,t){if(t)return t.toLowerCase().replace(e,(function(e){return e.toUpperCase()}))}},{key:"render",value:function(){var e,t=this.state.employeesData;u().not.empty(t)&&u().existy(t)&&(e=t.map((function(e){return h.createElement(D,{value:e.identity_card_id,key:e.identity_card_id},e.name?"".concat(e.name,"（").concat(e.identity_card_id,"）"):"".concat(e.identity_card_id))})));var n=(0,v.CE)(["dispatch","employeesSecond"],this.props),a=this.props.style||{width:260},r=C(C({},n),{},{style:a,placeholder:"请输入身份证号搜索",showSearch:!0,defaultActiveFirstOption:!1,showArrow:!1,allowClear:!0,filterOption:!1,onChange:this.onChange,onSearch:this.onSearch,notFoundContent:null});return h.createElement(O.Hr,r,e)}}]),n}(h.Component);(0,s.Z)(w,"propTypes",{employeesSecond:y().object}),(0,s.Z)(w,"defaultProps",{employeesSecond:{}});t.Z=(0,b.connect)((function(e){return{employeesSecond:e.employeeManage.employeesSecond}}))(w)},48390:function(e,t,n){n(52466);var a=n(10642),r=(n(36037),n(47933)),o=n(4942),c=(n(35668),n(86585)),i=n(29439),l=n(93517),s=n.n(l),p=n(94315),u=n.n(p),d=n(67294),m=n(30381),f=n.n(m),y=n(96036),h=n(78890),b=n(80385),O=n(12213);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=c.Z.useForm(),n=(0,i.Z)(t,1)[0],o=(0,d.useState)({}),l=(0,i.Z)(o,2),p=l[0],m=l[1],g=(0,d.useState)(!1),E=(0,i.Z)(g,2),C=E[0],Z=E[1],D=(0,d.useState)({}),w=(0,i.Z)(D,2),_=w[0],j=w[1],k=(0,d.useState)({}),S=(0,i.Z)(k,2),P=S[0],I=S[1],M=(0,d.useState)({}),F=(0,i.Z)(M,2),R=F[0],B=F[1];(0,d.useEffect)((function(){e.visible&&u().not.empty(e.detail)&&B(e.detail)}),[e.visible]);var T,Y,x=function(e,t){m(t),n.setFieldsValue({planDoneDate:void 0})},G=function(){e.onCancel&&e.onCancel(),I({}),m({}),n.resetFields()},U=function(){Z(!1)};return d.createElement(c.Z,{form:n,onFinish:function(t){var a;t.planDoneDate!==b.E0m.sameMonth&&t.planDoneDate!==b.E0m.perfect||(a=Number(f()().format("YYYYMMDD"))),t.planDoneDate===b.E0m.nextMonth&&(a=Number(f()().subtract("month",-1).format("YYYYMM01")));var r=v(v({},t),{},{planDoneDate:a,ownerId:R._id,staffId:p._id,district:R.biz_district_ids});j(r),e.dispatch({type:"teamManager/fetchTeamKnightDistrcit",payload:v(v({},r),{},{onSuccessCallBack:function(t){!function(t,a){var r=n.getFieldValue;u().not.empty(t)&&u().existy(t)&&r("planDoneDate")===b.E0m.sameMonth?(e.onCancel&&e.onCancel(),I(t),Z(!0)):e.dispatch({type:"teamManager/updateOwnerteamManagers",payload:v(v({},a),{},{onSuccessCallBack:function(){e.onSuccessCallBack&&e.onSuccessCallBack(),e.onCancel&&e.onCancel(),I({}),m({}),n.resetFields()}})})}(t,r)}})})}},d.createElement(a.Z,{title:"变更业主",visible:e.visible,width:650,onOk:function(){n.submit()},onCancel:G},(Y=[d.createElement(c.Z.Item,{label:"团队ID"},d.createElement("span",null,R._id||"--"))],d.createElement(y.IT,{title:"业主团队信息"},d.createElement(y.Fp,{items:Y,cols:1}))),function(){var e=R.staff_info||{},t=[{span:10,render:d.createElement(c.Z.Item,{label:"身份证号"},d.createElement("span",null,R.state===b.zqR.notEffect?R.identity_card_id?R.identity_card_id:"--":s().get(R,"staff_info.identity_card_id","--")))},{span:6,render:d.createElement(c.Z.Item,{label:"姓名"},d.createElement("span",null,e.name||"--"))},d.createElement(c.Z.Item,{label:"手机号"},d.createElement("span",null,e.phone||"--")),{span:12,render:d.createElement(c.Z.Item,{label:"业主ID"},d.createElement("span",null,R.staff_id||"--"))}];return d.createElement(y.IT,{title:"变更前业主"},d.createElement(y.Fp,{items:t}))}(),function(){var e=n.getFieldValue,t=[{span:17,render:d.createElement(c.Z.Item,{label:"身份证号",name:"idCard",help:p._id?"":"暂无档案的新业主,输入身份证号后点“确定”即邀请加入",rules:[{required:!0,message:"请输入正确的身份证号"}]},d.createElement(h.Z,{style:{width:"95%"},onChange:x}))},{span:12,render:d.createElement(c.Z.Item,{label:"姓名"},d.createElement("span",null,p.name||"--"))},{span:12,render:d.createElement(c.Z.Item,{label:"手机号"},d.createElement("span",null,p.phone||"--"))},{span:24,render:d.createElement(c.Z.Item,{label:"生效日期",name:"planDoneDate",rules:[{required:!0,message:"请选择生效日期"}]},d.createElement(r.ZP.Group,null,d.createElement(r.ZP,{disabled:!p._id||!e("idCard"),value:b.E0m.sameMonth},b.E0m.description(b.E0m.sameMonth)),d.createElement(r.ZP,{disabled:!p._id||!e("idCard"),value:b.E0m.nextMonth},b.E0m.description(b.E0m.nextMonth)),d.createElement(r.ZP,{disabled:void 0!==p._id||!e("idCard"),value:b.E0m.perfect},b.E0m.description(b.E0m.perfect))))}];return d.createElement(y.IT,{title:"变更后业主"},d.createElement(y.Fp,{items:t}))}()),(T=e.onClickUpdateOwner,d.createElement(O.Z,{isDistrictModal:C,detail:R,onDistrictHandleCancel:U,api:"teamManager/updateOwnerteamManagers",onClickUpdateOwner:T,onCancel:G,knightInfo:P,updateListCallback:e.onSuccessCallBack,paramsInfo:_})))}}}]);