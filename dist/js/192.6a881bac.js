"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[192],{80192:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});n(62004);var r=n(11382),a=(n(13062),n(71230)),o=(n(89032),n(15746)),c=(n(52560),n(71577)),i=(n(36616),n(51368)),s=n(4942),l=(n(51838),n(48086)),m=n(29439),d=(n(9070),n(20924)),u=n(94315),f=n.n(u),p=n(67294),y=n(55609),b=n(66939),v=(n(98703),n(96036)),E=n(80385),h=(n(438),n(14277)),Z=(n(55295),n(69713)),g=n(93433),O=n(7145),w=n.n(O),P=n(45697),_=n.n(P),x=(n(29093),n(16317)),C=n(93517),D=n.n(C),A=n(96486),j=n.n(A),S=n(10839),F=x.Z.Option,M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.namespace,n=e.value,r=e.onChange,a=e.employees,o=e.dispatch,c=e.disabled,i=e.name,s=D().get(a,t,{}),l=s.data||[],m=function(e){var n={name:e,state:[E.G8O.normal],page:1,limit:30,namespace:t};o({type:"enterprisePayment/fetchEmployees",payload:n})},d=j().debounce((function(e){m(e)}),800),u=function(e){var t=l.filter((function(t){return t.staff_info._id===e})),n="",a="";f().existy(t)&&f().not.empty(t)&&(n=t[0].staff_info.identity_card_id,a=t[0].staff_info.name),r&&r({value:e,identityCardId:n,name:a})};return!0===c?p.createElement(x.Z,{disabled:c,value:i,showArrow:!1,placeholder:"请输入姓名",className:S.Z.bossEmployeeListNameSelector},l.map((function(e){return p.createElement(F,{key:n,value:e.staff_info.name},e.staff_info.name)}))):p.createElement(x.Z,{showSearch:!0,showArrow:!1,value:n,placeholder:"请输入姓名",filterOption:!1,onSearch:d,onChange:u,className:S.Z.bossEmployeeListNameSelector},l.map((function(e){return p.createElement(F,{key:e.staff_info._id,value:e.staff_info._id},e.staff_info.name)})))};M.propTypes={value:_().any,namespace:_().string,onChange:_().func},M.defaultProps={namespace:"default",value:"",onChange:function(){}};var N=(0,y.connect)((function(e){return{employees:e.enterprisePayment.employees}}))(M);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,n=e.onChange,r=e.dispatch,l=e.changeShow,u=(0,p.useState)(0),y=(0,m.Z)(u,2),b=y[0],O=y[1],P=function(e){l&&l(!0),r({type:"enterprisePayment/fetchEmployeListUpload",payload:{fileKey:e,onSuccessCallBack:x,onErrorCallBack:_}})},_=function(){l&&l(!1)},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=t;l(!1);var a=e.map((function(e){return I(I({},e),{},{disabled:!0,owner_id:e.staff_id,money:E.fbc.exchangePriceToYuan(e.money)})}));n([].concat((0,g.Z)(r),(0,g.Z)(a)))},C=function(){r({type:"enterprisePayment/fetchPaymentDownloadTemplate",payload:{}})},D=function(e,r){var a=t,o=a[r].money;(f().not.existy(a[r].money)||f().empty(a[r].money))&&(o=void 0),n(w()(a,(0,s.Z)({},r,{owner_id:{$set:e.value},identity_card_id:{$set:e.identityCardId},name:{$set:e.name},money:{$set:o}})))},A=function(e,r){var a=t,o=a[r].name,c=a[r].identity_card_id,i=a[r].owner_id;a[r].money=e,(f().not.existy(a[r].name)||f().empty(a[r].name))&&(o=void 0),(f().not.existy(a[r].identity_card_id)||f().empty(a[r].identity_card_id))&&(c=void 0),(f().not.existy(a[r].owner_id)||f().empty(a[r].owner_id))&&(i=void 0),n(w()(a,(0,s.Z)({},r,{money:{$set:e},name:{$set:o},identity_card_id:{$set:c},owner_id:{$set:i}})))},j=function(e){var r=t;n(w()(r,{$splice:[[e,1]]}))},F=function(){var e=t,r={namespace:b,temp_id:null};O(b+1),n(w()(e,{$push:[r]}))},M=function(){var e=p.createElement(Z.Z,{title:"建议上传不超过300条记录的Excel文件"},p.createElement(c.Z,null,"导入Excel"));return p.createElement(a.Z,null,p.createElement(o.Z,{span:12,offset:6,className:S.Z.bossAddExcelWrap},p.createElement(c.Z,{className:S.Z.bossAddExcelDownload,onClick:C},"下载模板"),p.createElement(v.zI,{domain:"payment",customContent:e,onSuccess:P}),p.createElement(c.Z,{className:S.Z.bossAddExcelDetal,onClick:F},"新增明细")))},k=function(){return t.map((function(e,t){var n=!!e.disabled;return p.createElement(a.Z,{className:S.Z.bossAddMemberItem,key:t},p.createElement(o.Z,{span:12,offset:6},p.createElement("div",{className:S.Z.bossAddMemberForm},p.createElement(N,{disabled:n,namespace:"".concat(e.namespace),name:e.name,value:e.owner_id,onChange:function(e){return D(e,t)}}),p.createElement(d.Z,{className:S.Z.bossAddMemberCardId,disabled:!0,value:e.identity_card_id}),p.createElement(i.Z,{className:S.Z.bossAddMemberExpense,disabled:n,value:e.money,placeholder:"请输入费用",step:.01,min:0,formatter:E.fbc.limitDecimals,parser:E.fbc.limitDecimals,onChange:function(e){return A(e,t)}}),p.createElement(c.Z,{onClick:function(){j(t)}},"移除"))))}))},V="".concat(window.innerHeight-434,"px");return p.createElement("div",null,p.createElement("div",{className:S.Z.bossAddMemberRenderExcel},M()),t.length>0?p.createElement("div",{style:{height:V,overflowY:"scroll"}},p.createElement("div",null,k())):p.createElement("div",{style:{height:V,display:"flex",alignItems:"center",justifyContent:"center"}},p.createElement(h.Z,{image:h.Z.PRESENTED_IMAGE_SIMPLE})))};V.propTypes={value:_().array,onChange:_().func,changeShow:_().func},V.defaultProps={value:[],onChange:function(){},changeShow:function(){}};var U=(0,y.connect)()(V);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=d.Z.TextArea,T=(0,y.connect)()(b.Z.create()((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.form,n=void 0===t?{}:t,s=e.dispatch,d=(0,p.useState)(!1),u=(0,m.Z)(d,2),y=u[0],h=u[1],Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(f().not.array(e))return l.ZP.error("付款单明细的数据格式错误");var t=!1;return!(!f().not.existy(e)&&!f().empty(e))||(e.forEach((function(e){if(!f().empty(e))return e.money&&e.name?void Object.keys(e).forEach((function(n){if(f().not.existy(e[n])||f().empty(e[n]))return t=!0,!0})):(t=!0,!0);t=!0})),t)},g=function(e){e.preventDefault(),n.validateFieldsAndScroll((function(e,t){if(!e){var n=t.detailArray.map((function(e){return delete e.temp_id,K({},e)})),r=Z(n);if(f().not.empty(n[0])&&!0===r)return l.ZP.error("付款单明细请填写完整或移除不完整项");if(0===t.totalMoney)return l.ZP.error("费用总计金额不能为0");if(n.map((function(e){return e.money})).reduce((function(e,t){return e+t}))!==t.totalMoney)return l.ZP.error("明细中的付款金额总值和费用总计金额值不一致，请重新输入！");var a=K({},t);s({type:"enterprisePayment/createPayment",payload:a})}}))},O=function(){var e=n.getFieldDecorator,t=[{label:"费用总计",form:e("totalMoney",{rules:[{required:!0,message:"请输入费用总计"}]})(p.createElement(i.Z,{className:S.Z.bossPaymentOrderSumInput,placeholder:"请输入费用总计",step:.01,min:0,formatter:E.fbc.limitDecimals,parser:E.fbc.limitDecimals}))},{label:"款项说明：",form:e("note",{rules:[{required:!0,message:"请输入款项说明"}]})(p.createElement(L,{rows:8}))}];return p.createElement(v.KP,{items:t,cols:1,layout:{labelCol:{span:8},wrapperCol:{span:8}}})},w=function(e){h(e)},P=function(){var e=n.getFieldDecorator;return p.createElement(b.Z.Item,null,e("detailArray",{initialValue:[]})(p.createElement(U,{changeShow:w})))},_=function(){return p.createElement(a.Z,{className:S.Z.bossPaymentOrderFooterWrap},p.createElement(o.Z,{span:8,offset:8,className:S.Z.bossPaymentOrderFooterItem},p.createElement(c.Z,{className:S.Z.bossPaymentOrderFooterCancel,onClick:function(){window.location.href="#/Enterprise/Payment"}},"取消"),p.createElement(c.Z,{type:"primary",htmlType:"submit"},"提交")))},x="".concat(window.innerHeight,"px"),C=y?"block":"none";return p.createElement("div",null,p.createElement("div",{style:{display:C,width:"100%",height:x,position:"absolute",zIndex:"9999"}},p.createElement("div",{className:S.Z.bossPaymentOrderSpinWrap},p.createElement(r.Z,{tip:"数据导入中...",size:"large"}))),p.createElement("form",{onSubmit:g},O(),P(),_()))})))},10839:function(e,t){t.Z={bossAddExcelWrap:"gml20CVe3FxbAbnjsDYt",bossAddExcelDownload:"Y3x3q1aOb78NhlSAbMfF",bossAddExcelDetal:"EBBLE9d56qbcxEoQy2jx",bossAddMemberItem:"wFVUugXfA94hpiD16vfv",bossAddMemberForm:"W7ACKeJHHO2ZklPFcRVA",bossAddMemberCardId:"lc8aJoDn5ydLMvrh_8dS",bossAddMemberExpense:"nQb38kCwgbUDBgPw__rF",bossAddMemberRenderExcel:"hpMnUBTIz6Srgp2pFZXm",bossDetailFooterWrap:"MMUk8JqZsUx0FVGnNFiE",bossDetailFooterItem:"cWA_o0vUK_tNGuBtsmdU",bossDetailFooterCancel:"VJ6wEvgVOywk_dO_R446",bossEmployeeListNameSelector:"LYerEsCfaZBDDHK9KRtI",bossPaymentOrderSumInput:"cspRr3EHMDpZtv16K3Mx",bossPaymentOrderSpinWrap:"TzYEOdznVFM0nIzBULqz",bossPaymentOrderFooterWrap:"VvVOuwiVL8jKWIxPx7Jj",bossPaymentOrderFooterItem:"VQTHm1tKwUG_UhmoVDcX",bossPaymentOrderFooterCancel:"p82VC5KqaU8hemQhGmwf"}}}]);