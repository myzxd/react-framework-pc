"use strict";(self.webpackChunkaoaoBoss=self.webpackChunkaoaoBoss||[]).push([[8215],{8215:function(e,t,n){n.r(t),n.d(t,{default:function(){return J}});n(20186);var r=n(75385),a=(n(55295),n(69713)),o=n(15671),i=n(43144),c=n(97326),s=n(60136),l=n(82963),d=n(61120),u=n(4942),p=n(94315),m=n.n(p),f=n(93517),h=n.n(f),g=n(67294),v=n(55609),y=n(45697),E=n.n(y),x=n(96036),Z=n(80385),b=(n(9070),n(20924)),S=n(87462),w=(n(21316),n(75443)),C=(n(52560),n(71577)),T=(n(51838),n(48086)),Y=(n(54071),n(14072)),D=(n(29093),n(16317)),M=n(30381),I=n.n(M),k=n(88144);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var F=D.Z.Option,O=Y.Z.MonthPicker,V=Y.Z.RangePicker,N=function(e){(0,s.Z)(n,e);var t=P(n);function n(e){var r;return(0,o.Z)(this,n),r=t.call(this,e),(0,u.Z)((0,c.Z)(r),"onToggle",(function(e){var t=r.props.onToggle;t&&t(e)})),(0,u.Z)((0,c.Z)(r),"onReset",(function(){var e=r.state.onSearch,t={type:void 0,state:void 0,approval:void 0,subjects:void 0,cost:void 0,attribution:void 0,submissionStart:void 0,submissionEnd:void 0,paymentStart:void 0,paymentEnd:void 0,themeTags:void 0};r.setState({search:t}),e&&e(t)})),(0,u.Z)((0,c.Z)(r),"onNormalizeThemeTags",(function(e){var t=e,n=t.length,r=n>=1?t[n-1].replace(/\s+/g,""):"";return""===r?t.pop():t[n-1]=r,t})),(0,u.Z)((0,c.Z)(r),"onHookForm",(function(e){r.setState({form:e})})),(0,u.Z)((0,c.Z)(r),"onFailureExportCallback",(function(){T.ZP.error("导出数据失败")})),(0,u.Z)((0,c.Z)(r),"onCreateExportTask",(function(){var e=r.props.dispatch;r.state.form.validateFields((function(t,n){var a=n.platforms,o=n.suppliers,i=n.cities,c=n.districts,s=n.attribution,l=n.type,d=n.state,u=n.approval,p=n.subjects,f=n.cost,h=n.submissionDate,g=n.paymentDate,v=n.themeTags,y={platforms:a,suppliers:o,cities:i,districts:c,type:l,state:d,approval:u,subjects:p,cost:f,attribution:s?Number(I()(s).format("YYYYMM")):"",themeTags:v};m().existy(h)&&m().not.empty(h)&&(y.submissionStart=I()(h[0]).format("YYYYMMDD"),y.submissionEnd=I()(h[1]).format("YYYYMMDD")),m().existy(g)&&m().not.empty(g)&&(y.paymentStart=I()(g[0]).format("YYYYMMDD"),y.paymentEnd=I()(g[1]).format("YYYYMMDD")),e({type:"expenseCostOrder/fetchCostOrderExport",payload:{params:y,onSuccessCallback:r.onSuccessExportCallback,onFailureCallback:r.onFailureExportCallback}})}))})),(0,u.Z)((0,c.Z)(r),"onSearch",(function(e){var t=r.state.onSearch,n=e.platforms,a=e.suppliers,o=e.cities,i=e.districts,c=e.attribution,s=e.type,l=e.state,d=e.approval,u=e.subjects,p=e.cost,f=e.submissionDate,h=e.paymentDate,g=e.themeTags,v={platforms:n,suppliers:a,cities:o,districts:i,type:s,state:l,approval:d,subjects:u,cost:p,attribution:c?Number(I()(c).format("YYYYMM")):"",themeTags:g};m().existy(f)&&m().not.empty(f)&&(v.submissionStart=I()(f[0]).format("YYYYMMDD"),v.submissionEnd=I()(f[1]).format("YYYYMMDD")),m().existy(h)&&m().not.empty(h)&&(v.paymentStart=I()(h[0]).format("YYYYMMDD"),v.paymentEnd=I()(h[1]).format("YYYYMMDD")),t&&t(v)})),(0,u.Z)((0,c.Z)(r),"onSubmissionChange",(function(e,t){var n=r.state.search;n.submissionStart=t[0],n.submissionEnd=t[1],r.setState({search:n})})),(0,u.Z)((0,c.Z)(r),"onPaymentChange",(function(e,t){var n=r.state.search;n.paymentStart=t[0],n.paymentEnd=t[1],r.setState({search:n})})),(0,u.Z)((0,c.Z)(r),"render",(function(){var e,t=r.state.search,n=t.type,a=t.state,o=t.subjects,i=t.approval,c=t.cost,s=r.props.isShowExpand;e=g.createElement(w.Z,{title:"创建下载任务？",onConfirm:r.onCreateExportTask,okText:"确认",cancelText:"取消"},g.createElement(C.Z,{type:"primary"},"导出EXCEL"));var l={showSearch:!0,mode:"multiple",optionFilterProp:"children",allowClear:!0,showArrow:!0},d={items:[{label:"费用分组",form:function(e){return e.getFieldDecorator("type",{initialValue:n})(g.createElement(k.G_,(0,S.Z)({allowClear:!0,placeholder:"请选择费用分组"},l)))}},{label:"单据状态",form:function(e){return e.getFieldDecorator("state",{initialValue:a})(g.createElement(D.Z,(0,S.Z)({allowClear:!0,placeholder:"请选择费用单状态"},l),g.createElement(F,{value:Z.Vm3.processing},Z.Vm3.description(Z.Vm3.processing)),g.createElement(F,{value:Z.Vm3.close},Z.Vm3.description(Z.Vm3.close)),g.createElement(F,{value:Z.Vm3.done},Z.Vm3.description(Z.Vm3.done))))}},{label:"科目",form:function(e){return e.getFieldDecorator("subjects",{initialValue:o})(g.createElement(k.t7,(0,S.Z)({allowClear:!0,placeholder:"请选择科目"},l)))}},{label:"审批单号",form:function(e){return e.getFieldDecorator("approval",{initialValue:i})(g.createElement(b.Z,{placeholder:"请输入审批单号"}))}},{label:"费用单号",form:function(e){return e.getFieldDecorator("cost",{initialValue:c})(g.createElement(b.Z,{placeholder:"请输入费用单号"}))}},{label:"归属周期",form:function(e){return e.getFieldDecorator("attribution",{initialValue:null})(g.createElement(O,null))}},{label:"提报日期",form:function(e){return e.getFieldDecorator("submissionDate",{initialValue:null})(g.createElement(V,{keys:"3",onChange:r.onSubmissionChange}))}},{label:"付款日期",form:function(e){return e.getFieldDecorator("paymentDate",{initialValue:null})(g.createElement(V,{keys:"2",onChange:r.onPaymentChange}))}},{label:"主题标签",form:function(e){return e.getFieldDecorator("themeTags",{initialValue:[],normalize:r.onNormalizeThemeTags})(g.createElement(D.Z,{placeholder:"请输入主题标签",mode:"tags",notFoundContent:"",tokenSeparators:[",","，"]}))}}],operations:e,isExpenseModel:!0,onReset:r.onReset,onSearch:r.onSearch,onHookForm:r.onHookForm,expand:s,onToggle:r.onToggle};return g.createElement(x.IT,null,g.createElement(k.p8,d))})),r.state={form:void 0,search:{type:void 0,state:void 0,approval:void 0,subjects:void 0,cost:void 0,attribution:void 0,submissionStart:void 0,submissionEnd:void 0,paymentStart:void 0,paymentEnd:void 0},onToggle:e.onToggle,expand:e.isShowExpand,onSearch:e.onSearch},r}return n}(g.Component);(0,u.Z)(N,"propTypes",{onToggle:E().func,isShowExpand:E().bool}),(0,u.Z)(N,"defaultProps",{onToggle:function(){},isShowExpand:!1});var R=(0,v.connect)()(N),j="k04cpTMi6nPY2FmX6FQj",A="MAaXot7YTgAgNKjB4QV8",B="pz0wyiR0Vn5BJWT7JlWm",z="YX0QuUJWVTZhEpv08RiH",L="pld2D2j18sApBRNwAq7T";function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var H=function(e){(0,s.Z)(n,e);var t=_(n);function n(){var e;return(0,o.Z)(this,n),e=t.call(this),(0,u.Z)((0,c.Z)(e),"onSearch",(function(t){e.private.searchParams=t,e.private.searchParams.page||(e.private.searchParams.page=1),e.private.searchParams.limit||(e.private.searchParams.limit=30),e.props.dispatch({type:"expenseCostOrder/fetchCostOrders",payload:e.private.searchParams})})),(0,u.Z)((0,c.Z)(e),"onShowSizeChange",(function(t,n){var r=e.private.searchParams;r.page=t,r.limit=n,e.onSearch(r)})),(0,u.Z)((0,c.Z)(e),"onToggle",(function(t){e.setState({isShowExpand:t})})),(0,u.Z)((0,c.Z)(e),"onChangePage",(function(t,n){var r=e.private.searchParams;r.page=t,r.limit=n,e.onSearch(r)})),(0,u.Z)((0,c.Z)(e),"renderSearch",(function(){var t=(0,c.Z)(e),n=t.onSearch,r=t.onToggle,a=e.state.isShowExpand;return g.createElement(R,{onSearch:n,onToggle:r,isShowExpand:a})})),(0,u.Z)((0,c.Z)(e),"renderContent",(function(){var t=e.props.costOrdersData,n=[{title:"审批单号",dataIndex:"applicationOrderId",fixed:"left",width:120,render:function(e){return g.createElement("div",null,g.createElement("a",{className:j,key:"detail",target:"_blank",rel:"noopener noreferrer",href:"/#/Expense/Manage/ExamineOrder/Detail?orderId=".concat(e)},e))}},{title:"费用单号",dataIndex:"id",fixed:"left",width:120,render:function(e){return g.createElement("div",{className:A},e)}},{title:"主题标签",dataIndex:"themeLabelList",width:100,fixed:"left",render:function(e){return e?m().not.empty(e)&&e.length>3?g.createElement(a.Z,{title:e.map((function(e){return e})).join(" 、 ")},g.createElement("div",{className:B},h().get(e,"0"),"、",h().get(e,"1"),"、",h().get(e,"2"),"...")):m().not.empty(e)&&e.length<=3?g.createElement("div",{className:B},e.map((function(e){return e})).join("、")):"--":"--"}},{title:"费用分组",dataIndex:"costGroupName",width:150},{title:"平台",dataIndex:"platformNames",width:70,render:function(e){return m().array(e)&&m().not.empty(e)?e.join(","):"--"}},{title:"供应商",dataIndex:"supplierNames",width:"7%",render:function(e){return m().array(e)&&m().not.empty(e)?e.join(","):"--"}},{title:"城市",dataIndex:"cityNames",width:100,render:function(e){return m().not.existy(e)||m().empty(e)||m().not.array(e)?"--":1===e.length?h().get(e,"0"):g.createElement(a.Z,{title:e.join(" , ")},g.createElement("span",null,h().get(e,"0")," 等",e.length,"条"))}},{title:"商圈",dataIndex:"bizDistrictNames",width:"7%",render:function(e){return m().not.existy(e)||m().empty(e)||m().not.array(e)?"--":1===e.length?h().get(e,"0"):g.createElement(a.Z,{title:e.join(" , ")},g.createElement("span",null,h().get(e,"0")," 等",e.length,"条"))}},{title:"是否可记账",dataIndex:"isBook",width:120,render:function(e){return e?"是":"否"}},{title:"付款周期",dataIndex:"paidMonth",width:120,render:function(e){return e||"--"}},{title:"归属周期",dataIndex:"bookMonth",width:120,render:function(e){return e||"--"}},{title:"科目",dataIndex:["costAccountingInfo","name"],width:180,render:function(e,t){return g.createElement("p",{className:z},"".concat(e,"(").concat(t.costAccountingCode,")"))}},{title:"科目成本归属",dataIndex:"costCenterType",width:180,render:function(e){return e?g.createElement("p",{className:z},Z.F$Y.description(e)):"--"}},{title:"是否开票",dataIndex:"invoiceFlag",width:100,render:function(e){return e?Z.dR2.description(e):"无"}},{title:"申请人",dataIndex:"applyAccountInfo",width:100,render:function(e){return e&&e.name?e.name:"--"}},{title:"付款金额（元）",dataIndex:"totalMoney",width:100,render:function(e){return g.createElement("div",{className:L},Z.fbc.exchangePriceCentToMathFormat(e))}},{title:"发票总金额（元）",dataIndex:"totalCostBillAmount",width:150,render:function(e){return e?g.createElement("div",{className:L},Z.fbc.exchangePriceCentToMathFormat(e)):"--"}},{title:"费用总金额（元）",dataIndex:"totalTaxDeductionAmount",width:100,render:function(e){return e?g.createElement("div",{className:L},Z.fbc.exchangePriceCentToMathFormat(e)):"--"}},{title:"总税金（元）",dataIndex:"totalTaxAmountAmount",width:100,render:function(e){return e?g.createElement("div",{className:L},Z.fbc.exchangePriceCentToMathFormat(e)):"--"}},{title:"是否红冲",dataIndex:"type",width:100,render:function(e){return e===Z.l4R.redPunch?"是":"否"}},{title:"单据状态",dataIndex:"state",width:100,render:function(e){return Z.Vm3.description(e)}},{title:"操作",dataIndex:"operation",fixed:"right",width:60,render:function(e,t){var n=t.applicationOrderId,r=t.id,a=h().get(t,"applicationOrderInfo.application_order_type",void 0),o="1";a!==Z.ZBL.cost&&a!==Z.ZBL.travel||(o="2");var i=1;return t.bizExtraTravelApplyOrderId&&(i=7),g.createElement("div",null,g.createElement("a",{key:"detail",target:"_blank",rel:"noopener noreferrer",href:"/#/Expense/Manage/Template/Detail?recordId=".concat(r,"&template=").concat(i,"&applicationOrderId=").concat(n,"&newMoneyRule=").concat(o)},"详情"))}}],o=e.private.searchParams,i=o.page,c={pageSize:o.limit||30,onChange:e.onChangePage,total:h().get(t,"meta.count",0),showTotal:function(e){return"总共".concat(e,"条")},pageSizeOptions:["10","20","30","40"],showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:e.onShowSizeChange};return i&&(c.current=i),g.createElement(x.IT,null,g.createElement(r.Z,{dataSource:h().get(t,"data",[]),columns:n,pagination:c,rowKey:function(e){return e.id},scroll:{x:2650,y:400},bordered:!0}))})),e.state={isShowExpand:!0},e.private={searchParams:{}},e}return(0,i.Z)(n,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"expenseCostOrder/fetchCostOrders"})}},{key:"render",value:function(){var e=this.renderSearch,t=this.renderContent;return g.createElement("div",null,e(),t())}}]),n}(g.Component);(0,u.Z)(H,"propTypes",{costOrdersData:E().object}),(0,u.Z)(H,"defaultProps",{costOrdersData:{}});var J=(0,v.connect)((function(e){return{costOrdersData:e.expenseCostOrder.costOrdersData}}))(H)}}]);