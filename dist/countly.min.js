!function(e,t){"function"==typeof define&&define.amd?define([],(function(){return t(e.Countly)})):"object"==typeof module&&module.exports?module.exports=t(e.Countly):e.Countly=t(e.Countly)}("undefined"!=typeof window?window:this,(function(e){function t(e){var t=[];if(void 0!==e.options)for(var i=0;i<e.options.length;i++)e.options[i].selected&&t.push(e.options[i].value);return t.join(", ")}function i(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))}function n(){return Math.floor((new Date).getTime()/1e3)}function o(){var e=(new Date).getTime();return C>=e?C++:C=e,C}function s(t,i,n){if(i&&Object.keys(i).length){if(void 0!==i[t])return i[t]}else if(void 0!==e[t])return e[t];return n}function r(t,i,n){for(var o in e.i)e.i[o].tracking_crashes&&e.i[o].recordError(t,i,n)}function a(e){var t,i=[];for(t in e)i.push(t+"="+encodeURIComponent(e[t]));return i.join("&")}function c(e){return"/"===e.substr(e.length-1)?e.substr(0,e.length-1):e}function d(e,t){for(var i,n={},o=0;o<t.length;o++)void 0!==e[i=t[o]]&&(n[i]=e[i]);return n}function l(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function u(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function f(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function m(){var e=document;return Math.min(Math.min(e.body.clientHeight,e.documentElement.clientHeight),Math.min(e.body.offsetHeight,e.documentElement.offsetHeight),window.innerHeight)}function h(e){if(e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}function p(e,t,i,n,o,s){var r;(e=document.createElement(e)).setAttribute(t,i),e.setAttribute(n,o),s&&(e.onreadystatechange=e.onload=function(){r||s(),r=!0}),document.getElementsByTagName("head")[0].appendChild(e)}function _(e,t){p("script","type","text/javascript","src",e,t)}function g(e,t){p("link","rel","stylesheet","href",e,t)}function y(){if(!(e=document.getElementById("cly-loader"))){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}":t.appendChild(document.createTextNode("#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}")),e.appendChild(t),(e=document.createElement("div")).setAttribute("id","cly-loader"),document.body.appendChild(e)}e.style.display="block"}function v(){var e=document.getElementById("cly-loader");e&&(e.style.display="none")}(e=e||{}).features="sessions events views scrolls clicks forms crashes attribution users star-rating location apm feedback remote-config".split(" "),e.utm={source:!0,medium:!0,campaign:!0,term:!0,content:!0},e.q=e.q||[],e.onload=e.onload||[];var w="20.11.1",k="javascript_native_web",b=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,x=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/;e.CountlyClass=function(p){function C(e){if(!R.ignore_visitor)if(e.key){e.count||(e.count=1);var t=d(e,["key","count","sum","dur","segmentation"]);t.timestamp=o();var i=new Date;t.hour=i.getHours(),t.dow=i.getDay(),W.push(t),j("cly_event",W),H("Adding event: ",e)}else H("Event must have key property")}function N(){R.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(R.ignore_visitor=!0),R.ignore_bots&&x.test(navigator.userAgent)&&(R.ignore_visitor=!0)}function O(e,t){if(!document.getElementById("countly-feedback-sticker-"+e._id))try{var i=document.createElement("div");i.className="countly-iframe-wrapper",i.id="countly-iframe-wrapper-"+e._id;var n=document.createElement("span");n.className="countly-feedback-close-icon",n.id="countly-feedback-close-icon-"+e._id,n.innerText="x";var o=document.createElement("iframe");if(o.name="countly-feedback-iframe",o.id="countly-feedback-iframe",o.src=R.url+"/feedback?widget_id="+e._id+"&app_key="+R.app_key+"&device_id="+R.device_id+"&sdk_version="+w,document.body.appendChild(i),i.appendChild(n),i.appendChild(o),S(document.getElementById("countly-feedback-close-icon-"+e._id),"click",(function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="none",document.getElementById("cfbg").style.display="none"})),t){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.id="feedback-sticker-svg",s.setAttribute("aria-hidden","true"),s.setAttribute("data-prefix","far"),s.setAttribute("data-icon","grin"),s.setAttribute("class","svg-inline--fa fa-grin fa-w-16"),s.setAttribute("role","img"),s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("viewBox","0 0 496 512");var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.id="smileyPathInStickerSvg",r.setAttribute("fill","white"),r.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");var a=document.createElement("span");a.innerText=e.trigger_button_text;var c=document.createElement("div");c.style.color=7>e.trigger_font_color?"#"+e.trigger_font_color:e.trigger_font_color,c.style.backgroundColor=7>e.trigger_bg_color.length?"#"+e.trigger_bg_color:e.trigger_bg_color,c.className="countly-feedback-sticker  "+e.trigger_position+"-"+e.trigger_size,c.id="countly-feedback-sticker-"+e._id,s.appendChild(r),c.appendChild(s),c.appendChild(a),document.body.appendChild(c);var d=document.getElementById("smileyPathInStickerSvg");d&&(d.style.fill=7>e.trigger_font_color?"#"+e.trigger_font_color:e.trigger_font_color),S(document.getElementById("countly-feedback-sticker-"+e._id),"click",(function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}))}else document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(e){H("Somethings went wrong while element injecting process: "+e)}}function A(){var e;if(void 0!==R.onload&&0<R.onload.length){for(e=0;e<R.onload.length;e++)"function"==typeof R.onload[e]&&R.onload[e](R);R.onload=[]}}function T(){if(oe){var e={name:oe};R.check_consent("views")&&C({key:"[CLY]_view",dur:ke?n()-se:re,segmentation:e}),oe=null}}function B(){if(he){var e=j("cly_session");(!e||parseInt(e)<=n())&&(F=!1,R.begin_session(!ie)),j("cly_session",n()+60*pe)}}function I(e){e.app_key=R.app_key,e.device_id=R.device_id,e.sdk_name=k,e.sdk_version=w,R.check_consent("location")?(R.country_code&&(e.country_code=R.country_code),R.city&&(e.city=R.city),null!==R.ip_address&&(e.ip_address=R.ip_address)):e.location="",e.timestamp=o();var t=new Date;e.hour=t.getHours(),e.dow=t.getDay()}function M(e){R.ignore_visitor||(R.app_key&&R.device_id?(I(e),$.length>G&&$.shift(),$.push(e),j("cly_queue",$,!0)):H("app_key or device_id is missing"))}function z(){if(A(),R.test_mode||R.ignore_visitor)ge=!1;else{ge=!0;var t=0;if(Y&&void 0!==e.q&&0<e.q.length){var i,o=e.q;for(e.q=[],t=0;t<o.length;t++)if(H("Processing queued call",i=o[t]),"function"==typeof i)i();else if(Array.isArray(i)&&0<i.length){var s=R,r=0;if(e.i[i[r]]&&(s=e.i[i[r]],r++),"function"==typeof s[i[r]])s[i[r]].apply(s,i.slice(r+1));else if(0===i[r].indexOf("userData.")){var a=i[r].replace("userData.","");"function"==typeof s.userData[a]&&s.userData[a].apply(s,i.slice(r+1))}else"function"==typeof e[i[r]]&&e[i[r]].apply(e,i.slice(r+1))}}F&&ie&&ke&&((t=n())-V>ue&&(R.session_duration(t-V),V=t)),0<W.length&&(W.length<=fe?(M({events:JSON.stringify(W)}),W=[]):(t=W.splice(0,fe),M({events:JSON.stringify(t)})),j("cly_event",W)),!ye&&0<$.length&&_e&&n()>ae&&(_e=!1,t=$[0],h(ve)&&(Se&&(clearTimeout(Se),Se=null),t.consent=JSON.stringify(ve),ve={}),H("Processing request",t),j("cly_queue",$,!0),J(R.url+U,t,(function(e,t){H("Request Finished",t,e),e?ae=n()+ce:$.shift(),j("cly_queue",$,!0),_e=!0}))),setTimeout(z,X)}}function q(){return j("cly_id")||i()}function P(){var e=JSON.parse(JSON.stringify(R.metrics||{}));if(e._app_version=e._app_version||R.app_version,e._ua=e._ua||navigator.userAgent,screen.width){var t=screen.width?parseInt(screen.width):0,i=screen.height?parseInt(screen.height):0;if(0!==t&&0!==i){if(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)t=Math.round(t*window.devicePixelRatio),i=Math.round(i*window.devicePixelRatio);else if(90===Math.abs(window.orientation)){var n=t;t=i,i=n}e._resolution=e._resolution||t+"x"+i}}if(window.devicePixelRatio&&(e._density=e._density||window.devicePixelRatio),void 0!==(t=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage)&&(e._locale=e._locale||t),void 0!==document.referrer&&document.referrer.length&&(t=b.exec(document.referrer))&&t[11]&&t[11]!==window.location.hostname){if(t=!1,ee&&ee.length)for(i=0;i<ee.length;i++)try{if(RegExp(ee[i]).test(document.referrer)){H("Ignored:",document.referrer),t=!0;break}}catch(e){H("Problem with regex",ee[i])}t||(e._store=e._store||document.referrer)}return H("Got metrics",e),e}function H(){R.debug&&"undefined"!=typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),Y||(arguments[0]="["+R.app_key+"] "+arguments[0]),console.log(Array.prototype.slice.call(arguments).join("\n")))}function J(e,t,i){try{H("Sending XML HTTP request");var n=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):null,o=a(t=t||{}),s="GET";for(var r in(R.force_post||2e3<=o.length)&&(s="POST"),"GET"===s?n.open("GET",e+"?"+o,!0):(n.open("POST",e,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded")),R.headers)n.setRequestHeader(r,R.headers[r]);n.onreadystatechange=function(){4===this.readyState&&200<=this.status&&300>this.status?"function"==typeof i&&i(!1,t,this.responseText):4===this.readyState&&(H("Failed Server XML HTTP request",this.status),"function"==typeof i&&i(!0,t))},"GET"===s?n.send():n.send(o)}catch(e){H("Failed XML HTTP request",e),"function"==typeof i&&i(!0,t)}}function D(e){j("cly_token",e)}function j(e,t,i,n){function o(e,t,i){var n=new Date;n.setTime(n.getTime()+864e5*i),i="; expires="+n.toGMTString(),document.cookie=e+"="+t+i+"; path=/"}if("none"!==R.storage){n||(e=R.app_key+"/"+e,R.namespace&&(e=c(R.namespace)+"/"+e));var s;i=i||"localstorage"===R.storage;if(null!=t&&(t=R.serialize(t),xe?localStorage.setItem(e,t):i||o(e,t,30)),void 0===t){if(xe)s=localStorage.getItem(e);else if(!i)e:{for(e+="=",i=0,n=(t=document.cookie.split(";")).length;i<n;i++){for(s=t[i];" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(e)){s=s.substring(e.length,s.length);break e}}s=null}return R.deserialize(s)}null===t&&(xe?localStorage.removeItem(e):i||o(e,"",-1))}}var V,R=this,Y=!e.i,F=!1,U="/i",X=s("interval",p,500),G=s("queue_size",p,1e3),$=[],W=[],Q={},K=[],Z={},ee=s("ignore_referrers",p,[]),te=null,ie=!0,ne=0,oe=null,se=0,re=0,ae=0,ce=s("fail_timeout",p,60),de=s("inactivity_time",p,20),le=0,ue=s("session_update",p,60),fe=s("max_events",p,10),me=s("max_logs",p,100),he=s("use_session_cookie",p,!0),pe=s("session_cookie_timeout",p,30),_e=!0,ge=!1,ye=s("offline_mode",p,!1),ve={},we={},ke=!0,be=n(),xe=!0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(e){xe=!1}for(var Ce={},Ee=0;Ee<e.features.length;Ee++)Ce[e.features[Ee]]={};this.initialize=function(){if(this.serialize=p.serialize||e.serialize,this.deserialize=p.deserialize||e.deserialize,this.getViewName=p.getViewName||e.getViewName,this.getViewUrl=p.getViewUrl||e.getViewUrl,this.namespace=s("namespace",p,""),this.app_key=s("app_key",p,null),this.onload=s("onload",p,[]),this.utm=s("utm",p,{source:!0,medium:!0,campaign:!0,term:!0,content:!0}),this.ignore_prefetch=s("ignore_prefetch",p,!0),this.debug=s("debug",p,!1),this.test_mode=s("test_mode",p,!1),this.metrics=s("metrics",p,{}),this.headers=s("headers",p,{}),this.url=c(s("url",p,"")),this.app_version=s("app_version",p,"0.0"),this.country_code=s("country_code",p,null),this.city=s("city",p,null),this.ip_address=s("ip_address",p,null),this.ignore_bots=s("ignore_bots",p,!0),this.force_post=s("force_post",p,!1),this.remote_config=s("remote_config",p,!1),this.ignore_visitor=s("ignore_visitor",p,!1),this.require_consent=s("require_consent",p,!1),this.track_domains=s("track_domains",p,!0),this.storage=s("storage",p,"default"),"cookie"===this.storage&&(xe=!1),Array.isArray(ee)||(ee=[]),""===this.url&&(H("Please provide server URL"),this.ignore_visitor=!0),j("cly_ignore")&&(this.ignore_visitor=!0),j(R.namespace+"cly_id",void 0,!1,!0)){j("cly_id",j(R.namespace+"cly_id",void 0,!1,!0)),j("cly_event",j(R.namespace+"cly_event",void 0,!1,!0)),j("cly_session",j(R.namespace+"cly_session",void 0,!1,!0));var t=j(R.namespace+"cly_queue",void 0,!1,!0);Array.isArray(t)&&j("cly_queue",t=t.filter((function(e){return e.app_key===R.app_key}))),j(R.namespace+"cly_cmp_id",void 0,!1,!0)&&(j("cly_cmp_id",j(R.namespace+"cly_cmp_id",void 0,!1,!0)),j("cly_cmp_uid",j(R.namespace+"cly_cmp_uid",void 0,!1,!0))),j(R.namespace+"cly_ignore",void 0,!1,!0)&&j("cly_ignore",j(R.namespace+"cly_ignore",void 0,!1,!0)),j("cly_id",null,!1,!0),j("cly_event",null,!1,!0),j("cly_session",null,!1,!0),j("cly_queue",null,!1,!0),j("cly_cmp_id",null,!1,!0),j("cly_cmp_uid",null,!1,!0),j("cly_ignore",null,!1,!0)}if(ye?this.device_id||(this.device_id="[CLY]_temp_id"):this.device_id=s("device_id",p,q()),$=j("cly_queue")||[],W=j("cly_event")||[],Q=j("cly_remote_configs")||{},N(),window.name&&0===window.name.indexOf("cly:"))try{this.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(e){H("Could not parse name",window.name)}else if(location.hash&&0===location.hash.indexOf("#cly:"))try{this.passed_data=JSON.parse(location.hash.replace("#cly:",""))}catch(e){H("Could not parse hash",location.hash)}if((this.passed_data&&this.passed_data.app_key&&this.passed_data.app_key===this.app_key||this.passed_data&&!this.passed_data.app_key&&Y)&&this.passed_data.token&&this.passed_data.purpose&&(this.passed_data.token!==j("cly_old_token")&&(D(this.passed_data.token),j("cly_old_token",this.passed_data.token)),"heatmap"===this.passed_data.purpose&&(this.ignore_visitor=!0,y(),_(this.url+"/views/heatmap.js",v))),!this.ignore_visitor){if(H("Countly initialized"),location.search){t=location.search.substring(1).split("&");for(var i={},n=!1,o=0;o<t.length;o++){var r=t[o].split("=");"cly_id"===r[0]?j("cly_cmp_id",r[1]):"cly_uid"===r[0]?j("cly_cmp_uid",r[1]):"cly_device_id"===r[0]?this.device_id=r[1]:0===(r[0]+"").indexOf("utm_")&&this.utm[r[0].replace("utm_","")]&&(i[r[0].replace("utm_","")]=r[1],n=!0)}if(n){for(var a in this.utm)i[a]?this.userData.set("utm_"+a,i[a]):this.userData.unset("utm_"+a);this.userData.save()}}ye||this.device_id!==j("cly_id")&&j("cly_id",this.device_id),this.remote_config&&this.fetch_remote_config(this.remote_config),A(),setTimeout(z,1)}document.documentElement.setAttribute("data-countly-useragent",navigator.userAgent)},this.group_features=function(e){if(e)for(var t in e)Ce[t]?H("Feature name "+t+" is already reserved"):"string"==typeof e[t]?Ce[t]={features:[e[t]]}:e[t]&&Array.isArray(e[t])&&e[t].length?Ce[t]={features:e[t]}:H("Incorrect feature list for "+t+" value: "+e[t]);else H("Incorrect features: "+e)},this.check_consent=function(e){return!this.require_consent||(Ce[e]?!(!Ce[e]||!Ce[e].optin):(H("No feature available for "+e),!1))},this.check_any_consent=function(){if(!this.require_consent)return!0;for(var e in Ce)if(Ce[e]&&Ce[e].optin)return!0;return!1},this.add_consent=function(e){if(H("Adding consent for "+e),Array.isArray(e))for(var t=0;t<e.length;t++)this.add_consent(e[t]);else Ce[e]?Ce[e].features?(Ce[e].optin=!0,this.add_consent(Ce[e].features)):!0!==Ce[e].optin&&(ve[e]=!0,Ce[e].optin=!0,Le(),setTimeout((function(){"sessions"===e&&we.begin_session?(R.begin_session.apply(R,we.begin_session),we.begin_session=null):"views"===e&&we.track_pageview&&(oe=null,R.track_pageview.apply(R,we.track_pageview),we.track_pageview=null),we.change_id&&(R.change_id.apply(R,we.change_id),we.change_id=null)}),1)):H("No feature available for "+e)},this.remove_consent=function(e){if(H("Removing consent for "+e),Array.isArray(e))for(var t=0;t<e.length;t++)this.remove_consent(e[t]);else Ce[e]?(Ce[e].features?this.remove_consent(Ce[e].features):!1!==Ce[e].optin&&(ve[e]=!1,Le()),Ce[e].optin=!1):H("No feature available for "+e)};var Se,Le=function(){Se&&(clearTimeout(Se),Se=null),Se=setTimeout((function(){h(ve)&&(M({consent:JSON.stringify(ve)}),ve={})}),1e3)};this.enable_offline_mode=function(){ye=!0,this.device_id="[CLY]_temp_id"},this.disable_offline_mode=function(e){if(ye=!1,e&&this.device_id!==e?(this.device_id=e,j("cly_id",this.device_id),H("Changing id")):(this.device_id=q(),this.device_id!==j("cly_id")&&j("cly_id",this.device_id)),e=!1,0<$.length)for(var t=0;t<$.length;t++)"[CLY]_temp_id"===$[t].device_id&&($[t].device_id=this.device_id,e=!0);e&&j("cly_queue",$,!0)},this.begin_session=function(e,t){if(this.check_consent("sessions")){if(!F){this.report_orientation(),S(window,"resize",(function(){R.report_orientation()})),V=n(),F=!0,ie=!e;var i=j("cly_session");(t||!he||!i||parseInt(i)<=n())&&(H("Session started"),(i={begin_session:1}).metrics=JSON.stringify(P()),M(i)),j("cly_session",n()+60*pe)}}else we.begin_session=arguments},this.session_duration=function(e){this.check_consent("sessions")&&F&&(H("Session extended",e),M({session_duration:e}),B())},this.end_session=function(e,t){this.check_consent("sessions")&&F&&(e=e||n()-V,T(),!he||t?(H("Ending session"),M({end_session:1,session_duration:e})):this.session_duration(e),F=!1)},this.change_id=function(e,t){if(this.device_id!==e){t||(0<W.length&&(M({events:JSON.stringify(W)}),j("cly_event",W=[])),this.end_session(null,!0),Z={});var i=this.device_id;this.device_id=e,j("cly_id",this.device_id),H("Changing id"),t?this.check_any_consent()?M({old_device_id:i}):we.change_id=arguments:this.begin_session(!ie,!0),this.remote_config&&(j("cly_remote_configs",Q={}),this.fetch_remote_config(this.remote_config))}},this.add_event=function(e){this.check_consent("events")&&C(e)},this.start_event=function(e){Z[e]?H("Timed event with key "+e+" already started"):Z[e]=n()},this.end_event=function(e){"string"==typeof e&&(e={key:e}),e.key?Z[e.key]?(e.dur=n()-Z[e.key],this.add_event(e),delete Z[e.key]):H("Timed event with key "+e.key+" was not started"):H("Event must have key property")},this.report_orientation=function(e){this.check_consent("users")&&C({key:"[CLY]_orientation",segmentation:{mode:e||(window.innerWidth>window.innerHeight?"landscape":"portrait")}})},this.report_conversion=function(e,t){this.check_consent("attribution")&&(e=e||j("cly_cmp_id")||"cly_organic",t=t||j("cly_cmp_uid"),e&&t?M({campaign_id:e,campaign_user:t}):e&&M({campaign_id:e}))},this.user_details=function(e){this.check_consent("users")&&(H("Adding userdetails: ",e),M({user_details:JSON.stringify(d(e,"name username email organization phone picture gender byear custom".split(" ")))}))};var Ne={},Oe=function(e,t,i){R.check_consent("users")&&(Ne[e]||(Ne[e]={}),"$push"===i||"$pull"===i||"$addToSet"===i?(Ne[e][i]||(Ne[e][i]=[]),Ne[e][i].push(t)):Ne[e][i]=t)};this.userData={set:function(e,t){Ne[e]=t},unset:function(e){Ne[e]=""},set_once:function(e,t){Oe(e,t,"$setOnce")},increment:function(e){Oe(e,1,"$inc")},increment_by:function(e,t){Oe(e,t,"$inc")},multiply:function(e,t){Oe(e,t,"$mul")},max:function(e,t){Oe(e,t,"$max")},min:function(e,t){Oe(e,t,"$min")},push:function(e,t){Oe(e,t,"$push")},push_unique:function(e,t){Oe(e,t,"$addToSet")},pull:function(e,t){Oe(e,t,"$pull")},save:function(){R.check_consent("users")&&M({user_details:JSON.stringify({custom:Ne})}),Ne={}}},this.report_trace=function(e){if(this.check_consent("apm")){for(var t="type name stz etz apm_metrics apm_attr".split(" "),i=0;i<t.length;i++)if("apm_attr"!==t[i]&&void 0===e[t[i]])return void H("APM trace must have a",t[i]);(t=d(e,t)).timestamp=e.stz,e=new Date,t.hour=e.getHours(),t.dow=e.getDay(),M({apm:JSON.stringify(t)}),H("Adding APM trace: ",t)}},this.track_errors=function(t){e.i[this.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,te=t,window.onerror=function(e,t,i,n,o){if(void 0!==o)r(o,!1);else{var s="";void 0!==e&&(s+=e+"\n"),void 0!==t&&(s+="at "+t),void 0!==i&&(s+=":"+i),void 0!==(n=n||window.event&&window.event.errorCharacter)&&(s+=":"+n),s+="\n";try{for(var a=[],c=arguments.callee.caller;c;)a.push(c.name),c=c.caller;s+=a.join("\n")}catch(e){}r(s,!1)}},window.addEventListener("unhandledrejection",(function(e){r(Error("Unhandled rejection (reason: "+(e.reason&&e.reason.stack?e.reason.stack:e.reason)+")."),!0)})))},this.log_error=function(e,t){this.recordError(e,!0,t)},this.add_log=function(e){this.check_consent("crashes")&&(K.length>me&&K.shift(),K.push(e))},this.fetch_remote_config=function(e,t,i){if(this.check_consent("remote-config")){var n={method:"fetch_remote_config"};this.check_consent("sessions")&&(n.metrics=JSON.stringify(P())),e&&(i||"function"!=typeof e?Array.isArray(e)&&e.length&&(n.keys=JSON.stringify(e)):(i=e,e=null)),t&&(i||"function"!=typeof t?Array.isArray(t)&&t.length&&(n.omit_keys=JSON.stringify(t)):(i=t,t=null)),I(n),J(this.url+"/o/sdk",n,(function(e,t,o){try{var s=JSON.parse(o);if(n.keys||n.omit_keys)for(var r in s)Q[r]=s[r];else Q=s;j("cly_remote_configs",Q)}catch(e){}"function"==typeof i&&i(e,Q)}))}else H("Remote config requires explicit consent"),"function"==typeof i&&i(Error("Remote config requires explicit consent"),Q)},this.get_remote_config=function(e){return void 0!==e?Q[e]:Q},this.stop_time=function(){ke&&(ke=!1,ne=n()-V,re=n()-se)},this.start_time=function(){ke||(ke=!0,V=n()-ne,se=n()-re,re=0,B())},this.track_sessions=function(){function e(){document[i]?R.stop_time():R.start_time()}function t(){le>=de&&R.start_time(),le=0}this.begin_session(),this.start_time(),S(window,"beforeunload",(function(){R.end_session()})),S(window,"unload",(function(){R.end_session()}));var i="hidden";i in document?document.addEventListener("visibilitychange",e):(i="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(i="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(i="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?(S(window,"focusin",(function(){R.start_time()})),S(window,"focusout",(function(){R.stop_time()}))):(S(window,"focus",(function(){R.start_time()})),S(window,"blur",(function(){R.stop_time()})),S(window,"pageshow",(function(){R.start_time()})),S(window,"pagehide",(function(){R.stop_time()}))),S(window,"mousemove",t),S(window,"click",t),S(window,"keydown",t),S(window,"scroll",t),setInterval((function(){++le>=de&&R.stop_time()}),6e4)},this.track_pageview=function(e,t,i){if(T(),e&&Array.isArray(e)&&(t=e,e=null),e||(e=this.getViewName()),t&&t.length)for(var o=0;o<t.length;o++)try{if(RegExp(t[o]).test(e))return void H("Ignored:",e)}catch(e){H("Problem with regex",t[o])}if(oe=e,se=n(),o={name:e,visit:1,view:this.getViewUrl()},this.track_domains&&(o.domain=window.location.hostname),void 0!==document.referrer&&document.referrer.length){var s=b.exec(document.referrer);s&&s[11]&&s[11]!==window.location.hostname&&(o.start=1)}if(i)for(var r in i)void 0===o[r]&&(o[r]=i[r]);this.check_consent("views")?C({key:"[CLY]_view",segmentation:o}):we.track_pageview=arguments},this.track_view=function(e,t,i){this.track_pageview(e,t,i)},this.track_clicks=function(e){e=e||document;var t=!0;S(e,"click",(function(e){if(t){if(t=!1,l(e),void 0!==e.pageX&&void 0!==e.pageY){var i=u(),n=f();R.check_consent("clicks")&&(e={type:"click",x:e.pageX,y:e.pageY,width:n,height:i,view:R.getViewUrl()},R.track_domains&&(e.domain=window.location.hostname),C({key:"[CLY]_action",segmentation:e}))}setTimeout((function(){t=!0}),1e3)}}))},this.track_scrolls=function(e){function t(){if(i){i=!1;var e=u(),t=f(),o=m();R.check_consent("scrolls")&&(e={type:"scroll",y:n+o,width:t,height:e,view:R.getViewUrl()},R.track_domains&&(e.domain=window.location.hostname),C({key:"[CLY]_action",segmentation:e}))}}e=e||window;var i=!0,n=0;S(e,"scroll",(function(){n=Math.max(n,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)})),S(e,"beforeunload",t),S(e,"unload",t)},this.track_links=function(e){e=e||document,S(e,"click",(function(e){var t=L(e).closest("a");t&&(l(e),R.check_consent("clicks")&&C({key:"linkClick",segmentation:{href:t.href,text:t.innerText,id:t.id,view:R.getViewUrl()}}))}))},this.track_forms=function(e,i){function n(e){return e.name||e.id||e.type||e.nodeName}e=e||document,S(e,"submit",(function(e){var o,s={id:(e=L(e)).attributes.id&&e.attributes.id.nodeValue,name:e.attributes.name&&e.attributes.name.nodeValue,action:e.attributes.action&&e.attributes.action.nodeValue,method:e.attributes.method&&e.attributes.method.nodeValue,view:R.getViewUrl()};if(void 0!==e.elements){for(var r=0;r<e.elements.length;r++)(o=e.elements[r])&&"password"!==o.type&&-1===o.className.indexOf("cly_user_ignore")&&(void 0===s["input:"+n(o)]&&(s["input:"+n(o)]=[]),"select"===o.nodeName.toLowerCase()?void 0!==o.multiple?s["input:"+n(o)].push(t(o)):s["input:"+n(o)].push(o.options[o.selectedIndex].value):"input"===o.nodeName.toLowerCase()?void 0!==o.type?"checkbox"===o.type.toLowerCase()||"radio"===o.type.toLowerCase()?o.checked&&s["input:"+n(o)].push(o.value):("hidden"!==o.type.toLowerCase()||i)&&s["input:"+n(o)].push(o.value):s["input:"+n(o)].push(o.value):("textarea"===o.nodeName.toLowerCase()||void 0!==o.value)&&s["input:"+n(o)].push(o.value));for(var a in s)s[a]&&"function"==typeof s[a].join&&(s[a]=s[a].join(", "))}R.check_consent("forms")&&C({key:"formSubmit",segmentation:s})}))},this.collect_from_forms=function(e,i){e=e||document,S(e,"submit",(function(n){var o,s={},r=!1;if(void 0!==(n=L(n)).elements){var a,c={},d=e.getElementsByTagName("LABEL");for(a=0;a<d.length;a++)d[a].htmlFor&&""!==d[a].htmlFor&&(c[d[a].htmlFor]=d[a].innerText||d[a].textContent||d[a].innerHTML);for(a=0;a<n.elements.length;a++)if((o=n.elements[a])&&"password"!==o.type&&-1===o.className.indexOf("cly_user_ignore"))if(d="","select"===o.nodeName.toLowerCase()?d=void 0!==o.multiple?t(o):o.options[o.selectedIndex].value:"input"===o.nodeName.toLowerCase()?void 0!==o.type&&("checkbox"===o.type.toLowerCase()||"radio"===o.type.toLowerCase())?o.checked&&(d=o.value):d=o.value:("textarea"===o.nodeName.toLowerCase()||void 0!==o.value)&&(d=o.value),o.className&&-1!==o.className.indexOf("cly_user_")){var l=o.className.split(" ");for(o=0;o<l.length;o++)if(0===l[o].indexOf("cly_user_")){s[l[o].replace("cly_user_","")]=d,r=!0;break}}else o.type&&"email"===o.type.toLowerCase()||o.name&&-1!==o.name.toLowerCase().indexOf("email")||o.id&&-1!==o.id.toLowerCase().indexOf("email")||o.id&&c[o.id]&&-1!==c[o.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(d)?(s.email||(s.email=d),r=!0):o.name&&-1!==o.name.toLowerCase().indexOf("username")||o.id&&-1!==o.id.toLowerCase().indexOf("username")||o.id&&c[o.id]&&-1!==c[o.id].toLowerCase().indexOf("username")?(s.username||(s.username=d),r=!0):o.name&&(-1!==o.name.toLowerCase().indexOf("tel")||-1!==o.name.toLowerCase().indexOf("phone")||-1!==o.name.toLowerCase().indexOf("number"))||o.id&&(-1!==o.id.toLowerCase().indexOf("tel")||-1!==o.id.toLowerCase().indexOf("phone")||-1!==o.id.toLowerCase().indexOf("number"))||o.id&&c[o.id]&&(-1!==c[o.id].toLowerCase().indexOf("tel")||-1!==c[o.id].toLowerCase().indexOf("phone")||-1!==c[o.id].toLowerCase().indexOf("number"))?(s.phone||(s.phone=d),r=!0):o.name&&(-1!==o.name.toLowerCase().indexOf("org")||-1!==o.name.toLowerCase().indexOf("company"))||o.id&&(-1!==o.id.toLowerCase().indexOf("org")||-1!==o.id.toLowerCase().indexOf("company"))||o.id&&c[o.id]&&(-1!==c[o.id].toLowerCase().indexOf("org")||-1!==c[o.id].toLowerCase().indexOf("company"))?(s.organization||(s.organization=d),r=!0):(o.name&&-1!==o.name.toLowerCase().indexOf("name")||o.id&&-1!==o.id.toLowerCase().indexOf("name")||o.id&&c[o.id]&&-1!==c[o.id].toLowerCase().indexOf("name"))&&(s.name||(s.name=""),s.name+=d+" ",r=!0)}r&&(H("Gathered user data",s),i?R.user_details({custom:s}):R.user_details(s))}))},this.collect_from_facebook=function(e){FB&&FB.api&&FB.api("/me",(function(t){var i={};(t.name&&(i.name=t.name),t.email&&(i.email=t.email),"male"===t.gender?i.gender="M":"female"===t.gender&&(i.gender="F"),t.birthday)&&((o=t.birthday.split("/").pop())&&4===o.length&&(i.byear=o));if(t.work&&t.work[0]&&t.work[0].employer&&t.work[0].employer.name&&(i.organization=t.work[0].employer.name),e)for(var n in i.custom={},e){for(var o=e[n].split("."),s=t,r=0;r<o.length&&void 0!==(s=s[o[r]]);r++);void 0!==s&&(i.custom[n]=s)}R.user_details(i)}))},this.opt_out=function(){this.ignore_visitor=!0,j("cly_ignore",!0)},this.opt_in=function(){j("cly_ignore",!1),this.ignore_visitor=!1,N(),!this.ignore_visitor&&!ge&&z()},this.report_feedback=function(e){if(this.check_consent("star-rating")||this.check_consent("feedback"))if(e.widget_id)if(e.rating){if(this.check_consent("events")){var t={key:"[CLY]_star_rating",count:1,segmentation:{}};t.segmentation=d(e,"widget_id contactMe platform app_version rating email comment".split(" ")),t.segmentation.app_version||(t.segmentation.app_version=this.metrics._app_version||this.app_version),H("Reporting feedback: ",t),this.add_event(t)}}else H("Feedback must contain rating property");else H("Feedback must contain widget_id property")},this.show_feedback_popup=function(e){(this.check_consent("star-rating")||this.check_consent("feedback"))&&(ye?H("Cannot show feedback popup in offline mode"):J(this.url+"/o/feedback/widget",{widget_id:e},(function(e,t,i){e&&H("Error occurred",e);try{O(JSON.parse(i),!1)}catch(e){H("JSON parse failed: "+e)}})))},this.initialize_feedback_popups=function(e){if(this.check_consent("star-rating")||this.check_consent("feedback")){e||(e=j("cly_fb_widgets"));for(var t=document.getElementsByClassName("countly-feedback-sticker");0<t.length;)t[0].remove();J(this.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(e)},(function(e,t,i){if(e)H("Errors occurred:",e);else try{var n=JSON.parse(i);for(e=0;e<n.length;e++)if("true"===n[e].is_active&&n[e].target_devices[E.device])if("string"==typeof n[e].hide_sticker&&(n[e].hide_sticker="true"===n[e].hide_sticker),"all"!==n[e].target_page||n[e].hide_sticker){var o=n[e].target_pages;for(t=0;t<o.length;t++){var s=o[t].substr(0,o[t].length-1)===window.location.pathname.substr(0,o[t].length-1),r=o[t]===window.location.pathname;(o[t].includes("*")&&s||r)&&!n[e].hide_sticker&&O(n[e],!0)}}else O(n[e],!0)}catch(e){H("JSON parse error: "+e)}}))}},this.enable_feedback=function(e){(this.check_consent("star-rating")||this.check_consent("feedback"))&&(ye?H("Cannot enable feedback in offline mode"):(j("cly_fb_widgets",e.popups||e.widgets),g(this.url+"/star-rating/stylesheets/countly-feedback-web.css"),0<(e=e.popups||e.widgets).length?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),this.initialize_feedback_popups(e)):H("You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")))},this.get_available_feedback_widgets=function(e){this.check_consent("star-rating")||this.check_consent("feedback")?ye?H("Cannot enable feedback in offline mode."):J(this.url+"/o/sdk",{method:"feedback",device_id:this.device_id,app_key:this.app_key},(function(t,i,n){if(t)H("Error occured while fetching feedbacks",t),e&&e(null,t);else try{var o=JSON.parse(n).result||[];e&&e(o,null)}catch(t){H("Error while processing feedbacks",t),e&&e(null,t)}})):e&&e(null,Error("Consent for feedback not provided."))},this.present_feedback_widget=function(t){function i(e){document.getElementById("countly-surveys-wrapper-"+e._id).style.display="block",document.getElementById("csbg").style.display="block"}if(this.check_consent("star-rating")||this.check_consent("feedback"))if(!t||"object"!=typeof t||Array.isArray(t))H("Please provide atleast one feedback widget object.");else try{var n=this.url;if("nps"===t.type)n+="/feedback/nps";else{if("survey"!==t.type)return void H("Feedback widget only accepts nps and survey types.");n+="/feedback/survey"}n=(n=(n=(n=(n=(n=(n=(n=(n=n+"?widget_id="+t._id)+"&app_key="+this.app_key)+"&device_id="+this.device_id)+"&sdk_name="+k)+"&platform="+this.platform)+"&app_version="+this.app_version)+"&sdk_version="+w)+"&origin="+window.origin)+"&widget_v=web";var o=document.createElement("iframe");o.name="countly-surveys-iframe",o.id="countly-surveys-iframe",o.src=n;var s=!1;o.onload=function(){s&&(document.getElementById("countly-surveys-wrapper-"+t._id).style.display="none",document.getElementById("csbg").style.display="none"),s=!0},g(this.url+"/surveys/stylesheets/countly-surveys.css");for(var r=document.getElementById("csbg");r;)r.remove(),r=document.getElementById("csbg");var a=document.getElementsByClassName("countly-surveys-wrapper");for(n=0;n<a.length;n++)a[n].remove();if(document.body.insertAdjacentHTML("beforeend",'<div id="csbg"></div>'),(a=document.createElement("div")).className="countly-surveys-wrapper",a.id="countly-surveys-wrapper-"+t._id,"survey"===t.type&&(a.className=a.className+" "+t.appearance.position),document.body.appendChild(a),a.appendChild(o),S(window,"message",(function(i){var n={};try{n=JSON.parse(i.data)}catch(e){H("Error while parsing message body "+e)}i.origin===e.url&&n.close&&(document.getElementById("countly-surveys-wrapper-"+t._id).style.display="none",document.getElementById("csbg").style.display="none")})),"survey"===t.type){var c=!1;switch(t.showPolicy){case"afterPageLoad":"complete"===document.readyState?c||(c=!0,i(t)):S(document,"readystatechange",(function(e){"complete"===e.target.readyState&&!c&&(c=!0,i(t))}));break;case"afterConstantDelay":setTimeout((function(){c||(c=!0,i(t))}),1e4);break;case"onAbandon":"complete"===document.readyState?S(document,"mouseleave",(function(){c||(c=!0,i(t))})):S(document,"readystatechange",(function(e){"complete"===e.target.readyState&&S(document,"mouseleave",(function(){c||(c=!0,i(t))}))}));break;case"onScrollHalfwayDown":S(window,"scroll",(function(){c||Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)>=u()/2&&(c=!0,i(t))}));break;default:c||(c=!0,i(t))}}else"nps"===t.type&&(document.getElementById("countly-surveys-wrapper-"+t._id).style.display="block",document.getElementById("csbg").style.display="block")}catch(e){H("Somethings went wrong while presenting the feedback",e)}},this.recordError=function(e,t,i){if(this.check_consent("crashes")&&e){i=i||te;var o="";"object"==typeof e?void 0!==e.stack?o=e.stack:(void 0!==e.name&&(o+=e.name+":"),void 0!==e.message&&(o+=e.message+"\n"),void 0!==e.fileName&&(o+="in "+e.fileName+"\n"),void 0!==e.lineNumber&&(o+="on "+e.lineNumber),void 0!==e.columnNumber&&(o+=":"+e.columnNumber)):o=e+"",t=!!t,o={_resolution:(e=P())._resolution,_error:o,_app_version:e._app_version,_run:n()-be,_not_os_specific:!0,_javascript:!0},(e=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery)&&(o._bat=Math.floor(100*e.level)),void 0!==navigator.onLine&&(o._online=!!navigator.onLine),o._background=!document.hasFocus(),0<K.length&&(o._logs=K.join("\n")),K=[],o._nonfatal=t,o._view=this.getViewName(),void 0!==i&&(o._custom=i);try{var s=document.createElement("canvas").getContext("experimental-webgl");o._opengl=s.getParameter(s.VERSION)}catch(e){}M({crash:JSON.stringify(o)})}},this.onStorageChange=function(e,t){switch(e){case"cly_queue":$=R.deserialize(t||"[]");break;case"cly_event":W=R.deserialize(t||"[]");break;case"cly_remote_configs":Q=R.deserialize(t||"{}");break;case"cly_ignore":R.ignore_visitor=R.deserialize(t);break;case"cly_id":R.device_id=R.deserialize(t)}},this._internals={store:j,getDocWidth:f,getDocHeight:u,getViewportHeight:m,get_page_coord:l,get_event_target:L,add_event:S,getProperties:d,stripTrailingSlash:c,prepareParams:a,sendXmlHttpRequest:J,getMsTimestamp:o,getTimestamp:n,log:H,getMetrics:P,generateUUID:i,isUUID:function(){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(R.device_id)},getId:q,heartBeat:z,toRequestQueue:M,reportViewDuration:T,loadJS:_,loadCSS:g,getLastView:function(){return oe},setToken:D,getToken:function(){var e=j("cly_token");return j("cly_token",null),e},showLoader:y,hideLoader:v,add_cly_events:C,detect_device:E,getRequestQueue:function(){return $},getEventQueue:function(){return W},clearQueue:function(){$=[],j("cly_queue",[]),W=[],j("cly_event",[])}},this.initialize()},e.init=function(t){var i=(t=t||{}).app_key||e.app_key;if(!e.i||!e.i[i]){if(t=new e.CountlyClass(t),!e.i)for(var n in e.i={},t)e[n]=t[n];e.i[i]=t}return e.i[i]};var C=0;Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;for(e=e.toUpperCase();t;){if(t.nodeName.toUpperCase()===e)return t;t=t.parentElement}});var E,S=function(e,t,i){void 0!==e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},L=function(e){return e?void 0!==e.target?e.target:e.srcElement:window.event.srcElement},N=navigator.userAgent.toLowerCase(),O=function(e){return e&&(N=(e+"").toLowerCase()),/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(N)?"tablet":/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(N)?"phone":"desktop"};return E={device:O(),detect:O,isMobile:"desktop"!==O(),userAgent:N},window.addEventListener("storage",(function(t){var i=(n=(t.key+"").split("/")).pop(),n=n.pop();e.i&&e.i[n]&&e.i[n].onStorageChange(i,t.newValue)})),e.serialize=function(e){return"object"==typeof e&&(e=JSON.stringify(e)),e},e.deserialize=function(e){try{e=JSON.parse(e)}catch(e){}return e},e.getViewName=function(){return window.location.pathname},e.getViewUrl=function(){return window.location.pathname},e}));