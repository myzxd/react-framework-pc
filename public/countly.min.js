(function(d,y){"function"===typeof define&&define.amd?define([],function(){return y(d.Countly)}):"object"===typeof module&&module.exports?module.exports=y(d.Countly):d.Countly=y(d.Countly)})("undefined"!==typeof window?window:this,function(d){function y(b){var l=[];if("undefined"!==typeof b.options)for(var d=0;d<b.options.length;d++)b.options[d].selected&&l.push(b.options[d].value);return l.join(", ")}function oa(){var b=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(l){var d=(b+16*Math.random())%16|0;b=Math.floor(b/16);return("x"===l?d:d&3|8).toString(16)})}function n(){return Math.floor((new Date).getTime()/1E3)}function $(){var b=(new Date).getTime();A>=b?A++:A=b;return A}function h(b,l,h){if(l&&Object.keys(l).length){if("undefined"!==typeof l[b])return l[b]}else if("undefined"!==typeof d[b])return d[b];return h}function aa(b,l,h){for(var k in d.i)d.i[k].tracking_crashes&&d.i[k].recordError(b,l,h)}function pa(b){var d=[],h;for(h in b)d.push(h+"="+
encodeURIComponent(b[h]));return d.join("&")}function ba(b){return"/"===b.substr(b.length-1)?b.substr(0,b.length-1):b}function B(b,d){for(var h={},k,n=0;n<d.length;n++)k=d[n],"undefined"!==typeof b[k]&&(h[k]=b[k]);return h}function ca(b){"undefined"===typeof b.pageY&&("number"===typeof b.clientX&&document.documentElement)&&(b.pageX=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b.pageY=b.clientY+document.body.scrollTop+document.documentElement.scrollTop);return b}function R(){var b=
document;return Math.max(Math.max(b.body.scrollHeight,b.documentElement.scrollHeight),Math.max(b.body.offsetHeight,b.documentElement.offsetHeight),Math.max(b.body.clientHeight,b.documentElement.clientHeight))}function da(){var b=document;return Math.max(Math.max(b.body.scrollWidth,b.documentElement.scrollWidth),Math.max(b.body.offsetWidth,b.documentElement.offsetWidth),Math.max(b.body.clientWidth,b.documentElement.clientWidth))}function qa(){var b=document;return Math.min(Math.min(b.body.clientHeight,
b.documentElement.clientHeight),Math.min(b.body.offsetHeight,b.documentElement.offsetHeight),window.innerHeight)}function ra(b){if(b)for(var d in b)if(Object.prototype.hasOwnProperty.call(b,d))return!0;return!1}function P(b,d,h,k,n,y){var b=document.createElement(b),B;b.setAttribute(d,h);b.setAttribute(k,n);y&&(b.onreadystatechange=b.onload=function(){B||y();B=!0});document.getElementsByTagName("head")[0].appendChild(b)}function sa(b,d){P("script","type","text/javascript","src",b,d)}function ea(b,
d){P("link","rel","stylesheet","href",b,d)}function ta(){var b=document.getElementById("cly-loader");if(!b){var b=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css";d.styleSheet?d.styleSheet.cssText="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}":
d.appendChild(document.createTextNode("#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}"));
b.appendChild(d);b=document.createElement("div");b.setAttribute("id","cly-loader");document.body.appendChild(b)}b.style.display="block"}function ua(){var b=document.getElementById("cly-loader");b&&(b.style.display="none")}d=d||{};d.features="sessions events views scrolls clicks forms crashes attribution users star-rating location apm feedback remote-config".split(" ");d.utm={source:!0,medium:!0,campaign:!0,term:!0,content:!0};d.q=d.q||[];d.onload=d.onload||[];var fa="20.11.1",va="javascript_native_web",
wa=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,Ga=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/;
d.CountlyClass=function(b){function l(a){if(!e.ignore_visitor)if(a.key){a.count||(a.count=1);var f=B(a,["key","count","sum","dur","segmentation"]);f.timestamp=$();var m=new Date;f.hour=m.getHours();f.dow=m.getDay();s.push(f);g("cly_event",s);i("Adding event: ",a)}else i("Event must have key property")}function na(){e.ignore_prefetch&&("undefined"!==typeof document.visibilityState&&"prerender"===document.visibilityState)&&(e.ignore_visitor=!0);e.ignore_bots&&Ga.test(navigator.userAgent)&&(e.ignore_visitor=
!0)}function A(a,f){if(!document.getElementById("countly-feedback-sticker-"+a._id))try{var m=document.createElement("div");m.className="countly-iframe-wrapper";m.id="countly-iframe-wrapper-"+a._id;var b=document.createElement("span");b.className="countly-feedback-close-icon";b.id="countly-feedback-close-icon-"+a._id;b.innerText="x";var d=document.createElement("iframe");d.name="countly-feedback-iframe";d.id="countly-feedback-iframe";d.src=e.url+"/feedback?widget_id="+a._id+"&app_key="+e.app_key+"&device_id="+
e.device_id+"&sdk_version="+fa;document.body.appendChild(m);m.appendChild(b);m.appendChild(d);k(document.getElementById("countly-feedback-close-icon-"+a._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+a._id).style.display="none";document.getElementById("cfbg").style.display="none"});if(f){var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.id="feedback-sticker-svg";c.setAttribute("aria-hidden","true");c.setAttribute("data-prefix","far");c.setAttribute("data-icon",
"grin");c.setAttribute("class","svg-inline--fa fa-grin fa-w-16");c.setAttribute("role","img");c.setAttribute("xmlns","http://www.w3.org/2000/svg");c.setAttribute("viewBox","0 0 496 512");var q=document.createElementNS("http://www.w3.org/2000/svg","path");q.id="smileyPathInStickerSvg";q.setAttribute("fill","white");q.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");
var g=document.createElement("span");g.innerText=a.trigger_button_text;var h=document.createElement("div");h.style.color=7>a.trigger_font_color?"#"+a.trigger_font_color:a.trigger_font_color;h.style.backgroundColor=7>a.trigger_bg_color.length?"#"+a.trigger_bg_color:a.trigger_bg_color;h.className="countly-feedback-sticker  "+a.trigger_position+"-"+a.trigger_size;h.id="countly-feedback-sticker-"+a._id;c.appendChild(q);h.appendChild(c);h.appendChild(g);document.body.appendChild(h);var l=document.getElementById("smileyPathInStickerSvg");
l&&(l.style.fill=7>a.trigger_font_color?"#"+a.trigger_font_color:a.trigger_font_color);k(document.getElementById("countly-feedback-sticker-"+a._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+a._id).style.display="block";document.getElementById("cfbg").style.display="block"})}else document.getElementById("countly-iframe-wrapper-"+a._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(n){i("Somethings went wrong while element injecting process: "+
n)}}function I(){var a;if("undefined"!==typeof e.onload&&0<e.onload.length){for(a=0;a<e.onload.length;a++)if("function"===typeof e.onload[a])e.onload[a](e);e.onload=[]}}function J(){if(K){var a={name:K};e.check_consent("views")&&l({key:"[CLY]_view",dur:L?n()-T:U,segmentation:a});K=null}}function P(){if(ga){var a=g("cly_session");if(!a||parseInt(a)<=n())E=!1,e.begin_session(!V);g("cly_session",n()+60*xa)}}function ya(a){a.app_key=e.app_key;a.device_id=e.device_id;a.sdk_name=va;a.sdk_version=fa;e.check_consent("location")?
(e.country_code&&(a.country_code=e.country_code),e.city&&(a.city=e.city),null!==e.ip_address&&(a.ip_address=e.ip_address)):a.location="";a.timestamp=$();var f=new Date;a.hour=f.getHours();a.dow=f.getDay()}function u(a){e.ignore_visitor||(!e.app_key||!e.device_id?i("app_key or device_id is missing"):(ya(a),r.length>Ha&&r.shift(),r.push(a),g("cly_queue",r,!0)))}function W(){I();if(e.test_mode||e.ignore_visitor)ha=!1;else{ha=!0;var a=0;if(ia&&"undefined"!==typeof d.q&&0<d.q.length){var f,m=d.q;d.q=[];
for(a=0;a<m.length;a++)if(f=m[a],i("Processing queued call",f),"function"===typeof f)f();else if(Array.isArray(f)&&0<f.length){var b=e,t=0;d.i[f[t]]&&(b=d.i[f[t]],t++);if("function"===typeof b[f[t]])b[f[t]].apply(b,f.slice(t+1));else if(0===f[t].indexOf("userData.")){var c=f[t].replace("userData.","");"function"===typeof b.userData[c]&&b.userData[c].apply(b,f.slice(t+1))}else"function"===typeof d[f[t]]&&d[f[t]].apply(d,f.slice(t+1))}}E&&(V&&L)&&(a=n(),a-F>Ia&&(e.session_duration(a-F),F=a));0<s.length&&
(s.length<=za?(u({events:JSON.stringify(s)}),s=[]):(a=s.splice(0,za),u({events:JSON.stringify(a)})),g("cly_event",s));!C&&(0<r.length&&ja&&n()>Aa)&&(ja=!1,a=r[0],ra(D)&&(G&&(clearTimeout(G),G=null),a.consent=JSON.stringify(D),D={}),i("Processing request",a),g("cly_queue",r,!0),M(e.url+Ja,a,function(a,f){i("Request Finished",f,a);a?Aa=n()+Ka:r.shift();g("cly_queue",r,!0);ja=!0}));setTimeout(W,La)}}function ka(){return g("cly_id")||oa()}function X(){var a=JSON.parse(JSON.stringify(e.metrics||{}));a._app_version=
a._app_version||e.app_version;a._ua=a._ua||navigator.userAgent;if(screen.width){var f=screen.width?parseInt(screen.width):0,m=screen.height?parseInt(screen.height):0;if(0!==f&&0!==m){if(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)f=Math.round(f*window.devicePixelRatio),m=Math.round(m*window.devicePixelRatio);else if(90===Math.abs(window.orientation))var b=f,f=m,m=b;a._resolution=a._resolution||""+f+"x"+m}}window.devicePixelRatio&&(a._density=a._density||
window.devicePixelRatio);f=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==typeof f&&(a._locale=a._locale||f);if("undefined"!==typeof document.referrer&&document.referrer.length&&(f=wa.exec(document.referrer))&&f[11]&&f[11]!==window.location.hostname){f=!1;if(H&&H.length)for(m=0;m<H.length;m++)try{if(RegExp(H[m]).test(document.referrer)){i("Ignored:",document.referrer);f=!0;break}}catch(d){i("Problem with regex",H[m])}f||(a._store=a._store||
document.referrer)}i("Got metrics",a);return a}function i(){e.debug&&"undefined"!==typeof console&&(arguments[1]&&"object"===typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),ia||(arguments[0]="["+e.app_key+"] "+arguments[0]),console.log(Array.prototype.slice.call(arguments).join("\n")))}function M(a,f,m){try{i("Sending XML HTTP request");var b=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):null,f=f||{},d=pa(f),c="GET";
if(e.force_post||2E3<=d.length)c="POST";"GET"===c?b.open("GET",a+"?"+d,!0):(b.open("POST",a,!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"));for(var q in e.headers)b.setRequestHeader(q,e.headers[q]);b.onreadystatechange=function(){4===this.readyState&&200<=this.status&&300>this.status?"function"===typeof m&&m(!1,f,this.responseText):4===this.readyState&&(i("Failed Server XML HTTP request",this.status),"function"===typeof m&&m(!0,f))};"GET"===c?b.send():b.send(d)}catch(g){i("Failed XML HTTP request",
g),"function"===typeof m&&m(!0,f)}}function Ba(a){g("cly_token",a)}function g(a,f,b,j){function d(a,f,b){var c=new Date;c.setTime(c.getTime()+864E5*b);b="; expires="+c.toGMTString();document.cookie=a+"="+f+b+"; path=/"}if("none"!==e.storage){j||(a=e.app_key+"/"+a,e.namespace&&(a=ba(e.namespace)+"/"+a));var b=b||"localstorage"===e.storage,c;"undefined"!==typeof f&&null!==f&&(f=e.serialize(f),Q?localStorage.setItem(a,f):b||d(a,f,30));if("undefined"===typeof f){if(Q)c=localStorage.getItem(a);else if(!b)a:{a+=
"=";f=document.cookie.split(";");b=0;for(j=f.length;b<j;b++){for(c=f[b];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(a)){c=c.substring(a.length,c.length);break a}}c=null}return e.deserialize(c)}null===f&&(Q?localStorage.removeItem(a):b||d(a,"",-1))}}var e=this,ia=!d.i,E=!1,Ja="/i",La=h("interval",b,500),Ha=h("queue_size",b,1E3),r=[],s=[],w={},N=[],O={},H=h("ignore_referrers",b,[]),Ca=null,V=!0,F,Da=0,K=null,T=0,U=0,Aa=0,Ka=h("fail_timeout",b,60),Ea=h("inactivity_time",b,20),Y=0,Ia=
h("session_update",b,60),za=h("max_events",b,10),Ma=h("max_logs",b,100),ga=h("use_session_cookie",b,!0),xa=h("session_cookie_timeout",b,30),ja=!0,ha=!1,C=h("offline_mode",b,!1),D={},v={},L=!0,Na=n(),Q=!0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(Oa){Q=!1}for(var p={},la=0;la<d.features.length;la++)p[d.features[la]]={};this.initialize=function(){this.serialize=b.serialize||d.serialize;this.deserialize=b.deserialize||d.deserialize;this.getViewName=b.getViewName||
d.getViewName;this.getViewUrl=b.getViewUrl||d.getViewUrl;this.namespace=h("namespace",b,"");this.app_key=h("app_key",b,null);this.onload=h("onload",b,[]);this.utm=h("utm",b,{source:!0,medium:!0,campaign:!0,term:!0,content:!0});this.ignore_prefetch=h("ignore_prefetch",b,!0);this.debug=h("debug",b,!1);this.test_mode=h("test_mode",b,!1);this.metrics=h("metrics",b,{});this.headers=h("headers",b,{});this.url=ba(h("url",b,""));this.app_version=h("app_version",b,"0.0");this.country_code=h("country_code",
b,null);this.city=h("city",b,null);this.ip_address=h("ip_address",b,null);this.ignore_bots=h("ignore_bots",b,!0);this.force_post=h("force_post",b,!1);this.remote_config=h("remote_config",b,!1);this.ignore_visitor=h("ignore_visitor",b,!1);this.require_consent=h("require_consent",b,!1);this.track_domains=h("track_domains",b,!0);this.storage=h("storage",b,"default");"cookie"===this.storage&&(Q=!1);Array.isArray(H)||(H=[]);""===this.url&&(i("Please provide server URL"),this.ignore_visitor=!0);g("cly_ignore")&&
(this.ignore_visitor=!0);if(g(e.namespace+"cly_id",void 0,!1,!0)){g("cly_id",g(e.namespace+"cly_id",void 0,!1,!0));g("cly_event",g(e.namespace+"cly_event",void 0,!1,!0));g("cly_session",g(e.namespace+"cly_session",void 0,!1,!0));var a=g(e.namespace+"cly_queue",void 0,!1,!0);Array.isArray(a)&&(a=a.filter(function(a){return a.app_key===e.app_key}),g("cly_queue",a));g(e.namespace+"cly_cmp_id",void 0,!1,!0)&&(g("cly_cmp_id",g(e.namespace+"cly_cmp_id",void 0,!1,!0)),g("cly_cmp_uid",g(e.namespace+"cly_cmp_uid",
void 0,!1,!0)));g(e.namespace+"cly_ignore",void 0,!1,!0)&&g("cly_ignore",g(e.namespace+"cly_ignore",void 0,!1,!0));g("cly_id",null,!1,!0);g("cly_event",null,!1,!0);g("cly_session",null,!1,!0);g("cly_queue",null,!1,!0);g("cly_cmp_id",null,!1,!0);g("cly_cmp_uid",null,!1,!0);g("cly_ignore",null,!1,!0)}C?this.device_id||(this.device_id="[CLY]_temp_id"):this.device_id=h("device_id",b,ka());r=g("cly_queue")||[];s=g("cly_event")||[];w=g("cly_remote_configs")||{};na();if(window.name&&0===window.name.indexOf("cly:"))try{this.passed_data=
JSON.parse(window.name.replace("cly:",""))}catch(f){i("Could not parse name",window.name)}else if(location.hash&&0===location.hash.indexOf("#cly:"))try{this.passed_data=JSON.parse(location.hash.replace("#cly:",""))}catch(m){i("Could not parse hash",location.hash)}if((this.passed_data&&this.passed_data.app_key&&this.passed_data.app_key===this.app_key||this.passed_data&&!this.passed_data.app_key&&ia)&&this.passed_data.token&&this.passed_data.purpose)this.passed_data.token!==g("cly_old_token")&&(Ba(this.passed_data.token),
g("cly_old_token",this.passed_data.token)),"heatmap"===this.passed_data.purpose&&(this.ignore_visitor=!0,ta(),sa(this.url+"/views/heatmap.js",ua));if(!this.ignore_visitor){i("Countly initialized");if(location.search){for(var a=location.search.substring(1).split("&"),j={},t=!1,c=0;c<a.length;c++){var q=a[c].split("=");"cly_id"===q[0]?g("cly_cmp_id",q[1]):"cly_uid"===q[0]?g("cly_cmp_uid",q[1]):"cly_device_id"===q[0]?this.device_id=q[1]:0===(q[0]+"").indexOf("utm_")&&this.utm[q[0].replace("utm_","")]&&
(j[q[0].replace("utm_","")]=q[1],t=!0)}if(t){for(var S in this.utm)j[S]?this.userData.set("utm_"+S,j[S]):this.userData.unset("utm_"+S);this.userData.save()}}C||this.device_id!==g("cly_id")&&g("cly_id",this.device_id);this.remote_config&&this.fetch_remote_config(this.remote_config);I();setTimeout(W,1)}document.documentElement.setAttribute("data-countly-useragent",navigator.userAgent)};this.group_features=function(a){if(a)for(var f in a)p[f]?i("Feature name "+f+" is already reserved"):"string"===typeof a[f]?
p[f]={features:[a[f]]}:a[f]&&Array.isArray(a[f])&&a[f].length?p[f]={features:a[f]}:i("Incorrect feature list for "+f+" value: "+a[f]);else i("Incorrect features: "+a)};this.check_consent=function(a){if(!this.require_consent)return!0;if(p[a])return p[a]&&p[a].optin?!0:!1;i("No feature available for "+a);return!1};this.check_any_consent=function(){if(!this.require_consent)return!0;for(var a in p)if(p[a]&&p[a].optin)return!0;return!1};this.add_consent=function(a){i("Adding consent for "+a);if(Array.isArray(a))for(var f=
0;f<a.length;f++)this.add_consent(a[f]);else p[a]?p[a].features?(p[a].optin=!0,this.add_consent(p[a].features)):!0!==p[a].optin&&(D[a]=!0,p[a].optin=!0,Fa(),setTimeout(function(){"sessions"===a&&v.begin_session?(e.begin_session.apply(e,v.begin_session),v.begin_session=null):"views"===a&&v.track_pageview&&(K=null,e.track_pageview.apply(e,v.track_pageview),v.track_pageview=null);v.change_id&&(e.change_id.apply(e,v.change_id),v.change_id=null)},1)):i("No feature available for "+a)};this.remove_consent=
function(a){i("Removing consent for "+a);if(Array.isArray(a))for(var f=0;f<a.length;f++)this.remove_consent(a[f]);else p[a]?(p[a].features?this.remove_consent(p[a].features):!1!==p[a].optin&&(D[a]=!1,Fa()),p[a].optin=!1):i("No feature available for "+a)};var G,Fa=function(){G&&(clearTimeout(G),G=null);G=setTimeout(function(){ra(D)&&(u({consent:JSON.stringify(D)}),D={})},1E3)};this.enable_offline_mode=function(){C=!0;this.device_id="[CLY]_temp_id"};this.disable_offline_mode=function(a){C=!1;a&&this.device_id!==
a?(this.device_id=a,g("cly_id",this.device_id),i("Changing id")):(this.device_id=ka(),this.device_id!==g("cly_id")&&g("cly_id",this.device_id));a=!1;if(0<r.length)for(var f=0;f<r.length;f++)"[CLY]_temp_id"===r[f].device_id&&(r[f].device_id=this.device_id,a=!0);a&&g("cly_queue",r,!0)};this.begin_session=function(a,f){if(this.check_consent("sessions")){if(!E){this.report_orientation();k(window,"resize",function(){e.report_orientation()});F=n();E=!0;V=a?!1:!0;var b=g("cly_session");if(f||!ga||!b||parseInt(b)<=
n())i("Session started"),b={begin_session:1},b.metrics=JSON.stringify(X()),u(b);g("cly_session",n()+60*xa)}}else v.begin_session=arguments};this.session_duration=function(a){this.check_consent("sessions")&&E&&(i("Session extended",a),u({session_duration:a}),P())};this.end_session=function(a,f){this.check_consent("sessions")&&E&&(a=a||n()-F,J(),!ga||f?(i("Ending session"),u({end_session:1,session_duration:a})):this.session_duration(a),E=!1)};this.change_id=function(a,f){if(this.device_id!==a){f||(0<
s.length&&(u({events:JSON.stringify(s)}),s=[],g("cly_event",s)),this.end_session(null,!0),O={});var b=this.device_id;this.device_id=a;g("cly_id",this.device_id);i("Changing id");f?this.check_any_consent()?u({old_device_id:b}):v.change_id=arguments:this.begin_session(!V,!0);this.remote_config&&(w={},g("cly_remote_configs",w),this.fetch_remote_config(this.remote_config))}};this.add_event=function(a){this.check_consent("events")&&l(a)};this.start_event=function(a){O[a]?i("Timed event with key "+a+" already started"):
O[a]=n()};this.end_event=function(a){"string"===typeof a&&(a={key:a});a.key?O[a.key]?(a.dur=n()-O[a.key],this.add_event(a),delete O[a.key]):i("Timed event with key "+a.key+" was not started"):i("Event must have key property")};this.report_orientation=function(a){this.check_consent("users")&&l({key:"[CLY]_orientation",segmentation:{mode:a||(window.innerWidth>window.innerHeight?"landscape":"portrait")}})};this.report_conversion=function(a,f){this.check_consent("attribution")&&(a=a||g("cly_cmp_id")||
"cly_organic",f=f||g("cly_cmp_uid"),a&&f?u({campaign_id:a,campaign_user:f}):a&&u({campaign_id:a}))};this.user_details=function(a){this.check_consent("users")&&(i("Adding userdetails: ",a),u({user_details:JSON.stringify(B(a,"name username email organization phone picture gender byear custom".split(" ")))}))};var x={},z=function(a,f,b){e.check_consent("users")&&(x[a]||(x[a]={}),"$push"===b||"$pull"===b||"$addToSet"===b?(x[a][b]||(x[a][b]=[]),x[a][b].push(f)):x[a][b]=f)};this.userData={set:function(a,
f){x[a]=f},unset:function(a){x[a]=""},set_once:function(a,f){z(a,f,"$setOnce")},increment:function(a){z(a,1,"$inc")},increment_by:function(a,f){z(a,f,"$inc")},multiply:function(a,f){z(a,f,"$mul")},max:function(a,f){z(a,f,"$max")},min:function(a,f){z(a,f,"$min")},push:function(a,f){z(a,f,"$push")},push_unique:function(a,f){z(a,f,"$addToSet")},pull:function(a,f){z(a,f,"$pull")},save:function(){e.check_consent("users")&&u({user_details:JSON.stringify({custom:x})});x={}}};this.report_trace=function(a){if(this.check_consent("apm")){for(var f=
"type name stz etz apm_metrics apm_attr".split(" "),b=0;b<f.length;b++)if("apm_attr"!==f[b]&&"undefined"===typeof a[f[b]]){i("APM trace must have a",f[b]);return}f=B(a,f);f.timestamp=a.stz;a=new Date;f.hour=a.getHours();f.dow=a.getDay();u({apm:JSON.stringify(f)});i("Adding APM trace: ",f)}};this.track_errors=function(a){d.i[this.app_key].tracking_crashes=!0;window.cly_crashes||(window.cly_crashes=!0,Ca=a,window.onerror=function(a,b,j,e,c){if("undefined"!==typeof c)aa(c,!1);else{var e=e||window.event&&
window.event.errorCharacter,d="";"undefined"!==typeof a&&(d+=a+"\n");"undefined"!==typeof b&&(d+="at "+b);"undefined"!==typeof j&&(d+=":"+j);"undefined"!==typeof e&&(d+=":"+e);d+="\n";try{for(var g=[],i=arguments.callee.caller;i;)g.push(i.name),i=i.caller;d+=g.join("\n")}catch(h){}aa(d,!1)}},window.addEventListener("unhandledrejection",function(a){aa(Error("Unhandled rejection (reason: "+(a.reason&&a.reason.stack?a.reason.stack:a.reason)+")."),!0)}))};this.log_error=function(a,f){this.recordError(a,
!0,f)};this.add_log=function(a){this.check_consent("crashes")&&(N.length>Ma&&N.shift(),N.push(a))};this.fetch_remote_config=function(a,f,b){if(this.check_consent("remote-config")){var j={method:"fetch_remote_config"};this.check_consent("sessions")&&(j.metrics=JSON.stringify(X()));a&&(!b&&"function"===typeof a?(b=a,a=null):Array.isArray(a)&&a.length&&(j.keys=JSON.stringify(a)));f&&(!b&&"function"===typeof f?(b=f,f=null):Array.isArray(f)&&f.length&&(j.omit_keys=JSON.stringify(f)));ya(j);M(this.url+
"/o/sdk",j,function(a,f,d){try{var e=JSON.parse(d);if(j.keys||j.omit_keys)for(var i in e)w[i]=e[i];else w=e;g("cly_remote_configs",w)}catch(h){}"function"===typeof b&&b(a,w)})}else i("Remote config requires explicit consent"),"function"===typeof b&&b(Error("Remote config requires explicit consent"),w)};this.get_remote_config=function(a){return"undefined"!==typeof a?w[a]:w};this.stop_time=function(){L&&(L=!1,Da=n()-F,U=n()-T)};this.start_time=function(){L||(L=!0,F=n()-Da,T=n()-U,U=0,P())};this.track_sessions=
function(){function a(){document[m]?e.stop_time():e.start_time()}function b(){Y>=Ea&&e.start_time();Y=0}this.begin_session();this.start_time();k(window,"beforeunload",function(){e.end_session()});k(window,"unload",function(){e.end_session()});var m="hidden";m in document?document.addEventListener("visibilitychange",a):(m="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(m="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(m="msHidden")in document?
document.addEventListener("msvisibilitychange",a):"onfocusin"in document?(k(window,"focusin",function(){e.start_time()}),k(window,"focusout",function(){e.stop_time()})):(k(window,"focus",function(){e.start_time()}),k(window,"blur",function(){e.stop_time()}),k(window,"pageshow",function(){e.start_time()}),k(window,"pagehide",function(){e.stop_time()}));k(window,"mousemove",b);k(window,"click",b);k(window,"keydown",b);k(window,"scroll",b);setInterval(function(){Y++;Y>=Ea&&e.stop_time()},6E4)};this.track_pageview=
function(a,b,m){J();a&&Array.isArray(a)&&(b=a,a=null);a||(a=this.getViewName());if(b&&b.length)for(var j=0;j<b.length;j++)try{if(RegExp(b[j]).test(a)){i("Ignored:",a);return}}catch(d){i("Problem with regex",b[j])}K=a;T=n();j={name:a,visit:1,view:this.getViewUrl()};this.track_domains&&(j.domain=window.location.hostname);if("undefined"!==typeof document.referrer&&document.referrer.length){var c=wa.exec(document.referrer);c&&(c[11]&&c[11]!==window.location.hostname)&&(j.start=1)}if(m)for(var e in m)"undefined"===
typeof j[e]&&(j[e]=m[e]);this.check_consent("views")?l({key:"[CLY]_view",segmentation:j}):v.track_pageview=arguments};this.track_view=function(a,b,m){this.track_pageview(a,b,m)};this.track_clicks=function(a){var a=a||document,b=!0;k(a,"click",function(a){if(b){b=!1;ca(a);if("undefined"!==typeof a.pageX&&"undefined"!==typeof a.pageY){var j=R(),d=da();e.check_consent("clicks")&&(a={type:"click",x:a.pageX,y:a.pageY,width:d,height:j,view:e.getViewUrl()},e.track_domains&&(a.domain=window.location.hostname),
l({key:"[CLY]_action",segmentation:a}))}setTimeout(function(){b=!0},1E3)}})};this.track_scrolls=function(a){function b(){if(m){m=!1;var a=R(),f=da(),d=qa();e.check_consent("scrolls")&&(a={type:"scroll",y:j+d,width:f,height:a,view:e.getViewUrl()},e.track_domains&&(a.domain=window.location.hostname),l({key:"[CLY]_action",segmentation:a}))}}var a=a||window,m=!0,j=0;k(a,"scroll",function(){j=Math.max(j,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)});k(a,"beforeunload",b);
k(a,"unload",b)};this.track_links=function(a){a=a||document;k(a,"click",function(a){var b=Z(a).closest("a");b&&(ca(a),e.check_consent("clicks")&&l({key:"linkClick",segmentation:{href:b.href,text:b.innerText,id:b.id,view:e.getViewUrl()}}))})};this.track_forms=function(a,b){function m(a){return a.name||a.id||a.type||a.nodeName}a=a||document;k(a,"submit",function(a){var a=Z(a),d={id:a.attributes.id&&a.attributes.id.nodeValue,name:a.attributes.name&&a.attributes.name.nodeValue,action:a.attributes.action&&
a.attributes.action.nodeValue,method:a.attributes.method&&a.attributes.method.nodeValue,view:e.getViewUrl()},c;if("undefined"!==typeof a.elements){for(var g=0;g<a.elements.length;g++)if((c=a.elements[g])&&"password"!==c.type&&-1===c.className.indexOf("cly_user_ignore"))"undefined"===typeof d["input:"+m(c)]&&(d["input:"+m(c)]=[]),"select"===c.nodeName.toLowerCase()?"undefined"!==typeof c.multiple?d["input:"+m(c)].push(y(c)):d["input:"+m(c)].push(c.options[c.selectedIndex].value):"input"===c.nodeName.toLowerCase()?
"undefined"!==typeof c.type?"checkbox"===c.type.toLowerCase()||"radio"===c.type.toLowerCase()?c.checked&&d["input:"+m(c)].push(c.value):("hidden"!==c.type.toLowerCase()||b)&&d["input:"+m(c)].push(c.value):d["input:"+m(c)].push(c.value):"textarea"===c.nodeName.toLowerCase()?d["input:"+m(c)].push(c.value):"undefined"!==typeof c.value&&d["input:"+m(c)].push(c.value);for(var i in d)d[i]&&"function"===typeof d[i].join&&(d[i]=d[i].join(", "))}e.check_consent("forms")&&l({key:"formSubmit",segmentation:d})})};
this.collect_from_forms=function(a,b){a=a||document;k(a,"submit",function(d){var d=Z(d),j={},g=!1,c;if("undefined"!==typeof d.elements){var h={},l=a.getElementsByTagName("LABEL"),k;for(k=0;k<l.length;k++)l[k].htmlFor&&""!==l[k].htmlFor&&(h[l[k].htmlFor]=l[k].innerText||l[k].textContent||l[k].innerHTML);for(k=0;k<d.elements.length;k++)if((c=d.elements[k])&&"password"!==c.type&&-1===c.className.indexOf("cly_user_ignore"))if(l="","select"===c.nodeName.toLowerCase()?l="undefined"!==typeof c.multiple?
y(c):c.options[c.selectedIndex].value:"input"===c.nodeName.toLowerCase()?"undefined"!==typeof c.type?"checkbox"===c.type.toLowerCase()||"radio"===c.type.toLowerCase()?c.checked&&(l=c.value):l=c.value:l=c.value:"textarea"===c.nodeName.toLowerCase()?l=c.value:"undefined"!==typeof c.value&&(l=c.value),c.className&&-1!==c.className.indexOf("cly_user_")){var n=c.className.split(" ");for(c=0;c<n.length;c++)if(0===n[c].indexOf("cly_user_")){j[n[c].replace("cly_user_","")]=l;g=!0;break}}else if(c.type&&"email"===
c.type.toLowerCase()||c.name&&-1!==c.name.toLowerCase().indexOf("email")||c.id&&-1!==c.id.toLowerCase().indexOf("email")||c.id&&h[c.id]&&-1!==h[c.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(l))j.email||(j.email=l),g=!0;else if(c.name&&-1!==c.name.toLowerCase().indexOf("username")||c.id&&-1!==c.id.toLowerCase().indexOf("username")||c.id&&h[c.id]&&-1!==h[c.id].toLowerCase().indexOf("username"))j.username||(j.username=l),g=!0;else if(c.name&&(-1!==c.name.toLowerCase().indexOf("tel")||
-1!==c.name.toLowerCase().indexOf("phone")||-1!==c.name.toLowerCase().indexOf("number"))||c.id&&(-1!==c.id.toLowerCase().indexOf("tel")||-1!==c.id.toLowerCase().indexOf("phone")||-1!==c.id.toLowerCase().indexOf("number"))||c.id&&h[c.id]&&(-1!==h[c.id].toLowerCase().indexOf("tel")||-1!==h[c.id].toLowerCase().indexOf("phone")||-1!==h[c.id].toLowerCase().indexOf("number")))j.phone||(j.phone=l),g=!0;else if(c.name&&(-1!==c.name.toLowerCase().indexOf("org")||-1!==c.name.toLowerCase().indexOf("company"))||
c.id&&(-1!==c.id.toLowerCase().indexOf("org")||-1!==c.id.toLowerCase().indexOf("company"))||c.id&&h[c.id]&&(-1!==h[c.id].toLowerCase().indexOf("org")||-1!==h[c.id].toLowerCase().indexOf("company")))j.organization||(j.organization=l),g=!0;else if(c.name&&-1!==c.name.toLowerCase().indexOf("name")||c.id&&-1!==c.id.toLowerCase().indexOf("name")||c.id&&h[c.id]&&-1!==h[c.id].toLowerCase().indexOf("name"))j.name||(j.name=""),j.name+=l+" ",g=!0}g&&(i("Gathered user data",j),b?e.user_details({custom:j}):e.user_details(j))})};
this.collect_from_facebook=function(a){FB&&FB.api&&FB.api("/me",function(b){var d={};b.name&&(d.name=b.name);b.email&&(d.email=b.email);"male"===b.gender?d.gender="M":"female"===b.gender&&(d.gender="F");if(b.birthday){var j=b.birthday.split("/").pop();j&&4===j.length&&(d.byear=j)}b.work&&(b.work[0]&&b.work[0].employer&&b.work[0].employer.name)&&(d.organization=b.work[0].employer.name);if(a){d.custom={};for(var g in a){for(var j=a[g].split("."),c=b,h=0;h<j.length&&!(c=c[j[h]],"undefined"===typeof c);h++);
"undefined"!==typeof c&&(d.custom[g]=c)}}e.user_details(d)})};this.opt_out=function(){this.ignore_visitor=!0;g("cly_ignore",!0)};this.opt_in=function(){g("cly_ignore",!1);this.ignore_visitor=!1;na();!this.ignore_visitor&&!ha&&W()};this.report_feedback=function(a){if(this.check_consent("star-rating")||this.check_consent("feedback"))if(a.widget_id)if(a.rating){if(this.check_consent("events")){var b={key:"[CLY]_star_rating",count:1,segmentation:{}};b.segmentation=B(a,"widget_id contactMe platform app_version rating email comment".split(" "));
b.segmentation.app_version||(b.segmentation.app_version=this.metrics._app_version||this.app_version);i("Reporting feedback: ",b);this.add_event(b)}}else i("Feedback must contain rating property");else i("Feedback must contain widget_id property")};this.show_feedback_popup=function(a){if(this.check_consent("star-rating")||this.check_consent("feedback"))C?i("Cannot show feedback popup in offline mode"):M(this.url+"/o/feedback/widget",{widget_id:a},function(a,b,d){a&&i("Error occurred",a);try{var e=
JSON.parse(d);A(e,!1)}catch(c){i("JSON parse failed: "+c)}})};this.initialize_feedback_popups=function(a){if(this.check_consent("star-rating")||this.check_consent("feedback")){a||(a=g("cly_fb_widgets"));for(var b=document.getElementsByClassName("countly-feedback-sticker");0<b.length;)b[0].remove();M(this.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(a)},function(a,b,f){if(a)i("Errors occurred:",a);else try{for(var c=JSON.parse(f),a=0;a<c.length;a++)if("true"===c[a].is_active&&c[a].target_devices[ma.device])if("string"===
typeof c[a].hide_sticker&&(c[a].hide_sticker="true"===c[a].hide_sticker?!0:!1),"all"===c[a].target_page&&!c[a].hide_sticker)A(c[a],!0);else for(var d=c[a].target_pages,b=0;b<d.length;b++){var e=d[b].substr(0,d[b].length-1)===window.location.pathname.substr(0,d[b].length-1),g=d[b]===window.location.pathname;(d[b].includes("*")&&e||g)&&!c[a].hide_sticker&&A(c[a],!0)}}catch(h){i("JSON parse error: "+h)}})}};this.enable_feedback=function(a){if(this.check_consent("star-rating")||this.check_consent("feedback"))C?
i("Cannot enable feedback in offline mode"):(g("cly_fb_widgets",a.popups||a.widgets),ea(this.url+"/star-rating/stylesheets/countly-feedback-web.css"),a=a.popups||a.widgets,0<a.length?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),this.initialize_feedback_popups(a)):i("You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback"))};this.get_available_feedback_widgets=function(a){!this.check_consent("star-rating")&&
!this.check_consent("feedback")?a&&a(null,Error("Consent for feedback not provided.")):C?i("Cannot enable feedback in offline mode."):M(this.url+"/o/sdk",{method:"feedback",device_id:this.device_id,app_key:this.app_key},function(b,d,e){if(b)i("Error occured while fetching feedbacks",b),a&&a(null,b);else try{var g=JSON.parse(e).result||[];a&&a(g,null)}catch(c){i("Error while processing feedbacks",c),a&&a(null,c)}})};this.present_feedback_widget=function(a){function b(a){document.getElementById("countly-surveys-wrapper-"+
a._id).style.display="block";document.getElementById("csbg").style.display="block"}if(this.check_consent("star-rating")||this.check_consent("feedback"))if(!a||"object"!==typeof a||Array.isArray(a))i("Please provide atleast one feedback widget object.");else try{var e=this.url;if("nps"===a.type)e+="/feedback/nps";else if("survey"===a.type)e+="/feedback/survey";else{i("Feedback widget only accepts nps and survey types.");return}var e=e+("?widget_id="+a._id),e=e+("&app_key="+this.app_key),e=e+("&device_id="+
this.device_id),e=e+("&sdk_name="+va),e=e+("&platform="+this.platform),e=e+("&app_version="+this.app_version),e=e+("&sdk_version="+fa),e=e+("&origin="+window.origin),e=e+"&widget_v=web",g=document.createElement("iframe");g.name="countly-surveys-iframe";g.id="countly-surveys-iframe";g.src=e;var h=!1;g.onload=function(){h&&(document.getElementById("countly-surveys-wrapper-"+a._id).style.display="none",document.getElementById("csbg").style.display="none");h=!0};ea(this.url+"/surveys/stylesheets/countly-surveys.css");
for(var c=document.getElementById("csbg");c;)c.remove(),c=document.getElementById("csbg");for(var l=document.getElementsByClassName("countly-surveys-wrapper"),e=0;e<l.length;e++)l[e].remove();document.body.insertAdjacentHTML("beforeend",'<div id="csbg"></div>');l=document.createElement("div");l.className="countly-surveys-wrapper";l.id="countly-surveys-wrapper-"+a._id;"survey"===a.type&&(l.className=l.className+" "+a.appearance.position);document.body.appendChild(l);l.appendChild(g);k(window,"message",
function(b){var c={};try{c=JSON.parse(b.data)}catch(f){i("Error while parsing message body "+f)}b.origin===d.url&&c.close&&(document.getElementById("countly-surveys-wrapper-"+a._id).style.display="none",document.getElementById("csbg").style.display="none")});if("survey"===a.type){var n=!1;switch(a.showPolicy){case "afterPageLoad":"complete"===document.readyState?n||(n=!0,b(a)):k(document,"readystatechange",function(c){"complete"===c.target.readyState&&!n&&(n=!0,b(a))});break;case "afterConstantDelay":setTimeout(function(){n||
(n=!0,b(a))},1E4);break;case "onAbandon":"complete"===document.readyState?k(document,"mouseleave",function(){n||(n=!0,b(a))}):k(document,"readystatechange",function(c){"complete"===c.target.readyState&&k(document,"mouseleave",function(){n||(n=!0,b(a))})});break;case "onScrollHalfwayDown":k(window,"scroll",function(){if(!n){var c=Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop),d=R();c>=d/2&&(n=!0,b(a))}});break;default:n||(n=!0,b(a))}}else"nps"===a.type&&(document.getElementById("countly-surveys-wrapper-"+
a._id).style.display="block",document.getElementById("csbg").style.display="block")}catch(p){i("Somethings went wrong while presenting the feedback",p)}};this.recordError=function(a,b,d){if(this.check_consent("crashes")&&a){var d=d||Ca,e="";"object"===typeof a?"undefined"!==typeof a.stack?e=a.stack:("undefined"!==typeof a.name&&(e+=a.name+":"),"undefined"!==typeof a.message&&(e+=a.message+"\n"),"undefined"!==typeof a.fileName&&(e+="in "+a.fileName+"\n"),"undefined"!==typeof a.lineNumber&&(e+="on "+
a.lineNumber),"undefined"!==typeof a.columnNumber&&(e+=":"+a.columnNumber)):e=a+"";b=b?!0:!1;a=X();e={_resolution:a._resolution,_error:e,_app_version:a._app_version,_run:n()-Na,_not_os_specific:!0,_javascript:!0};if(a=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery)e._bat=Math.floor(100*a.level);"undefined"!==typeof navigator.onLine&&(e._online=navigator.onLine?!0:!1);e._background=document.hasFocus()?!1:!0;0<N.length&&(e._logs=N.join("\n"));N=[];e._nonfatal=
b;e._view=this.getViewName();"undefined"!==typeof d&&(e._custom=d);try{var g=document.createElement("canvas").getContext("experimental-webgl");e._opengl=g.getParameter(g.VERSION)}catch(c){}u({crash:JSON.stringify(e)})}};this.onStorageChange=function(a,b){switch(a){case "cly_queue":r=e.deserialize(b||"[]");break;case "cly_event":s=e.deserialize(b||"[]");break;case "cly_remote_configs":w=e.deserialize(b||"{}");break;case "cly_ignore":e.ignore_visitor=e.deserialize(b);break;case "cly_id":e.device_id=
e.deserialize(b)}};this._internals={store:g,getDocWidth:da,getDocHeight:R,getViewportHeight:qa,get_page_coord:ca,get_event_target:Z,add_event:k,getProperties:B,stripTrailingSlash:ba,prepareParams:pa,sendXmlHttpRequest:M,getMsTimestamp:$,getTimestamp:n,log:i,getMetrics:X,generateUUID:oa,isUUID:function(){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(e.device_id)},getId:ka,heartBeat:W,toRequestQueue:u,reportViewDuration:J,loadJS:sa,loadCSS:ea,getLastView:function(){return K},
setToken:Ba,getToken:function(){var a=g("cly_token");g("cly_token",null);return a},showLoader:ta,hideLoader:ua,add_cly_events:l,detect_device:ma,getRequestQueue:function(){return r},getEventQueue:function(){return s},clearQueue:function(){r=[];g("cly_queue",[]);s=[];g("cly_event",[])}};this.initialize()};d.init=function(b){var b=b||{},h=b.app_key||d.app_key;if(!d.i||!d.i[h]){b=new d.CountlyClass(b);if(!d.i){d.i={};for(var k in b)d[k]=b[k]}d.i[h]=b}return d.i[h]};var A=0;Element.prototype.closest||
(Element.prototype.closest=function(b){for(var d=this,b=b.toUpperCase();d;){if(d.nodeName.toUpperCase()===b)return d;d=d.parentElement}});var k=function(b,d,h){"undefined"!==typeof b.addEventListener?b.addEventListener(d,h,!1):b.attachEvent("on"+d,h)},Z=function(b){return b?"undefined"!==typeof b.target?b.target:b.srcElement:window.event.srcElement},ma,I=navigator.userAgent.toLowerCase(),J=function(b){b&&(I=(b+"").toLowerCase());return/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(I)?
"tablet":/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(I)?"phone":"desktop"};ma={device:J(),detect:J,isMobile:"desktop"!==J()?!0:!1,userAgent:I};window.addEventListener("storage",function(b){var h=(b.key+"").split("/"),k=h.pop(),h=h.pop();if(d.i&&d.i[h])d.i[h].onStorageChange(k,b.newValue)});d.serialize=function(b){"object"===typeof b&&(b=JSON.stringify(b));return b};d.deserialize=function(b){try{b=
JSON.parse(b)}catch(d){}return b};d.getViewName=function(){return window.location.pathname};d.getViewUrl=function(){return window.location.pathname};return d});
